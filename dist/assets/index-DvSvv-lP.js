var IN=Object.defineProperty;var xb=i=>{throw TypeError(i)};var PN=(i,t,e)=>t in i?IN(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ot=(i,t,e)=>PN(i,typeof t!="symbol"?t+"":t,e),v0=(i,t,e)=>t.has(i)||xb("Cannot "+e);var g=(i,t,e)=>(v0(i,t,"read from private field"),e?e.call(i):t.get(i)),w=(i,t,e)=>t.has(i)?xb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),C=(i,t,e,n)=>(v0(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),R=(i,t,e)=>(v0(i,t,"access private method"),e);var Rn=(i,t,e,n)=>({set _(o){C(i,t,o,e)},get _(){return g(i,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();function __(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var A0={exports:{}},nf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b;function LN(){if(_b)return nf;_b=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,o,r){var u=null;if(r!==void 0&&(u=""+r),o.key!==void 0&&(u=""+o.key),"key"in o){r={};for(var c in o)c!=="key"&&(r[c]=o[c])}else r=o;return o=r.ref,{$$typeof:i,type:n,key:u,ref:o!==void 0?o:null,props:r}}return nf.Fragment=t,nf.jsx=e,nf.jsxs=e,nf}var wb;function kN(){return wb||(wb=1,A0.exports=LN()),A0.exports}var M=kN(),T0={exports:{}},It={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mb;function UN(){if(Mb)return It;Mb=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),A=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=A&&V[A]||V["@@iterator"],typeof V=="function"?V:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function D(V,j,st){this.props=V,this.context=j,this.refs=x,this.updater=st||E}D.prototype.isReactComponent={},D.prototype.setState=function(V,j){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,j,"setState")},D.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function N(){}N.prototype=D.prototype;function L(V,j,st){this.props=V,this.context=j,this.refs=x,this.updater=st||E}var P=L.prototype=new N;P.constructor=L,b(P,D.prototype),P.isPureReactComponent=!0;var U=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function B(V,j,st,it,dt,Nt){return st=Nt.ref,{$$typeof:i,type:V,key:j,ref:st!==void 0?st:null,props:Nt}}function q(V,j){return B(V.type,j,void 0,void 0,void 0,V.props)}function Y(V){return typeof V=="object"&&V!==null&&V.$$typeof===i}function Q(V){var j={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(st){return j[st]})}var Z=/\/+/g;function ut(V,j){return typeof V=="object"&&V!==null&&V.key!=null?Q(""+V.key):j.toString(36)}function St(){}function gt(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(St,St):(V.status="pending",V.then(function(j){V.status==="pending"&&(V.status="fulfilled",V.value=j)},function(j){V.status==="pending"&&(V.status="rejected",V.reason=j)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function yt(V,j,st,it,dt){var Nt=typeof V;(Nt==="undefined"||Nt==="boolean")&&(V=null);var Et=!1;if(V===null)Et=!0;else switch(Nt){case"bigint":case"string":case"number":Et=!0;break;case"object":switch(V.$$typeof){case i:case t:Et=!0;break;case y:return Et=V._init,yt(Et(V._payload),j,st,it,dt)}}if(Et)return dt=dt(V),Et=it===""?"."+ut(V,0):it,U(dt)?(st="",Et!=null&&(st=Et.replace(Z,"$&/")+"/"),yt(dt,j,st,"",function(_i){return _i})):dt!=null&&(Y(dt)&&(dt=q(dt,st+(dt.key==null||V&&V.key===dt.key?"":(""+dt.key).replace(Z,"$&/")+"/")+Et)),j.push(dt)),1;Et=0;var kt=it===""?".":it+":";if(U(V))for(var Yt=0;Yt<V.length;Yt++)it=V[Yt],Nt=kt+ut(it,Yt),Et+=yt(it,j,st,Nt,dt);else if(Yt=S(V),typeof Yt=="function")for(V=Yt.call(V),Yt=0;!(it=V.next()).done;)it=it.value,Nt=kt+ut(it,Yt++),Et+=yt(it,j,st,Nt,dt);else if(Nt==="object"){if(typeof V.then=="function")return yt(gt(V),j,st,it,dt);throw j=String(V),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return Et}function G(V,j,st){if(V==null)return V;var it=[],dt=0;return yt(V,it,"","",function(Nt){return j.call(st,Nt,dt++)}),it}function $(V){if(V._status===-1){var j=V._result;j=j(),j.then(function(st){(V._status===0||V._status===-1)&&(V._status=1,V._result=st)},function(st){(V._status===0||V._status===-1)&&(V._status=2,V._result=st)}),V._status===-1&&(V._status=0,V._result=j)}if(V._status===1)return V._result.default;throw V._result}var rt=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function vt(){}return It.Children={map:G,forEach:function(V,j,st){G(V,function(){j.apply(this,arguments)},st)},count:function(V){var j=0;return G(V,function(){j++}),j},toArray:function(V){return G(V,function(j){return j})||[]},only:function(V){if(!Y(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},It.Component=D,It.Fragment=e,It.Profiler=o,It.PureComponent=L,It.StrictMode=n,It.Suspense=f,It.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,It.__COMPILER_RUNTIME={__proto__:null,c:function(V){return k.H.useMemoCache(V)}},It.cache=function(V){return function(){return V.apply(null,arguments)}},It.cloneElement=function(V,j,st){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var it=b({},V.props),dt=V.key,Nt=void 0;if(j!=null)for(Et in j.ref!==void 0&&(Nt=void 0),j.key!==void 0&&(dt=""+j.key),j)!F.call(j,Et)||Et==="key"||Et==="__self"||Et==="__source"||Et==="ref"&&j.ref===void 0||(it[Et]=j[Et]);var Et=arguments.length-2;if(Et===1)it.children=st;else if(1<Et){for(var kt=Array(Et),Yt=0;Yt<Et;Yt++)kt[Yt]=arguments[Yt+2];it.children=kt}return B(V.type,dt,void 0,void 0,Nt,it)},It.createContext=function(V){return V={$$typeof:u,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:r,_context:V},V},It.createElement=function(V,j,st){var it,dt={},Nt=null;if(j!=null)for(it in j.key!==void 0&&(Nt=""+j.key),j)F.call(j,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(dt[it]=j[it]);var Et=arguments.length-2;if(Et===1)dt.children=st;else if(1<Et){for(var kt=Array(Et),Yt=0;Yt<Et;Yt++)kt[Yt]=arguments[Yt+2];dt.children=kt}if(V&&V.defaultProps)for(it in Et=V.defaultProps,Et)dt[it]===void 0&&(dt[it]=Et[it]);return B(V,Nt,void 0,void 0,null,dt)},It.createRef=function(){return{current:null}},It.forwardRef=function(V){return{$$typeof:c,render:V}},It.isValidElement=Y,It.lazy=function(V){return{$$typeof:y,_payload:{_status:-1,_result:V},_init:$}},It.memo=function(V,j){return{$$typeof:h,type:V,compare:j===void 0?null:j}},It.startTransition=function(V){var j=k.T,st={};k.T=st;try{var it=V(),dt=k.S;dt!==null&&dt(st,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(vt,rt)}catch(Nt){rt(Nt)}finally{k.T=j}},It.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},It.use=function(V){return k.H.use(V)},It.useActionState=function(V,j,st){return k.H.useActionState(V,j,st)},It.useCallback=function(V,j){return k.H.useCallback(V,j)},It.useContext=function(V){return k.H.useContext(V)},It.useDebugValue=function(){},It.useDeferredValue=function(V,j){return k.H.useDeferredValue(V,j)},It.useEffect=function(V,j,st){var it=k.H;if(typeof st=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return it.useEffect(V,j)},It.useId=function(){return k.H.useId()},It.useImperativeHandle=function(V,j,st){return k.H.useImperativeHandle(V,j,st)},It.useInsertionEffect=function(V,j){return k.H.useInsertionEffect(V,j)},It.useLayoutEffect=function(V,j){return k.H.useLayoutEffect(V,j)},It.useMemo=function(V,j){return k.H.useMemo(V,j)},It.useOptimistic=function(V,j){return k.H.useOptimistic(V,j)},It.useReducer=function(V,j,st){return k.H.useReducer(V,j,st)},It.useRef=function(V){return k.H.useRef(V)},It.useState=function(V){return k.H.useState(V)},It.useSyncExternalStore=function(V,j,st){return k.H.useSyncExternalStore(V,j,st)},It.useTransition=function(){return k.H.useTransition()},It.version="19.1.0",It}var Rb;function hT(){return Rb||(Rb=1,T0.exports=UN()),T0.exports}var at=hT();const FN=__(at);var S0={exports:{}},sf={},E0={exports:{}},C0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nb;function ON(){return Nb||(Nb=1,function(i){function t(G,$){var rt=G.length;G.push($);t:for(;0<rt;){var vt=rt-1>>>1,V=G[vt];if(0<o(V,$))G[vt]=$,G[rt]=V,rt=vt;else break t}}function e(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var $=G[0],rt=G.pop();if(rt!==$){G[0]=rt;t:for(var vt=0,V=G.length,j=V>>>1;vt<j;){var st=2*(vt+1)-1,it=G[st],dt=st+1,Nt=G[dt];if(0>o(it,rt))dt<V&&0>o(Nt,it)?(G[vt]=Nt,G[dt]=rt,vt=dt):(G[vt]=it,G[st]=rt,vt=st);else if(dt<V&&0>o(Nt,rt))G[vt]=Nt,G[dt]=rt,vt=dt;else break t}}return $}function o(G,$){var rt=G.sortIndex-$.sortIndex;return rt!==0?rt:G.id-$.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var u=Date,c=u.now();i.unstable_now=function(){return u.now()-c}}var f=[],h=[],y=1,A=null,S=3,E=!1,b=!1,x=!1,D=!1,N=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function U(G){for(var $=e(h);$!==null;){if($.callback===null)n(h);else if($.startTime<=G)n(h),$.sortIndex=$.expirationTime,t(f,$);else break;$=e(h)}}function k(G){if(x=!1,U(G),!b)if(e(f)!==null)b=!0,F||(F=!0,ut());else{var $=e(h);$!==null&&yt(k,$.startTime-G)}}var F=!1,B=-1,q=5,Y=-1;function Q(){return D?!0:!(i.unstable_now()-Y<q)}function Z(){if(D=!1,F){var G=i.unstable_now();Y=G;var $=!0;try{t:{b=!1,x&&(x=!1,L(B),B=-1),E=!0;var rt=S;try{e:{for(U(G),A=e(f);A!==null&&!(A.expirationTime>G&&Q());){var vt=A.callback;if(typeof vt=="function"){A.callback=null,S=A.priorityLevel;var V=vt(A.expirationTime<=G);if(G=i.unstable_now(),typeof V=="function"){A.callback=V,U(G),$=!0;break e}A===e(f)&&n(f),U(G)}else n(f);A=e(f)}if(A!==null)$=!0;else{var j=e(h);j!==null&&yt(k,j.startTime-G),$=!1}}break t}finally{A=null,S=rt,E=!1}$=void 0}}finally{$?ut():F=!1}}}var ut;if(typeof P=="function")ut=function(){P(Z)};else if(typeof MessageChannel<"u"){var St=new MessageChannel,gt=St.port2;St.port1.onmessage=Z,ut=function(){gt.postMessage(null)}}else ut=function(){N(Z,0)};function yt(G,$){B=N(function(){G(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return S},i.unstable_next=function(G){switch(S){case 1:case 2:case 3:var $=3;break;default:$=S}var rt=S;S=$;try{return G()}finally{S=rt}},i.unstable_requestPaint=function(){D=!0},i.unstable_runWithPriority=function(G,$){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var rt=S;S=G;try{return $()}finally{S=rt}},i.unstable_scheduleCallback=function(G,$,rt){var vt=i.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?vt+rt:vt):rt=vt,G){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=rt+V,G={id:y++,callback:$,priorityLevel:G,startTime:rt,expirationTime:V,sortIndex:-1},rt>vt?(G.sortIndex=rt,t(h,G),e(f)===null&&G===e(h)&&(x?(L(B),B=-1):x=!0,yt(k,rt-vt))):(G.sortIndex=V,t(f,G),b||E||(b=!0,F||(F=!0,ut()))),G},i.unstable_shouldYield=Q,i.unstable_wrapCallback=function(G){var $=S;return function(){var rt=S;S=$;try{return G.apply(this,arguments)}finally{S=rt}}}}(C0)),C0}var Db;function BN(){return Db||(Db=1,E0.exports=ON()),E0.exports}var b0={exports:{}},vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function GN(){if(Ib)return vn;Ib=1;var i=hT();function t(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},o=Symbol.for("react.portal");function r(f,h,y){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:A==null?null:""+A,children:f,containerInfo:h,implementation:y}}var u=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,vn.createPortal=function(f,h){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return r(f,h,null,y)},vn.flushSync=function(f){var h=u.T,y=n.p;try{if(u.T=null,n.p=2,f)return f()}finally{u.T=h,n.p=y,n.d.f()}},vn.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(f,h))},vn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},vn.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var y=h.as,A=c(y,h.crossOrigin),S=typeof h.integrity=="string"?h.integrity:void 0,E=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;y==="style"?n.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:A,integrity:S,fetchPriority:E}):y==="script"&&n.d.X(f,{crossOrigin:A,integrity:S,fetchPriority:E,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},vn.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var y=c(h.as,h.crossOrigin);n.d.M(f,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(f)},vn.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var y=h.as,A=c(y,h.crossOrigin);n.d.L(f,y,{crossOrigin:A,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},vn.preloadModule=function(f,h){if(typeof f=="string")if(h){var y=c(h.as,h.crossOrigin);n.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(f)},vn.requestFormReset=function(f){n.d.r(f)},vn.unstable_batchedUpdates=function(f,h){return f(h)},vn.useFormState=function(f,h,y){return u.H.useFormState(f,h,y)},vn.useFormStatus=function(){return u.H.useHostTransitionStatus()},vn.version="19.1.0",vn}var Pb;function VN(){if(Pb)return b0.exports;Pb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),b0.exports=GN(),b0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb;function HN(){if(Lb)return sf;Lb=1;var i=BN(),t=hT(),e=VN();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function r(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function u(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function c(s){if(r(s)!==s)throw Error(n(188))}function f(s){var a=s.alternate;if(!a){if(a=r(s),a===null)throw Error(n(188));return a!==s?null:s}for(var l=s,m=a;;){var v=l.return;if(v===null)break;var T=v.alternate;if(T===null){if(m=v.return,m!==null){l=m;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===l)return c(v),s;if(T===m)return c(v),a;T=T.sibling}throw Error(n(188))}if(l.return!==m.return)l=v,m=T;else{for(var _=!1,I=v.child;I;){if(I===l){_=!0,l=v,m=T;break}if(I===m){_=!0,m=v,l=T;break}I=I.sibling}if(!_){for(I=T.child;I;){if(I===l){_=!0,l=T,m=v;break}if(I===m){_=!0,m=T,l=v;break}I=I.sibling}if(!_)throw Error(n(189))}}if(l.alternate!==m)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?s:a}function h(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=h(s),a!==null)return a;s=s.sibling}return null}var y=Object.assign,A=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),P=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function ut(s){return s===null||typeof s!="object"?null:(s=Z&&s[Z]||s["@@iterator"],typeof s=="function"?s:null)}var St=Symbol.for("react.client.reference");function gt(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===St?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case D:return"Profiler";case x:return"StrictMode";case k:return"Suspense";case F:return"SuspenseList";case Y:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case P:return(s.displayName||"Context")+".Provider";case L:return(s._context.displayName||"Context")+".Consumer";case U:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return a=s.displayName||null,a!==null?a:gt(s.type)||"Memo";case q:a=s._payload,s=s._init;try{return gt(s(a))}catch{}}return null}var yt=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rt={pending:!1,data:null,method:null,action:null},vt=[],V=-1;function j(s){return{current:s}}function st(s){0>V||(s.current=vt[V],vt[V]=null,V--)}function it(s,a){V++,vt[V]=s.current,s.current=a}var dt=j(null),Nt=j(null),Et=j(null),kt=j(null);function Yt(s,a){switch(it(Et,a),it(Nt,s),it(dt,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?jC(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=jC(a),s=tb(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}st(dt),it(dt,s)}function _i(){st(dt),st(Nt),st(Et)}function rr(s){s.memoizedState!==null&&it(kt,s);var a=dt.current,l=tb(a,s.type);a!==l&&(it(Nt,s),it(dt,l))}function wi(s){Nt.current===s&&(st(dt),st(Nt)),kt.current===s&&(st(kt),Qd._currentValue=rt)}var zs=Object.prototype.hasOwnProperty,Ht=i.unstable_scheduleCallback,Hn=i.unstable_cancelCallback,xn=i.unstable_shouldYield,Xl=i.unstable_requestPaint,Oe=i.unstable_now,ay=i.unstable_getCurrentPriorityLevel,sd=i.unstable_ImmediatePriority,pp=i.unstable_UserBlockingPriority,lr=i.unstable_NormalPriority,gp=i.unstable_LowPriority,od=i.unstable_IdlePriority,mp=i.log,yp=i.unstable_setDisableYieldValue,Xo=null,_n=null;function xe(s){if(typeof mp=="function"&&yp(s),_n&&typeof _n.setStrictMode=="function")try{_n.setStrictMode(Xo,s)}catch{}}var wn=Math.clz32?Math.clz32:vR,mR=Math.log,yR=Math.LN2;function vR(s){return s>>>=0,s===0?32:31-(mR(s)/yR|0)|0}var vp=256,Ap=4194304;function ur(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Tp(s,a,l){var m=s.pendingLanes;if(m===0)return 0;var v=0,T=s.suspendedLanes,_=s.pingedLanes;s=s.warmLanes;var I=m&134217727;return I!==0?(m=I&~T,m!==0?v=ur(m):(_&=I,_!==0?v=ur(_):l||(l=I&~s,l!==0&&(v=ur(l))))):(I=m&~T,I!==0?v=ur(I):_!==0?v=ur(_):l||(l=m&~s,l!==0&&(v=ur(l)))),v===0?0:a!==0&&a!==v&&(a&T)===0&&(T=v&-v,l=a&-a,T>=l||T===32&&(l&4194048)!==0)?a:v}function ad(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function AR(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UT(){var s=vp;return vp<<=1,(vp&4194048)===0&&(vp=256),s}function FT(){var s=Ap;return Ap<<=1,(Ap&62914560)===0&&(Ap=4194304),s}function ry(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function rd(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function TR(s,a,l,m,v,T){var _=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,O=s.expirationTimes,J=s.hiddenUpdates;for(l=_&~l;0<l;){var tt=31-wn(l),nt=1<<tt;I[tt]=0,O[tt]=-1;var K=J[tt];if(K!==null)for(J[tt]=null,tt=0;tt<K.length;tt++){var W=K[tt];W!==null&&(W.lane&=-536870913)}l&=~nt}m!==0&&OT(s,m,0),T!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=T&~(_&~a))}function OT(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var m=31-wn(a);s.entangledLanes|=a,s.entanglements[m]=s.entanglements[m]|1073741824|l&4194090}function BT(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var m=31-wn(l),v=1<<m;v&a|s[m]&a&&(s[m]|=a),l&=~v}}function ly(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function uy(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function GT(){var s=$.p;return s!==0?s:(s=window.event,s===void 0?32:Ab(s.type))}function SR(s,a){var l=$.p;try{return $.p=s,a()}finally{$.p=l}}var Jo=Math.random().toString(36).slice(2),mn="__reactFiber$"+Jo,zn="__reactProps$"+Jo,Jl="__reactContainer$"+Jo,cy="__reactEvents$"+Jo,ER="__reactListeners$"+Jo,CR="__reactHandles$"+Jo,VT="__reactResources$"+Jo,ld="__reactMarker$"+Jo;function dy(s){delete s[mn],delete s[zn],delete s[cy],delete s[ER],delete s[CR]}function Kl(s){var a=s[mn];if(a)return a;for(var l=s.parentNode;l;){if(a=l[Jl]||l[mn]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=sb(s);s!==null;){if(l=s[mn])return l;s=sb(s)}return a}s=l,l=s.parentNode}return null}function Wl(s){if(s=s[mn]||s[Jl]){var a=s.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return s}return null}function ud(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function Ql(s){var a=s[VT];return a||(a=s[VT]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ye(s){s[ld]=!0}var HT=new Set,zT={};function cr(s,a){Zl(s,a),Zl(s+"Capture",a)}function Zl(s,a){for(zT[s]=a,s=0;s<a.length;s++)HT.add(a[s])}var bR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qT={},$T={};function xR(s){return zs.call($T,s)?!0:zs.call(qT,s)?!1:bR.test(s)?$T[s]=!0:(qT[s]=!0,!1)}function Sp(s,a,l){if(xR(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var m=a.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function Ep(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function qs(s,a,l,m){if(m===null)s.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+m)}}var fy,YT;function jl(s){if(fy===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);fy=a&&a[1]||"",YT=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fy+s+YT}var hy=!1;function py(s,a){if(!s||hy)return"";hy=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(a){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(W){var K=W}Reflect.construct(s,[],nt)}else{try{nt.call()}catch(W){K=W}s.call(nt.prototype)}}else{try{throw Error()}catch(W){K=W}(nt=s())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(W){if(W&&K&&typeof W.stack=="string")return[W.stack,K.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),_=T[0],I=T[1];if(_&&I){var O=_.split(`
`),J=I.split(`
`);for(v=m=0;m<O.length&&!O[m].includes("DetermineComponentFrameRoot");)m++;for(;v<J.length&&!J[v].includes("DetermineComponentFrameRoot");)v++;if(m===O.length||v===J.length)for(m=O.length-1,v=J.length-1;1<=m&&0<=v&&O[m]!==J[v];)v--;for(;1<=m&&0<=v;m--,v--)if(O[m]!==J[v]){if(m!==1||v!==1)do if(m--,v--,0>v||O[m]!==J[v]){var tt=`
`+O[m].replace(" at new "," at ");return s.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",s.displayName)),tt}while(1<=m&&0<=v);break}}}finally{hy=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?jl(l):""}function _R(s){switch(s.tag){case 26:case 27:case 5:return jl(s.type);case 16:return jl("Lazy");case 13:return jl("Suspense");case 19:return jl("SuspenseList");case 0:case 15:return py(s.type,!1);case 11:return py(s.type.render,!1);case 1:return py(s.type,!0);case 31:return jl("Activity");default:return""}}function XT(s){try{var a="";do a+=_R(s),s=s.return;while(s);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Mi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function JT(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function wR(s){var a=JT(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),m=""+s[a];if(!s.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var v=l.get,T=l.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return v.call(this)},set:function(_){m=""+_,T.call(this,_)}}),Object.defineProperty(s,a,{enumerable:l.enumerable}),{getValue:function(){return m},setValue:function(_){m=""+_},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Cp(s){s._valueTracker||(s._valueTracker=wR(s))}function KT(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),m="";return s&&(m=JT(s)?s.checked?"true":"false":s.value),s=m,s!==l?(a.setValue(s),!0):!1}function bp(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var MR=/[\n"\\]/g;function Ri(s){return s.replace(MR,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function gy(s,a,l,m,v,T,_,I){s.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?s.type=_:s.removeAttribute("type"),a!=null?_==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Mi(a)):s.value!==""+Mi(a)&&(s.value=""+Mi(a)):_!=="submit"&&_!=="reset"||s.removeAttribute("value"),a!=null?my(s,_,Mi(a)):l!=null?my(s,_,Mi(l)):m!=null&&s.removeAttribute("value"),v==null&&T!=null&&(s.defaultChecked=!!T),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+Mi(I):s.removeAttribute("name")}function WT(s,a,l,m,v,T,_,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),a!=null||l!=null){if(!(T!=="submit"&&T!=="reset"||a!=null))return;l=l!=null?""+Mi(l):"",a=a!=null?""+Mi(a):l,I||a===s.value||(s.value=a),s.defaultValue=a}m=m??v,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=I?s.checked:!!m,s.defaultChecked=!!m,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.name=_)}function my(s,a,l){a==="number"&&bp(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function tu(s,a,l,m){if(s=s.options,a){a={};for(var v=0;v<l.length;v++)a["$"+l[v]]=!0;for(l=0;l<s.length;l++)v=a.hasOwnProperty("$"+s[l].value),s[l].selected!==v&&(s[l].selected=v),v&&m&&(s[l].defaultSelected=!0)}else{for(l=""+Mi(l),a=null,v=0;v<s.length;v++){if(s[v].value===l){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}a!==null||s[v].disabled||(a=s[v])}a!==null&&(a.selected=!0)}}function QT(s,a,l){if(a!=null&&(a=""+Mi(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+Mi(l):""}function ZT(s,a,l,m){if(a==null){if(m!=null){if(l!=null)throw Error(n(92));if(yt(m)){if(1<m.length)throw Error(n(93));m=m[0]}l=m}l==null&&(l=""),a=l}l=Mi(a),s.defaultValue=l,m=s.textContent,m===l&&m!==""&&m!==null&&(s.value=m)}function eu(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var RR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jT(s,a,l){var m=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?m?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":m?s.setProperty(a,l):typeof l!="number"||l===0||RR.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function tS(s,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,l!=null){for(var m in l)!l.hasOwnProperty(m)||a!=null&&a.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var v in a)m=a[v],a.hasOwnProperty(v)&&l[v]!==m&&jT(s,v,m)}else for(var T in a)a.hasOwnProperty(T)&&jT(s,T,a[T])}function yy(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),DR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xp(s){return DR.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var vy=null;function Ay(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var nu=null,iu=null;function eS(s){var a=Wl(s);if(a&&(s=a.stateNode)){var l=s[zn]||null;t:switch(s=a.stateNode,a.type){case"input":if(gy(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ri(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var m=l[a];if(m!==s&&m.form===s.form){var v=m[zn]||null;if(!v)throw Error(n(90));gy(m,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<l.length;a++)m=l[a],m.form===s.form&&KT(m)}break t;case"textarea":QT(s,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&tu(s,!!l.multiple,a,!1)}}}var Ty=!1;function nS(s,a,l){if(Ty)return s(a,l);Ty=!0;try{var m=s(a);return m}finally{if(Ty=!1,(nu!==null||iu!==null)&&(cg(),nu&&(a=nu,s=iu,iu=nu=null,eS(a),s)))for(a=0;a<s.length;a++)eS(s[a])}}function cd(s,a){var l=s.stateNode;if(l===null)return null;var m=l[zn]||null;if(m===null)return null;l=m[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break t;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sy=!1;if($s)try{var dd={};Object.defineProperty(dd,"passive",{get:function(){Sy=!0}}),window.addEventListener("test",dd,dd),window.removeEventListener("test",dd,dd)}catch{Sy=!1}var Ko=null,Ey=null,_p=null;function iS(){if(_p)return _p;var s,a=Ey,l=a.length,m,v="value"in Ko?Ko.value:Ko.textContent,T=v.length;for(s=0;s<l&&a[s]===v[s];s++);var _=l-s;for(m=1;m<=_&&a[l-m]===v[T-m];m++);return _p=v.slice(s,1<m?1-m:void 0)}function wp(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Mp(){return!0}function sS(){return!1}function qn(s){function a(l,m,v,T,_){this._reactName=l,this._targetInst=v,this.type=m,this.nativeEvent=T,this.target=_,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Mp:sS,this.isPropagationStopped=sS,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Mp)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Mp)},persist:function(){},isPersistent:Mp}),a}var dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rp=qn(dr),fd=y({},dr,{view:0,detail:0}),IR=qn(fd),Cy,by,hd,Np=y({},fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_y,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hd&&(hd&&s.type==="mousemove"?(Cy=s.screenX-hd.screenX,by=s.screenY-hd.screenY):by=Cy=0,hd=s),Cy)},movementY:function(s){return"movementY"in s?s.movementY:by}}),oS=qn(Np),PR=y({},Np,{dataTransfer:0}),LR=qn(PR),kR=y({},fd,{relatedTarget:0}),xy=qn(kR),UR=y({},dr,{animationName:0,elapsedTime:0,pseudoElement:0}),FR=qn(UR),OR=y({},dr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),BR=qn(OR),GR=y({},dr,{data:0}),aS=qn(GR),VR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qR(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=zR[s])?!!a[s]:!1}function _y(){return qR}var $R=y({},fd,{key:function(s){if(s.key){var a=VR[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=wp(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?HR[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_y,charCode:function(s){return s.type==="keypress"?wp(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?wp(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),YR=qn($R),XR=y({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rS=qn(XR),JR=y({},fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_y}),KR=qn(JR),WR=y({},dr,{propertyName:0,elapsedTime:0,pseudoElement:0}),QR=qn(WR),ZR=y({},Np,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),jR=qn(ZR),t1=y({},dr,{newState:0,oldState:0}),e1=qn(t1),n1=[9,13,27,32],wy=$s&&"CompositionEvent"in window,pd=null;$s&&"documentMode"in document&&(pd=document.documentMode);var i1=$s&&"TextEvent"in window&&!pd,lS=$s&&(!wy||pd&&8<pd&&11>=pd),uS=" ",cS=!1;function dS(s,a){switch(s){case"keyup":return n1.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fS(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var su=!1;function s1(s,a){switch(s){case"compositionend":return fS(a);case"keypress":return a.which!==32?null:(cS=!0,uS);case"textInput":return s=a.data,s===uS&&cS?null:s;default:return null}}function o1(s,a){if(su)return s==="compositionend"||!wy&&dS(s,a)?(s=iS(),_p=Ey=Ko=null,su=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return lS&&a.locale!=="ko"?null:a.data;default:return null}}var a1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hS(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!a1[s.type]:a==="textarea"}function pS(s,a,l,m){nu?iu?iu.push(m):iu=[m]:nu=m,a=mg(a,"onChange"),0<a.length&&(l=new Rp("onChange","change",null,l,m),s.push({event:l,listeners:a}))}var gd=null,md=null;function r1(s){JC(s,0)}function Dp(s){var a=ud(s);if(KT(a))return s}function gS(s,a){if(s==="change")return a}var mS=!1;if($s){var My;if($s){var Ry="oninput"in document;if(!Ry){var yS=document.createElement("div");yS.setAttribute("oninput","return;"),Ry=typeof yS.oninput=="function"}My=Ry}else My=!1;mS=My&&(!document.documentMode||9<document.documentMode)}function vS(){gd&&(gd.detachEvent("onpropertychange",AS),md=gd=null)}function AS(s){if(s.propertyName==="value"&&Dp(md)){var a=[];pS(a,md,s,Ay(s)),nS(r1,a)}}function l1(s,a,l){s==="focusin"?(vS(),gd=a,md=l,gd.attachEvent("onpropertychange",AS)):s==="focusout"&&vS()}function u1(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Dp(md)}function c1(s,a){if(s==="click")return Dp(a)}function d1(s,a){if(s==="input"||s==="change")return Dp(a)}function f1(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var ti=typeof Object.is=="function"?Object.is:f1;function yd(s,a){if(ti(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),m=Object.keys(a);if(l.length!==m.length)return!1;for(m=0;m<l.length;m++){var v=l[m];if(!zs.call(a,v)||!ti(s[v],a[v]))return!1}return!0}function TS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function SS(s,a){var l=TS(s);s=0;for(var m;l;){if(l.nodeType===3){if(m=s+l.textContent.length,s<=a&&m>=a)return{node:l,offset:a-s};s=m}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=TS(l)}}function ES(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?ES(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function CS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=bp(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=bp(s.document)}return a}function Ny(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var h1=$s&&"documentMode"in document&&11>=document.documentMode,ou=null,Dy=null,vd=null,Iy=!1;function bS(s,a,l){var m=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Iy||ou==null||ou!==bp(m)||(m=ou,"selectionStart"in m&&Ny(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),vd&&yd(vd,m)||(vd=m,m=mg(Dy,"onSelect"),0<m.length&&(a=new Rp("onSelect","select",null,a,l),s.push({event:a,listeners:m}),a.target=ou)))}function fr(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var au={animationend:fr("Animation","AnimationEnd"),animationiteration:fr("Animation","AnimationIteration"),animationstart:fr("Animation","AnimationStart"),transitionrun:fr("Transition","TransitionRun"),transitionstart:fr("Transition","TransitionStart"),transitioncancel:fr("Transition","TransitionCancel"),transitionend:fr("Transition","TransitionEnd")},Py={},xS={};$s&&(xS=document.createElement("div").style,"AnimationEvent"in window||(delete au.animationend.animation,delete au.animationiteration.animation,delete au.animationstart.animation),"TransitionEvent"in window||delete au.transitionend.transition);function hr(s){if(Py[s])return Py[s];if(!au[s])return s;var a=au[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in xS)return Py[s]=a[l];return s}var _S=hr("animationend"),wS=hr("animationiteration"),MS=hr("animationstart"),p1=hr("transitionrun"),g1=hr("transitionstart"),m1=hr("transitioncancel"),RS=hr("transitionend"),NS=new Map,Ly="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ly.push("scrollEnd");function Ki(s,a){NS.set(s,a),cr(a,[s])}var DS=new WeakMap;function Ni(s,a){if(typeof s=="object"&&s!==null){var l=DS.get(s);return l!==void 0?l:(a={value:s,source:a,stack:XT(a)},DS.set(s,a),a)}return{value:s,source:a,stack:XT(a)}}var Di=[],ru=0,ky=0;function Ip(){for(var s=ru,a=ky=ru=0;a<s;){var l=Di[a];Di[a++]=null;var m=Di[a];Di[a++]=null;var v=Di[a];Di[a++]=null;var T=Di[a];if(Di[a++]=null,m!==null&&v!==null){var _=m.pending;_===null?v.next=v:(v.next=_.next,_.next=v),m.pending=v}T!==0&&IS(l,v,T)}}function Pp(s,a,l,m){Di[ru++]=s,Di[ru++]=a,Di[ru++]=l,Di[ru++]=m,ky|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function Uy(s,a,l,m){return Pp(s,a,l,m),Lp(s)}function lu(s,a){return Pp(s,null,null,a),Lp(s)}function IS(s,a,l){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l);for(var v=!1,T=s.return;T!==null;)T.childLanes|=l,m=T.alternate,m!==null&&(m.childLanes|=l),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(v=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,v&&a!==null&&(v=31-wn(l),s=T.hiddenUpdates,m=s[v],m===null?s[v]=[a]:m.push(a),a.lane=l|536870912),T):null}function Lp(s){if(50<zd)throw zd=0,Hv=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var uu={};function y1(s,a,l,m){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(s,a,l,m){return new y1(s,a,l,m)}function Fy(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ys(s,a){var l=s.alternate;return l===null?(l=ei(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function PS(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function kp(s,a,l,m,v,T){var _=0;if(m=s,typeof s=="function")Fy(s)&&(_=1);else if(typeof s=="string")_=AN(s,l,dt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case Y:return s=ei(31,l,a,v),s.elementType=Y,s.lanes=T,s;case b:return pr(l.children,v,T,a);case x:_=8,v|=24;break;case D:return s=ei(12,l,a,v|2),s.elementType=D,s.lanes=T,s;case k:return s=ei(13,l,a,v),s.elementType=k,s.lanes=T,s;case F:return s=ei(19,l,a,v),s.elementType=F,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:case P:_=10;break t;case L:_=9;break t;case U:_=11;break t;case B:_=14;break t;case q:_=16,m=null;break t}_=29,l=Error(n(130,s===null?"null":typeof s,"")),m=null}return a=ei(_,l,a,v),a.elementType=s,a.type=m,a.lanes=T,a}function pr(s,a,l,m){return s=ei(7,s,m,a),s.lanes=l,s}function Oy(s,a,l){return s=ei(6,s,null,a),s.lanes=l,s}function By(s,a,l){return a=ei(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var cu=[],du=0,Up=null,Fp=0,Ii=[],Pi=0,gr=null,Xs=1,Js="";function mr(s,a){cu[du++]=Fp,cu[du++]=Up,Up=s,Fp=a}function LS(s,a,l){Ii[Pi++]=Xs,Ii[Pi++]=Js,Ii[Pi++]=gr,gr=s;var m=Xs;s=Js;var v=32-wn(m)-1;m&=~(1<<v),l+=1;var T=32-wn(a)+v;if(30<T){var _=v-v%5;T=(m&(1<<_)-1).toString(32),m>>=_,v-=_,Xs=1<<32-wn(a)+v|l<<v|m,Js=T+s}else Xs=1<<T|l<<v|m,Js=s}function Gy(s){s.return!==null&&(mr(s,1),LS(s,1,0))}function Vy(s){for(;s===Up;)Up=cu[--du],cu[du]=null,Fp=cu[--du],cu[du]=null;for(;s===gr;)gr=Ii[--Pi],Ii[Pi]=null,Js=Ii[--Pi],Ii[Pi]=null,Xs=Ii[--Pi],Ii[Pi]=null}var Mn=null,Ee=null,Jt=!1,yr=null,ps=!1,Hy=Error(n(519));function vr(s){var a=Error(n(418,""));throw Sd(Ni(a,s)),Hy}function kS(s){var a=s.stateNode,l=s.type,m=s.memoizedProps;switch(a[mn]=s,a[zn]=m,l){case"dialog":Bt("cancel",a),Bt("close",a);break;case"iframe":case"object":case"embed":Bt("load",a);break;case"video":case"audio":for(l=0;l<$d.length;l++)Bt($d[l],a);break;case"source":Bt("error",a);break;case"img":case"image":case"link":Bt("error",a),Bt("load",a);break;case"details":Bt("toggle",a);break;case"input":Bt("invalid",a),WT(a,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Cp(a);break;case"select":Bt("invalid",a);break;case"textarea":Bt("invalid",a),ZT(a,m.value,m.defaultValue,m.children),Cp(a)}l=m.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||m.suppressHydrationWarning===!0||ZC(a.textContent,l)?(m.popover!=null&&(Bt("beforetoggle",a),Bt("toggle",a)),m.onScroll!=null&&Bt("scroll",a),m.onScrollEnd!=null&&Bt("scrollend",a),m.onClick!=null&&(a.onclick=yg),a=!0):a=!1,a||vr(s)}function US(s){for(Mn=s.return;Mn;)switch(Mn.tag){case 5:case 13:ps=!1;return;case 27:case 3:ps=!0;return;default:Mn=Mn.return}}function Ad(s){if(s!==Mn)return!1;if(!Jt)return US(s),Jt=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||s0(s.type,s.memoizedProps)),l=!l),l&&Ee&&vr(s),US(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));t:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(a===0){Ee=Qi(s.nextSibling);break t}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;s=s.nextSibling}Ee=null}}else a===27?(a=Ee,da(s.type)?(s=l0,l0=null,Ee=s):Ee=a):Ee=Mn?Qi(s.stateNode.nextSibling):null;return!0}function Td(){Ee=Mn=null,Jt=!1}function FS(){var s=yr;return s!==null&&(Xn===null?Xn=s:Xn.push.apply(Xn,s),yr=null),s}function Sd(s){yr===null?yr=[s]:yr.push(s)}var zy=j(null),Ar=null,Ks=null;function Wo(s,a,l){it(zy,a._currentValue),a._currentValue=l}function Ws(s){s._currentValue=zy.current,st(zy)}function qy(s,a,l){for(;s!==null;){var m=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),s===l)break;s=s.return}}function $y(s,a,l,m){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var T=v.dependencies;if(T!==null){var _=v.child;T=T.firstContext;t:for(;T!==null;){var I=T;T=v;for(var O=0;O<a.length;O++)if(I.context===a[O]){T.lanes|=l,I=T.alternate,I!==null&&(I.lanes|=l),qy(T.return,l,s),m||(_=null);break t}T=I.next}}else if(v.tag===18){if(_=v.return,_===null)throw Error(n(341));_.lanes|=l,T=_.alternate,T!==null&&(T.lanes|=l),qy(_,l,s),_=null}else _=v.child;if(_!==null)_.return=v;else for(_=v;_!==null;){if(_===s){_=null;break}if(v=_.sibling,v!==null){v.return=_.return,_=v;break}_=_.return}v=_}}function Ed(s,a,l,m){s=null;for(var v=a,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var _=v.alternate;if(_===null)throw Error(n(387));if(_=_.memoizedProps,_!==null){var I=v.type;ti(v.pendingProps.value,_.value)||(s!==null?s.push(I):s=[I])}}else if(v===kt.current){if(_=v.alternate,_===null)throw Error(n(387));_.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Qd):s=[Qd])}v=v.return}s!==null&&$y(a,s,l,m),a.flags|=262144}function Op(s){for(s=s.firstContext;s!==null;){if(!ti(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Tr(s){Ar=s,Ks=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function yn(s){return OS(Ar,s)}function Bp(s,a){return Ar===null&&Tr(s),OS(s,a)}function OS(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Ks===null){if(s===null)throw Error(n(308));Ks=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ks=Ks.next=a;return l}var v1=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,m){s.push(m)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},A1=i.unstable_scheduleCallback,T1=i.unstable_NormalPriority,Be={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yy(){return{controller:new v1,data:new Map,refCount:0}}function Cd(s){s.refCount--,s.refCount===0&&A1(T1,function(){s.controller.abort()})}var bd=null,Xy=0,fu=0,hu=null;function S1(s,a){if(bd===null){var l=bd=[];Xy=0,fu=Kv(),hu={status:"pending",value:void 0,then:function(m){l.push(m)}}}return Xy++,a.then(BS,BS),a}function BS(){if(--Xy===0&&bd!==null){hu!==null&&(hu.status="fulfilled");var s=bd;bd=null,fu=0,hu=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function E1(s,a){var l=[],m={status:"pending",value:null,reason:null,then:function(v){l.push(v)}};return s.then(function(){m.status="fulfilled",m.value=a;for(var v=0;v<l.length;v++)(0,l[v])(a)},function(v){for(m.status="rejected",m.reason=v,v=0;v<l.length;v++)(0,l[v])(void 0)}),m}var GS=G.S;G.S=function(s,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&S1(s,a),GS!==null&&GS(s,a)};var Sr=j(null);function Jy(){var s=Sr.current;return s!==null?s:ue.pooledCache}function Gp(s,a){a===null?it(Sr,Sr.current):it(Sr,a.pool)}function VS(){var s=Jy();return s===null?null:{parent:Be._currentValue,pool:s}}var xd=Error(n(460)),HS=Error(n(474)),Vp=Error(n(542)),Ky={then:function(){}};function zS(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Hp(){}function qS(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(Hp,Hp),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,YS(s),s;default:if(typeof a.status=="string")a.then(Hp,Hp);else{if(s=ue,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(m){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=m}},function(m){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=m}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,YS(s),s}throw _d=a,xd}}var _d=null;function $S(){if(_d===null)throw Error(n(459));var s=_d;return _d=null,s}function YS(s){if(s===xd||s===Vp)throw Error(n(483))}var Qo=!1;function Wy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qy(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Zo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function jo(s,a,l){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Qt&2)!==0){var v=m.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),m.pending=a,a=Lp(s),IS(s,null,l),a}return Pp(s,m,a,l),Lp(s)}function wd(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var m=a.lanes;m&=s.pendingLanes,l|=m,a.lanes=l,BT(s,l)}}function Zy(s,a){var l=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,l===m)){var v=null,T=null;if(l=l.firstBaseUpdate,l!==null){do{var _={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};T===null?v=T=_:T=T.next=_,l=l.next}while(l!==null);T===null?v=T=a:T=T.next=a}else v=T=a;l={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var jy=!1;function Md(){if(jy){var s=hu;if(s!==null)throw s}}function Rd(s,a,l,m){jy=!1;var v=s.updateQueue;Qo=!1;var T=v.firstBaseUpdate,_=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var O=I,J=O.next;O.next=null,_===null?T=J:_.next=J,_=O;var tt=s.alternate;tt!==null&&(tt=tt.updateQueue,I=tt.lastBaseUpdate,I!==_&&(I===null?tt.firstBaseUpdate=J:I.next=J,tt.lastBaseUpdate=O))}if(T!==null){var nt=v.baseState;_=0,tt=J=O=null,I=T;do{var K=I.lane&-536870913,W=K!==I.lane;if(W?(zt&K)===K:(m&K)===K){K!==0&&K===fu&&(jy=!0),tt!==null&&(tt=tt.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});t:{var wt=s,bt=I;K=a;var ie=l;switch(bt.tag){case 1:if(wt=bt.payload,typeof wt=="function"){nt=wt.call(ie,nt,K);break t}nt=wt;break t;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=bt.payload,K=typeof wt=="function"?wt.call(ie,nt,K):wt,K==null)break t;nt=y({},nt,K);break t;case 2:Qo=!0}}K=I.callback,K!==null&&(s.flags|=64,W&&(s.flags|=8192),W=v.callbacks,W===null?v.callbacks=[K]:W.push(K))}else W={lane:K,tag:I.tag,payload:I.payload,callback:I.callback,next:null},tt===null?(J=tt=W,O=nt):tt=tt.next=W,_|=K;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;W=I,I=W.next,W.next=null,v.lastBaseUpdate=W,v.shared.pending=null}}while(!0);tt===null&&(O=nt),v.baseState=O,v.firstBaseUpdate=J,v.lastBaseUpdate=tt,T===null&&(v.shared.lanes=0),ra|=_,s.lanes=_,s.memoizedState=nt}}function XS(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function JS(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)XS(l[s],a)}var pu=j(null),zp=j(0);function KS(s,a){s=io,it(zp,s),it(pu,a),io=s|a.baseLanes}function tv(){it(zp,io),it(pu,pu.current)}function ev(){io=zp.current,st(pu),st(zp)}var ta=0,Lt=null,ee=null,De=null,qp=!1,gu=!1,Er=!1,$p=0,Nd=0,mu=null,C1=0;function _e(){throw Error(n(321))}function nv(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!ti(s[l],a[l]))return!1;return!0}function iv(s,a,l,m,v,T){return ta=T,Lt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,G.H=s===null||s.memoizedState===null?IE:PE,Er=!1,T=l(m,v),Er=!1,gu&&(T=QS(a,l,m,v)),WS(s),T}function WS(s){G.H=Qp;var a=ee!==null&&ee.next!==null;if(ta=0,De=ee=Lt=null,qp=!1,Nd=0,mu=null,a)throw Error(n(300));s===null||Xe||(s=s.dependencies,s!==null&&Op(s)&&(Xe=!0))}function QS(s,a,l,m){Lt=s;var v=0;do{if(gu&&(mu=null),Nd=0,gu=!1,25<=v)throw Error(n(301));if(v+=1,De=ee=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}G.H=N1,T=a(l,m)}while(gu);return T}function b1(){var s=G.H,a=s.useState()[0];return a=typeof a.then=="function"?Dd(a):a,s=s.useState()[0],(ee!==null?ee.memoizedState:null)!==s&&(Lt.flags|=1024),a}function sv(){var s=$p!==0;return $p=0,s}function ov(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function av(s){if(qp){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}qp=!1}ta=0,De=ee=Lt=null,gu=!1,Nd=$p=0,mu=null}function $n(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return De===null?Lt.memoizedState=De=s:De=De.next=s,De}function Ie(){if(ee===null){var s=Lt.alternate;s=s!==null?s.memoizedState:null}else s=ee.next;var a=De===null?Lt.memoizedState:De.next;if(a!==null)De=a,ee=s;else{if(s===null)throw Lt.alternate===null?Error(n(467)):Error(n(310));ee=s,s={memoizedState:ee.memoizedState,baseState:ee.baseState,baseQueue:ee.baseQueue,queue:ee.queue,next:null},De===null?Lt.memoizedState=De=s:De=De.next=s}return De}function rv(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dd(s){var a=Nd;return Nd+=1,mu===null&&(mu=[]),s=qS(mu,s,a),a=Lt,(De===null?a.memoizedState:De.next)===null&&(a=a.alternate,G.H=a===null||a.memoizedState===null?IE:PE),s}function Yp(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Dd(s);if(s.$$typeof===P)return yn(s)}throw Error(n(438,String(s)))}function lv(s){var a=null,l=Lt.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var m=Lt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(a={data:m.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=rv(),Lt.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),m=0;m<s;m++)l[m]=Q;return a.index++,l}function Qs(s,a){return typeof a=="function"?a(s):a}function Xp(s){var a=Ie();return uv(a,ee,s)}function uv(s,a,l){var m=s.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var v=s.baseQueue,T=m.pending;if(T!==null){if(v!==null){var _=v.next;v.next=T.next,T.next=_}a.baseQueue=v=T,m.pending=null}if(T=s.baseState,v===null)s.memoizedState=T;else{a=v.next;var I=_=null,O=null,J=a,tt=!1;do{var nt=J.lane&-536870913;if(nt!==J.lane?(zt&nt)===nt:(ta&nt)===nt){var K=J.revertLane;if(K===0)O!==null&&(O=O.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),nt===fu&&(tt=!0);else if((ta&K)===K){J=J.next,K===fu&&(tt=!0);continue}else nt={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},O===null?(I=O=nt,_=T):O=O.next=nt,Lt.lanes|=K,ra|=K;nt=J.action,Er&&l(T,nt),T=J.hasEagerState?J.eagerState:l(T,nt)}else K={lane:nt,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},O===null?(I=O=K,_=T):O=O.next=K,Lt.lanes|=nt,ra|=nt;J=J.next}while(J!==null&&J!==a);if(O===null?_=T:O.next=I,!ti(T,s.memoizedState)&&(Xe=!0,tt&&(l=hu,l!==null)))throw l;s.memoizedState=T,s.baseState=_,s.baseQueue=O,m.lastRenderedState=T}return v===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function cv(s){var a=Ie(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=s;var m=l.dispatch,v=l.pending,T=a.memoizedState;if(v!==null){l.pending=null;var _=v=v.next;do T=s(T,_.action),_=_.next;while(_!==v);ti(T,a.memoizedState)||(Xe=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),l.lastRenderedState=T}return[T,m]}function ZS(s,a,l){var m=Lt,v=Ie(),T=Jt;if(T){if(l===void 0)throw Error(n(407));l=l()}else l=a();var _=!ti((ee||v).memoizedState,l);_&&(v.memoizedState=l,Xe=!0),v=v.queue;var I=eE.bind(null,m,v,s);if(Id(2048,8,I,[s]),v.getSnapshot!==a||_||De!==null&&De.memoizedState.tag&1){if(m.flags|=2048,yu(9,Jp(),tE.bind(null,m,v,l,a),null),ue===null)throw Error(n(349));T||(ta&124)!==0||jS(m,a,l)}return l}function jS(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=Lt.updateQueue,a===null?(a=rv(),Lt.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function tE(s,a,l,m){a.value=l,a.getSnapshot=m,nE(a)&&iE(s)}function eE(s,a,l){return l(function(){nE(a)&&iE(s)})}function nE(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!ti(s,l)}catch{return!0}}function iE(s){var a=lu(s,2);a!==null&&ai(a,s,2)}function dv(s){var a=$n();if(typeof s=="function"){var l=s;if(s=l(),Er){xe(!0);try{l()}finally{xe(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:s},a}function sE(s,a,l,m){return s.baseState=l,uv(s,ee,typeof m=="function"?m:Qs)}function x1(s,a,l,m,v){if(Wp(s))throw Error(n(485));if(s=a.action,s!==null){var T={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){T.listeners.push(_)}};G.T!==null?l(!0):T.isTransition=!1,m(T),l=a.pending,l===null?(T.next=a.pending=T,oE(a,T)):(T.next=l.next,a.pending=l.next=T)}}function oE(s,a){var l=a.action,m=a.payload,v=s.state;if(a.isTransition){var T=G.T,_={};G.T=_;try{var I=l(v,m),O=G.S;O!==null&&O(_,I),aE(s,a,I)}catch(J){fv(s,a,J)}finally{G.T=T}}else try{T=l(v,m),aE(s,a,T)}catch(J){fv(s,a,J)}}function aE(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(m){rE(s,a,m)},function(m){return fv(s,a,m)}):rE(s,a,l)}function rE(s,a,l){a.status="fulfilled",a.value=l,lE(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,oE(s,l)))}function fv(s,a,l){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do a.status="rejected",a.reason=l,lE(a),a=a.next;while(a!==m)}s.action=null}function lE(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function uE(s,a){return a}function cE(s,a){if(Jt){var l=ue.formState;if(l!==null){t:{var m=Lt;if(Jt){if(Ee){e:{for(var v=Ee,T=ps;v.nodeType!==8;){if(!T){v=null;break e}if(v=Qi(v.nextSibling),v===null){v=null;break e}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){Ee=Qi(v.nextSibling),m=v.data==="F!";break t}}vr(m)}m=!1}m&&(a=l[0])}}return l=$n(),l.memoizedState=l.baseState=a,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uE,lastRenderedState:a},l.queue=m,l=RE.bind(null,Lt,m),m.dispatch=l,m=dv(!1),T=yv.bind(null,Lt,!1,m.queue),m=$n(),v={state:a,dispatch:null,action:s,pending:null},m.queue=v,l=x1.bind(null,Lt,v,T,l),v.dispatch=l,m.memoizedState=s,[a,l,!1]}function dE(s){var a=Ie();return fE(a,ee,s)}function fE(s,a,l){if(a=uv(s,a,uE)[0],s=Xp(Qs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var m=Dd(a)}catch(_){throw _===xd?Vp:_}else m=a;a=Ie();var v=a.queue,T=v.dispatch;return l!==a.memoizedState&&(Lt.flags|=2048,yu(9,Jp(),_1.bind(null,v,l),null)),[m,T,s]}function _1(s,a){s.action=a}function hE(s){var a=Ie(),l=ee;if(l!==null)return fE(a,l,s);Ie(),a=a.memoizedState,l=Ie();var m=l.queue.dispatch;return l.memoizedState=s,[a,m,!1]}function yu(s,a,l,m){return s={tag:s,create:l,deps:m,inst:a,next:null},a=Lt.updateQueue,a===null&&(a=rv(),Lt.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(m=l.next,l.next=s,s.next=m,a.lastEffect=s),s}function Jp(){return{destroy:void 0,resource:void 0}}function pE(){return Ie().memoizedState}function Kp(s,a,l,m){var v=$n();m=m===void 0?null:m,Lt.flags|=s,v.memoizedState=yu(1|a,Jp(),l,m)}function Id(s,a,l,m){var v=Ie();m=m===void 0?null:m;var T=v.memoizedState.inst;ee!==null&&m!==null&&nv(m,ee.memoizedState.deps)?v.memoizedState=yu(a,T,l,m):(Lt.flags|=s,v.memoizedState=yu(1|a,T,l,m))}function gE(s,a){Kp(8390656,8,s,a)}function mE(s,a){Id(2048,8,s,a)}function yE(s,a){return Id(4,2,s,a)}function vE(s,a){return Id(4,4,s,a)}function AE(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function TE(s,a,l){l=l!=null?l.concat([s]):null,Id(4,4,AE.bind(null,a,s),l)}function hv(){}function SE(s,a){var l=Ie();a=a===void 0?null:a;var m=l.memoizedState;return a!==null&&nv(a,m[1])?m[0]:(l.memoizedState=[s,a],s)}function EE(s,a){var l=Ie();a=a===void 0?null:a;var m=l.memoizedState;if(a!==null&&nv(a,m[1]))return m[0];if(m=s(),Er){xe(!0);try{s()}finally{xe(!1)}}return l.memoizedState=[m,a],m}function pv(s,a,l){return l===void 0||(ta&1073741824)!==0?s.memoizedState=a:(s.memoizedState=l,s=xC(),Lt.lanes|=s,ra|=s,l)}function CE(s,a,l,m){return ti(l,a)?l:pu.current!==null?(s=pv(s,l,m),ti(s,a)||(Xe=!0),s):(ta&42)===0?(Xe=!0,s.memoizedState=l):(s=xC(),Lt.lanes|=s,ra|=s,a)}function bE(s,a,l,m,v){var T=$.p;$.p=T!==0&&8>T?T:8;var _=G.T,I={};G.T=I,yv(s,!1,a,l);try{var O=v(),J=G.S;if(J!==null&&J(I,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var tt=E1(O,m);Pd(s,a,tt,oi(s))}else Pd(s,a,m,oi(s))}catch(nt){Pd(s,a,{then:function(){},status:"rejected",reason:nt},oi())}finally{$.p=T,G.T=_}}function w1(){}function gv(s,a,l,m){if(s.tag!==5)throw Error(n(476));var v=xE(s).queue;bE(s,v,a,rt,l===null?w1:function(){return _E(s),l(m)})}function xE(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:rt,baseState:rt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:rt},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function _E(s){var a=xE(s).next.queue;Pd(s,a,{},oi())}function mv(){return yn(Qd)}function wE(){return Ie().memoizedState}function ME(){return Ie().memoizedState}function M1(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=oi();s=Zo(l);var m=jo(a,s,l);m!==null&&(ai(m,a,l),wd(m,a,l)),a={cache:Yy()},s.payload=a;return}a=a.return}}function R1(s,a,l){var m=oi();l={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Wp(s)?NE(a,l):(l=Uy(s,a,l,m),l!==null&&(ai(l,s,m),DE(l,a,m)))}function RE(s,a,l){var m=oi();Pd(s,a,l,m)}function Pd(s,a,l,m){var v={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Wp(s))NE(a,v);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var _=a.lastRenderedState,I=T(_,l);if(v.hasEagerState=!0,v.eagerState=I,ti(I,_))return Pp(s,a,v,0),ue===null&&Ip(),!1}catch{}finally{}if(l=Uy(s,a,v,m),l!==null)return ai(l,s,m),DE(l,a,m),!0}return!1}function yv(s,a,l,m){if(m={lane:2,revertLane:Kv(),action:m,hasEagerState:!1,eagerState:null,next:null},Wp(s)){if(a)throw Error(n(479))}else a=Uy(s,l,m,2),a!==null&&ai(a,s,2)}function Wp(s){var a=s.alternate;return s===Lt||a!==null&&a===Lt}function NE(s,a){gu=qp=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function DE(s,a,l){if((l&4194048)!==0){var m=a.lanes;m&=s.pendingLanes,l|=m,a.lanes=l,BT(s,l)}}var Qp={readContext:yn,use:Yp,useCallback:_e,useContext:_e,useEffect:_e,useImperativeHandle:_e,useLayoutEffect:_e,useInsertionEffect:_e,useMemo:_e,useReducer:_e,useRef:_e,useState:_e,useDebugValue:_e,useDeferredValue:_e,useTransition:_e,useSyncExternalStore:_e,useId:_e,useHostTransitionStatus:_e,useFormState:_e,useActionState:_e,useOptimistic:_e,useMemoCache:_e,useCacheRefresh:_e},IE={readContext:yn,use:Yp,useCallback:function(s,a){return $n().memoizedState=[s,a===void 0?null:a],s},useContext:yn,useEffect:gE,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,Kp(4194308,4,AE.bind(null,a,s),l)},useLayoutEffect:function(s,a){return Kp(4194308,4,s,a)},useInsertionEffect:function(s,a){Kp(4,2,s,a)},useMemo:function(s,a){var l=$n();a=a===void 0?null:a;var m=s();if(Er){xe(!0);try{s()}finally{xe(!1)}}return l.memoizedState=[m,a],m},useReducer:function(s,a,l){var m=$n();if(l!==void 0){var v=l(a);if(Er){xe(!0);try{l(a)}finally{xe(!1)}}}else v=a;return m.memoizedState=m.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},m.queue=s,s=s.dispatch=R1.bind(null,Lt,s),[m.memoizedState,s]},useRef:function(s){var a=$n();return s={current:s},a.memoizedState=s},useState:function(s){s=dv(s);var a=s.queue,l=RE.bind(null,Lt,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:hv,useDeferredValue:function(s,a){var l=$n();return pv(l,s,a)},useTransition:function(){var s=dv(!1);return s=bE.bind(null,Lt,s.queue,!0,!1),$n().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var m=Lt,v=$n();if(Jt){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),ue===null)throw Error(n(349));(zt&124)!==0||jS(m,a,l)}v.memoizedState=l;var T={value:l,getSnapshot:a};return v.queue=T,gE(eE.bind(null,m,T,s),[s]),m.flags|=2048,yu(9,Jp(),tE.bind(null,m,T,l,a),null),l},useId:function(){var s=$n(),a=ue.identifierPrefix;if(Jt){var l=Js,m=Xs;l=(m&~(1<<32-wn(m)-1)).toString(32)+l,a="«"+a+"R"+l,l=$p++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=C1++,a="«"+a+"r"+l.toString(32)+"»";return s.memoizedState=a},useHostTransitionStatus:mv,useFormState:cE,useActionState:cE,useOptimistic:function(s){var a=$n();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=yv.bind(null,Lt,!0,l),l.dispatch=a,[s,a]},useMemoCache:lv,useCacheRefresh:function(){return $n().memoizedState=M1.bind(null,Lt)}},PE={readContext:yn,use:Yp,useCallback:SE,useContext:yn,useEffect:mE,useImperativeHandle:TE,useInsertionEffect:yE,useLayoutEffect:vE,useMemo:EE,useReducer:Xp,useRef:pE,useState:function(){return Xp(Qs)},useDebugValue:hv,useDeferredValue:function(s,a){var l=Ie();return CE(l,ee.memoizedState,s,a)},useTransition:function(){var s=Xp(Qs)[0],a=Ie().memoizedState;return[typeof s=="boolean"?s:Dd(s),a]},useSyncExternalStore:ZS,useId:wE,useHostTransitionStatus:mv,useFormState:dE,useActionState:dE,useOptimistic:function(s,a){var l=Ie();return sE(l,ee,s,a)},useMemoCache:lv,useCacheRefresh:ME},N1={readContext:yn,use:Yp,useCallback:SE,useContext:yn,useEffect:mE,useImperativeHandle:TE,useInsertionEffect:yE,useLayoutEffect:vE,useMemo:EE,useReducer:cv,useRef:pE,useState:function(){return cv(Qs)},useDebugValue:hv,useDeferredValue:function(s,a){var l=Ie();return ee===null?pv(l,s,a):CE(l,ee.memoizedState,s,a)},useTransition:function(){var s=cv(Qs)[0],a=Ie().memoizedState;return[typeof s=="boolean"?s:Dd(s),a]},useSyncExternalStore:ZS,useId:wE,useHostTransitionStatus:mv,useFormState:hE,useActionState:hE,useOptimistic:function(s,a){var l=Ie();return ee!==null?sE(l,ee,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:lv,useCacheRefresh:ME},vu=null,Ld=0;function Zp(s){var a=Ld;return Ld+=1,vu===null&&(vu=[]),qS(vu,s,a)}function kd(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function jp(s,a){throw a.$$typeof===A?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function LE(s){var a=s._init;return a(s._payload)}function kE(s){function a(z,H){if(s){var X=z.deletions;X===null?(z.deletions=[H],z.flags|=16):X.push(H)}}function l(z,H){if(!s)return null;for(;H!==null;)a(z,H),H=H.sibling;return null}function m(z){for(var H=new Map;z!==null;)z.key!==null?H.set(z.key,z):H.set(z.index,z),z=z.sibling;return H}function v(z,H){return z=Ys(z,H),z.index=0,z.sibling=null,z}function T(z,H,X){return z.index=X,s?(X=z.alternate,X!==null?(X=X.index,X<H?(z.flags|=67108866,H):X):(z.flags|=67108866,H)):(z.flags|=1048576,H)}function _(z){return s&&z.alternate===null&&(z.flags|=67108866),z}function I(z,H,X,et){return H===null||H.tag!==6?(H=Oy(X,z.mode,et),H.return=z,H):(H=v(H,X),H.return=z,H)}function O(z,H,X,et){var pt=X.type;return pt===b?tt(z,H,X.props.children,et,X.key):H!==null&&(H.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===q&&LE(pt)===H.type)?(H=v(H,X.props),kd(H,X),H.return=z,H):(H=kp(X.type,X.key,X.props,null,z.mode,et),kd(H,X),H.return=z,H)}function J(z,H,X,et){return H===null||H.tag!==4||H.stateNode.containerInfo!==X.containerInfo||H.stateNode.implementation!==X.implementation?(H=By(X,z.mode,et),H.return=z,H):(H=v(H,X.children||[]),H.return=z,H)}function tt(z,H,X,et,pt){return H===null||H.tag!==7?(H=pr(X,z.mode,et,pt),H.return=z,H):(H=v(H,X),H.return=z,H)}function nt(z,H,X){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Oy(""+H,z.mode,X),H.return=z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case S:return X=kp(H.type,H.key,H.props,null,z.mode,X),kd(X,H),X.return=z,X;case E:return H=By(H,z.mode,X),H.return=z,H;case q:var et=H._init;return H=et(H._payload),nt(z,H,X)}if(yt(H)||ut(H))return H=pr(H,z.mode,X,null),H.return=z,H;if(typeof H.then=="function")return nt(z,Zp(H),X);if(H.$$typeof===P)return nt(z,Bp(z,H),X);jp(z,H)}return null}function K(z,H,X,et){var pt=H!==null?H.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return pt!==null?null:I(z,H,""+X,et);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case S:return X.key===pt?O(z,H,X,et):null;case E:return X.key===pt?J(z,H,X,et):null;case q:return pt=X._init,X=pt(X._payload),K(z,H,X,et)}if(yt(X)||ut(X))return pt!==null?null:tt(z,H,X,et,null);if(typeof X.then=="function")return K(z,H,Zp(X),et);if(X.$$typeof===P)return K(z,H,Bp(z,X),et);jp(z,X)}return null}function W(z,H,X,et,pt){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return z=z.get(X)||null,I(H,z,""+et,pt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case S:return z=z.get(et.key===null?X:et.key)||null,O(H,z,et,pt);case E:return z=z.get(et.key===null?X:et.key)||null,J(H,z,et,pt);case q:var Ut=et._init;return et=Ut(et._payload),W(z,H,X,et,pt)}if(yt(et)||ut(et))return z=z.get(X)||null,tt(H,z,et,pt,null);if(typeof et.then=="function")return W(z,H,X,Zp(et),pt);if(et.$$typeof===P)return W(z,H,X,Bp(H,et),pt);jp(H,et)}return null}function wt(z,H,X,et){for(var pt=null,Ut=null,Tt=H,_t=H=0,Ke=null;Tt!==null&&_t<X.length;_t++){Tt.index>_t?(Ke=Tt,Tt=null):Ke=Tt.sibling;var Xt=K(z,Tt,X[_t],et);if(Xt===null){Tt===null&&(Tt=Ke);break}s&&Tt&&Xt.alternate===null&&a(z,Tt),H=T(Xt,H,_t),Ut===null?pt=Xt:Ut.sibling=Xt,Ut=Xt,Tt=Ke}if(_t===X.length)return l(z,Tt),Jt&&mr(z,_t),pt;if(Tt===null){for(;_t<X.length;_t++)Tt=nt(z,X[_t],et),Tt!==null&&(H=T(Tt,H,_t),Ut===null?pt=Tt:Ut.sibling=Tt,Ut=Tt);return Jt&&mr(z,_t),pt}for(Tt=m(Tt);_t<X.length;_t++)Ke=W(Tt,z,_t,X[_t],et),Ke!==null&&(s&&Ke.alternate!==null&&Tt.delete(Ke.key===null?_t:Ke.key),H=T(Ke,H,_t),Ut===null?pt=Ke:Ut.sibling=Ke,Ut=Ke);return s&&Tt.forEach(function(ma){return a(z,ma)}),Jt&&mr(z,_t),pt}function bt(z,H,X,et){if(X==null)throw Error(n(151));for(var pt=null,Ut=null,Tt=H,_t=H=0,Ke=null,Xt=X.next();Tt!==null&&!Xt.done;_t++,Xt=X.next()){Tt.index>_t?(Ke=Tt,Tt=null):Ke=Tt.sibling;var ma=K(z,Tt,Xt.value,et);if(ma===null){Tt===null&&(Tt=Ke);break}s&&Tt&&ma.alternate===null&&a(z,Tt),H=T(ma,H,_t),Ut===null?pt=ma:Ut.sibling=ma,Ut=ma,Tt=Ke}if(Xt.done)return l(z,Tt),Jt&&mr(z,_t),pt;if(Tt===null){for(;!Xt.done;_t++,Xt=X.next())Xt=nt(z,Xt.value,et),Xt!==null&&(H=T(Xt,H,_t),Ut===null?pt=Xt:Ut.sibling=Xt,Ut=Xt);return Jt&&mr(z,_t),pt}for(Tt=m(Tt);!Xt.done;_t++,Xt=X.next())Xt=W(Tt,z,_t,Xt.value,et),Xt!==null&&(s&&Xt.alternate!==null&&Tt.delete(Xt.key===null?_t:Xt.key),H=T(Xt,H,_t),Ut===null?pt=Xt:Ut.sibling=Xt,Ut=Xt);return s&&Tt.forEach(function(DN){return a(z,DN)}),Jt&&mr(z,_t),pt}function ie(z,H,X,et){if(typeof X=="object"&&X!==null&&X.type===b&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case S:t:{for(var pt=X.key;H!==null;){if(H.key===pt){if(pt=X.type,pt===b){if(H.tag===7){l(z,H.sibling),et=v(H,X.props.children),et.return=z,z=et;break t}}else if(H.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===q&&LE(pt)===H.type){l(z,H.sibling),et=v(H,X.props),kd(et,X),et.return=z,z=et;break t}l(z,H);break}else a(z,H);H=H.sibling}X.type===b?(et=pr(X.props.children,z.mode,et,X.key),et.return=z,z=et):(et=kp(X.type,X.key,X.props,null,z.mode,et),kd(et,X),et.return=z,z=et)}return _(z);case E:t:{for(pt=X.key;H!==null;){if(H.key===pt)if(H.tag===4&&H.stateNode.containerInfo===X.containerInfo&&H.stateNode.implementation===X.implementation){l(z,H.sibling),et=v(H,X.children||[]),et.return=z,z=et;break t}else{l(z,H);break}else a(z,H);H=H.sibling}et=By(X,z.mode,et),et.return=z,z=et}return _(z);case q:return pt=X._init,X=pt(X._payload),ie(z,H,X,et)}if(yt(X))return wt(z,H,X,et);if(ut(X)){if(pt=ut(X),typeof pt!="function")throw Error(n(150));return X=pt.call(X),bt(z,H,X,et)}if(typeof X.then=="function")return ie(z,H,Zp(X),et);if(X.$$typeof===P)return ie(z,H,Bp(z,X),et);jp(z,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,H!==null&&H.tag===6?(l(z,H.sibling),et=v(H,X),et.return=z,z=et):(l(z,H),et=Oy(X,z.mode,et),et.return=z,z=et),_(z)):l(z,H)}return function(z,H,X,et){try{Ld=0;var pt=ie(z,H,X,et);return vu=null,pt}catch(Tt){if(Tt===xd||Tt===Vp)throw Tt;var Ut=ei(29,Tt,null,z.mode);return Ut.lanes=et,Ut.return=z,Ut}finally{}}}var Au=kE(!0),UE=kE(!1),Li=j(null),gs=null;function ea(s){var a=s.alternate;it(Ge,Ge.current&1),it(Li,s),gs===null&&(a===null||pu.current!==null||a.memoizedState!==null)&&(gs=s)}function FE(s){if(s.tag===22){if(it(Ge,Ge.current),it(Li,s),gs===null){var a=s.alternate;a!==null&&a.memoizedState!==null&&(gs=s)}}else na()}function na(){it(Ge,Ge.current),it(Li,Li.current)}function Zs(s){st(Li),gs===s&&(gs=null),st(Ge)}var Ge=j(0);function tg(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||r0(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function vv(s,a,l,m){a=s.memoizedState,l=l(m,a),l=l==null?a:y({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Av={enqueueSetState:function(s,a,l){s=s._reactInternals;var m=oi(),v=Zo(m);v.payload=a,l!=null&&(v.callback=l),a=jo(s,v,m),a!==null&&(ai(a,s,m),wd(a,s,m))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var m=oi(),v=Zo(m);v.tag=1,v.payload=a,l!=null&&(v.callback=l),a=jo(s,v,m),a!==null&&(ai(a,s,m),wd(a,s,m))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=oi(),m=Zo(l);m.tag=2,a!=null&&(m.callback=a),a=jo(s,m,l),a!==null&&(ai(a,s,l),wd(a,s,l))}};function OE(s,a,l,m,v,T,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,T,_):a.prototype&&a.prototype.isPureReactComponent?!yd(l,m)||!yd(v,T):!0}function BE(s,a,l,m){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,m),a.state!==s&&Av.enqueueReplaceState(a,a.state,null)}function Cr(s,a){var l=a;if("ref"in a){l={};for(var m in a)m!=="ref"&&(l[m]=a[m])}if(s=s.defaultProps){l===a&&(l=y({},l));for(var v in s)l[v]===void 0&&(l[v]=s[v])}return l}var eg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function GE(s){eg(s)}function VE(s){console.error(s)}function HE(s){eg(s)}function ng(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(m){setTimeout(function(){throw m})}}function zE(s,a,l){try{var m=s.onCaughtError;m(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Tv(s,a,l){return l=Zo(l),l.tag=3,l.payload={element:null},l.callback=function(){ng(s,a)},l}function qE(s){return s=Zo(s),s.tag=3,s}function $E(s,a,l,m){var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var T=m.value;s.payload=function(){return v(T)},s.callback=function(){zE(a,l,m)}}var _=l.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(s.callback=function(){zE(a,l,m),typeof v!="function"&&(la===null?la=new Set([this]):la.add(this));var I=m.stack;this.componentDidCatch(m.value,{componentStack:I!==null?I:""})})}function D1(s,a,l,m,v){if(l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(a=l.alternate,a!==null&&Ed(a,l,v,!0),l=Li.current,l!==null){switch(l.tag){case 13:return gs===null?qv():l.alternate===null&&Ce===0&&(Ce=3),l.flags&=-257,l.flags|=65536,l.lanes=v,m===Ky?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([m]):a.add(m),Yv(s,m,v)),!1;case 22:return l.flags|=65536,m===Ky?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([m])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([m]):l.add(m)),Yv(s,m,v)),!1}throw Error(n(435,l.tag))}return Yv(s,m,v),qv(),!1}if(Jt)return a=Li.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,m!==Hy&&(s=Error(n(422),{cause:m}),Sd(Ni(s,l)))):(m!==Hy&&(a=Error(n(423),{cause:m}),Sd(Ni(a,l))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,m=Ni(m,l),v=Tv(s.stateNode,m,v),Zy(s,v),Ce!==4&&(Ce=2)),!1;var T=Error(n(520),{cause:m});if(T=Ni(T,l),Hd===null?Hd=[T]:Hd.push(T),Ce!==4&&(Ce=2),a===null)return!0;m=Ni(m,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=v&-v,l.lanes|=s,s=Tv(l.stateNode,m,s),Zy(l,s),!1;case 1:if(a=l.type,T=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(la===null||!la.has(T))))return l.flags|=65536,v&=-v,l.lanes|=v,v=qE(v),$E(v,s,l,m),Zy(l,v),!1}l=l.return}while(l!==null);return!1}var YE=Error(n(461)),Xe=!1;function sn(s,a,l,m){a.child=s===null?UE(a,null,l,m):Au(a,s.child,l,m)}function XE(s,a,l,m,v){l=l.render;var T=a.ref;if("ref"in m){var _={};for(var I in m)I!=="ref"&&(_[I]=m[I])}else _=m;return Tr(a),m=iv(s,a,l,_,T,v),I=sv(),s!==null&&!Xe?(ov(s,a,v),js(s,a,v)):(Jt&&I&&Gy(a),a.flags|=1,sn(s,a,m,v),a.child)}function JE(s,a,l,m,v){if(s===null){var T=l.type;return typeof T=="function"&&!Fy(T)&&T.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=T,KE(s,a,T,m,v)):(s=kp(l.type,null,m,a,a.mode,v),s.ref=a.ref,s.return=a,a.child=s)}if(T=s.child,!Mv(s,v)){var _=T.memoizedProps;if(l=l.compare,l=l!==null?l:yd,l(_,m)&&s.ref===a.ref)return js(s,a,v)}return a.flags|=1,s=Ys(T,m),s.ref=a.ref,s.return=a,a.child=s}function KE(s,a,l,m,v){if(s!==null){var T=s.memoizedProps;if(yd(T,m)&&s.ref===a.ref)if(Xe=!1,a.pendingProps=m=T,Mv(s,v))(s.flags&131072)!==0&&(Xe=!0);else return a.lanes=s.lanes,js(s,a,v)}return Sv(s,a,l,m,v)}function WE(s,a,l){var m=a.pendingProps,v=m.children,T=s!==null?s.memoizedState:null;if(m.mode==="hidden"){if((a.flags&128)!==0){if(m=T!==null?T.baseLanes|l:l,s!==null){for(v=a.child=s.child,T=0;v!==null;)T=T|v.lanes|v.childLanes,v=v.sibling;a.childLanes=T&~m}else a.childLanes=0,a.child=null;return QE(s,a,m,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Gp(a,T!==null?T.cachePool:null),T!==null?KS(a,T):tv(),FE(a);else return a.lanes=a.childLanes=536870912,QE(s,a,T!==null?T.baseLanes|l:l,l)}else T!==null?(Gp(a,T.cachePool),KS(a,T),na(),a.memoizedState=null):(s!==null&&Gp(a,null),tv(),na());return sn(s,a,v,l),a.child}function QE(s,a,l,m){var v=Jy();return v=v===null?null:{parent:Be._currentValue,pool:v},a.memoizedState={baseLanes:l,cachePool:v},s!==null&&Gp(a,null),tv(),FE(a),s!==null&&Ed(s,a,m,!0),null}function ig(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function Sv(s,a,l,m,v){return Tr(a),l=iv(s,a,l,m,void 0,v),m=sv(),s!==null&&!Xe?(ov(s,a,v),js(s,a,v)):(Jt&&m&&Gy(a),a.flags|=1,sn(s,a,l,v),a.child)}function ZE(s,a,l,m,v,T){return Tr(a),a.updateQueue=null,l=QS(a,m,l,v),WS(s),m=sv(),s!==null&&!Xe?(ov(s,a,T),js(s,a,T)):(Jt&&m&&Gy(a),a.flags|=1,sn(s,a,l,T),a.child)}function jE(s,a,l,m,v){if(Tr(a),a.stateNode===null){var T=uu,_=l.contextType;typeof _=="object"&&_!==null&&(T=yn(_)),T=new l(m,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Av,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=m,T.state=a.memoizedState,T.refs={},Wy(a),_=l.contextType,T.context=typeof _=="object"&&_!==null?yn(_):uu,T.state=a.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(vv(a,l,_,m),T.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(_=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),_!==T.state&&Av.enqueueReplaceState(T,T.state,null),Rd(a,m,T,v),Md(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),m=!0}else if(s===null){T=a.stateNode;var I=a.memoizedProps,O=Cr(l,I);T.props=O;var J=T.context,tt=l.contextType;_=uu,typeof tt=="object"&&tt!==null&&(_=yn(tt));var nt=l.getDerivedStateFromProps;tt=typeof nt=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,tt||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||J!==_)&&BE(a,T,m,_),Qo=!1;var K=a.memoizedState;T.state=K,Rd(a,m,T,v),Md(),J=a.memoizedState,I||K!==J||Qo?(typeof nt=="function"&&(vv(a,l,nt,m),J=a.memoizedState),(O=Qo||OE(a,l,O,m,K,J,_))?(tt||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=J),T.props=m,T.state=J,T.context=_,m=O):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{T=a.stateNode,Qy(s,a),_=a.memoizedProps,tt=Cr(l,_),T.props=tt,nt=a.pendingProps,K=T.context,J=l.contextType,O=uu,typeof J=="object"&&J!==null&&(O=yn(J)),I=l.getDerivedStateFromProps,(J=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(_!==nt||K!==O)&&BE(a,T,m,O),Qo=!1,K=a.memoizedState,T.state=K,Rd(a,m,T,v),Md();var W=a.memoizedState;_!==nt||K!==W||Qo||s!==null&&s.dependencies!==null&&Op(s.dependencies)?(typeof I=="function"&&(vv(a,l,I,m),W=a.memoizedState),(tt=Qo||OE(a,l,tt,m,K,W,O)||s!==null&&s.dependencies!==null&&Op(s.dependencies))?(J||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,W,O),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,W,O)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=W),T.props=m,T.state=W,T.context=O,m=tt):(typeof T.componentDidUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),m=!1)}return T=m,ig(s,a),m=(a.flags&128)!==0,T||m?(T=a.stateNode,l=m&&typeof l.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,s!==null&&m?(a.child=Au(a,s.child,null,v),a.child=Au(a,null,l,v)):sn(s,a,l,v),a.memoizedState=T.state,s=a.child):s=js(s,a,v),s}function tC(s,a,l,m){return Td(),a.flags|=256,sn(s,a,l,m),a.child}var Ev={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cv(s){return{baseLanes:s,cachePool:VS()}}function bv(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=ki),s}function eC(s,a,l){var m=a.pendingProps,v=!1,T=(a.flags&128)!==0,_;if((_=T)||(_=s!==null&&s.memoizedState===null?!1:(Ge.current&2)!==0),_&&(v=!0,a.flags&=-129),_=(a.flags&32)!==0,a.flags&=-33,s===null){if(Jt){if(v?ea(a):na(),Jt){var I=Ee,O;if(O=I){t:{for(O=I,I=ps;O.nodeType!==8;){if(!I){I=null;break t}if(O=Qi(O.nextSibling),O===null){I=null;break t}}I=O}I!==null?(a.memoizedState={dehydrated:I,treeContext:gr!==null?{id:Xs,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},O=ei(18,null,null,0),O.stateNode=I,O.return=a,a.child=O,Mn=a,Ee=null,O=!0):O=!1}O||vr(a)}if(I=a.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return r0(I)?a.lanes=32:a.lanes=536870912,null;Zs(a)}return I=m.children,m=m.fallback,v?(na(),v=a.mode,I=sg({mode:"hidden",children:I},v),m=pr(m,v,l,null),I.return=a,m.return=a,I.sibling=m,a.child=I,v=a.child,v.memoizedState=Cv(l),v.childLanes=bv(s,_,l),a.memoizedState=Ev,m):(ea(a),xv(a,I))}if(O=s.memoizedState,O!==null&&(I=O.dehydrated,I!==null)){if(T)a.flags&256?(ea(a),a.flags&=-257,a=_v(s,a,l)):a.memoizedState!==null?(na(),a.child=s.child,a.flags|=128,a=null):(na(),v=m.fallback,I=a.mode,m=sg({mode:"visible",children:m.children},I),v=pr(v,I,l,null),v.flags|=2,m.return=a,v.return=a,m.sibling=v,a.child=m,Au(a,s.child,null,l),m=a.child,m.memoizedState=Cv(l),m.childLanes=bv(s,_,l),a.memoizedState=Ev,a=v);else if(ea(a),r0(I)){if(_=I.nextSibling&&I.nextSibling.dataset,_)var J=_.dgst;_=J,m=Error(n(419)),m.stack="",m.digest=_,Sd({value:m,source:null,stack:null}),a=_v(s,a,l)}else if(Xe||Ed(s,a,l,!1),_=(l&s.childLanes)!==0,Xe||_){if(_=ue,_!==null&&(m=l&-l,m=(m&42)!==0?1:ly(m),m=(m&(_.suspendedLanes|l))!==0?0:m,m!==0&&m!==O.retryLane))throw O.retryLane=m,lu(s,m),ai(_,s,m),YE;I.data==="$?"||qv(),a=_v(s,a,l)}else I.data==="$?"?(a.flags|=192,a.child=s.child,a=null):(s=O.treeContext,Ee=Qi(I.nextSibling),Mn=a,Jt=!0,yr=null,ps=!1,s!==null&&(Ii[Pi++]=Xs,Ii[Pi++]=Js,Ii[Pi++]=gr,Xs=s.id,Js=s.overflow,gr=a),a=xv(a,m.children),a.flags|=4096);return a}return v?(na(),v=m.fallback,I=a.mode,O=s.child,J=O.sibling,m=Ys(O,{mode:"hidden",children:m.children}),m.subtreeFlags=O.subtreeFlags&65011712,J!==null?v=Ys(J,v):(v=pr(v,I,l,null),v.flags|=2),v.return=a,m.return=a,m.sibling=v,a.child=m,m=v,v=a.child,I=s.child.memoizedState,I===null?I=Cv(l):(O=I.cachePool,O!==null?(J=Be._currentValue,O=O.parent!==J?{parent:J,pool:J}:O):O=VS(),I={baseLanes:I.baseLanes|l,cachePool:O}),v.memoizedState=I,v.childLanes=bv(s,_,l),a.memoizedState=Ev,m):(ea(a),l=s.child,s=l.sibling,l=Ys(l,{mode:"visible",children:m.children}),l.return=a,l.sibling=null,s!==null&&(_=a.deletions,_===null?(a.deletions=[s],a.flags|=16):_.push(s)),a.child=l,a.memoizedState=null,l)}function xv(s,a){return a=sg({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function sg(s,a){return s=ei(22,s,null,a),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function _v(s,a,l){return Au(a,s.child,null,l),s=xv(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function nC(s,a,l){s.lanes|=a;var m=s.alternate;m!==null&&(m.lanes|=a),qy(s.return,a,l)}function wv(s,a,l,m,v){var T=s.memoizedState;T===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:l,tailMode:v}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=m,T.tail=l,T.tailMode=v)}function iC(s,a,l){var m=a.pendingProps,v=m.revealOrder,T=m.tail;if(sn(s,a,m.children,l),m=Ge.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&nC(s,l,a);else if(s.tag===19)nC(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break t;for(;s.sibling===null;){if(s.return===null||s.return===a)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}switch(it(Ge,m),v){case"forwards":for(l=a.child,v=null;l!==null;)s=l.alternate,s!==null&&tg(s)===null&&(v=l),l=l.sibling;l=v,l===null?(v=a.child,a.child=null):(v=l.sibling,l.sibling=null),wv(a,!1,v,l,T);break;case"backwards":for(l=null,v=a.child,a.child=null;v!==null;){if(s=v.alternate,s!==null&&tg(s)===null){a.child=v;break}s=v.sibling,v.sibling=l,l=v,v=s}wv(a,!0,l,null,T);break;case"together":wv(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function js(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),ra|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(Ed(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,l=Ys(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=Ys(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function Mv(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&Op(s)))}function I1(s,a,l){switch(a.tag){case 3:Yt(a,a.stateNode.containerInfo),Wo(a,Be,s.memoizedState.cache),Td();break;case 27:case 5:rr(a);break;case 4:Yt(a,a.stateNode.containerInfo);break;case 10:Wo(a,a.type,a.memoizedProps.value);break;case 13:var m=a.memoizedState;if(m!==null)return m.dehydrated!==null?(ea(a),a.flags|=128,null):(l&a.child.childLanes)!==0?eC(s,a,l):(ea(a),s=js(s,a,l),s!==null?s.sibling:null);ea(a);break;case 19:var v=(s.flags&128)!==0;if(m=(l&a.childLanes)!==0,m||(Ed(s,a,l,!1),m=(l&a.childLanes)!==0),v){if(m)return iC(s,a,l);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),it(Ge,Ge.current),m)break;return null;case 22:case 23:return a.lanes=0,WE(s,a,l);case 24:Wo(a,Be,s.memoizedState.cache)}return js(s,a,l)}function sC(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)Xe=!0;else{if(!Mv(s,l)&&(a.flags&128)===0)return Xe=!1,I1(s,a,l);Xe=(s.flags&131072)!==0}else Xe=!1,Jt&&(a.flags&1048576)!==0&&LS(a,Fp,a.index);switch(a.lanes=0,a.tag){case 16:t:{s=a.pendingProps;var m=a.elementType,v=m._init;if(m=v(m._payload),a.type=m,typeof m=="function")Fy(m)?(s=Cr(m,s),a.tag=1,a=jE(null,a,m,s,l)):(a.tag=0,a=Sv(null,a,m,s,l));else{if(m!=null){if(v=m.$$typeof,v===U){a.tag=11,a=XE(null,a,m,s,l);break t}else if(v===B){a.tag=14,a=JE(null,a,m,s,l);break t}}throw a=gt(m)||m,Error(n(306,a,""))}}return a;case 0:return Sv(s,a,a.type,a.pendingProps,l);case 1:return m=a.type,v=Cr(m,a.pendingProps),jE(s,a,m,v,l);case 3:t:{if(Yt(a,a.stateNode.containerInfo),s===null)throw Error(n(387));m=a.pendingProps;var T=a.memoizedState;v=T.element,Qy(s,a),Rd(a,m,null,l);var _=a.memoizedState;if(m=_.cache,Wo(a,Be,m),m!==T.cache&&$y(a,[Be],l,!0),Md(),m=_.element,T.isDehydrated)if(T={element:m,isDehydrated:!1,cache:_.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=tC(s,a,m,l);break t}else if(m!==v){v=Ni(Error(n(424)),a),Sd(v),a=tC(s,a,m,l);break t}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Ee=Qi(s.firstChild),Mn=a,Jt=!0,yr=null,ps=!0,l=UE(a,null,m,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Td(),m===v){a=js(s,a,l);break t}sn(s,a,m,l)}a=a.child}return a;case 26:return ig(s,a),s===null?(l=lb(a.type,null,a.pendingProps,null))?a.memoizedState=l:Jt||(l=a.type,s=a.pendingProps,m=vg(Et.current).createElement(l),m[mn]=a,m[zn]=s,an(m,l,s),Ye(m),a.stateNode=m):a.memoizedState=lb(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return rr(a),s===null&&Jt&&(m=a.stateNode=ob(a.type,a.pendingProps,Et.current),Mn=a,ps=!0,v=Ee,da(a.type)?(l0=v,Ee=Qi(m.firstChild)):Ee=v),sn(s,a,a.pendingProps.children,l),ig(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Jt&&((v=m=Ee)&&(m=aN(m,a.type,a.pendingProps,ps),m!==null?(a.stateNode=m,Mn=a,Ee=Qi(m.firstChild),ps=!1,v=!0):v=!1),v||vr(a)),rr(a),v=a.type,T=a.pendingProps,_=s!==null?s.memoizedProps:null,m=T.children,s0(v,T)?m=null:_!==null&&s0(v,_)&&(a.flags|=32),a.memoizedState!==null&&(v=iv(s,a,b1,null,null,l),Qd._currentValue=v),ig(s,a),sn(s,a,m,l),a.child;case 6:return s===null&&Jt&&((s=l=Ee)&&(l=rN(l,a.pendingProps,ps),l!==null?(a.stateNode=l,Mn=a,Ee=null,s=!0):s=!1),s||vr(a)),null;case 13:return eC(s,a,l);case 4:return Yt(a,a.stateNode.containerInfo),m=a.pendingProps,s===null?a.child=Au(a,null,m,l):sn(s,a,m,l),a.child;case 11:return XE(s,a,a.type,a.pendingProps,l);case 7:return sn(s,a,a.pendingProps,l),a.child;case 8:return sn(s,a,a.pendingProps.children,l),a.child;case 12:return sn(s,a,a.pendingProps.children,l),a.child;case 10:return m=a.pendingProps,Wo(a,a.type,m.value),sn(s,a,m.children,l),a.child;case 9:return v=a.type._context,m=a.pendingProps.children,Tr(a),v=yn(v),m=m(v),a.flags|=1,sn(s,a,m,l),a.child;case 14:return JE(s,a,a.type,a.pendingProps,l);case 15:return KE(s,a,a.type,a.pendingProps,l);case 19:return iC(s,a,l);case 31:return m=a.pendingProps,l=a.mode,m={mode:m.mode,children:m.children},s===null?(l=sg(m,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=Ys(s.child,m),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return WE(s,a,l);case 24:return Tr(a),m=yn(Be),s===null?(v=Jy(),v===null&&(v=ue,T=Yy(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=l),v=T),a.memoizedState={parent:m,cache:v},Wy(a),Wo(a,Be,v)):((s.lanes&l)!==0&&(Qy(s,a),Rd(a,null,null,l),Md()),v=s.memoizedState,T=a.memoizedState,v.parent!==m?(v={parent:m,cache:m},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),Wo(a,Be,m)):(m=T.cache,Wo(a,Be,m),m!==v.cache&&$y(a,[Be],l,!0))),sn(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function to(s){s.flags|=4}function oC(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!hb(a)){if(a=Li.current,a!==null&&((zt&4194048)===zt?gs!==null:(zt&62914560)!==zt&&(zt&536870912)===0||a!==gs))throw _d=Ky,HS;s.flags|=8192}}function og(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?FT():536870912,s.lanes|=a,Cu|=a)}function Ud(s,a){if(!Jt)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Ae(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,m=0;if(a)for(var v=s.child;v!==null;)l|=v.lanes|v.childLanes,m|=v.subtreeFlags&65011712,m|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)l|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=l,a}function P1(s,a,l){var m=a.pendingProps;switch(Vy(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ae(a),null;case 1:return Ae(a),null;case 3:return l=a.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),a.memoizedState.cache!==m&&(a.flags|=2048),Ws(Be),_i(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Ad(a)?to(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,FS())),Ae(a),null;case 26:return l=a.memoizedState,s===null?(to(a),l!==null?(Ae(a),oC(a,l)):(Ae(a),a.flags&=-16777217)):l?l!==s.memoizedState?(to(a),Ae(a),oC(a,l)):(Ae(a),a.flags&=-16777217):(s.memoizedProps!==m&&to(a),Ae(a),a.flags&=-16777217),null;case 27:wi(a),l=Et.current;var v=a.type;if(s!==null&&a.stateNode!=null)s.memoizedProps!==m&&to(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return Ae(a),null}s=dt.current,Ad(a)?kS(a):(s=ob(v,m,l),a.stateNode=s,to(a))}return Ae(a),null;case 5:if(wi(a),l=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==m&&to(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return Ae(a),null}if(s=dt.current,Ad(a))kS(a);else{switch(v=vg(Et.current),s){case 1:s=v.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=v.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=v.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof m.is=="string"?v.createElement("select",{is:m.is}):v.createElement("select"),m.multiple?s.multiple=!0:m.size&&(s.size=m.size);break;default:s=typeof m.is=="string"?v.createElement(l,{is:m.is}):v.createElement(l)}}s[mn]=a,s[zn]=m;t:for(v=a.child;v!==null;){if(v.tag===5||v.tag===6)s.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===a)break t;for(;v.sibling===null;){if(v.return===null||v.return===a)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}a.stateNode=s;t:switch(an(s,l,m),l){case"button":case"input":case"select":case"textarea":s=!!m.autoFocus;break t;case"img":s=!0;break t;default:s=!1}s&&to(a)}}return Ae(a),a.flags&=-16777217,null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==m&&to(a);else{if(typeof m!="string"&&a.stateNode===null)throw Error(n(166));if(s=Et.current,Ad(a)){if(s=a.stateNode,l=a.memoizedProps,m=null,v=Mn,v!==null)switch(v.tag){case 27:case 5:m=v.memoizedProps}s[mn]=a,s=!!(s.nodeValue===l||m!==null&&m.suppressHydrationWarning===!0||ZC(s.nodeValue,l)),s||vr(a)}else s=vg(s).createTextNode(m),s[mn]=a,a.stateNode=s}return Ae(a),null;case 13:if(m=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Ad(a),m!==null&&m.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[mn]=a}else Td(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ae(a),v=!1}else v=FS(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(Zs(a),a):(Zs(a),null)}if(Zs(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=m!==null,s=s!==null&&s.memoizedState!==null,l){m=a.child,v=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(v=m.alternate.memoizedState.cachePool.pool);var T=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==v&&(m.flags|=2048)}return l!==s&&l&&(a.child.flags|=8192),og(a,a.updateQueue),Ae(a),null;case 4:return _i(),s===null&&jv(a.stateNode.containerInfo),Ae(a),null;case 10:return Ws(a.type),Ae(a),null;case 19:if(st(Ge),v=a.memoizedState,v===null)return Ae(a),null;if(m=(a.flags&128)!==0,T=v.rendering,T===null)if(m)Ud(v,!1);else{if(Ce!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(T=tg(s),T!==null){for(a.flags|=128,Ud(v,!1),s=T.updateQueue,a.updateQueue=s,og(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)PS(l,s),l=l.sibling;return it(Ge,Ge.current&1|2),a.child}s=s.sibling}v.tail!==null&&Oe()>lg&&(a.flags|=128,m=!0,Ud(v,!1),a.lanes=4194304)}else{if(!m)if(s=tg(T),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,og(a,s),Ud(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!Jt)return Ae(a),null}else 2*Oe()-v.renderingStartTime>lg&&l!==536870912&&(a.flags|=128,m=!0,Ud(v,!1),a.lanes=4194304);v.isBackwards?(T.sibling=a.child,a.child=T):(s=v.last,s!==null?s.sibling=T:a.child=T,v.last=T)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Oe(),a.sibling=null,s=Ge.current,it(Ge,m?s&1|2:s&1),a):(Ae(a),null);case 22:case 23:return Zs(a),ev(),m=a.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(a.flags|=8192):m&&(a.flags|=8192),m?(l&536870912)!==0&&(a.flags&128)===0&&(Ae(a),a.subtreeFlags&6&&(a.flags|=8192)):Ae(a),l=a.updateQueue,l!==null&&og(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),m=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),m!==l&&(a.flags|=2048),s!==null&&st(Sr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Ws(Be),Ae(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function L1(s,a){switch(Vy(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ws(Be),_i(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return wi(a),null;case 13:if(Zs(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Td()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return st(Ge),null;case 4:return _i(),null;case 10:return Ws(a.type),null;case 22:case 23:return Zs(a),ev(),s!==null&&st(Sr),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Ws(Be),null;case 25:return null;default:return null}}function aC(s,a){switch(Vy(a),a.tag){case 3:Ws(Be),_i();break;case 26:case 27:case 5:wi(a);break;case 4:_i();break;case 13:Zs(a);break;case 19:st(Ge);break;case 10:Ws(a.type);break;case 22:case 23:Zs(a),ev(),s!==null&&st(Sr);break;case 24:Ws(Be)}}function Fd(s,a){try{var l=a.updateQueue,m=l!==null?l.lastEffect:null;if(m!==null){var v=m.next;l=v;do{if((l.tag&s)===s){m=void 0;var T=l.create,_=l.inst;m=T(),_.destroy=m}l=l.next}while(l!==v)}}catch(I){le(a,a.return,I)}}function ia(s,a,l){try{var m=a.updateQueue,v=m!==null?m.lastEffect:null;if(v!==null){var T=v.next;m=T;do{if((m.tag&s)===s){var _=m.inst,I=_.destroy;if(I!==void 0){_.destroy=void 0,v=a;var O=l,J=I;try{J()}catch(tt){le(v,O,tt)}}}m=m.next}while(m!==T)}}catch(tt){le(a,a.return,tt)}}function rC(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{JS(a,l)}catch(m){le(s,s.return,m)}}}function lC(s,a,l){l.props=Cr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(m){le(s,a,m)}}function Od(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof l=="function"?s.refCleanup=l(m):l.current=m}}catch(v){le(s,a,v)}}function ms(s,a){var l=s.ref,m=s.refCleanup;if(l!==null)if(typeof m=="function")try{m()}catch(v){le(s,a,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(v){le(s,a,v)}else l.current=null}function uC(s){var a=s.type,l=s.memoizedProps,m=s.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&m.focus();break t;case"img":l.src?m.src=l.src:l.srcSet&&(m.srcset=l.srcSet)}}catch(v){le(s,s.return,v)}}function Rv(s,a,l){try{var m=s.stateNode;eN(m,s.type,l,a),m[zn]=a}catch(v){le(s,s.return,v)}}function cC(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&da(s.type)||s.tag===4}function Nv(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||cC(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&da(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Dv(s,a,l){var m=s.tag;if(m===5||m===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=yg));else if(m!==4&&(m===27&&da(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(Dv(s,a,l),s=s.sibling;s!==null;)Dv(s,a,l),s=s.sibling}function ag(s,a,l){var m=s.tag;if(m===5||m===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(m!==4&&(m===27&&da(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(ag(s,a,l),s=s.sibling;s!==null;)ag(s,a,l),s=s.sibling}function dC(s){var a=s.stateNode,l=s.memoizedProps;try{for(var m=s.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);an(a,m,l),a[mn]=s,a[zn]=l}catch(T){le(s,s.return,T)}}var eo=!1,we=!1,Iv=!1,fC=typeof WeakSet=="function"?WeakSet:Set,Je=null;function k1(s,a){if(s=s.containerInfo,n0=bg,s=CS(s),Ny(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else t:{l=(l=s.ownerDocument)&&l.defaultView||window;var m=l.getSelection&&l.getSelection();if(m&&m.rangeCount!==0){l=m.anchorNode;var v=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{l.nodeType,T.nodeType}catch{l=null;break t}var _=0,I=-1,O=-1,J=0,tt=0,nt=s,K=null;e:for(;;){for(var W;nt!==l||v!==0&&nt.nodeType!==3||(I=_+v),nt!==T||m!==0&&nt.nodeType!==3||(O=_+m),nt.nodeType===3&&(_+=nt.nodeValue.length),(W=nt.firstChild)!==null;)K=nt,nt=W;for(;;){if(nt===s)break e;if(K===l&&++J===v&&(I=_),K===T&&++tt===m&&(O=_),(W=nt.nextSibling)!==null)break;nt=K,K=nt.parentNode}nt=W}l=I===-1||O===-1?null:{start:I,end:O}}else l=null}l=l||{start:0,end:0}}else l=null;for(i0={focusedElem:s,selectionRange:l},bg=!1,Je=a;Je!==null;)if(a=Je,s=a.child,(a.subtreeFlags&1024)!==0&&s!==null)s.return=a,Je=s;else for(;Je!==null;){switch(a=Je,T=a.alternate,s=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,l=a,v=T.memoizedProps,T=T.memoizedState,m=l.stateNode;try{var wt=Cr(l.type,v,l.elementType===l.type);s=m.getSnapshotBeforeUpdate(wt,T),m.__reactInternalSnapshotBeforeUpdate=s}catch(bt){le(l,l.return,bt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)a0(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":a0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Je=s;break}Je=a.return}}function hC(s,a,l){var m=l.flags;switch(l.tag){case 0:case 11:case 15:sa(s,l),m&4&&Fd(5,l);break;case 1:if(sa(s,l),m&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(_){le(l,l.return,_)}else{var v=Cr(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(v,a,s.__reactInternalSnapshotBeforeUpdate)}catch(_){le(l,l.return,_)}}m&64&&rC(l),m&512&&Od(l,l.return);break;case 3:if(sa(s,l),m&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{JS(s,a)}catch(_){le(l,l.return,_)}}break;case 27:a===null&&m&4&&dC(l);case 26:case 5:sa(s,l),a===null&&m&4&&uC(l),m&512&&Od(l,l.return);break;case 12:sa(s,l);break;case 13:sa(s,l),m&4&&mC(s,l),m&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=q1.bind(null,l),lN(s,l))));break;case 22:if(m=l.memoizedState!==null||eo,!m){a=a!==null&&a.memoizedState!==null||we,v=eo;var T=we;eo=m,(we=a)&&!T?oa(s,l,(l.subtreeFlags&8772)!==0):sa(s,l),eo=v,we=T}break;case 30:break;default:sa(s,l)}}function pC(s){var a=s.alternate;a!==null&&(s.alternate=null,pC(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&dy(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pe=null,Yn=!1;function no(s,a,l){for(l=l.child;l!==null;)gC(s,a,l),l=l.sibling}function gC(s,a,l){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(Xo,l)}catch{}switch(l.tag){case 26:we||ms(l,a),no(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:we||ms(l,a);var m=pe,v=Yn;da(l.type)&&(pe=l.stateNode,Yn=!1),no(s,a,l),Xd(l.stateNode),pe=m,Yn=v;break;case 5:we||ms(l,a);case 6:if(m=pe,v=Yn,pe=null,no(s,a,l),pe=m,Yn=v,pe!==null)if(Yn)try{(pe.nodeType===9?pe.body:pe.nodeName==="HTML"?pe.ownerDocument.body:pe).removeChild(l.stateNode)}catch(T){le(l,a,T)}else try{pe.removeChild(l.stateNode)}catch(T){le(l,a,T)}break;case 18:pe!==null&&(Yn?(s=pe,ib(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),ef(s)):ib(pe,l.stateNode));break;case 4:m=pe,v=Yn,pe=l.stateNode.containerInfo,Yn=!0,no(s,a,l),pe=m,Yn=v;break;case 0:case 11:case 14:case 15:we||ia(2,l,a),we||ia(4,l,a),no(s,a,l);break;case 1:we||(ms(l,a),m=l.stateNode,typeof m.componentWillUnmount=="function"&&lC(l,a,m)),no(s,a,l);break;case 21:no(s,a,l);break;case 22:we=(m=we)||l.memoizedState!==null,no(s,a,l),we=m;break;default:no(s,a,l)}}function mC(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ef(s)}catch(l){le(a,a.return,l)}}function U1(s){switch(s.tag){case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new fC),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new fC),a;default:throw Error(n(435,s.tag))}}function Pv(s,a){var l=U1(s);a.forEach(function(m){var v=$1.bind(null,s,m);l.has(m)||(l.add(m),m.then(v,v))})}function ni(s,a){var l=a.deletions;if(l!==null)for(var m=0;m<l.length;m++){var v=l[m],T=s,_=a,I=_;t:for(;I!==null;){switch(I.tag){case 27:if(da(I.type)){pe=I.stateNode,Yn=!1;break t}break;case 5:pe=I.stateNode,Yn=!1;break t;case 3:case 4:pe=I.stateNode.containerInfo,Yn=!0;break t}I=I.return}if(pe===null)throw Error(n(160));gC(T,_,v),pe=null,Yn=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)yC(a,s),a=a.sibling}var Wi=null;function yC(s,a){var l=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ni(a,s),ii(s),m&4&&(ia(3,s,s.return),Fd(3,s),ia(5,s,s.return));break;case 1:ni(a,s),ii(s),m&512&&(we||l===null||ms(l,l.return)),m&64&&eo&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?m:l.concat(m))));break;case 26:var v=Wi;if(ni(a,s),ii(s),m&512&&(we||l===null||ms(l,l.return)),m&4){var T=l!==null?l.memoizedState:null;if(m=s.memoizedState,l===null)if(m===null)if(s.stateNode===null){t:{m=s.type,l=s.memoizedProps,v=v.ownerDocument||v;e:switch(m){case"title":T=v.getElementsByTagName("title")[0],(!T||T[ld]||T[mn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(m),v.head.insertBefore(T,v.querySelector("head > title"))),an(T,m,l),T[mn]=s,Ye(T),m=T;break t;case"link":var _=db("link","href",v).get(m+(l.href||""));if(_){for(var I=0;I<_.length;I++)if(T=_[I],T.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&T.getAttribute("rel")===(l.rel==null?null:l.rel)&&T.getAttribute("title")===(l.title==null?null:l.title)&&T.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){_.splice(I,1);break e}}T=v.createElement(m),an(T,m,l),v.head.appendChild(T);break;case"meta":if(_=db("meta","content",v).get(m+(l.content||""))){for(I=0;I<_.length;I++)if(T=_[I],T.getAttribute("content")===(l.content==null?null:""+l.content)&&T.getAttribute("name")===(l.name==null?null:l.name)&&T.getAttribute("property")===(l.property==null?null:l.property)&&T.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&T.getAttribute("charset")===(l.charSet==null?null:l.charSet)){_.splice(I,1);break e}}T=v.createElement(m),an(T,m,l),v.head.appendChild(T);break;default:throw Error(n(468,m))}T[mn]=s,Ye(T),m=T}s.stateNode=m}else fb(v,s.type,s.stateNode);else s.stateNode=cb(v,m,s.memoizedProps);else T!==m?(T===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):T.count--,m===null?fb(v,s.type,s.stateNode):cb(v,m,s.memoizedProps)):m===null&&s.stateNode!==null&&Rv(s,s.memoizedProps,l.memoizedProps)}break;case 27:ni(a,s),ii(s),m&512&&(we||l===null||ms(l,l.return)),l!==null&&m&4&&Rv(s,s.memoizedProps,l.memoizedProps);break;case 5:if(ni(a,s),ii(s),m&512&&(we||l===null||ms(l,l.return)),s.flags&32){v=s.stateNode;try{eu(v,"")}catch(W){le(s,s.return,W)}}m&4&&s.stateNode!=null&&(v=s.memoizedProps,Rv(s,v,l!==null?l.memoizedProps:v)),m&1024&&(Iv=!0);break;case 6:if(ni(a,s),ii(s),m&4){if(s.stateNode===null)throw Error(n(162));m=s.memoizedProps,l=s.stateNode;try{l.nodeValue=m}catch(W){le(s,s.return,W)}}break;case 3:if(Sg=null,v=Wi,Wi=Ag(a.containerInfo),ni(a,s),Wi=v,ii(s),m&4&&l!==null&&l.memoizedState.isDehydrated)try{ef(a.containerInfo)}catch(W){le(s,s.return,W)}Iv&&(Iv=!1,vC(s));break;case 4:m=Wi,Wi=Ag(s.stateNode.containerInfo),ni(a,s),ii(s),Wi=m;break;case 12:ni(a,s),ii(s);break;case 13:ni(a,s),ii(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Bv=Oe()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Pv(s,m)));break;case 22:v=s.memoizedState!==null;var O=l!==null&&l.memoizedState!==null,J=eo,tt=we;if(eo=J||v,we=tt||O,ni(a,s),we=tt,eo=J,ii(s),m&8192)t:for(a=s.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(l===null||O||eo||we||br(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){O=l=a;try{if(T=O.stateNode,v)_=T.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{I=O.stateNode;var nt=O.memoizedProps.style,K=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;I.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(W){le(O,O.return,W)}}}else if(a.tag===6){if(l===null){O=a;try{O.stateNode.nodeValue=v?"":O.memoizedProps}catch(W){le(O,O.return,W)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break t;for(;a.sibling===null;){if(a.return===null||a.return===s)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}m&4&&(m=s.updateQueue,m!==null&&(l=m.retryQueue,l!==null&&(m.retryQueue=null,Pv(s,l))));break;case 19:ni(a,s),ii(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Pv(s,m)));break;case 30:break;case 21:break;default:ni(a,s),ii(s)}}function ii(s){var a=s.flags;if(a&2){try{for(var l,m=s.return;m!==null;){if(cC(m)){l=m;break}m=m.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var v=l.stateNode,T=Nv(s);ag(s,T,v);break;case 5:var _=l.stateNode;l.flags&32&&(eu(_,""),l.flags&=-33);var I=Nv(s);ag(s,I,_);break;case 3:case 4:var O=l.stateNode.containerInfo,J=Nv(s);Dv(s,J,O);break;default:throw Error(n(161))}}catch(tt){le(s,s.return,tt)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function vC(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;vC(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function sa(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)hC(s,a.alternate,a),a=a.sibling}function br(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:ia(4,a,a.return),br(a);break;case 1:ms(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&lC(a,a.return,l),br(a);break;case 27:Xd(a.stateNode);case 26:case 5:ms(a,a.return),br(a);break;case 22:a.memoizedState===null&&br(a);break;case 30:br(a);break;default:br(a)}s=s.sibling}}function oa(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var m=a.alternate,v=s,T=a,_=T.flags;switch(T.tag){case 0:case 11:case 15:oa(v,T,l),Fd(4,T);break;case 1:if(oa(v,T,l),m=T,v=m.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(J){le(m,m.return,J)}if(m=T,v=m.updateQueue,v!==null){var I=m.stateNode;try{var O=v.shared.hiddenCallbacks;if(O!==null)for(v.shared.hiddenCallbacks=null,v=0;v<O.length;v++)XS(O[v],I)}catch(J){le(m,m.return,J)}}l&&_&64&&rC(T),Od(T,T.return);break;case 27:dC(T);case 26:case 5:oa(v,T,l),l&&m===null&&_&4&&uC(T),Od(T,T.return);break;case 12:oa(v,T,l);break;case 13:oa(v,T,l),l&&_&4&&mC(v,T);break;case 22:T.memoizedState===null&&oa(v,T,l),Od(T,T.return);break;case 30:break;default:oa(v,T,l)}a=a.sibling}}function Lv(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Cd(l))}function kv(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Cd(s))}function ys(s,a,l,m){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)AC(s,a,l,m),a=a.sibling}function AC(s,a,l,m){var v=a.flags;switch(a.tag){case 0:case 11:case 15:ys(s,a,l,m),v&2048&&Fd(9,a);break;case 1:ys(s,a,l,m);break;case 3:ys(s,a,l,m),v&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Cd(s)));break;case 12:if(v&2048){ys(s,a,l,m),s=a.stateNode;try{var T=a.memoizedProps,_=T.id,I=T.onPostCommit;typeof I=="function"&&I(_,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(O){le(a,a.return,O)}}else ys(s,a,l,m);break;case 13:ys(s,a,l,m);break;case 23:break;case 22:T=a.stateNode,_=a.alternate,a.memoizedState!==null?T._visibility&2?ys(s,a,l,m):Bd(s,a):T._visibility&2?ys(s,a,l,m):(T._visibility|=2,Tu(s,a,l,m,(a.subtreeFlags&10256)!==0)),v&2048&&Lv(_,a);break;case 24:ys(s,a,l,m),v&2048&&kv(a.alternate,a);break;default:ys(s,a,l,m)}}function Tu(s,a,l,m,v){for(v=v&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var T=s,_=a,I=l,O=m,J=_.flags;switch(_.tag){case 0:case 11:case 15:Tu(T,_,I,O,v),Fd(8,_);break;case 23:break;case 22:var tt=_.stateNode;_.memoizedState!==null?tt._visibility&2?Tu(T,_,I,O,v):Bd(T,_):(tt._visibility|=2,Tu(T,_,I,O,v)),v&&J&2048&&Lv(_.alternate,_);break;case 24:Tu(T,_,I,O,v),v&&J&2048&&kv(_.alternate,_);break;default:Tu(T,_,I,O,v)}a=a.sibling}}function Bd(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,m=a,v=m.flags;switch(m.tag){case 22:Bd(l,m),v&2048&&Lv(m.alternate,m);break;case 24:Bd(l,m),v&2048&&kv(m.alternate,m);break;default:Bd(l,m)}a=a.sibling}}var Gd=8192;function Su(s){if(s.subtreeFlags&Gd)for(s=s.child;s!==null;)TC(s),s=s.sibling}function TC(s){switch(s.tag){case 26:Su(s),s.flags&Gd&&s.memoizedState!==null&&SN(Wi,s.memoizedState,s.memoizedProps);break;case 5:Su(s);break;case 3:case 4:var a=Wi;Wi=Ag(s.stateNode.containerInfo),Su(s),Wi=a;break;case 22:s.memoizedState===null&&(a=s.alternate,a!==null&&a.memoizedState!==null?(a=Gd,Gd=16777216,Su(s),Gd=a):Su(s));break;default:Su(s)}}function SC(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Vd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var m=a[l];Je=m,CC(m,s)}SC(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)EC(s),s=s.sibling}function EC(s){switch(s.tag){case 0:case 11:case 15:Vd(s),s.flags&2048&&ia(9,s,s.return);break;case 3:Vd(s);break;case 12:Vd(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,rg(s)):Vd(s);break;default:Vd(s)}}function rg(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var m=a[l];Je=m,CC(m,s)}SC(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:ia(8,a,a.return),rg(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,rg(a));break;default:rg(a)}s=s.sibling}}function CC(s,a){for(;Je!==null;){var l=Je;switch(l.tag){case 0:case 11:case 15:ia(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var m=l.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Cd(l.memoizedState.cache)}if(m=l.child,m!==null)m.return=l,Je=m;else t:for(l=s;Je!==null;){m=Je;var v=m.sibling,T=m.return;if(pC(m),m===l){Je=null;break t}if(v!==null){v.return=T,Je=v;break t}Je=T}}}var F1={getCacheForType:function(s){var a=yn(Be),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l}},O1=typeof WeakMap=="function"?WeakMap:Map,Qt=0,ue=null,Ot=null,zt=0,Zt=0,si=null,aa=!1,Eu=!1,Uv=!1,io=0,Ce=0,ra=0,xr=0,Fv=0,ki=0,Cu=0,Hd=null,Xn=null,Ov=!1,Bv=0,lg=1/0,ug=null,la=null,on=0,ua=null,bu=null,xu=0,Gv=0,Vv=null,bC=null,zd=0,Hv=null;function oi(){if((Qt&2)!==0&&zt!==0)return zt&-zt;if(G.T!==null){var s=fu;return s!==0?s:Kv()}return GT()}function xC(){ki===0&&(ki=(zt&536870912)===0||Jt?UT():536870912);var s=Li.current;return s!==null&&(s.flags|=32),ki}function ai(s,a,l){(s===ue&&(Zt===2||Zt===9)||s.cancelPendingCommit!==null)&&(_u(s,0),ca(s,zt,ki,!1)),rd(s,l),((Qt&2)===0||s!==ue)&&(s===ue&&((Qt&2)===0&&(xr|=l),Ce===4&&ca(s,zt,ki,!1)),vs(s))}function _C(s,a,l){if((Qt&6)!==0)throw Error(n(327));var m=!l&&(a&124)===0&&(a&s.expiredLanes)===0||ad(s,a),v=m?V1(s,a):$v(s,a,!0),T=m;do{if(v===0){Eu&&!m&&ca(s,a,0,!1);break}else{if(l=s.current.alternate,T&&!B1(l)){v=$v(s,a,!1),T=!1;continue}if(v===2){if(T=a,s.errorRecoveryDisabledLanes&T)var _=0;else _=s.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){a=_;t:{var I=s;v=Hd;var O=I.current.memoizedState.isDehydrated;if(O&&(_u(I,_).flags|=256),_=$v(I,_,!1),_!==2){if(Uv&&!O){I.errorRecoveryDisabledLanes|=T,xr|=T,v=4;break t}T=Xn,Xn=v,T!==null&&(Xn===null?Xn=T:Xn.push.apply(Xn,T))}v=_}if(T=!1,v!==2)continue}}if(v===1){_u(s,0),ca(s,a,0,!0);break}t:{switch(m=s,T=v,T){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:ca(m,a,ki,!aa);break t;case 2:Xn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(v=Bv+300-Oe(),10<v)){if(ca(m,a,ki,!aa),Tp(m,0,!0)!==0)break t;m.timeoutHandle=eb(wC.bind(null,m,l,Xn,ug,Ov,a,ki,xr,Cu,aa,T,2,-0,0),v);break t}wC(m,l,Xn,ug,Ov,a,ki,xr,Cu,aa,T,0,-0,0)}}break}while(!0);vs(s)}function wC(s,a,l,m,v,T,_,I,O,J,tt,nt,K,W){if(s.timeoutHandle=-1,nt=a.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(Wd={stylesheets:null,count:0,unsuspend:TN},TC(a),nt=EN(),nt!==null)){s.cancelPendingCommit=nt(LC.bind(null,s,a,T,l,m,v,_,I,O,tt,1,K,W)),ca(s,T,_,!J);return}LC(s,a,T,l,m,v,_,I,O)}function B1(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var m=0;m<l.length;m++){var v=l[m],T=v.getSnapshot;v=v.value;try{if(!ti(T(),v))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ca(s,a,l,m){a&=~Fv,a&=~xr,s.suspendedLanes|=a,s.pingedLanes&=~a,m&&(s.warmLanes|=a),m=s.expirationTimes;for(var v=a;0<v;){var T=31-wn(v),_=1<<T;m[T]=-1,v&=~_}l!==0&&OT(s,l,a)}function cg(){return(Qt&6)===0?(qd(0),!1):!0}function zv(){if(Ot!==null){if(Zt===0)var s=Ot.return;else s=Ot,Ks=Ar=null,av(s),vu=null,Ld=0,s=Ot;for(;s!==null;)aC(s.alternate,s),s=s.return;Ot=null}}function _u(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,iN(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),zv(),ue=s,Ot=l=Ys(s.current,null),zt=a,Zt=0,si=null,aa=!1,Eu=ad(s,a),Uv=!1,Cu=ki=Fv=xr=ra=Ce=0,Xn=Hd=null,Ov=!1,(a&8)!==0&&(a|=a&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=a;0<m;){var v=31-wn(m),T=1<<v;a|=s[v],m&=~T}return io=a,Ip(),l}function MC(s,a){Lt=null,G.H=Qp,a===xd||a===Vp?(a=$S(),Zt=3):a===HS?(a=$S(),Zt=4):Zt=a===YE?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,si=a,Ot===null&&(Ce=1,ng(s,Ni(a,s.current)))}function RC(){var s=G.H;return G.H=Qp,s===null?Qp:s}function NC(){var s=G.A;return G.A=F1,s}function qv(){Ce=4,aa||(zt&4194048)!==zt&&Li.current!==null||(Eu=!0),(ra&134217727)===0&&(xr&134217727)===0||ue===null||ca(ue,zt,ki,!1)}function $v(s,a,l){var m=Qt;Qt|=2;var v=RC(),T=NC();(ue!==s||zt!==a)&&(ug=null,_u(s,a)),a=!1;var _=Ce;t:do try{if(Zt!==0&&Ot!==null){var I=Ot,O=si;switch(Zt){case 8:zv(),_=6;break t;case 3:case 2:case 9:case 6:Li.current===null&&(a=!0);var J=Zt;if(Zt=0,si=null,wu(s,I,O,J),l&&Eu){_=0;break t}break;default:J=Zt,Zt=0,si=null,wu(s,I,O,J)}}G1(),_=Ce;break}catch(tt){MC(s,tt)}while(!0);return a&&s.shellSuspendCounter++,Ks=Ar=null,Qt=m,G.H=v,G.A=T,Ot===null&&(ue=null,zt=0,Ip()),_}function G1(){for(;Ot!==null;)DC(Ot)}function V1(s,a){var l=Qt;Qt|=2;var m=RC(),v=NC();ue!==s||zt!==a?(ug=null,lg=Oe()+500,_u(s,a)):Eu=ad(s,a);t:do try{if(Zt!==0&&Ot!==null){a=Ot;var T=si;e:switch(Zt){case 1:Zt=0,si=null,wu(s,a,T,1);break;case 2:case 9:if(zS(T)){Zt=0,si=null,IC(a);break}a=function(){Zt!==2&&Zt!==9||ue!==s||(Zt=7),vs(s)},T.then(a,a);break t;case 3:Zt=7;break t;case 4:Zt=5;break t;case 7:zS(T)?(Zt=0,si=null,IC(a)):(Zt=0,si=null,wu(s,a,T,7));break;case 5:var _=null;switch(Ot.tag){case 26:_=Ot.memoizedState;case 5:case 27:var I=Ot;if(!_||hb(_)){Zt=0,si=null;var O=I.sibling;if(O!==null)Ot=O;else{var J=I.return;J!==null?(Ot=J,dg(J)):Ot=null}break e}}Zt=0,si=null,wu(s,a,T,5);break;case 6:Zt=0,si=null,wu(s,a,T,6);break;case 8:zv(),Ce=6;break t;default:throw Error(n(462))}}H1();break}catch(tt){MC(s,tt)}while(!0);return Ks=Ar=null,G.H=m,G.A=v,Qt=l,Ot!==null?0:(ue=null,zt=0,Ip(),Ce)}function H1(){for(;Ot!==null&&!xn();)DC(Ot)}function DC(s){var a=sC(s.alternate,s,io);s.memoizedProps=s.pendingProps,a===null?dg(s):Ot=a}function IC(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=ZE(l,a,a.pendingProps,a.type,void 0,zt);break;case 11:a=ZE(l,a,a.pendingProps,a.type.render,a.ref,zt);break;case 5:av(a);default:aC(l,a),a=Ot=PS(a,io),a=sC(l,a,io)}s.memoizedProps=s.pendingProps,a===null?dg(s):Ot=a}function wu(s,a,l,m){Ks=Ar=null,av(a),vu=null,Ld=0;var v=a.return;try{if(D1(s,v,a,l,zt)){Ce=1,ng(s,Ni(l,s.current)),Ot=null;return}}catch(T){if(v!==null)throw Ot=v,T;Ce=1,ng(s,Ni(l,s.current)),Ot=null;return}a.flags&32768?(Jt||m===1?s=!0:Eu||(zt&536870912)!==0?s=!1:(aa=s=!0,(m===2||m===9||m===3||m===6)&&(m=Li.current,m!==null&&m.tag===13&&(m.flags|=16384))),PC(a,s)):dg(a)}function dg(s){var a=s;do{if((a.flags&32768)!==0){PC(a,aa);return}s=a.return;var l=P1(a.alternate,a,io);if(l!==null){Ot=l;return}if(a=a.sibling,a!==null){Ot=a;return}Ot=a=s}while(a!==null);Ce===0&&(Ce=5)}function PC(s,a){do{var l=L1(s.alternate,s);if(l!==null){l.flags&=32767,Ot=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){Ot=s;return}Ot=s=l}while(s!==null);Ce=6,Ot=null}function LC(s,a,l,m,v,T,_,I,O){s.cancelPendingCommit=null;do fg();while(on!==0);if((Qt&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(T=a.lanes|a.childLanes,T|=ky,TR(s,l,T,_,I,O),s===ue&&(Ot=ue=null,zt=0),bu=a,ua=s,xu=l,Gv=T,Vv=v,bC=m,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Y1(lr,function(){return BC(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||m){m=G.T,G.T=null,v=$.p,$.p=2,_=Qt,Qt|=4;try{k1(s,a,l)}finally{Qt=_,$.p=v,G.T=m}}on=1,kC(),UC(),FC()}}function kC(){if(on===1){on=0;var s=ua,a=bu,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=G.T,G.T=null;var m=$.p;$.p=2;var v=Qt;Qt|=4;try{yC(a,s);var T=i0,_=CS(s.containerInfo),I=T.focusedElem,O=T.selectionRange;if(_!==I&&I&&I.ownerDocument&&ES(I.ownerDocument.documentElement,I)){if(O!==null&&Ny(I)){var J=O.start,tt=O.end;if(tt===void 0&&(tt=J),"selectionStart"in I)I.selectionStart=J,I.selectionEnd=Math.min(tt,I.value.length);else{var nt=I.ownerDocument||document,K=nt&&nt.defaultView||window;if(K.getSelection){var W=K.getSelection(),wt=I.textContent.length,bt=Math.min(O.start,wt),ie=O.end===void 0?bt:Math.min(O.end,wt);!W.extend&&bt>ie&&(_=ie,ie=bt,bt=_);var z=SS(I,bt),H=SS(I,ie);if(z&&H&&(W.rangeCount!==1||W.anchorNode!==z.node||W.anchorOffset!==z.offset||W.focusNode!==H.node||W.focusOffset!==H.offset)){var X=nt.createRange();X.setStart(z.node,z.offset),W.removeAllRanges(),bt>ie?(W.addRange(X),W.extend(H.node,H.offset)):(X.setEnd(H.node,H.offset),W.addRange(X))}}}}for(nt=[],W=I;W=W.parentNode;)W.nodeType===1&&nt.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<nt.length;I++){var et=nt[I];et.element.scrollLeft=et.left,et.element.scrollTop=et.top}}bg=!!n0,i0=n0=null}finally{Qt=v,$.p=m,G.T=l}}s.current=a,on=2}}function UC(){if(on===2){on=0;var s=ua,a=bu,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=G.T,G.T=null;var m=$.p;$.p=2;var v=Qt;Qt|=4;try{hC(s,a.alternate,a)}finally{Qt=v,$.p=m,G.T=l}}on=3}}function FC(){if(on===4||on===3){on=0,Xl();var s=ua,a=bu,l=xu,m=bC;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?on=5:(on=0,bu=ua=null,OC(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(la=null),uy(l),a=a.stateNode,_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(Xo,a,void 0,(a.current.flags&128)===128)}catch{}if(m!==null){a=G.T,v=$.p,$.p=2,G.T=null;try{for(var T=s.onRecoverableError,_=0;_<m.length;_++){var I=m[_];T(I.value,{componentStack:I.stack})}}finally{G.T=a,$.p=v}}(xu&3)!==0&&fg(),vs(s),v=s.pendingLanes,(l&4194090)!==0&&(v&42)!==0?s===Hv?zd++:(zd=0,Hv=s):zd=0,qd(0)}}function OC(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Cd(a)))}function fg(s){return kC(),UC(),FC(),BC()}function BC(){if(on!==5)return!1;var s=ua,a=Gv;Gv=0;var l=uy(xu),m=G.T,v=$.p;try{$.p=32>l?32:l,G.T=null,l=Vv,Vv=null;var T=ua,_=xu;if(on=0,bu=ua=null,xu=0,(Qt&6)!==0)throw Error(n(331));var I=Qt;if(Qt|=4,EC(T.current),AC(T,T.current,_,l),Qt=I,qd(0,!1),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(Xo,T)}catch{}return!0}finally{$.p=v,G.T=m,OC(s,a)}}function GC(s,a,l){a=Ni(l,a),a=Tv(s.stateNode,a,2),s=jo(s,a,2),s!==null&&(rd(s,2),vs(s))}function le(s,a,l){if(s.tag===3)GC(s,s,l);else for(;a!==null;){if(a.tag===3){GC(a,s,l);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(la===null||!la.has(m))){s=Ni(l,s),l=qE(2),m=jo(a,l,2),m!==null&&($E(l,m,a,s),rd(m,2),vs(m));break}}a=a.return}}function Yv(s,a,l){var m=s.pingCache;if(m===null){m=s.pingCache=new O1;var v=new Set;m.set(a,v)}else v=m.get(a),v===void 0&&(v=new Set,m.set(a,v));v.has(l)||(Uv=!0,v.add(l),s=z1.bind(null,s,a,l),a.then(s,s))}function z1(s,a,l){var m=s.pingCache;m!==null&&m.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,ue===s&&(zt&l)===l&&(Ce===4||Ce===3&&(zt&62914560)===zt&&300>Oe()-Bv?(Qt&2)===0&&_u(s,0):Fv|=l,Cu===zt&&(Cu=0)),vs(s)}function VC(s,a){a===0&&(a=FT()),s=lu(s,a),s!==null&&(rd(s,a),vs(s))}function q1(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),VC(s,l)}function $1(s,a){var l=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(l=v.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(a),VC(s,l)}function Y1(s,a){return Ht(s,a)}var hg=null,Mu=null,Xv=!1,pg=!1,Jv=!1,_r=0;function vs(s){s!==Mu&&s.next===null&&(Mu===null?hg=Mu=s:Mu=Mu.next=s),pg=!0,Xv||(Xv=!0,J1())}function qd(s,a){if(!Jv&&pg){Jv=!0;do for(var l=!1,m=hg;m!==null;){if(s!==0){var v=m.pendingLanes;if(v===0)var T=0;else{var _=m.suspendedLanes,I=m.pingedLanes;T=(1<<31-wn(42|s)+1)-1,T&=v&~(_&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(l=!0,$C(m,T))}else T=zt,T=Tp(m,m===ue?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(T&3)===0||ad(m,T)||(l=!0,$C(m,T));m=m.next}while(l);Jv=!1}}function X1(){HC()}function HC(){pg=Xv=!1;var s=0;_r!==0&&(nN()&&(s=_r),_r=0);for(var a=Oe(),l=null,m=hg;m!==null;){var v=m.next,T=zC(m,a);T===0?(m.next=null,l===null?hg=v:l.next=v,v===null&&(Mu=l)):(l=m,(s!==0||(T&3)!==0)&&(pg=!0)),m=v}qd(s)}function zC(s,a){for(var l=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var _=31-wn(T),I=1<<_,O=v[_];O===-1?((I&l)===0||(I&m)!==0)&&(v[_]=AR(I,a)):O<=a&&(s.expiredLanes|=I),T&=~I}if(a=ue,l=zt,l=Tp(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,l===0||s===a&&(Zt===2||Zt===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&Hn(m),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||ad(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(m!==null&&Hn(m),uy(l)){case 2:case 8:l=pp;break;case 32:l=lr;break;case 268435456:l=od;break;default:l=lr}return m=qC.bind(null,s),l=Ht(l,m),s.callbackPriority=a,s.callbackNode=l,a}return m!==null&&m!==null&&Hn(m),s.callbackPriority=2,s.callbackNode=null,2}function qC(s,a){if(on!==0&&on!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(fg()&&s.callbackNode!==l)return null;var m=zt;return m=Tp(s,s===ue?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(_C(s,m,a),zC(s,Oe()),s.callbackNode!=null&&s.callbackNode===l?qC.bind(null,s):null)}function $C(s,a){if(fg())return null;_C(s,a,!0)}function J1(){sN(function(){(Qt&6)!==0?Ht(sd,X1):HC()})}function Kv(){return _r===0&&(_r=UT()),_r}function YC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:xp(""+s)}function XC(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function K1(s,a,l,m,v){if(a==="submit"&&l&&l.stateNode===v){var T=YC((v[zn]||null).action),_=m.submitter;_&&(a=(a=_[zn]||null)?YC(a.formAction):_.getAttribute("formAction"),a!==null&&(T=a,_=null));var I=new Rp("action","action",null,m,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(_r!==0){var O=_?XC(v,_):new FormData(v);gv(l,{pending:!0,data:O,method:v.method,action:T},null,O)}}else typeof T=="function"&&(I.preventDefault(),O=_?XC(v,_):new FormData(v),gv(l,{pending:!0,data:O,method:v.method,action:T},T,O))},currentTarget:v}]})}}for(var Wv=0;Wv<Ly.length;Wv++){var Qv=Ly[Wv],W1=Qv.toLowerCase(),Q1=Qv[0].toUpperCase()+Qv.slice(1);Ki(W1,"on"+Q1)}Ki(_S,"onAnimationEnd"),Ki(wS,"onAnimationIteration"),Ki(MS,"onAnimationStart"),Ki("dblclick","onDoubleClick"),Ki("focusin","onFocus"),Ki("focusout","onBlur"),Ki(p1,"onTransitionRun"),Ki(g1,"onTransitionStart"),Ki(m1,"onTransitionCancel"),Ki(RS,"onTransitionEnd"),Zl("onMouseEnter",["mouseout","mouseover"]),Zl("onMouseLeave",["mouseout","mouseover"]),Zl("onPointerEnter",["pointerout","pointerover"]),Zl("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $d="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($d));function JC(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var m=s[l],v=m.event;m=m.listeners;t:{var T=void 0;if(a)for(var _=m.length-1;0<=_;_--){var I=m[_],O=I.instance,J=I.currentTarget;if(I=I.listener,O!==T&&v.isPropagationStopped())break t;T=I,v.currentTarget=J;try{T(v)}catch(tt){eg(tt)}v.currentTarget=null,T=O}else for(_=0;_<m.length;_++){if(I=m[_],O=I.instance,J=I.currentTarget,I=I.listener,O!==T&&v.isPropagationStopped())break t;T=I,v.currentTarget=J;try{T(v)}catch(tt){eg(tt)}v.currentTarget=null,T=O}}}}function Bt(s,a){var l=a[cy];l===void 0&&(l=a[cy]=new Set);var m=s+"__bubble";l.has(m)||(KC(a,s,2,!1),l.add(m))}function Zv(s,a,l){var m=0;a&&(m|=4),KC(l,s,m,a)}var gg="_reactListening"+Math.random().toString(36).slice(2);function jv(s){if(!s[gg]){s[gg]=!0,HT.forEach(function(l){l!=="selectionchange"&&(Z1.has(l)||Zv(l,!1,s),Zv(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[gg]||(a[gg]=!0,Zv("selectionchange",!1,a))}}function KC(s,a,l,m){switch(Ab(a)){case 2:var v=xN;break;case 8:v=_N;break;default:v=h0}l=v.bind(null,a,l,s),v=void 0,!Sy||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(a,l,{capture:!0,passive:v}):s.addEventListener(a,l,!0):v!==void 0?s.addEventListener(a,l,{passive:v}):s.addEventListener(a,l,!1)}function t0(s,a,l,m,v){var T=m;if((a&1)===0&&(a&2)===0&&m!==null)t:for(;;){if(m===null)return;var _=m.tag;if(_===3||_===4){var I=m.stateNode.containerInfo;if(I===v)break;if(_===4)for(_=m.return;_!==null;){var O=_.tag;if((O===3||O===4)&&_.stateNode.containerInfo===v)return;_=_.return}for(;I!==null;){if(_=Kl(I),_===null)return;if(O=_.tag,O===5||O===6||O===26||O===27){m=T=_;continue t}I=I.parentNode}}m=m.return}nS(function(){var J=T,tt=Ay(l),nt=[];t:{var K=NS.get(s);if(K!==void 0){var W=Rp,wt=s;switch(s){case"keypress":if(wp(l)===0)break t;case"keydown":case"keyup":W=YR;break;case"focusin":wt="focus",W=xy;break;case"focusout":wt="blur",W=xy;break;case"beforeblur":case"afterblur":W=xy;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=oS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=LR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=KR;break;case _S:case wS:case MS:W=FR;break;case RS:W=QR;break;case"scroll":case"scrollend":W=IR;break;case"wheel":W=jR;break;case"copy":case"cut":case"paste":W=BR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=rS;break;case"toggle":case"beforetoggle":W=e1}var bt=(a&4)!==0,ie=!bt&&(s==="scroll"||s==="scrollend"),z=bt?K!==null?K+"Capture":null:K;bt=[];for(var H=J,X;H!==null;){var et=H;if(X=et.stateNode,et=et.tag,et!==5&&et!==26&&et!==27||X===null||z===null||(et=cd(H,z),et!=null&&bt.push(Yd(H,et,X))),ie)break;H=H.return}0<bt.length&&(K=new W(K,wt,null,l,tt),nt.push({event:K,listeners:bt}))}}if((a&7)===0){t:{if(K=s==="mouseover"||s==="pointerover",W=s==="mouseout"||s==="pointerout",K&&l!==vy&&(wt=l.relatedTarget||l.fromElement)&&(Kl(wt)||wt[Jl]))break t;if((W||K)&&(K=tt.window===tt?tt:(K=tt.ownerDocument)?K.defaultView||K.parentWindow:window,W?(wt=l.relatedTarget||l.toElement,W=J,wt=wt?Kl(wt):null,wt!==null&&(ie=r(wt),bt=wt.tag,wt!==ie||bt!==5&&bt!==27&&bt!==6)&&(wt=null)):(W=null,wt=J),W!==wt)){if(bt=oS,et="onMouseLeave",z="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(bt=rS,et="onPointerLeave",z="onPointerEnter",H="pointer"),ie=W==null?K:ud(W),X=wt==null?K:ud(wt),K=new bt(et,H+"leave",W,l,tt),K.target=ie,K.relatedTarget=X,et=null,Kl(tt)===J&&(bt=new bt(z,H+"enter",wt,l,tt),bt.target=X,bt.relatedTarget=ie,et=bt),ie=et,W&&wt)e:{for(bt=W,z=wt,H=0,X=bt;X;X=Ru(X))H++;for(X=0,et=z;et;et=Ru(et))X++;for(;0<H-X;)bt=Ru(bt),H--;for(;0<X-H;)z=Ru(z),X--;for(;H--;){if(bt===z||z!==null&&bt===z.alternate)break e;bt=Ru(bt),z=Ru(z)}bt=null}else bt=null;W!==null&&WC(nt,K,W,bt,!1),wt!==null&&ie!==null&&WC(nt,ie,wt,bt,!0)}}t:{if(K=J?ud(J):window,W=K.nodeName&&K.nodeName.toLowerCase(),W==="select"||W==="input"&&K.type==="file")var pt=gS;else if(hS(K))if(mS)pt=d1;else{pt=u1;var Ut=l1}else W=K.nodeName,!W||W.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?J&&yy(J.elementType)&&(pt=gS):pt=c1;if(pt&&(pt=pt(s,J))){pS(nt,pt,l,tt);break t}Ut&&Ut(s,K,J),s==="focusout"&&J&&K.type==="number"&&J.memoizedProps.value!=null&&my(K,"number",K.value)}switch(Ut=J?ud(J):window,s){case"focusin":(hS(Ut)||Ut.contentEditable==="true")&&(ou=Ut,Dy=J,vd=null);break;case"focusout":vd=Dy=ou=null;break;case"mousedown":Iy=!0;break;case"contextmenu":case"mouseup":case"dragend":Iy=!1,bS(nt,l,tt);break;case"selectionchange":if(h1)break;case"keydown":case"keyup":bS(nt,l,tt)}var Tt;if(wy)t:{switch(s){case"compositionstart":var _t="onCompositionStart";break t;case"compositionend":_t="onCompositionEnd";break t;case"compositionupdate":_t="onCompositionUpdate";break t}_t=void 0}else su?dS(s,l)&&(_t="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(_t="onCompositionStart");_t&&(lS&&l.locale!=="ko"&&(su||_t!=="onCompositionStart"?_t==="onCompositionEnd"&&su&&(Tt=iS()):(Ko=tt,Ey="value"in Ko?Ko.value:Ko.textContent,su=!0)),Ut=mg(J,_t),0<Ut.length&&(_t=new aS(_t,s,null,l,tt),nt.push({event:_t,listeners:Ut}),Tt?_t.data=Tt:(Tt=fS(l),Tt!==null&&(_t.data=Tt)))),(Tt=i1?s1(s,l):o1(s,l))&&(_t=mg(J,"onBeforeInput"),0<_t.length&&(Ut=new aS("onBeforeInput","beforeinput",null,l,tt),nt.push({event:Ut,listeners:_t}),Ut.data=Tt)),K1(nt,s,J,l,tt)}JC(nt,a)})}function Yd(s,a,l){return{instance:s,listener:a,currentTarget:l}}function mg(s,a){for(var l=a+"Capture",m=[];s!==null;){var v=s,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=cd(s,l),v!=null&&m.unshift(Yd(s,v,T)),v=cd(s,a),v!=null&&m.push(Yd(s,v,T))),s.tag===3)return m;s=s.return}return[]}function Ru(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function WC(s,a,l,m,v){for(var T=a._reactName,_=[];l!==null&&l!==m;){var I=l,O=I.alternate,J=I.stateNode;if(I=I.tag,O!==null&&O===m)break;I!==5&&I!==26&&I!==27||J===null||(O=J,v?(J=cd(l,T),J!=null&&_.unshift(Yd(l,J,O))):v||(J=cd(l,T),J!=null&&_.push(Yd(l,J,O)))),l=l.return}_.length!==0&&s.push({event:a,listeners:_})}var j1=/\r\n?/g,tN=/\u0000|\uFFFD/g;function QC(s){return(typeof s=="string"?s:""+s).replace(j1,`
`).replace(tN,"")}function ZC(s,a){return a=QC(a),QC(s)===a}function yg(){}function ne(s,a,l,m,v,T){switch(l){case"children":typeof m=="string"?a==="body"||a==="textarea"&&m===""||eu(s,m):(typeof m=="number"||typeof m=="bigint")&&a!=="body"&&eu(s,""+m);break;case"className":Ep(s,"class",m);break;case"tabIndex":Ep(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Ep(s,l,m);break;case"style":tS(s,m,T);break;case"data":if(a!=="object"){Ep(s,"data",m);break}case"src":case"href":if(m===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(l);break}m=xp(""+m),s.setAttribute(l,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(l==="formAction"?(a!=="input"&&ne(s,a,"name",v.name,v,null),ne(s,a,"formEncType",v.formEncType,v,null),ne(s,a,"formMethod",v.formMethod,v,null),ne(s,a,"formTarget",v.formTarget,v,null)):(ne(s,a,"encType",v.encType,v,null),ne(s,a,"method",v.method,v,null),ne(s,a,"target",v.target,v,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(l);break}m=xp(""+m),s.setAttribute(l,m);break;case"onClick":m!=null&&(s.onclick=yg);break;case"onScroll":m!=null&&Bt("scroll",s);break;case"onScrollEnd":m!=null&&Bt("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(l=m.__html,l!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}l=xp(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,""+m):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":m===!0?s.setAttribute(l,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,m):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(l,m):s.removeAttribute(l);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(l):s.setAttribute(l,m);break;case"popover":Bt("beforetoggle",s),Bt("toggle",s),Sp(s,"popover",m);break;case"xlinkActuate":qs(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":qs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":qs(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":qs(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":qs(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":qs(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":qs(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":qs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":qs(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Sp(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=NR.get(l)||l,Sp(s,l,m))}}function e0(s,a,l,m,v,T){switch(l){case"style":tS(s,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(l=m.__html,l!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"children":typeof m=="string"?eu(s,m):(typeof m=="number"||typeof m=="bigint")&&eu(s,""+m);break;case"onScroll":m!=null&&Bt("scroll",s);break;case"onScrollEnd":m!=null&&Bt("scrollend",s);break;case"onClick":m!=null&&(s.onclick=yg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zT.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(v=l.endsWith("Capture"),a=l.slice(2,v?l.length-7:void 0),T=s[zn]||null,T=T!=null?T[l]:null,typeof T=="function"&&s.removeEventListener(a,T,v),typeof m=="function")){typeof T!="function"&&T!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,m,v);break t}l in s?s[l]=m:m===!0?s.setAttribute(l,""):Sp(s,l,m)}}}function an(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",s),Bt("load",s);var m=!1,v=!1,T;for(T in l)if(l.hasOwnProperty(T)){var _=l[T];if(_!=null)switch(T){case"src":m=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ne(s,a,T,_,l,null)}}v&&ne(s,a,"srcSet",l.srcSet,l,null),m&&ne(s,a,"src",l.src,l,null);return;case"input":Bt("invalid",s);var I=T=_=v=null,O=null,J=null;for(m in l)if(l.hasOwnProperty(m)){var tt=l[m];if(tt!=null)switch(m){case"name":v=tt;break;case"type":_=tt;break;case"checked":O=tt;break;case"defaultChecked":J=tt;break;case"value":T=tt;break;case"defaultValue":I=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,a));break;default:ne(s,a,m,tt,l,null)}}WT(s,T,I,O,J,_,v,!1),Cp(s);return;case"select":Bt("invalid",s),m=_=T=null;for(v in l)if(l.hasOwnProperty(v)&&(I=l[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":_=I;break;case"multiple":m=I;default:ne(s,a,v,I,l,null)}a=T,l=_,s.multiple=!!m,a!=null?tu(s,!!m,a,!1):l!=null&&tu(s,!!m,l,!0);return;case"textarea":Bt("invalid",s),T=v=m=null;for(_ in l)if(l.hasOwnProperty(_)&&(I=l[_],I!=null))switch(_){case"value":m=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:ne(s,a,_,I,l,null)}ZT(s,m,v,T),Cp(s);return;case"option":for(O in l)if(l.hasOwnProperty(O)&&(m=l[O],m!=null))switch(O){case"selected":s.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ne(s,a,O,m,l,null)}return;case"dialog":Bt("beforetoggle",s),Bt("toggle",s),Bt("cancel",s),Bt("close",s);break;case"iframe":case"object":Bt("load",s);break;case"video":case"audio":for(m=0;m<$d.length;m++)Bt($d[m],s);break;case"image":Bt("error",s),Bt("load",s);break;case"details":Bt("toggle",s);break;case"embed":case"source":case"link":Bt("error",s),Bt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in l)if(l.hasOwnProperty(J)&&(m=l[J],m!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ne(s,a,J,m,l,null)}return;default:if(yy(a)){for(tt in l)l.hasOwnProperty(tt)&&(m=l[tt],m!==void 0&&e0(s,a,tt,m,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(m=l[I],m!=null&&ne(s,a,I,m,l,null))}function eN(s,a,l,m){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,_=null,I=null,O=null,J=null,tt=null;for(W in l){var nt=l[W];if(l.hasOwnProperty(W)&&nt!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":O=nt;default:m.hasOwnProperty(W)||ne(s,a,W,null,m,nt)}}for(var K in m){var W=m[K];if(nt=l[K],m.hasOwnProperty(K)&&(W!=null||nt!=null))switch(K){case"type":T=W;break;case"name":v=W;break;case"checked":J=W;break;case"defaultChecked":tt=W;break;case"value":_=W;break;case"defaultValue":I=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:W!==nt&&ne(s,a,K,W,m,nt)}}gy(s,_,I,O,J,tt,T,v);return;case"select":W=_=I=K=null;for(T in l)if(O=l[T],l.hasOwnProperty(T)&&O!=null)switch(T){case"value":break;case"multiple":W=O;default:m.hasOwnProperty(T)||ne(s,a,T,null,m,O)}for(v in m)if(T=m[v],O=l[v],m.hasOwnProperty(v)&&(T!=null||O!=null))switch(v){case"value":K=T;break;case"defaultValue":I=T;break;case"multiple":_=T;default:T!==O&&ne(s,a,v,T,m,O)}a=I,l=_,m=W,K!=null?tu(s,!!l,K,!1):!!m!=!!l&&(a!=null?tu(s,!!l,a,!0):tu(s,!!l,l?[]:"",!1));return;case"textarea":W=K=null;for(I in l)if(v=l[I],l.hasOwnProperty(I)&&v!=null&&!m.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ne(s,a,I,null,m,v)}for(_ in m)if(v=m[_],T=l[_],m.hasOwnProperty(_)&&(v!=null||T!=null))switch(_){case"value":K=v;break;case"defaultValue":W=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==T&&ne(s,a,_,v,m,T)}QT(s,K,W);return;case"option":for(var wt in l)if(K=l[wt],l.hasOwnProperty(wt)&&K!=null&&!m.hasOwnProperty(wt))switch(wt){case"selected":s.selected=!1;break;default:ne(s,a,wt,null,m,K)}for(O in m)if(K=m[O],W=l[O],m.hasOwnProperty(O)&&K!==W&&(K!=null||W!=null))switch(O){case"selected":s.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:ne(s,a,O,K,m,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in l)K=l[bt],l.hasOwnProperty(bt)&&K!=null&&!m.hasOwnProperty(bt)&&ne(s,a,bt,null,m,K);for(J in m)if(K=m[J],W=l[J],m.hasOwnProperty(J)&&K!==W&&(K!=null||W!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(137,a));break;default:ne(s,a,J,K,m,W)}return;default:if(yy(a)){for(var ie in l)K=l[ie],l.hasOwnProperty(ie)&&K!==void 0&&!m.hasOwnProperty(ie)&&e0(s,a,ie,void 0,m,K);for(tt in m)K=m[tt],W=l[tt],!m.hasOwnProperty(tt)||K===W||K===void 0&&W===void 0||e0(s,a,tt,K,m,W);return}}for(var z in l)K=l[z],l.hasOwnProperty(z)&&K!=null&&!m.hasOwnProperty(z)&&ne(s,a,z,null,m,K);for(nt in m)K=m[nt],W=l[nt],!m.hasOwnProperty(nt)||K===W||K==null&&W==null||ne(s,a,nt,K,m,W)}var n0=null,i0=null;function vg(s){return s.nodeType===9?s:s.ownerDocument}function jC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tb(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function s0(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var o0=null;function nN(){var s=window.event;return s&&s.type==="popstate"?s===o0?!1:(o0=s,!0):(o0=null,!1)}var eb=typeof setTimeout=="function"?setTimeout:void 0,iN=typeof clearTimeout=="function"?clearTimeout:void 0,nb=typeof Promise=="function"?Promise:void 0,sN=typeof queueMicrotask=="function"?queueMicrotask:typeof nb<"u"?function(s){return nb.resolve(null).then(s).catch(oN)}:eb;function oN(s){setTimeout(function(){throw s})}function da(s){return s==="head"}function ib(s,a){var l=a,m=0,v=0;do{var T=l.nextSibling;if(s.removeChild(l),T&&T.nodeType===8)if(l=T.data,l==="/$"){if(0<m&&8>m){l=m;var _=s.ownerDocument;if(l&1&&Xd(_.documentElement),l&2&&Xd(_.body),l&4)for(l=_.head,Xd(l),_=l.firstChild;_;){var I=_.nextSibling,O=_.nodeName;_[ld]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&_.rel.toLowerCase()==="stylesheet"||l.removeChild(_),_=I}}if(v===0){s.removeChild(T),ef(a);return}v--}else l==="$"||l==="$?"||l==="$!"?v++:m=l.charCodeAt(0)-48;else m=0;l=T}while(l);ef(a)}function a0(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":a0(l),dy(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function aN(s,a,l,m){for(;s.nodeType===1;){var v=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[ld])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=Qi(s.nextSibling),s===null)break}return null}function rN(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Qi(s.nextSibling),s===null))return null;return s}function r0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function lN(s,a){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")a();else{var m=function(){a(),l.removeEventListener("DOMContentLoaded",m)};l.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function Qi(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return s}var l0=null;function sb(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return s;a--}else l==="/$"&&a++}s=s.previousSibling}return null}function ob(s,a,l){switch(a=vg(l),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Xd(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);dy(s)}var Ui=new Map,ab=new Set;function Ag(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var so=$.d;$.d={f:uN,r:cN,D:dN,C:fN,L:hN,m:pN,X:mN,S:gN,M:yN};function uN(){var s=so.f(),a=cg();return s||a}function cN(s){var a=Wl(s);a!==null&&a.tag===5&&a.type==="form"?_E(a):so.r(s)}var Nu=typeof document>"u"?null:document;function rb(s,a,l){var m=Nu;if(m&&typeof a=="string"&&a){var v=Ri(a);v='link[rel="'+s+'"][href="'+v+'"]',typeof l=="string"&&(v+='[crossorigin="'+l+'"]'),ab.has(v)||(ab.add(v),s={rel:s,crossOrigin:l,href:a},m.querySelector(v)===null&&(a=m.createElement("link"),an(a,"link",s),Ye(a),m.head.appendChild(a)))}}function dN(s){so.D(s),rb("dns-prefetch",s,null)}function fN(s,a){so.C(s,a),rb("preconnect",s,a)}function hN(s,a,l){so.L(s,a,l);var m=Nu;if(m&&s&&a){var v='link[rel="preload"][as="'+Ri(a)+'"]';a==="image"&&l&&l.imageSrcSet?(v+='[imagesrcset="'+Ri(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(v+='[imagesizes="'+Ri(l.imageSizes)+'"]')):v+='[href="'+Ri(s)+'"]';var T=v;switch(a){case"style":T=Du(s);break;case"script":T=Iu(s)}Ui.has(T)||(s=y({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),Ui.set(T,s),m.querySelector(v)!==null||a==="style"&&m.querySelector(Jd(T))||a==="script"&&m.querySelector(Kd(T))||(a=m.createElement("link"),an(a,"link",s),Ye(a),m.head.appendChild(a)))}}function pN(s,a){so.m(s,a);var l=Nu;if(l&&s){var m=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+Ri(m)+'"][href="'+Ri(s)+'"]',T=v;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Iu(s)}if(!Ui.has(T)&&(s=y({rel:"modulepreload",href:s},a),Ui.set(T,s),l.querySelector(v)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Kd(T)))return}m=l.createElement("link"),an(m,"link",s),Ye(m),l.head.appendChild(m)}}}function gN(s,a,l){so.S(s,a,l);var m=Nu;if(m&&s){var v=Ql(m).hoistableStyles,T=Du(s);a=a||"default";var _=v.get(T);if(!_){var I={loading:0,preload:null};if(_=m.querySelector(Jd(T)))I.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":a},l),(l=Ui.get(T))&&u0(s,l);var O=_=m.createElement("link");Ye(O),an(O,"link",s),O._p=new Promise(function(J,tt){O.onload=J,O.onerror=tt}),O.addEventListener("load",function(){I.loading|=1}),O.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Tg(_,a,m)}_={type:"stylesheet",instance:_,count:1,state:I},v.set(T,_)}}}function mN(s,a){so.X(s,a);var l=Nu;if(l&&s){var m=Ql(l).hoistableScripts,v=Iu(s),T=m.get(v);T||(T=l.querySelector(Kd(v)),T||(s=y({src:s,async:!0},a),(a=Ui.get(v))&&c0(s,a),T=l.createElement("script"),Ye(T),an(T,"link",s),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(v,T))}}function yN(s,a){so.M(s,a);var l=Nu;if(l&&s){var m=Ql(l).hoistableScripts,v=Iu(s),T=m.get(v);T||(T=l.querySelector(Kd(v)),T||(s=y({src:s,async:!0,type:"module"},a),(a=Ui.get(v))&&c0(s,a),T=l.createElement("script"),Ye(T),an(T,"link",s),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(v,T))}}function lb(s,a,l,m){var v=(v=Et.current)?Ag(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Du(l.href),l=Ql(v).hoistableStyles,m=l.get(a),m||(m={type:"style",instance:null,count:0,state:null},l.set(a,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Du(l.href);var T=Ql(v).hoistableStyles,_=T.get(s);if(_||(v=v.ownerDocument||v,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,_),(T=v.querySelector(Jd(s)))&&!T._p&&(_.instance=T,_.state.loading=5),Ui.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ui.set(s,l),T||vN(v,s,l,_.state))),a&&m===null)throw Error(n(528,""));return _}if(a&&m!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Iu(l),l=Ql(v).hoistableScripts,m=l.get(a),m||(m={type:"script",instance:null,count:0,state:null},l.set(a,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Du(s){return'href="'+Ri(s)+'"'}function Jd(s){return'link[rel="stylesheet"]['+s+"]"}function ub(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function vN(s,a,l,m){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?m.loading=1:(a=s.createElement("link"),m.preload=a,a.addEventListener("load",function(){return m.loading|=1}),a.addEventListener("error",function(){return m.loading|=2}),an(a,"link",l),Ye(a),s.head.appendChild(a))}function Iu(s){return'[src="'+Ri(s)+'"]'}function Kd(s){return"script[async]"+s}function cb(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var m=s.querySelector('style[data-href~="'+Ri(l.href)+'"]');if(m)return a.instance=m,Ye(m),m;var v=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),Ye(m),an(m,"style",v),Tg(m,l.precedence,s),a.instance=m;case"stylesheet":v=Du(l.href);var T=s.querySelector(Jd(v));if(T)return a.state.loading|=4,a.instance=T,Ye(T),T;m=ub(l),(v=Ui.get(v))&&u0(m,v),T=(s.ownerDocument||s).createElement("link"),Ye(T);var _=T;return _._p=new Promise(function(I,O){_.onload=I,_.onerror=O}),an(T,"link",m),a.state.loading|=4,Tg(T,l.precedence,s),a.instance=T;case"script":return T=Iu(l.src),(v=s.querySelector(Kd(T)))?(a.instance=v,Ye(v),v):(m=l,(v=Ui.get(T))&&(m=y({},l),c0(m,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ye(v),an(v,"link",m),s.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(m=a.instance,a.state.loading|=4,Tg(m,l.precedence,s));return a.instance}function Tg(s,a,l){for(var m=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=m.length?m[m.length-1]:null,T=v,_=0;_<m.length;_++){var I=m[_];if(I.dataset.precedence===a)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(s,T.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function u0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function c0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Sg=null;function db(s,a,l){if(Sg===null){var m=new Map,v=Sg=new Map;v.set(l,m)}else v=Sg,m=v.get(l),m||(m=new Map,v.set(l,m));if(m.has(s))return m;for(m.set(s,null),l=l.getElementsByTagName(s),v=0;v<l.length;v++){var T=l[v];if(!(T[ld]||T[mn]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var _=T.getAttribute(a)||"";_=s+_;var I=m.get(_);I?I.push(T):m.set(_,[T])}}return m}function fb(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function AN(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function hb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Wd=null;function TN(){}function SN(s,a,l){if(Wd===null)throw Error(n(475));var m=Wd;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var v=Du(l.href),T=s.querySelector(Jd(v));if(T){s=T._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(m.count++,m=Eg.bind(m),s.then(m,m)),a.state.loading|=4,a.instance=T,Ye(T);return}T=s.ownerDocument||s,l=ub(l),(v=Ui.get(v))&&u0(l,v),T=T.createElement("link"),Ye(T);var _=T;_._p=new Promise(function(I,O){_.onload=I,_.onerror=O}),an(T,"link",l),a.instance=T}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(a,s),(s=a.state.preload)&&(a.state.loading&3)===0&&(m.count++,a=Eg.bind(m),s.addEventListener("load",a),s.addEventListener("error",a))}}function EN(){if(Wd===null)throw Error(n(475));var s=Wd;return s.stylesheets&&s.count===0&&d0(s,s.stylesheets),0<s.count?function(a){var l=setTimeout(function(){if(s.stylesheets&&d0(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Eg(){if(this.count--,this.count===0){if(this.stylesheets)d0(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Cg=null;function d0(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Cg=new Map,a.forEach(CN,s),Cg=null,Eg.call(s))}function CN(s,a){if(!(a.state.loading&4)){var l=Cg.get(s);if(l)var m=l.get(null);else{l=new Map,Cg.set(s,l);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var _=v[T];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(l.set(_.dataset.precedence,_),m=_)}m&&l.set(null,m)}v=a.instance,_=v.getAttribute("data-precedence"),T=l.get(_)||m,T===m&&l.set(null,v),l.set(_,v),this.count++,m=Eg.bind(this),v.addEventListener("load",m),v.addEventListener("error",m),T?T.parentNode.insertBefore(v,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),a.state.loading|=4}}var Qd={$$typeof:P,Provider:null,Consumer:null,_currentValue:rt,_currentValue2:rt,_threadCount:0};function bN(s,a,l,m,v,T,_,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ry(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ry(0),this.hiddenUpdates=ry(null),this.identifierPrefix=m,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function pb(s,a,l,m,v,T,_,I,O,J,tt,nt){return s=new bN(s,a,l,_,I,O,J,nt),a=1,T===!0&&(a|=24),T=ei(3,null,null,a),s.current=T,T.stateNode=s,a=Yy(),a.refCount++,s.pooledCache=a,a.refCount++,T.memoizedState={element:m,isDehydrated:l,cache:a},Wy(T),s}function gb(s){return s?(s=uu,s):uu}function mb(s,a,l,m,v,T){v=gb(v),m.context===null?m.context=v:m.pendingContext=v,m=Zo(a),m.payload={element:l},T=T===void 0?null:T,T!==null&&(m.callback=T),l=jo(s,m,a),l!==null&&(ai(l,s,a),wd(l,s,a))}function yb(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function f0(s,a){yb(s,a),(s=s.alternate)&&yb(s,a)}function vb(s){if(s.tag===13){var a=lu(s,67108864);a!==null&&ai(a,s,67108864),f0(s,67108864)}}var bg=!0;function xN(s,a,l,m){var v=G.T;G.T=null;var T=$.p;try{$.p=2,h0(s,a,l,m)}finally{$.p=T,G.T=v}}function _N(s,a,l,m){var v=G.T;G.T=null;var T=$.p;try{$.p=8,h0(s,a,l,m)}finally{$.p=T,G.T=v}}function h0(s,a,l,m){if(bg){var v=p0(m);if(v===null)t0(s,a,m,xg,l),Tb(s,m);else if(MN(v,s,a,l,m))m.stopPropagation();else if(Tb(s,m),a&4&&-1<wN.indexOf(s)){for(;v!==null;){var T=Wl(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var _=ur(T.pendingLanes);if(_!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;_;){var O=1<<31-wn(_);I.entanglements[1]|=O,_&=~O}vs(T),(Qt&6)===0&&(lg=Oe()+500,qd(0))}}break;case 13:I=lu(T,2),I!==null&&ai(I,T,2),cg(),f0(T,2)}if(T=p0(m),T===null&&t0(s,a,m,xg,l),T===v)break;v=T}v!==null&&m.stopPropagation()}else t0(s,a,m,null,l)}}function p0(s){return s=Ay(s),g0(s)}var xg=null;function g0(s){if(xg=null,s=Kl(s),s!==null){var a=r(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=u(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return xg=s,null}function Ab(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ay()){case sd:return 2;case pp:return 8;case lr:case gp:return 32;case od:return 268435456;default:return 32}default:return 32}}var m0=!1,fa=null,ha=null,pa=null,Zd=new Map,jd=new Map,ga=[],wN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Tb(s,a){switch(s){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":ha=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":Zd.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(a.pointerId)}}function tf(s,a,l,m,v,T){return s===null||s.nativeEvent!==T?(s={blockedOn:a,domEventName:l,eventSystemFlags:m,nativeEvent:T,targetContainers:[v]},a!==null&&(a=Wl(a),a!==null&&vb(a)),s):(s.eventSystemFlags|=m,a=s.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),s)}function MN(s,a,l,m,v){switch(a){case"focusin":return fa=tf(fa,s,a,l,m,v),!0;case"dragenter":return ha=tf(ha,s,a,l,m,v),!0;case"mouseover":return pa=tf(pa,s,a,l,m,v),!0;case"pointerover":var T=v.pointerId;return Zd.set(T,tf(Zd.get(T)||null,s,a,l,m,v)),!0;case"gotpointercapture":return T=v.pointerId,jd.set(T,tf(jd.get(T)||null,s,a,l,m,v)),!0}return!1}function Sb(s){var a=Kl(s.target);if(a!==null){var l=r(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){s.blockedOn=a,SR(s.priority,function(){if(l.tag===13){var m=oi();m=ly(m);var v=lu(l,m);v!==null&&ai(v,l,m),f0(l,m)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function _g(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=p0(s.nativeEvent);if(l===null){l=s.nativeEvent;var m=new l.constructor(l.type,l);vy=m,l.target.dispatchEvent(m),vy=null}else return a=Wl(l),a!==null&&vb(a),s.blockedOn=l,!1;a.shift()}return!0}function Eb(s,a,l){_g(s)&&l.delete(a)}function RN(){m0=!1,fa!==null&&_g(fa)&&(fa=null),ha!==null&&_g(ha)&&(ha=null),pa!==null&&_g(pa)&&(pa=null),Zd.forEach(Eb),jd.forEach(Eb)}function wg(s,a){s.blockedOn===a&&(s.blockedOn=null,m0||(m0=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,RN)))}var Mg=null;function Cb(s){Mg!==s&&(Mg=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Mg===s&&(Mg=null);for(var a=0;a<s.length;a+=3){var l=s[a],m=s[a+1],v=s[a+2];if(typeof m!="function"){if(g0(m||l)===null)continue;break}var T=Wl(l);T!==null&&(s.splice(a,3),a-=3,gv(T,{pending:!0,data:v,method:l.method,action:m},m,v))}}))}function ef(s){function a(O){return wg(O,s)}fa!==null&&wg(fa,s),ha!==null&&wg(ha,s),pa!==null&&wg(pa,s),Zd.forEach(a),jd.forEach(a);for(var l=0;l<ga.length;l++){var m=ga[l];m.blockedOn===s&&(m.blockedOn=null)}for(;0<ga.length&&(l=ga[0],l.blockedOn===null);)Sb(l),l.blockedOn===null&&ga.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(m=0;m<l.length;m+=3){var v=l[m],T=l[m+1],_=v[zn]||null;if(typeof T=="function")_||Cb(l);else if(_){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,_=T[zn]||null)I=_.formAction;else if(g0(v)!==null)continue}else I=_.action;typeof I=="function"?l[m+1]=I:(l.splice(m,3),m-=3),Cb(l)}}}function y0(s){this._internalRoot=s}Rg.prototype.render=y0.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,m=oi();mb(l,m,s,a,null,null)},Rg.prototype.unmount=y0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;mb(s.current,2,null,s,null,null),cg(),a[Jl]=null}};function Rg(s){this._internalRoot=s}Rg.prototype.unstable_scheduleHydration=function(s){if(s){var a=GT();s={blockedOn:null,target:s,priority:a};for(var l=0;l<ga.length&&a!==0&&a<ga[l].priority;l++);ga.splice(l,0,s),l===0&&Sb(s)}};var bb=t.version;if(bb!=="19.1.0")throw Error(n(527,bb,"19.1.0"));$.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=f(a),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var NN={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ng=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ng.isDisabled&&Ng.supportsFiber)try{Xo=Ng.inject(NN),_n=Ng}catch{}}return sf.createRoot=function(s,a){if(!o(s))throw Error(n(299));var l=!1,m="",v=GE,T=VE,_=HE,I=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(I=a.unstable_transitionCallbacks)),a=pb(s,1,!1,null,null,l,m,v,T,_,I,null),s[Jl]=a.current,jv(s),new y0(a)},sf.hydrateRoot=function(s,a,l){if(!o(s))throw Error(n(299));var m=!1,v="",T=GE,_=VE,I=HE,O=null,J=null;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(T=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(O=l.unstable_transitionCallbacks),l.formState!==void 0&&(J=l.formState)),a=pb(s,1,!0,a,l??null,m,v,T,_,I,O,J),a.context=gb(null),l=a.current,m=oi(),m=ly(m),v=Zo(m),v.callback=null,jo(l,v,m),l=m,a.current.lanes=l,rd(a,l),vs(a),s[Jl]=a.current,jv(s),new Rg(a)},sf.version="19.1.0",sf}var kb;function zN(){if(kb)return S0.exports;kb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),S0.exports=HN(),S0.exports}var qN=zN();const $N=__(qN);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let YN,XN;function JN(){return{geminiUrl:YN,vertexUrl:XN}}function KN(i,t,e){var n,o,r;if(!(!((n=i.httpOptions)===null||n===void 0)&&n.baseUrl)){const u=JN();return i.vertexai?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(r=u.geminiUrl)!==null&&r!==void 0?r:e}return i.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ql{}function At(i,t){const e=/\{([^}]+)\}/g;return i.replace(e,(n,o)=>{if(Object.prototype.hasOwnProperty.call(t,o)){const r=t[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function p(i,t,e){for(let r=0;r<t.length-1;r++){const u=t[r];if(u.endsWith("[]")){const c=u.slice(0,-2);if(!(c in i))if(Array.isArray(e))i[c]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(i[c])){const f=i[c];if(Array.isArray(e))for(let h=0;h<f.length;h++){const y=f[h];p(y,t.slice(r+1),e[h])}else for(const h of f)p(h,t.slice(r+1),e)}return}else if(u.endsWith("[0]")){const c=u.slice(0,-3);c in i||(i[c]=[{}]);const f=i[c];p(f[0],t.slice(r+1),e);return}(!i[u]||typeof i[u]!="object")&&(i[u]={}),i=i[u]}const n=t[t.length-1],o=i[n];if(o!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===o)return;if(typeof o=="object"&&typeof e=="object"&&o!==null&&e!==null)Object.assign(o,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=e}function d(i,t){try{if(t.length===1&&t[0]==="_self")return i;for(let e=0;e<t.length;e++){if(typeof i!="object"||i===null)return;const n=t[e];if(n.endsWith("[]")){const o=n.slice(0,-2);if(o in i){const r=i[o];return Array.isArray(r)?r.map(u=>d(u,t.slice(e+1))):void 0}else return}else i=i[n]}return i}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ub;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ub||(Ub={}));var Fb;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(Fb||(Fb={}));var Gs;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(Gs||(Gs={}));var Ob;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Ob||(Ob={}));var Bb;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(Bb||(Bb={}));var Gb;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(Gb||(Gb={}));var Vb;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Vb||(Vb={}));var Hb;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(Hb||(Hb={}));var zb;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(zb||(zb={}));var qb;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(qb||(qb={}));var $b;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})($b||($b={}));var Yb;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Yb||(Yb={}));var Xb;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(Xb||(Xb={}));var Jb;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Jb||(Jb={}));var Kb;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY"})(Kb||(Kb={}));var Wb;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wb||(Wb={}));var Tm;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(Tm||(Tm={}));var Qb;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Qb||(Qb={}));var k0;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(k0||(k0={}));var Zb;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Zb||(Zb={}));var jb;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(jb||(jb={}));var tx;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(tx||(tx={}));var ex;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(ex||(ex={}));var nx;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(nx||(nx={}));var ix;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(ix||(ix={}));var sx;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(sx||(sx={}));var ox;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(ox||(ox={}));var ax;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ax||(ax={}));var rx;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(rx||(rx={}));var lx;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(lx||(lx={}));var ux;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ux||(ux={}));var cx;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(cx||(cx={}));var dx;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(dx||(dx={}));var fx;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(fx||(fx={}));var hx;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(hx||(hx={}));var px;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(px||(px={}));var gx;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(gx||(gx={}));var mx;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(mx||(mx={}));var yx;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(yx||(yx={}));var vx;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(vx||(vx={}));var Ax;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Ax||(Ax={}));var Gu;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Gu||(Gu={}));class U0{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class of{get text(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",y=!1;const A=[];for(const S of(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[E,b]of Object.entries(S))E!=="text"&&E!=="thought"&&(b!==null||b!==void 0)&&A.push(E);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;y=!0,h+=S.text}}return A.length>0&&console.warn(`there are non-text parts ${A} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?h:void 0}get data(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const y=[];for(const A of(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[S,E]of Object.entries(A))S!=="inlineData"&&(E!==null||E!==void 0)&&y.push(S);A.inlineData&&typeof A.inlineData.data=="string"&&(h+=atob(A.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,e,n,o,r,u,c,f,h;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(A=>A.executableCode).map(A=>A.executableCode).filter(A=>A!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,e,n,o,r,u,c,f,h;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(A=>A.codeExecutionResult).map(A=>A.codeExecutionResult).filter(A=>A!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.output}}class Tx{}class Sx{}class WN{}class QN{}class Ex{}class Cx{}class bx{}class ZN{}class xx{}class _x{}class wx{}class jN{}class tD{}class eD{}class Mx{}class nD{get text(){var t,e,n;let o="",r=!1;const u=[];for(const c of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[f,h]of Object.entries(c))f!=="text"&&f!=="thought"&&h!==null&&u.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;r=!0,o+=c.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var t,e,n;let o="";const r=[];for(const u of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[c,f]of Object.entries(u))c!=="inlineData"&&f!==null&&r.push(c);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class iD{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function te(i,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function w_(i,t){const e=te(i,t);return e?e.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:e.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${e}`:e:""}function M_(i){return Array.isArray(i)?i.map(t=>Sm(t)):[Sm(i)]}function Sm(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function R_(i){const t=Sm(i);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function N_(i){const t=Sm(i);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Rx(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function D_(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(t=>Rx(t)):[Rx(i)]}function F0(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function Nx(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function Dx(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function bn(i){if(i==null)throw new Error("ContentUnion is required");return F0(i)?i:{role:"user",parts:D_(i)}}function I_(i,t){if(!t)return[];if(i.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=bn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const e=bn(t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>bn(e)):[bn(t)]}function Xi(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(Nx(i)||Dx(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[bn(i)]}const t=[],e=[],n=F0(i[0]);for(const o of i){const r=F0(o);if(r!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)t.push(o);else{if(Nx(o)||Dx(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");e.push(o)}}return n||t.push({role:"user",parts:D_(e)}),t}function sD(i,t){i.includes("null")&&(t.nullable=!0);const e=i.filter(n=>n!=="null");if(e.length===1)t.type=Object.values(Gs).includes(e[0].toUpperCase())?e[0].toUpperCase():Gs.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of e)t.anyOf.push({type:Object.values(Gs).includes(n.toUpperCase())?n.toUpperCase():Gs.TYPE_UNSPECIFIED})}}function qu(i){const t={},e=["items"],n=["anyOf"],o=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=i.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(t.nullable=!0,i=r[1]):r[1].type==="null"&&(t.nullable=!0,i=r[0])),i.type instanceof Array&&sD(i.type,t);for(const[u,c]of Object.entries(i))if(c!=null)if(u=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;t.type=Object.values(Gs).includes(c.toUpperCase())?c.toUpperCase():Gs.TYPE_UNSPECIFIED}else if(e.includes(u))t[u]=qu(c);else if(n.includes(u)){const f=[];for(const h of c){if(h.type=="null"){t.nullable=!0;continue}f.push(qu(h))}t[u]=f}else if(o.includes(u)){const f={};for(const[h,y]of Object.entries(c))f[h]=qu(y);t[u]=f}else{if(u==="additionalProperties")continue;t[u]=c}return t}function pT(i){return qu(i)}function gT(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function mT(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function jc(i){if(i.functionDeclarations)for(const t of i.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=qu(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=qu(t.response));return i}function td(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const t=[];for(const e of i)t.push(e);return t}function oD(i,t,e,n=1){const o=!t.startsWith(`${e}/`)&&t.split("/").length===n;return i.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${i.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:o?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}/${t}`:t:o?`${e}/${t}`:t}function $o(i,t){if(typeof t!="string")throw new Error("name must be a string");return oD(i,t,"cachedContents")}function P_(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function Yo(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}function aD(i){return i!=null&&typeof i=="object"&&"name"in i}function rD(i){return i!=null&&typeof i=="object"&&"video"in i}function lD(i){return i!=null&&typeof i=="object"&&"uri"in i}function L_(i){var t;let e;if(aD(i)&&(e=i.name),!(lD(i)&&(e=i.uri,e===void 0))&&!(rD(i)&&(e=(t=i.video)===null||t===void 0?void 0:t.uri,e===void 0))){if(typeof i=="string"&&(e=i),e===void 0)throw new Error("Could not extract file name from the provided input.");if(e.startsWith("https://")){const o=e.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${e}`);e=o[0]}else e.startsWith("files/")&&(e=e.split("files/")[1]);return e}}function k_(i,t){let e;return i.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function U_(i){for(const t of["models","tunedModels","publisherModels"])if(uD(i,t))return i[t];return[]}function uD(i,t){return i!==null&&typeof i=="object"&&t in i}function cD(i,t={}){const e=i,n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function dD(i,t={}){const e=[],n=new Set;for(const o of i){const r=o.name;if(n.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);n.add(r);const u=cD(o,t);u.functionDeclarations&&e.push(...u.functionDeclarations)}return{functionDeclarations:e}}function F_(i,t){if(typeof t!="string"&&!Array.isArray(t)){if(i&&i.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function fD(i){const t=i;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function ed(i,t){const e=t;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(e))return e.split("/").pop();throw new Error(`Invalid batch job name: ${e}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(e))return e.split("/").pop();if(/^\d+$/.test(e))return e;throw new Error(`Invalid batch job name: ${e}.`)}function O_(i){const t=i;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hD(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function pD(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function gD(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function mD(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],hD(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],pD(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],gD(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function B_(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>mD(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function yD(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const D=d(i,["minimum"]);D!=null&&p(t,["minimum"],D);const N=d(i,["nullable"]);N!=null&&p(t,["nullable"],N);const L=d(i,["pattern"]);L!=null&&p(t,["pattern"],L);const P=d(i,["properties"]);P!=null&&p(t,["properties"],P);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const k=d(i,["required"]);k!=null&&p(t,["required"],k);const F=d(i,["title"]);F!=null&&p(t,["title"],F);const B=d(i,["type"]);return B!=null&&p(t,["type"],B),t}function vD(i){const t={};if(d(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const e=d(i,["category"]);e!=null&&p(t,["category"],e);const n=d(i,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function AD(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function TD(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function SD(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],TD(e)),t}function ED(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function CD(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],ED(e)),t}function bD(){return{}}function xD(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>AD(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],SD(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],CD(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],bD());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function _D(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function wD(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function MD(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],wD(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function RD(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],_D(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],MD(n)),t}function ND(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function G_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],ND(e)),t}function DD(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],G_(n)),t}function ID(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>DD(o))),p(t,["speakerVoiceConfigs"],n)}return t}function PD(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],G_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],ID(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function LD(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function kD(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],B_(bn(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const D=d(t,["responseMimeType"]);D!=null&&p(n,["responseMimeType"],D);const N=d(t,["responseSchema"]);N!=null&&p(n,["responseSchema"],yD(pT(N)));const L=d(t,["responseJsonSchema"]);if(L!=null&&p(n,["responseJsonSchema"],L),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=d(t,["safetySettings"]);if(e!==void 0&&P!=null){let Z=P;Array.isArray(Z)&&(Z=Z.map(ut=>vD(ut))),p(e,["safetySettings"],Z)}const U=d(t,["tools"]);if(e!==void 0&&U!=null){let Z=td(U);Array.isArray(Z)&&(Z=Z.map(ut=>xD(jc(ut)))),p(e,["tools"],Z)}const k=d(t,["toolConfig"]);if(e!==void 0&&k!=null&&p(e,["toolConfig"],RD(k)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=d(t,["cachedContent"]);e!==void 0&&F!=null&&p(e,["cachedContent"],$o(i,F));const B=d(t,["responseModalities"]);B!=null&&p(n,["responseModalities"],B);const q=d(t,["mediaResolution"]);q!=null&&p(n,["mediaResolution"],q);const Y=d(t,["speechConfig"]);if(Y!=null&&p(n,["speechConfig"],PD(gT(Y))),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=d(t,["thinkingConfig"]);return Q!=null&&p(n,["thinkingConfig"],LD(Q)),n}function UD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["request","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>B_(c))),p(e,["request","contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["request","generationConfig"],kD(i,r,e)),e}function FD(i,t){const e={};if(d(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=d(t,["fileName"]);n!=null&&p(e,["fileName"],n);const o=d(t,["inlinedRequests"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(u=>UD(i,u))),p(e,["requests","requests"],r)}return e}function OD(i,t){const e={},n=d(i,["displayName"]);if(t!==void 0&&n!=null&&p(t,["batch","displayName"],n),d(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return e}function BD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["src"]);o!=null&&p(e,["batch","inputConfig"],FD(i,F_(i,o)));const r=d(t,["config"]);return r!=null&&p(e,["config"],OD(r,e)),e}function GD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function VD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function HD(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);if(t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),d(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return e}function zD(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],HD(e,t)),t}function qD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function $D(i){const t={},e=d(i,["format"]);e!=null&&p(t,["instancesFormat"],e);const n=d(i,["gcsUri"]);n!=null&&p(t,["gcsSource","uris"],n);const o=d(i,["bigqueryUri"]);if(o!=null&&p(t,["bigquerySource","inputUri"],o),d(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function YD(i){const t={},e=d(i,["format"]);e!=null&&p(t,["predictionsFormat"],e);const n=d(i,["gcsUri"]);n!=null&&p(t,["gcsDestination","outputUriPrefix"],n);const o=d(i,["bigqueryUri"]);if(o!=null&&p(t,["bigqueryDestination","outputUri"],o),d(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function XD(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["dest"]);return t!==void 0&&o!=null&&p(t,["outputConfig"],YD(fD(o))),e}function JD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],te(i,n));const o=d(t,["src"]);o!=null&&p(e,["inputConfig"],$D(F_(i,o)));const r=d(t,["config"]);return r!=null&&p(e,["config"],XD(r,e)),e}function KD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function WD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function QD(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function ZD(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],QD(e,t)),t}function jD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],ed(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function V_(){return{}}function tI(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function eI(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function nI(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function iI(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],tI(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],eI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],nI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function sI(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>iI(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function oI(i){const t={},e=d(i,["citationSources"]);return e!=null&&p(t,["citations"],e),t}function aI(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function rI(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>aI(o))),p(t,["urlMetadata"],n)}return t}function lI(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],sI(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],oI(n));const o=d(i,["tokenCount"]);o!=null&&p(t,["tokenCount"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],rI(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function uI(i){const t={},e=d(i,["candidates"]);if(e!=null){let u=e;Array.isArray(u)&&(u=u.map(c=>lI(c))),p(t,["candidates"],u)}const n=d(i,["modelVersion"]);n!=null&&p(t,["modelVersion"],n);const o=d(i,["promptFeedback"]);o!=null&&p(t,["promptFeedback"],o);const r=d(i,["usageMetadata"]);return r!=null&&p(t,["usageMetadata"],r),t}function cI(i){const t={},e=d(i,["response"]);return e!=null&&p(t,["response"],uI(e)),d(i,["error"])!=null&&p(t,["error"],V_()),t}function dI(i){const t={},e=d(i,["responsesFile"]);e!=null&&p(t,["fileName"],e);const n=d(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>cI(r))),p(t,["inlinedResponses"],o)}return t}function O0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata","displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["metadata","state"]);o!=null&&p(t,["state"],O_(o));const r=d(i,["metadata","createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["metadata","endTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["metadata","updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["metadata","model"]);f!=null&&p(t,["model"],f);const h=d(i,["metadata","output"]);return h!=null&&p(t,["dest"],dI(h)),t}function fI(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["operations"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>O0(r))),p(t,["batchJobs"],o)}return t}function hI(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["done"]);return n!=null&&p(t,["done"],n),d(i,["error"])!=null&&p(t,["error"],V_()),t}function H_(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["code"]);n!=null&&p(t,["code"],n);const o=d(i,["message"]);return o!=null&&p(t,["message"],o),t}function pI(i){const t={},e=d(i,["instancesFormat"]);e!=null&&p(t,["format"],e);const n=d(i,["gcsSource","uris"]);n!=null&&p(t,["gcsUri"],n);const o=d(i,["bigquerySource","inputUri"]);return o!=null&&p(t,["bigqueryUri"],o),t}function gI(i){const t={},e=d(i,["predictionsFormat"]);e!=null&&p(t,["format"],e);const n=d(i,["gcsDestination","outputUriPrefix"]);n!=null&&p(t,["gcsUri"],n);const o=d(i,["bigqueryDestination","outputUri"]);return o!=null&&p(t,["bigqueryUri"],o),t}function B0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["state"]);o!=null&&p(t,["state"],O_(o));const r=d(i,["error"]);r!=null&&p(t,["error"],H_(r));const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["startTime"]);c!=null&&p(t,["startTime"],c);const f=d(i,["endTime"]);f!=null&&p(t,["endTime"],f);const h=d(i,["updateTime"]);h!=null&&p(t,["updateTime"],h);const y=d(i,["model"]);y!=null&&p(t,["model"],y);const A=d(i,["inputConfig"]);A!=null&&p(t,["src"],pI(A));const S=d(i,["outputConfig"]);return S!=null&&p(t,["dest"],gI(S)),t}function mI(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["batchPredictionJobs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>B0(r))),p(t,["batchJobs"],o)}return t}function yI(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["done"]);n!=null&&p(t,["done"],n);const o=d(i,["error"]);return o!=null&&p(t,["error"],H_(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gl;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Gl||(Gl={}));class rp{constructor(t,e,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,o)}init(t,e,n){var o,r;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let u={config:{}};n?typeof n=="object"?u=Object.assign({},n):u=n:u={config:{}},u.config&&(u.config.pageToken=e.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(r=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vI extends ql{constructor(t){super(),this.apiClient=t,this.create=async e=>{if(this.apiClient.isVertexAI()){const o=Date.now().toString();if(Array.isArray(e.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(e.config=e.config||{},e.config.displayName===void 0&&(e.config.displayName="genaiBatchJob_${timestampStr}"),e.config.dest===void 0&&typeof e.src=="string")if(e.src.startsWith("gs://")&&e.src.endsWith(".jsonl"))e.config.dest=`${e.src.slice(0,-6)}/dest`;else if(e.src.startsWith("bq://"))e.config.dest=`${e.src}_dest_${o}`;else throw new Error("Unsupported source:"+e.src)}return await this.createInternal(e)},this.list=async(e={})=>new rp(Gl.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(e),e)}async createInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=JD(this.apiClient,t);return c=At("batchPredictionJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>B0(y))}else{const h=BD(this.apiClient,t);return c=At("{model}:batchGenerateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>O0(y))}}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=KD(this.apiClient,t);return c=At("batchPredictionJobs/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>B0(y))}else{const h=GD(this.apiClient,t);return c=At("batches/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>O0(y))}}async cancel(t){var e,n,o,r;let u="",c={};if(this.apiClient.isVertexAI()){const f=WD(this.apiClient,t);u=At("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const f=VD(this.apiClient,t);u=At("batches/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=ZD(t);return c=At("batchPredictionJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=mI(y),S=new Mx;return Object.assign(S,A),S})}else{const h=zD(t);return c=At("batches",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=fI(y),S=new Mx;return Object.assign(S,A),S})}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=jD(this.apiClient,t);return c=At("batchPredictionJobs/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>yI(y))}else{const h=qD(this.apiClient,t);return c=At("batches/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>hI(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AI(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function TI(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function SI(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function EI(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],AI(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],TI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],SI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Ix(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>EI(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function CI(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function bI(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function xI(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],bI(e)),t}function _I(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function wI(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],_I(e)),t}function MI(){return{}}function RI(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>CI(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],xI(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],wI(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],MI());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function NI(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function DI(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function II(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],DI(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function PI(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],NI(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],II(n)),t}function LI(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);t!==void 0&&o!=null&&p(t,["expireTime"],o);const r=d(i,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const u=d(i,["contents"]);if(t!==void 0&&u!=null){let y=Xi(u);Array.isArray(y)&&(y=y.map(A=>Ix(A))),p(t,["contents"],y)}const c=d(i,["systemInstruction"]);t!==void 0&&c!=null&&p(t,["systemInstruction"],Ix(bn(c)));const f=d(i,["tools"]);if(t!==void 0&&f!=null){let y=f;Array.isArray(y)&&(y=y.map(A=>RI(A))),p(t,["tools"],y)}const h=d(i,["toolConfig"]);if(t!==void 0&&h!=null&&p(t,["toolConfig"],PI(h)),d(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return e}function kI(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],w_(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],LI(o,e)),e}function UI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function FI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function OI(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);return t!==void 0&&o!=null&&p(t,["expireTime"],o),e}function BI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],OI(o,e)),e}function GI(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function VI(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],GI(e,t)),t}function HI(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function zI(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function qI(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function $I(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],HI(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],zI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],qI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Px(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>$I(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function YI(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function XI(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function JI(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],XI(e)),t}function KI(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function WI(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],KI(e)),t}function QI(){return{}}function ZI(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function jI(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],ZI(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function tP(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],jI(e)),t}function eP(){return{}}function nP(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>YI(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],JI(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],WI(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],QI());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],tP(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],eP());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function iP(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function sP(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function oP(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],sP(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function aP(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],iP(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],oP(n)),t}function rP(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);t!==void 0&&o!=null&&p(t,["expireTime"],o);const r=d(i,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const u=d(i,["contents"]);if(t!==void 0&&u!=null){let A=Xi(u);Array.isArray(A)&&(A=A.map(S=>Px(S))),p(t,["contents"],A)}const c=d(i,["systemInstruction"]);t!==void 0&&c!=null&&p(t,["systemInstruction"],Px(bn(c)));const f=d(i,["tools"]);if(t!==void 0&&f!=null){let A=f;Array.isArray(A)&&(A=A.map(S=>nP(S))),p(t,["tools"],A)}const h=d(i,["toolConfig"]);t!==void 0&&h!=null&&p(t,["toolConfig"],aP(h));const y=d(i,["kmsKeyName"]);return t!==void 0&&y!=null&&p(t,["encryption_spec","kmsKeyName"],y),e}function lP(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],w_(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],rP(o,e)),e}function uP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function cP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function dP(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);return t!==void 0&&o!=null&&p(t,["expireTime"],o),e}function fP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],$o(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],dP(o,e)),e}function hP(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function pP(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],hP(e,t)),t}function Gg(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["model"]);o!=null&&p(t,["model"],o);const r=d(i,["createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["updateTime"]);u!=null&&p(t,["updateTime"],u);const c=d(i,["expireTime"]);c!=null&&p(t,["expireTime"],c);const f=d(i,["usageMetadata"]);return f!=null&&p(t,["usageMetadata"],f),t}function gP(){return{}}function mP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["cachedContents"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Gg(r))),p(t,["cachedContents"],o)}return t}function Vg(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["model"]);o!=null&&p(t,["model"],o);const r=d(i,["createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["updateTime"]);u!=null&&p(t,["updateTime"],u);const c=d(i,["expireTime"]);c!=null&&p(t,["expireTime"],c);const f=d(i,["usageMetadata"]);return f!=null&&p(t,["usageMetadata"],f),t}function yP(){return{}}function vP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["cachedContents"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Vg(r))),p(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AP extends ql{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new rp(Gl.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=lP(this.apiClient,t);return c=At("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Vg(y))}else{const h=kI(this.apiClient,t);return c=At("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Gg(y))}}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=uP(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Vg(y))}else{const h=UI(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Gg(y))}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=cP(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(()=>{const y=yP(),A=new _x;return Object.assign(A,y),A})}else{const h=FI(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(()=>{const y=gP(),A=new _x;return Object.assign(A,y),A})}}async update(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=fP(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Vg(y))}else{const h=BI(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Gg(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=pP(t);return c=At("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=vP(y),S=new wx;return Object.assign(S,A),S})}else{const h=VI(t);return c=At("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=mP(y),S=new wx;return Object.assign(S,A),S})}}}function Lx(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function he(i){return this instanceof he?(this.v=i,this):new he(i)}function $u(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(E){return function(b){return Promise.resolve(b).then(E,A)}}function c(E,b){n[E]&&(o[E]=function(x){return new Promise(function(D,N){r.push([E,x,D,N])>1||f(E,x)})},b&&(o[E]=b(o[E])))}function f(E,b){try{h(n[E](b))}catch(x){S(r[0][3],x)}}function h(E){E.value instanceof he?Promise.resolve(E.value.v).then(y,A):S(r[0][2],E)}function y(E){f("next",E)}function A(E){f("throw",E)}function S(E,b){E(b),r.shift(),r.length&&f(r[0][0],r[0][1])}}function Rf(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Lx=="function"?Lx(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=i[r]&&function(u){return new Promise(function(c,f){u=i[r](u),o(c,f,u.done,u.value)})}}function o(r,u,c,f){Promise.resolve(f).then(function(h){r({value:h,done:c})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TP(i){var t;if(i.candidates==null||i.candidates.length===0)return!1;const e=(t=i.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:z_(e)}function z_(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const t of i.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function SP(i){if(i.length!==0){for(const t of i)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function kx(i){if(i===void 0||i.length===0)return[];const t=[],e=i.length;let n=0;for(;n<e;)if(i[n].role==="user")t.push(i[n]),n++;else{const o=[];let r=!0;for(;n<e&&i[n].role==="model";)o.push(i[n]),r&&!z_(i[n])&&(r=!1),n++;r?t.push(...o):t.pop()}return t}class EP{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new CP(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class CP{constructor(t,e,n,o={},r=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),SP(r)}async sendMessage(t){var e;await this.sendPromise;const n=bn(t.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var r,u,c;const f=await o,h=(u=(r=f.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content,y=f.automaticFunctionCallingHistory,A=this.getHistory(!0).length;let S=[];y!=null&&(S=(c=y.slice(A))!==null&&c!==void 0?c:[]);const E=h?[h]:[];this.recordHistory(n,E,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(t){var e;await this.sendPromise;const n=bn(t.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,n)}getHistory(t=!1){const e=t?kx(this.history):this.history;return structuredClone(e)}processStreamResponse(t,e){var n,o;return $u(this,arguments,function*(){var u,c,f,h;const y=[];try{for(var A=!0,S=Rf(t),E;E=yield he(S.next()),u=E.done,!u;A=!0){h=E.value,A=!1;const b=h;if(TP(b)){const x=(o=(n=b.candidates)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.content;x!==void 0&&y.push(x)}yield yield he(b)}}catch(b){c={error:b}}finally{try{!A&&!u&&(f=S.return)&&(yield he(f.call(S)))}finally{if(c)throw c.error}}this.recordHistory(e,y)})}recordHistory(t,e,n){let o=[];e.length>0&&e.every(r=>r.role!==void 0)?o=e:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...kx(n)):this.history.push(t),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wm extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Wm.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bP(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function xP(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],bP(e,t)),t}function _P(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["message"]);n!=null&&p(t,["message"],n);const o=d(i,["code"]);return o!=null&&p(t,["code"],o),t}function wP(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["mimeType"]);o!=null&&p(t,["mimeType"],o);const r=d(i,["sizeBytes"]);r!=null&&p(t,["sizeBytes"],r);const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["expirationTime"]);c!=null&&p(t,["expirationTime"],c);const f=d(i,["updateTime"]);f!=null&&p(t,["updateTime"],f);const h=d(i,["sha256Hash"]);h!=null&&p(t,["sha256Hash"],h);const y=d(i,["uri"]);y!=null&&p(t,["uri"],y);const A=d(i,["downloadUri"]);A!=null&&p(t,["downloadUri"],A);const S=d(i,["state"]);S!=null&&p(t,["state"],S);const E=d(i,["source"]);E!=null&&p(t,["source"],E);const b=d(i,["videoMetadata"]);b!=null&&p(t,["videoMetadata"],b);const x=d(i,["error"]);return x!=null&&p(t,["error"],_P(x)),t}function MP(i){const t={},e=d(i,["file"]);e!=null&&p(t,["file"],wP(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function RP(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","file"],L_(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function NP(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","file"],L_(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function DP(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["message"]);n!=null&&p(t,["message"],n);const o=d(i,["code"]);return o!=null&&p(t,["code"],o),t}function G0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["mimeType"]);o!=null&&p(t,["mimeType"],o);const r=d(i,["sizeBytes"]);r!=null&&p(t,["sizeBytes"],r);const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["expirationTime"]);c!=null&&p(t,["expirationTime"],c);const f=d(i,["updateTime"]);f!=null&&p(t,["updateTime"],f);const h=d(i,["sha256Hash"]);h!=null&&p(t,["sha256Hash"],h);const y=d(i,["uri"]);y!=null&&p(t,["uri"],y);const A=d(i,["downloadUri"]);A!=null&&p(t,["downloadUri"],A);const S=d(i,["state"]);S!=null&&p(t,["state"],S);const E=d(i,["source"]);E!=null&&p(t,["source"],E);const b=d(i,["videoMetadata"]);b!=null&&p(t,["videoMetadata"],b);const x=d(i,["error"]);return x!=null&&p(t,["error"],DP(x)),t}function IP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["files"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>G0(r))),p(t,["files"],o)}return t}function PP(){return{}}function LP(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kP extends ql{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new rp(Gl.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>G0(e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=xP(t);return r=At("files",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=IP(f),y=new jN;return Object.assign(y,h),y})}}async createInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=MP(t);return r=At("upload/v1beta/files",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(()=>{const f=PP(),h=new tD;return Object.assign(h,f),h})}}async get(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=RP(t);return r=At("files/{file}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>G0(f))}}async delete(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=NP(t);return r=At("files/{file}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(()=>{const f=LP(),h=new eD;return Object.assign(h,f),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UP(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function FP(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function q_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],UP(e)),t}function OP(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],FP(e)),t}function BP(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],q_(n)),t}function GP(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>BP(o))),p(t,["speakerVoiceConfigs"],n)}return t}function VP(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],q_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],GP(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function HP(i){const t={},e=d(i,["voiceConfig"]);if(e!=null&&p(t,["voiceConfig"],OP(e)),d(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function zP(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function qP(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function $P(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function YP(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function XP(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function JP(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function KP(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],zP(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],$P(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],XP(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function WP(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],qP(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],YP(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],JP(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function QP(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>KP(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function ZP(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>WP(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function jP(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function t2(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function e2(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function n2(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function i2(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],e2(e)),t}function s2(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],n2(e)),t}function o2(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function a2(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function r2(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],o2(e)),t}function l2(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],a2(e)),t}function u2(){return{}}function c2(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function d2(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],c2(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function f2(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],d2(e)),t}function h2(){return{}}function p2(){return{}}function g2(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>jP(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],i2(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],r2(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],h2());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function m2(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>t2(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],s2(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],l2(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],u2());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],f2(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],p2());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function y2(i){const t={},e=d(i,["handle"]);if(e!=null&&p(t,["handle"],e),d(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function v2(i){const t={},e=d(i,["handle"]);e!=null&&p(t,["handle"],e);const n=d(i,["transparent"]);return n!=null&&p(t,["transparent"],n),t}function Ux(){return{}}function Fx(){return{}}function A2(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function T2(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function S2(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],A2(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function E2(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],T2(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function C2(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function b2(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function x2(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],C2(n)),t}function _2(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],b2(n)),t}function w2(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function M2(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function R2(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],VP(mT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],QP(bn(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let k=td(b);Array.isArray(k)&&(k=k.map(F=>g2(jc(F)))),p(t,["setup","tools"],k)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],y2(x));const D=d(i,["inputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","inputAudioTranscription"],Ux());const N=d(i,["outputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","outputAudioTranscription"],Ux());const L=d(i,["realtimeInputConfig"]);t!==void 0&&L!=null&&p(t,["setup","realtimeInputConfig"],S2(L));const P=d(i,["contextWindowCompression"]);t!==void 0&&P!=null&&p(t,["setup","contextWindowCompression"],x2(P));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],w2(U)),e}function N2(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],HP(mT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],ZP(bn(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let k=td(b);Array.isArray(k)&&(k=k.map(F=>m2(jc(F)))),p(t,["setup","tools"],k)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],v2(x));const D=d(i,["inputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","inputAudioTranscription"],Fx());const N=d(i,["outputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","outputAudioTranscription"],Fx());const L=d(i,["realtimeInputConfig"]);t!==void 0&&L!=null&&p(t,["setup","realtimeInputConfig"],E2(L));const P=d(i,["contextWindowCompression"]);t!==void 0&&P!=null&&p(t,["setup","contextWindowCompression"],_2(P));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],M2(U)),e}function D2(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],R2(o,e)),e}function I2(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],N2(o,e)),e}function P2(){return{}}function L2(){return{}}function k2(){return{}}function U2(){return{}}function F2(i){const t={},e=d(i,["media"]);e!=null&&p(t,["mediaChunks"],M_(e));const n=d(i,["audio"]);n!=null&&p(t,["audio"],N_(n));const o=d(i,["audioStreamEnd"]);o!=null&&p(t,["audioStreamEnd"],o);const r=d(i,["video"]);r!=null&&p(t,["video"],R_(r));const u=d(i,["text"]);return u!=null&&p(t,["text"],u),d(i,["activityStart"])!=null&&p(t,["activityStart"],P2()),d(i,["activityEnd"])!=null&&p(t,["activityEnd"],k2()),t}function O2(i){const t={},e=d(i,["media"]);e!=null&&p(t,["mediaChunks"],M_(e));const n=d(i,["audio"]);n!=null&&p(t,["audio"],N_(n));const o=d(i,["audioStreamEnd"]);o!=null&&p(t,["audioStreamEnd"],o);const r=d(i,["video"]);r!=null&&p(t,["video"],R_(r));const u=d(i,["text"]);return u!=null&&p(t,["text"],u),d(i,["activityStart"])!=null&&p(t,["activityStart"],L2()),d(i,["activityEnd"])!=null&&p(t,["activityEnd"],U2()),t}function $_(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["weight"]);return n!=null&&p(t,["weight"],n),t}function B2(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>$_(o))),p(t,["weightedPrompts"],n)}return t}function Y_(i){const t={},e=d(i,["temperature"]);e!=null&&p(t,["temperature"],e);const n=d(i,["topK"]);n!=null&&p(t,["topK"],n);const o=d(i,["seed"]);o!=null&&p(t,["seed"],o);const r=d(i,["guidance"]);r!=null&&p(t,["guidance"],r);const u=d(i,["bpm"]);u!=null&&p(t,["bpm"],u);const c=d(i,["density"]);c!=null&&p(t,["density"],c);const f=d(i,["brightness"]);f!=null&&p(t,["brightness"],f);const h=d(i,["scale"]);h!=null&&p(t,["scale"],h);const y=d(i,["muteBass"]);y!=null&&p(t,["muteBass"],y);const A=d(i,["muteDrums"]);A!=null&&p(t,["muteDrums"],A);const S=d(i,["onlyBassAndDrums"]);return S!=null&&p(t,["onlyBassAndDrums"],S),t}function G2(i){const t={},e=d(i,["musicGenerationConfig"]);return e!=null&&p(t,["musicGenerationConfig"],Y_(e)),t}function X_(i){const t={},e=d(i,["model"]);return e!=null&&p(t,["model"],e),t}function J_(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>$_(o))),p(t,["weightedPrompts"],n)}return t}function V0(i){const t={},e=d(i,["setup"]);e!=null&&p(t,["setup"],X_(e));const n=d(i,["clientContent"]);n!=null&&p(t,["clientContent"],J_(n));const o=d(i,["musicGenerationConfig"]);o!=null&&p(t,["musicGenerationConfig"],Y_(o));const r=d(i,["playbackControl"]);return r!=null&&p(t,["playbackControl"],r),t}function V2(){return{}}function H2(i){const t={},e=d(i,["sessionId"]);return e!=null&&p(t,["sessionId"],e),t}function z2(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function q2(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function $2(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function Y2(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function X2(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function J2(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function K2(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],z2(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],$2(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],X2(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function W2(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],q2(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],Y2(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],J2(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Q2(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>K2(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function Z2(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>W2(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function Ox(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["finished"]);return n!=null&&p(t,["finished"],n),t}function Bx(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["finished"]);return n!=null&&p(t,["finished"],n),t}function j2(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function tL(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>j2(o))),p(t,["urlMetadata"],n)}return t}function eL(i){const t={},e=d(i,["modelTurn"]);e!=null&&p(t,["modelTurn"],Q2(e));const n=d(i,["turnComplete"]);n!=null&&p(t,["turnComplete"],n);const o=d(i,["interrupted"]);o!=null&&p(t,["interrupted"],o);const r=d(i,["groundingMetadata"]);r!=null&&p(t,["groundingMetadata"],r);const u=d(i,["generationComplete"]);u!=null&&p(t,["generationComplete"],u);const c=d(i,["inputTranscription"]);c!=null&&p(t,["inputTranscription"],Ox(c));const f=d(i,["outputTranscription"]);f!=null&&p(t,["outputTranscription"],Ox(f));const h=d(i,["urlContextMetadata"]);return h!=null&&p(t,["urlContextMetadata"],tL(h)),t}function nL(i){const t={},e=d(i,["modelTurn"]);e!=null&&p(t,["modelTurn"],Z2(e));const n=d(i,["turnComplete"]);n!=null&&p(t,["turnComplete"],n);const o=d(i,["interrupted"]);o!=null&&p(t,["interrupted"],o);const r=d(i,["groundingMetadata"]);r!=null&&p(t,["groundingMetadata"],r);const u=d(i,["generationComplete"]);u!=null&&p(t,["generationComplete"],u);const c=d(i,["inputTranscription"]);c!=null&&p(t,["inputTranscription"],Bx(c));const f=d(i,["outputTranscription"]);return f!=null&&p(t,["outputTranscription"],Bx(f)),t}function iL(i){const t={},e=d(i,["id"]);e!=null&&p(t,["id"],e);const n=d(i,["args"]);n!=null&&p(t,["args"],n);const o=d(i,["name"]);return o!=null&&p(t,["name"],o),t}function sL(i){const t={},e=d(i,["args"]);e!=null&&p(t,["args"],e);const n=d(i,["name"]);return n!=null&&p(t,["name"],n),t}function oL(i){const t={},e=d(i,["functionCalls"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>iL(o))),p(t,["functionCalls"],n)}return t}function aL(i){const t={},e=d(i,["functionCalls"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>sL(o))),p(t,["functionCalls"],n)}return t}function rL(i){const t={},e=d(i,["ids"]);return e!=null&&p(t,["ids"],e),t}function lL(i){const t={},e=d(i,["ids"]);return e!=null&&p(t,["ids"],e),t}function Dg(i){const t={},e=d(i,["modality"]);e!=null&&p(t,["modality"],e);const n=d(i,["tokenCount"]);return n!=null&&p(t,["tokenCount"],n),t}function Ig(i){const t={},e=d(i,["modality"]);e!=null&&p(t,["modality"],e);const n=d(i,["tokenCount"]);return n!=null&&p(t,["tokenCount"],n),t}function uL(i){const t={},e=d(i,["promptTokenCount"]);e!=null&&p(t,["promptTokenCount"],e);const n=d(i,["cachedContentTokenCount"]);n!=null&&p(t,["cachedContentTokenCount"],n);const o=d(i,["responseTokenCount"]);o!=null&&p(t,["responseTokenCount"],o);const r=d(i,["toolUsePromptTokenCount"]);r!=null&&p(t,["toolUsePromptTokenCount"],r);const u=d(i,["thoughtsTokenCount"]);u!=null&&p(t,["thoughtsTokenCount"],u);const c=d(i,["totalTokenCount"]);c!=null&&p(t,["totalTokenCount"],c);const f=d(i,["promptTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(E=>Dg(E))),p(t,["promptTokensDetails"],S)}const h=d(i,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(E=>Dg(E))),p(t,["cacheTokensDetails"],S)}const y=d(i,["responseTokensDetails"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(E=>Dg(E))),p(t,["responseTokensDetails"],S)}const A=d(i,["toolUsePromptTokensDetails"]);if(A!=null){let S=A;Array.isArray(S)&&(S=S.map(E=>Dg(E))),p(t,["toolUsePromptTokensDetails"],S)}return t}function cL(i){const t={},e=d(i,["promptTokenCount"]);e!=null&&p(t,["promptTokenCount"],e);const n=d(i,["cachedContentTokenCount"]);n!=null&&p(t,["cachedContentTokenCount"],n);const o=d(i,["candidatesTokenCount"]);o!=null&&p(t,["responseTokenCount"],o);const r=d(i,["toolUsePromptTokenCount"]);r!=null&&p(t,["toolUsePromptTokenCount"],r);const u=d(i,["thoughtsTokenCount"]);u!=null&&p(t,["thoughtsTokenCount"],u);const c=d(i,["totalTokenCount"]);c!=null&&p(t,["totalTokenCount"],c);const f=d(i,["promptTokensDetails"]);if(f!=null){let E=f;Array.isArray(E)&&(E=E.map(b=>Ig(b))),p(t,["promptTokensDetails"],E)}const h=d(i,["cacheTokensDetails"]);if(h!=null){let E=h;Array.isArray(E)&&(E=E.map(b=>Ig(b))),p(t,["cacheTokensDetails"],E)}const y=d(i,["candidatesTokensDetails"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(b=>Ig(b))),p(t,["responseTokensDetails"],E)}const A=d(i,["toolUsePromptTokensDetails"]);if(A!=null){let E=A;Array.isArray(E)&&(E=E.map(b=>Ig(b))),p(t,["toolUsePromptTokensDetails"],E)}const S=d(i,["trafficType"]);return S!=null&&p(t,["trafficType"],S),t}function dL(i){const t={},e=d(i,["timeLeft"]);return e!=null&&p(t,["timeLeft"],e),t}function fL(i){const t={},e=d(i,["timeLeft"]);return e!=null&&p(t,["timeLeft"],e),t}function hL(i){const t={},e=d(i,["newHandle"]);e!=null&&p(t,["newHandle"],e);const n=d(i,["resumable"]);n!=null&&p(t,["resumable"],n);const o=d(i,["lastConsumedClientMessageIndex"]);return o!=null&&p(t,["lastConsumedClientMessageIndex"],o),t}function pL(i){const t={},e=d(i,["newHandle"]);e!=null&&p(t,["newHandle"],e);const n=d(i,["resumable"]);n!=null&&p(t,["resumable"],n);const o=d(i,["lastConsumedClientMessageIndex"]);return o!=null&&p(t,["lastConsumedClientMessageIndex"],o),t}function gL(i){const t={};d(i,["setupComplete"])!=null&&p(t,["setupComplete"],V2());const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],eL(n));const o=d(i,["toolCall"]);o!=null&&p(t,["toolCall"],oL(o));const r=d(i,["toolCallCancellation"]);r!=null&&p(t,["toolCallCancellation"],rL(r));const u=d(i,["usageMetadata"]);u!=null&&p(t,["usageMetadata"],uL(u));const c=d(i,["goAway"]);c!=null&&p(t,["goAway"],dL(c));const f=d(i,["sessionResumptionUpdate"]);return f!=null&&p(t,["sessionResumptionUpdate"],hL(f)),t}function mL(i){const t={},e=d(i,["setupComplete"]);e!=null&&p(t,["setupComplete"],H2(e));const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],nL(n));const o=d(i,["toolCall"]);o!=null&&p(t,["toolCall"],aL(o));const r=d(i,["toolCallCancellation"]);r!=null&&p(t,["toolCallCancellation"],lL(r));const u=d(i,["usageMetadata"]);u!=null&&p(t,["usageMetadata"],cL(u));const c=d(i,["goAway"]);c!=null&&p(t,["goAway"],fL(c));const f=d(i,["sessionResumptionUpdate"]);return f!=null&&p(t,["sessionResumptionUpdate"],pL(f)),t}function yL(){return{}}function vL(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["weight"]);return n!=null&&p(t,["weight"],n),t}function AL(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>vL(o))),p(t,["weightedPrompts"],n)}return t}function TL(i){const t={},e=d(i,["temperature"]);e!=null&&p(t,["temperature"],e);const n=d(i,["topK"]);n!=null&&p(t,["topK"],n);const o=d(i,["seed"]);o!=null&&p(t,["seed"],o);const r=d(i,["guidance"]);r!=null&&p(t,["guidance"],r);const u=d(i,["bpm"]);u!=null&&p(t,["bpm"],u);const c=d(i,["density"]);c!=null&&p(t,["density"],c);const f=d(i,["brightness"]);f!=null&&p(t,["brightness"],f);const h=d(i,["scale"]);h!=null&&p(t,["scale"],h);const y=d(i,["muteBass"]);y!=null&&p(t,["muteBass"],y);const A=d(i,["muteDrums"]);A!=null&&p(t,["muteDrums"],A);const S=d(i,["onlyBassAndDrums"]);return S!=null&&p(t,["onlyBassAndDrums"],S),t}function SL(i){const t={},e=d(i,["clientContent"]);e!=null&&p(t,["clientContent"],AL(e));const n=d(i,["musicGenerationConfig"]);return n!=null&&p(t,["musicGenerationConfig"],TL(n)),t}function EL(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);n!=null&&p(t,["mimeType"],n);const o=d(i,["sourceMetadata"]);return o!=null&&p(t,["sourceMetadata"],SL(o)),t}function CL(i){const t={},e=d(i,["audioChunks"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>EL(o))),p(t,["audioChunks"],n)}return t}function bL(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["filteredReason"]);return n!=null&&p(t,["filteredReason"],n),t}function xL(i){const t={};d(i,["setupComplete"])!=null&&p(t,["setupComplete"],yL());const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],CL(n));const o=d(i,["filteredPrompt"]);return o!=null&&p(t,["filteredPrompt"],bL(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _L(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function wL(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function ML(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function RL(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],_L(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],wL(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],ML(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Qm(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>RL(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function NL(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const D=d(i,["minimum"]);D!=null&&p(t,["minimum"],D);const N=d(i,["nullable"]);N!=null&&p(t,["nullable"],N);const L=d(i,["pattern"]);L!=null&&p(t,["pattern"],L);const P=d(i,["properties"]);P!=null&&p(t,["properties"],P);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const k=d(i,["required"]);k!=null&&p(t,["required"],k);const F=d(i,["title"]);F!=null&&p(t,["title"],F);const B=d(i,["type"]);return B!=null&&p(t,["type"],B),t}function DL(i){const t={};if(d(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const e=d(i,["category"]);e!=null&&p(t,["category"],e);const n=d(i,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function IL(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function PL(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function LL(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],PL(e)),t}function kL(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function UL(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],kL(e)),t}function FL(){return{}}function OL(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>IL(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],LL(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],UL(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],FL());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function BL(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function GL(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function VL(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],GL(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function HL(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],BL(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],VL(n)),t}function zL(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function K_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],zL(e)),t}function qL(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],K_(n)),t}function $L(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>qL(o))),p(t,["speakerVoiceConfigs"],n)}return t}function YL(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],K_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],$L(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function XL(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function JL(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],Qm(bn(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const D=d(t,["responseMimeType"]);D!=null&&p(n,["responseMimeType"],D);const N=d(t,["responseSchema"]);N!=null&&p(n,["responseSchema"],NL(pT(N)));const L=d(t,["responseJsonSchema"]);if(L!=null&&p(n,["responseJsonSchema"],L),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=d(t,["safetySettings"]);if(e!==void 0&&P!=null){let Z=P;Array.isArray(Z)&&(Z=Z.map(ut=>DL(ut))),p(e,["safetySettings"],Z)}const U=d(t,["tools"]);if(e!==void 0&&U!=null){let Z=td(U);Array.isArray(Z)&&(Z=Z.map(ut=>OL(jc(ut)))),p(e,["tools"],Z)}const k=d(t,["toolConfig"]);if(e!==void 0&&k!=null&&p(e,["toolConfig"],HL(k)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=d(t,["cachedContent"]);e!==void 0&&F!=null&&p(e,["cachedContent"],$o(i,F));const B=d(t,["responseModalities"]);B!=null&&p(n,["responseModalities"],B);const q=d(t,["mediaResolution"]);q!=null&&p(n,["mediaResolution"],q);const Y=d(t,["speechConfig"]);if(Y!=null&&p(n,["speechConfig"],YL(gT(Y))),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=d(t,["thinkingConfig"]);return Q!=null&&p(n,["thinkingConfig"],XL(Q)),n}function Gx(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>Qm(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["generationConfig"],JL(i,r,e)),e}function KL(i,t){const e={},n=d(i,["taskType"]);t!==void 0&&n!=null&&p(t,["requests[]","taskType"],n);const o=d(i,["title"]);t!==void 0&&o!=null&&p(t,["requests[]","title"],o);const r=d(i,["outputDimensionality"]);if(t!==void 0&&r!=null&&p(t,["requests[]","outputDimensionality"],r),d(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return e}function WL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);o!=null&&p(e,["requests[]","content"],I_(i,o));const r=d(t,["config"]);r!=null&&p(e,["config"],KL(r,e));const u=d(t,["model"]);return u!==void 0&&p(e,["requests[]","model"],te(i,u)),e}function QL(i,t){const e={};if(d(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=d(i,["numberOfImages"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const o=d(i,["aspectRatio"]);t!==void 0&&o!=null&&p(t,["parameters","aspectRatio"],o);const r=d(i,["guidanceScale"]);if(t!==void 0&&r!=null&&p(t,["parameters","guidanceScale"],r),d(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=d(i,["safetyFilterLevel"]);t!==void 0&&u!=null&&p(t,["parameters","safetySetting"],u);const c=d(i,["personGeneration"]);t!==void 0&&c!=null&&p(t,["parameters","personGeneration"],c);const f=d(i,["includeSafetyAttributes"]);t!==void 0&&f!=null&&p(t,["parameters","includeSafetyAttributes"],f);const h=d(i,["includeRaiReason"]);t!==void 0&&h!=null&&p(t,["parameters","includeRaiReason"],h);const y=d(i,["language"]);t!==void 0&&y!=null&&p(t,["parameters","language"],y);const A=d(i,["outputMimeType"]);t!==void 0&&A!=null&&p(t,["parameters","outputOptions","mimeType"],A);const S=d(i,["outputCompressionQuality"]);if(t!==void 0&&S!=null&&p(t,["parameters","outputOptions","compressionQuality"],S),d(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return e}function ZL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["config"]);return r!=null&&p(e,["config"],QL(r,e)),e}function jL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function tk(i,t,e){const n={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const r=d(t,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const u=d(t,["filter"]);e!==void 0&&u!=null&&p(e,["_query","filter"],u);const c=d(t,["queryBase"]);return e!==void 0&&c!=null&&p(e,["_url","models_url"],k_(i,c)),n}function ek(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],tk(i,n,e)),e}function nk(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);t!==void 0&&o!=null&&p(t,["description"],o);const r=d(i,["defaultCheckpointId"]);return t!==void 0&&r!=null&&p(t,["defaultCheckpointId"],r),e}function ik(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],nk(o,e)),e}function sk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function ok(i){const t={};if(d(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function ak(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>Qm(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],ok(r)),e}function rk(i){const t={};if(d(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const e=d(i,["imageBytes"]);e!=null&&p(t,["bytesBase64Encoded"],Yo(e));const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function lk(i,t){const e={},n=d(i,["numberOfVideos"]);if(t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n),d(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=d(i,["durationSeconds"]);if(t!==void 0&&o!=null&&p(t,["parameters","durationSeconds"],o),d(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=d(i,["aspectRatio"]);if(t!==void 0&&r!=null&&p(t,["parameters","aspectRatio"],r),d(i,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=d(i,["personGeneration"]);if(t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u),d(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=d(i,["negativePrompt"]);t!==void 0&&c!=null&&p(t,["parameters","negativePrompt"],c);const f=d(i,["enhancePrompt"]);if(t!==void 0&&f!=null&&p(t,["parameters","enhancePrompt"],f),d(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(d(i,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(d(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return e}function uk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["image"]);if(r!=null&&p(e,["instances[0]","image"],rk(r)),d(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const u=d(t,["config"]);return u!=null&&p(e,["config"],lk(u,e)),e}function ck(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function dk(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function fk(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function hk(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],ck(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],dk(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],fk(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function nd(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>hk(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function pk(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const D=d(i,["minimum"]);D!=null&&p(t,["minimum"],D);const N=d(i,["nullable"]);N!=null&&p(t,["nullable"],N);const L=d(i,["pattern"]);L!=null&&p(t,["pattern"],L);const P=d(i,["properties"]);P!=null&&p(t,["properties"],P);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const k=d(i,["required"]);k!=null&&p(t,["required"],k);const F=d(i,["title"]);F!=null&&p(t,["title"],F);const B=d(i,["type"]);return B!=null&&p(t,["type"],B),t}function gk(i){const t={},e=d(i,["featureSelectionPreference"]);return e!=null&&p(t,["featureSelectionPreference"],e),t}function mk(i){const t={},e=d(i,["method"]);e!=null&&p(t,["method"],e);const n=d(i,["category"]);n!=null&&p(t,["category"],n);const o=d(i,["threshold"]);return o!=null&&p(t,["threshold"],o),t}function yk(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function vk(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function Ak(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],vk(e)),t}function Tk(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function Sk(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],Tk(e)),t}function Ek(){return{}}function Ck(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function bk(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],Ck(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function xk(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],bk(e)),t}function _k(){return{}}function W_(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>yk(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],Ak(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],Sk(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],Ek());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],xk(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],_k());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function wk(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function Mk(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function Rk(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],Mk(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function Nk(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],wk(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],Rk(n)),t}function Dk(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function Ik(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],Dk(e)),t}function Pk(i){const t={},e=d(i,["voiceConfig"]);if(e!=null&&p(t,["voiceConfig"],Ik(e)),d(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function Lk(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function kk(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],nd(bn(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const D=d(t,["responseMimeType"]);D!=null&&p(n,["responseMimeType"],D);const N=d(t,["responseSchema"]);N!=null&&p(n,["responseSchema"],pk(pT(N)));const L=d(t,["responseJsonSchema"]);L!=null&&p(n,["responseJsonSchema"],L);const P=d(t,["routingConfig"]);P!=null&&p(n,["routingConfig"],P);const U=d(t,["modelSelectionConfig"]);U!=null&&p(n,["modelConfig"],gk(U));const k=d(t,["safetySettings"]);if(e!==void 0&&k!=null){let yt=k;Array.isArray(yt)&&(yt=yt.map(G=>mk(G))),p(e,["safetySettings"],yt)}const F=d(t,["tools"]);if(e!==void 0&&F!=null){let yt=td(F);Array.isArray(yt)&&(yt=yt.map(G=>W_(jc(G)))),p(e,["tools"],yt)}const B=d(t,["toolConfig"]);e!==void 0&&B!=null&&p(e,["toolConfig"],Nk(B));const q=d(t,["labels"]);e!==void 0&&q!=null&&p(e,["labels"],q);const Y=d(t,["cachedContent"]);e!==void 0&&Y!=null&&p(e,["cachedContent"],$o(i,Y));const Q=d(t,["responseModalities"]);Q!=null&&p(n,["responseModalities"],Q);const Z=d(t,["mediaResolution"]);Z!=null&&p(n,["mediaResolution"],Z);const ut=d(t,["speechConfig"]);ut!=null&&p(n,["speechConfig"],Pk(gT(ut)));const St=d(t,["audioTimestamp"]);St!=null&&p(n,["audioTimestamp"],St);const gt=d(t,["thinkingConfig"]);return gt!=null&&p(n,["thinkingConfig"],Lk(gt)),n}function Vx(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>nd(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["generationConfig"],kk(i,r,e)),e}function Uk(i,t){const e={},n=d(i,["taskType"]);t!==void 0&&n!=null&&p(t,["instances[]","task_type"],n);const o=d(i,["title"]);t!==void 0&&o!=null&&p(t,["instances[]","title"],o);const r=d(i,["outputDimensionality"]);t!==void 0&&r!=null&&p(t,["parameters","outputDimensionality"],r);const u=d(i,["mimeType"]);t!==void 0&&u!=null&&p(t,["instances[]","mimeType"],u);const c=d(i,["autoTruncate"]);return t!==void 0&&c!=null&&p(t,["parameters","autoTruncate"],c),e}function Fk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);o!=null&&p(e,["instances[]","content"],I_(i,o));const r=d(t,["config"]);return r!=null&&p(e,["config"],Uk(r,e)),e}function Ok(i,t){const e={},n=d(i,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const o=d(i,["negativePrompt"]);t!==void 0&&o!=null&&p(t,["parameters","negativePrompt"],o);const r=d(i,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const u=d(i,["aspectRatio"]);t!==void 0&&u!=null&&p(t,["parameters","aspectRatio"],u);const c=d(i,["guidanceScale"]);t!==void 0&&c!=null&&p(t,["parameters","guidanceScale"],c);const f=d(i,["seed"]);t!==void 0&&f!=null&&p(t,["parameters","seed"],f);const h=d(i,["safetyFilterLevel"]);t!==void 0&&h!=null&&p(t,["parameters","safetySetting"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["includeSafetyAttributes"]);t!==void 0&&A!=null&&p(t,["parameters","includeSafetyAttributes"],A);const S=d(i,["includeRaiReason"]);t!==void 0&&S!=null&&p(t,["parameters","includeRaiReason"],S);const E=d(i,["language"]);t!==void 0&&E!=null&&p(t,["parameters","language"],E);const b=d(i,["outputMimeType"]);t!==void 0&&b!=null&&p(t,["parameters","outputOptions","mimeType"],b);const x=d(i,["outputCompressionQuality"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","compressionQuality"],x);const D=d(i,["addWatermark"]);t!==void 0&&D!=null&&p(t,["parameters","addWatermark"],D);const N=d(i,["enhancePrompt"]);return t!==void 0&&N!=null&&p(t,["parameters","enhancePrompt"],N),e}function Bk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["config"]);return r!=null&&p(e,["config"],Ok(r,e)),e}function Zm(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["imageBytes"]);n!=null&&p(t,["bytesBase64Encoded"],Yo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function Gk(i){const t={},e=d(i,["maskMode"]);e!=null&&p(t,["maskMode"],e);const n=d(i,["segmentationClasses"]);n!=null&&p(t,["maskClasses"],n);const o=d(i,["maskDilation"]);return o!=null&&p(t,["dilation"],o),t}function Vk(i){const t={},e=d(i,["controlType"]);e!=null&&p(t,["controlType"],e);const n=d(i,["enableControlImageComputation"]);return n!=null&&p(t,["computeControl"],n),t}function Hk(i){const t={},e=d(i,["styleDescription"]);return e!=null&&p(t,["styleDescription"],e),t}function zk(i){const t={},e=d(i,["subjectType"]);e!=null&&p(t,["subjectType"],e);const n=d(i,["subjectDescription"]);return n!=null&&p(t,["subjectDescription"],n),t}function qk(i){const t={},e=d(i,["referenceImage"]);e!=null&&p(t,["referenceImage"],Zm(e));const n=d(i,["referenceId"]);n!=null&&p(t,["referenceId"],n);const o=d(i,["referenceType"]);o!=null&&p(t,["referenceType"],o);const r=d(i,["maskImageConfig"]);r!=null&&p(t,["maskImageConfig"],Gk(r));const u=d(i,["controlImageConfig"]);u!=null&&p(t,["controlImageConfig"],Vk(u));const c=d(i,["styleImageConfig"]);c!=null&&p(t,["styleImageConfig"],Hk(c));const f=d(i,["subjectImageConfig"]);return f!=null&&p(t,["subjectImageConfig"],zk(f)),t}function $k(i,t){const e={},n=d(i,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const o=d(i,["negativePrompt"]);t!==void 0&&o!=null&&p(t,["parameters","negativePrompt"],o);const r=d(i,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const u=d(i,["aspectRatio"]);t!==void 0&&u!=null&&p(t,["parameters","aspectRatio"],u);const c=d(i,["guidanceScale"]);t!==void 0&&c!=null&&p(t,["parameters","guidanceScale"],c);const f=d(i,["seed"]);t!==void 0&&f!=null&&p(t,["parameters","seed"],f);const h=d(i,["safetyFilterLevel"]);t!==void 0&&h!=null&&p(t,["parameters","safetySetting"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["includeSafetyAttributes"]);t!==void 0&&A!=null&&p(t,["parameters","includeSafetyAttributes"],A);const S=d(i,["includeRaiReason"]);t!==void 0&&S!=null&&p(t,["parameters","includeRaiReason"],S);const E=d(i,["language"]);t!==void 0&&E!=null&&p(t,["parameters","language"],E);const b=d(i,["outputMimeType"]);t!==void 0&&b!=null&&p(t,["parameters","outputOptions","mimeType"],b);const x=d(i,["outputCompressionQuality"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","compressionQuality"],x);const D=d(i,["editMode"]);t!==void 0&&D!=null&&p(t,["parameters","editMode"],D);const N=d(i,["baseSteps"]);return t!==void 0&&N!=null&&p(t,["parameters","editConfig","baseSteps"],N),e}function Yk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["referenceImages"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>qk(f))),p(e,["instances[0]","referenceImages"],c)}const u=d(t,["config"]);return u!=null&&p(e,["config"],$k(u,e)),e}function Xk(i,t){const e={},n=d(i,["includeRaiReason"]);t!==void 0&&n!=null&&p(t,["parameters","includeRaiReason"],n);const o=d(i,["outputMimeType"]);t!==void 0&&o!=null&&p(t,["parameters","outputOptions","mimeType"],o);const r=d(i,["outputCompressionQuality"]);t!==void 0&&r!=null&&p(t,["parameters","outputOptions","compressionQuality"],r);const u=d(i,["enhanceInputImage"]);t!==void 0&&u!=null&&p(t,["parameters","upscaleConfig","enhanceInputImage"],u);const c=d(i,["imagePreservationFactor"]);t!==void 0&&c!=null&&p(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const f=d(i,["numberOfImages"]);t!==void 0&&f!=null&&p(t,["parameters","sampleCount"],f);const h=d(i,["mode"]);return t!==void 0&&h!=null&&p(t,["parameters","mode"],h),e}function Jk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["image"]);o!=null&&p(e,["instances[0]","image"],Zm(o));const r=d(t,["upscaleFactor"]);r!=null&&p(e,["parameters","upscaleConfig","upscaleFactor"],r);const u=d(t,["config"]);return u!=null&&p(e,["config"],Xk(u,e)),e}function Kk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function Wk(i,t,e){const n={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const r=d(t,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const u=d(t,["filter"]);e!==void 0&&u!=null&&p(e,["_query","filter"],u);const c=d(t,["queryBase"]);return e!==void 0&&c!=null&&p(e,["_url","models_url"],k_(i,c)),n}function Qk(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],Wk(i,n,e)),e}function Zk(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);t!==void 0&&o!=null&&p(t,["description"],o);const r=d(i,["defaultCheckpointId"]);return t!==void 0&&r!=null&&p(t,["defaultCheckpointId"],r),e}function jk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],Zk(o,e)),e}function tU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function eU(i,t){const e={},n=d(i,["systemInstruction"]);t!==void 0&&n!=null&&p(t,["systemInstruction"],nd(bn(n)));const o=d(i,["tools"]);if(t!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>W_(c))),p(t,["tools"],u)}const r=d(i,["generationConfig"]);return t!==void 0&&r!=null&&p(t,["generationConfig"],r),e}function nU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>nd(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],eU(r,e)),e}function iU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["contents"]);if(o!=null){let u=Xi(o);Array.isArray(u)&&(u=u.map(c=>nd(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],r),e}function sU(i){const t={},e=d(i,["uri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["videoBytes"]);n!=null&&p(t,["bytesBase64Encoded"],Yo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function oU(i,t){const e={},n=d(i,["numberOfVideos"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const o=d(i,["outputGcsUri"]);t!==void 0&&o!=null&&p(t,["parameters","storageUri"],o);const r=d(i,["fps"]);t!==void 0&&r!=null&&p(t,["parameters","fps"],r);const u=d(i,["durationSeconds"]);t!==void 0&&u!=null&&p(t,["parameters","durationSeconds"],u);const c=d(i,["seed"]);t!==void 0&&c!=null&&p(t,["parameters","seed"],c);const f=d(i,["aspectRatio"]);t!==void 0&&f!=null&&p(t,["parameters","aspectRatio"],f);const h=d(i,["resolution"]);t!==void 0&&h!=null&&p(t,["parameters","resolution"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["pubsubTopic"]);t!==void 0&&A!=null&&p(t,["parameters","pubsubTopic"],A);const S=d(i,["negativePrompt"]);t!==void 0&&S!=null&&p(t,["parameters","negativePrompt"],S);const E=d(i,["enhancePrompt"]);t!==void 0&&E!=null&&p(t,["parameters","enhancePrompt"],E);const b=d(i,["generateAudio"]);t!==void 0&&b!=null&&p(t,["parameters","generateAudio"],b);const x=d(i,["lastFrame"]);t!==void 0&&x!=null&&p(t,["instances[0]","lastFrame"],Zm(x));const D=d(i,["compressionQuality"]);return t!==void 0&&D!=null&&p(t,["parameters","compressionQuality"],D),e}function aU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],te(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["image"]);r!=null&&p(e,["instances[0]","image"],Zm(r));const u=d(t,["video"]);u!=null&&p(e,["instances[0]","video"],sU(u));const c=d(t,["config"]);return c!=null&&p(e,["config"],oU(c,e)),e}function rU(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function lU(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function uU(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function cU(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],rU(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],lU(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],uU(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function dU(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>cU(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function fU(i){const t={},e=d(i,["citationSources"]);return e!=null&&p(t,["citations"],e),t}function hU(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function pU(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>hU(o))),p(t,["urlMetadata"],n)}return t}function gU(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],dU(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],fU(n));const o=d(i,["tokenCount"]);o!=null&&p(t,["tokenCount"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],pU(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function Hx(i){const t={},e=d(i,["candidates"]);if(e!=null){let u=e;Array.isArray(u)&&(u=u.map(c=>gU(c))),p(t,["candidates"],u)}const n=d(i,["modelVersion"]);n!=null&&p(t,["modelVersion"],n);const o=d(i,["promptFeedback"]);o!=null&&p(t,["promptFeedback"],o);const r=d(i,["usageMetadata"]);return r!=null&&p(t,["usageMetadata"],r),t}function mU(i){const t={},e=d(i,["values"]);return e!=null&&p(t,["values"],e),t}function yU(){return{}}function vU(i){const t={},e=d(i,["embeddings"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>mU(r))),p(t,["embeddings"],o)}return d(i,["metadata"])!=null&&p(t,["metadata"],yU()),t}function AU(i){const t={},e=d(i,["bytesBase64Encoded"]);e!=null&&p(t,["imageBytes"],Yo(e));const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function Q_(i){const t={},e=d(i,["safetyAttributes","categories"]);e!=null&&p(t,["categories"],e);const n=d(i,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const o=d(i,["contentType"]);return o!=null&&p(t,["contentType"],o),t}function TU(i){const t={},e=d(i,["_self"]);e!=null&&p(t,["image"],AU(e));const n=d(i,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const o=d(i,["_self"]);return o!=null&&p(t,["safetyAttributes"],Q_(o)),t}function SU(i){const t={},e=d(i,["predictions"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>TU(r))),p(t,["generatedImages"],o)}const n=d(i,["positivePromptSafetyAttributes"]);return n!=null&&p(t,["positivePromptSafetyAttributes"],Q_(n)),t}function EU(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["updateTime"]);return o!=null&&p(t,["updateTime"],o),t}function H0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["version"]);r!=null&&p(t,["version"],r);const u=d(i,["_self"]);u!=null&&p(t,["tunedModelInfo"],EU(u));const c=d(i,["inputTokenLimit"]);c!=null&&p(t,["inputTokenLimit"],c);const f=d(i,["outputTokenLimit"]);f!=null&&p(t,["outputTokenLimit"],f);const h=d(i,["supportedGenerationMethods"]);return h!=null&&p(t,["supportedActions"],h),t}function CU(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["_self"]);if(n!=null){let o=U_(n);Array.isArray(o)&&(o=o.map(r=>H0(r))),p(t,["models"],o)}return t}function bU(){return{}}function xU(i){const t={},e=d(i,["totalTokens"]);e!=null&&p(t,["totalTokens"],e);const n=d(i,["cachedContentTokenCount"]);return n!=null&&p(t,["cachedContentTokenCount"],n),t}function _U(i){const t={},e=d(i,["video","uri"]);e!=null&&p(t,["uri"],e);const n=d(i,["video","encodedVideo"]);n!=null&&p(t,["videoBytes"],Yo(n));const o=d(i,["encoding"]);return o!=null&&p(t,["mimeType"],o),t}function wU(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],_U(e)),t}function MU(i){const t={},e=d(i,["generatedSamples"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>wU(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function RU(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response","generateVideoResponse"]);return u!=null&&p(t,["response"],MU(u)),t}function NU(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function DU(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function IU(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function PU(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],NU(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],DU(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],IU(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function LU(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>PU(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function kU(i){const t={},e=d(i,["citations"]);return e!=null&&p(t,["citations"],e),t}function UU(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function FU(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>UU(o))),p(t,["urlMetadata"],n)}return t}function OU(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],LU(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],kU(n));const o=d(i,["finishMessage"]);o!=null&&p(t,["finishMessage"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],FU(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function zx(i){const t={},e=d(i,["candidates"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>OU(h))),p(t,["candidates"],f)}const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["responseId"]);o!=null&&p(t,["responseId"],o);const r=d(i,["modelVersion"]);r!=null&&p(t,["modelVersion"],r);const u=d(i,["promptFeedback"]);u!=null&&p(t,["promptFeedback"],u);const c=d(i,["usageMetadata"]);return c!=null&&p(t,["usageMetadata"],c),t}function BU(i){const t={},e=d(i,["truncated"]);e!=null&&p(t,["truncated"],e);const n=d(i,["token_count"]);return n!=null&&p(t,["tokenCount"],n),t}function GU(i){const t={},e=d(i,["values"]);e!=null&&p(t,["values"],e);const n=d(i,["statistics"]);return n!=null&&p(t,["statistics"],BU(n)),t}function VU(i){const t={},e=d(i,["billableCharacterCount"]);return e!=null&&p(t,["billableCharacterCount"],e),t}function HU(i){const t={},e=d(i,["predictions[]","embeddings"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>GU(r))),p(t,["embeddings"],o)}const n=d(i,["metadata"]);return n!=null&&p(t,["metadata"],VU(n)),t}function zU(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["imageBytes"],Yo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function Z_(i){const t={},e=d(i,["safetyAttributes","categories"]);e!=null&&p(t,["categories"],e);const n=d(i,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const o=d(i,["contentType"]);return o!=null&&p(t,["contentType"],o),t}function yT(i){const t={},e=d(i,["_self"]);e!=null&&p(t,["image"],zU(e));const n=d(i,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const o=d(i,["_self"]);o!=null&&p(t,["safetyAttributes"],Z_(o));const r=d(i,["prompt"]);return r!=null&&p(t,["enhancedPrompt"],r),t}function qU(i){const t={},e=d(i,["predictions"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>yT(r))),p(t,["generatedImages"],o)}const n=d(i,["positivePromptSafetyAttributes"]);return n!=null&&p(t,["positivePromptSafetyAttributes"],Z_(n)),t}function $U(i){const t={},e=d(i,["predictions"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>yT(o))),p(t,["generatedImages"],n)}return t}function YU(i){const t={},e=d(i,["predictions"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>yT(o))),p(t,["generatedImages"],n)}return t}function XU(i){const t={},e=d(i,["endpoint"]);e!=null&&p(t,["name"],e);const n=d(i,["deployedModelId"]);return n!=null&&p(t,["deployedModelId"],n),t}function JU(i){const t={},e=d(i,["labels","google-vertex-llm-tuning-base-model-id"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["updateTime"]);return o!=null&&p(t,["updateTime"],o),t}function KU(i){const t={},e=d(i,["checkpointId"]);e!=null&&p(t,["checkpointId"],e);const n=d(i,["epoch"]);n!=null&&p(t,["epoch"],n);const o=d(i,["step"]);return o!=null&&p(t,["step"],o),t}function z0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["versionId"]);r!=null&&p(t,["version"],r);const u=d(i,["deployedModels"]);if(u!=null){let A=u;Array.isArray(A)&&(A=A.map(S=>XU(S))),p(t,["endpoints"],A)}const c=d(i,["labels"]);c!=null&&p(t,["labels"],c);const f=d(i,["_self"]);f!=null&&p(t,["tunedModelInfo"],JU(f));const h=d(i,["defaultCheckpointId"]);h!=null&&p(t,["defaultCheckpointId"],h);const y=d(i,["checkpoints"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(S=>KU(S))),p(t,["checkpoints"],A)}return t}function WU(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["_self"]);if(n!=null){let o=U_(n);Array.isArray(o)&&(o=o.map(r=>z0(r))),p(t,["models"],o)}return t}function QU(){return{}}function ZU(i){const t={},e=d(i,["totalTokens"]);return e!=null&&p(t,["totalTokens"],e),t}function jU(i){const t={},e=d(i,["tokensInfo"]);return e!=null&&p(t,["tokensInfo"],e),t}function tF(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["uri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],Yo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function eF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],tF(e)),t}function nF(i){const t={},e=d(i,["videos"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>eF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function iF(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response"]);return u!=null&&p(t,["response"],nF(u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sF="Content-Type",oF="X-Server-Timeout",aF="User-Agent",q0="x-goog-api-client",rF="1.9.0",lF=`google-genai-sdk/${rF}`,uF="v1beta1",cF="v1beta",qx=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class dF{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:uF,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:cF,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const o=[this.getRequestUrlInternal(e)];return n&&o.push(this.getBaseResourcePath()),t!==""&&o.push(t),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[u,c]of Object.entries(t.queryParams))o.searchParams.append(u,String(c));let r={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=t.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,e,t.abortSignal),this.unaryApiCall(o,r,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[o,r]of Object.entries(e))typeof r=="object"?n[o]=Object.assign(Object.assign({},n[o]),r):r!==void 0&&(n[o]=r);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=t.body,r=await this.includeExtraHttpOptionsToRequestInit(r,e,t.abortSignal),this.streamApiCall(o,r,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const o=new AbortController,r=o.signal;if(e.timeout&&(e==null?void 0:e.timeout)>0){const u=setTimeout(()=>o.abort(),e.timeout);u&&typeof u.unref=="function"&&u.unref()}n&&n.addEventListener("abort",()=>{o.abort()}),t.signal=r}return e&&e.extraBody!==null&&fF(t,e.extraBody),t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await $x(o),new U0(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await $x(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(t){var e;return $u(this,arguments,function*(){const o=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:c,value:f}=yield he(o.read());if(c){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=r.decode(f,{stream:!0});try{const A=JSON.parse(h);if("error"in A){const S=JSON.parse(JSON.stringify(A.error)),E=S.status,b=S.code,x=`got status: ${E}. ${JSON.stringify(A)}`;if(b>=400&&b<600)throw new Wm({message:x,status:b})}}catch(A){if(A.name==="ApiError")throw A}u+=h;let y=u.match(qx);for(;y;){const A=y[1];try{const S=new Response(A,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield he(new U0(S)),u=u.slice(y[0].length),y=u.match(qx)}catch(S){throw new Error(`exception parsing stream chunk ${A}. ${S}`)}}}}finally{o.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=lF+" "+this.clientOptions.userAgentExtra;return t[aF]=e,t[q0]=e,t[sF]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,o]of Object.entries(t.headers))e.append(n,o);t.timeout&&t.timeout>0&&e.append(oF,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const o={};e!=null&&(o.mimeType=e.mimeType,o.name=e.name,o.displayName=e.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,u=await r.stat(t);o.sizeBytes=String(u.size);const c=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:u.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=c;const f=await this.fetchUploadUrl(o,e);return r.upload(t,f,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let o={};e!=null&&e.httpOptions?o=e.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const r={file:t},u=await this.request({path:At("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(n=u==null?void 0:u.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function $x(i){var t;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const e=i.status;let n;!((t=i.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const o=JSON.stringify(n);throw e>=400&&e<600?new Wm({message:o,status:e}):new Error(o)}}function fF(i,t){if(!t||Object.keys(t).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let e={};if(typeof i.body=="string"&&i.body.length>0)try{const r=JSON.parse(i.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))e=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(r,u){const c=Object.assign({},r);for(const f in u)if(Object.prototype.hasOwnProperty.call(u,f)){const h=u[f],y=c[f];h&&typeof h=="object"&&!Array.isArray(h)&&y&&typeof y=="object"&&!Array.isArray(y)?c[f]=n(y,h):(y&&h&&typeof y!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof y}, New type: ${typeof h}. Overwriting.`),c[f]=h)}return c}const o=n(e,t);i.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hF="mcp_used/unknown";function j_(i){for(const t of i)if(vT(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function tw(i){var t;const e=(t=i[q0])!==null&&t!==void 0?t:"";i[q0]=(e+` ${hF}`).trimStart()}function pF(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>vT(o)))!==null&&n!==void 0?n:!1}function gF(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>!vT(o)))!==null&&n!==void 0?n:!1}function vT(i){return i!==null&&typeof i=="object"&&i instanceof AT}function mF(i,t=100){return $u(this,arguments,function*(){let n,o=0;for(;o<t;){const r=yield he(i.listTools({cursor:n}));for(const u of r.tools)yield yield he(u),o++;if(!r.nextCursor)break;n=r.nextCursor}})}class AT{constructor(t=[],e){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=e}static create(t,e){return new AT(t,e)}async initialize(){var t,e,n,o;if(this.mcpTools.length>0)return;const r={},u=[];for(const y of this.mcpClients)try{for(var c=!0,f=(e=void 0,Rf(mF(y))),h;h=await f.next(),t=h.done,!t;c=!0){o=h.value,c=!1;const A=o;u.push(A);const S=A.name;if(r[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);r[S]=y}}catch(A){e={error:A}}finally{try{!c&&!t&&(n=f.return)&&await n.call(f)}finally{if(e)throw e.error}}this.mcpTools=u,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),dD(this.mcpTools,this.config)}async callTool(t){await this.initialize();const e=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[n.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const u=await o.callTool({name:n.name,arguments:n.args},void 0,r);e.push({functionResponse:{name:n.name,response:u.isError?{error:u}:u}})}return e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function yF(i,t,e){const n=new iD;let o;e.data instanceof Blob?o=JSON.parse(await e.data.text()):o=JSON.parse(e.data);const r=xL(o);Object.assign(n,r),t(n)}class vF{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),u=SF(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${c}`;let h=()=>{};const y=new Promise(P=>{h=P}),A=t.callbacks,S=function(){h({})},E=this.apiClient,b={onopen:S,onmessage:P=>{yF(E,A.onmessage,P)},onerror:(e=A==null?void 0:A.onerror)!==null&&e!==void 0?e:function(P){},onclose:(n=A==null?void 0:A.onclose)!==null&&n!==void 0?n:function(P){}},x=this.webSocketFactory.create(f,TF(u),b);x.connect(),await y;const D=te(this.apiClient,t.model),N=X_({model:D}),L=V0({setup:N});return x.send(JSON.stringify(L)),new AF(x,this.apiClient)}}class AF{constructor(t,e){this.conn=t,this.apiClient=e}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const e=B2(t),n=J_(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const e=G2(t),n=V0(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const e=V0({playbackControl:t});this.conn.send(JSON.stringify(e))}play(){this.sendPlaybackControl(Gu.PLAY)}pause(){this.sendPlaybackControl(Gu.PAUSE)}stop(){this.sendPlaybackControl(Gu.STOP)}resetContext(){this.sendPlaybackControl(Gu.RESET_CONTEXT)}close(){this.conn.close()}}function TF(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function SF(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function CF(i,t,e){const n=new nD;let o;e.data instanceof Blob?o=await e.data.text():e.data instanceof ArrayBuffer?o=new TextDecoder().decode(e.data):o=e.data;const r=JSON.parse(o);if(i.isVertexAI()){const u=mL(r);Object.assign(n,u)}else{const u=gL(r);Object.assign(n,u)}t(n)}class bF{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n,this.music=new vF(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var e,n,o,r,u,c;const f=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let y;const A=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&j_(t.config.tools)&&tw(A);const S=MF(A);if(this.apiClient.isVertexAI())y=`${f}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S);else{const Y=this.apiClient.getApiKey();let Q="BidiGenerateContent",Z="key";Y!=null&&Y.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Q="BidiGenerateContentConstrained",Z="access_token"),y=`${f}/ws/google.ai.generativelanguage.${h}.GenerativeService.${Q}?${Z}=${Y}`}let E=()=>{};const b=new Promise(Y=>{E=Y}),x=t.callbacks,D=function(){var Y;(Y=x==null?void 0:x.onopen)===null||Y===void 0||Y.call(x),E({})},N=this.apiClient,L={onopen:D,onmessage:Y=>{CF(N,x.onmessage,Y)},onerror:(e=x==null?void 0:x.onerror)!==null&&e!==void 0?e:function(Y){},onclose:(n=x==null?void 0:x.onclose)!==null&&n!==void 0?n:function(Y){}},P=this.webSocketFactory.create(y,wF(S),L);P.connect(),await b;let U=te(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const Y=this.apiClient.getProject(),Q=this.apiClient.getLocation();U=`projects/${Y}/locations/${Q}/`+U}let k={};this.apiClient.isVertexAI()&&((o=t.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Tm.AUDIO]}:t.config.responseModalities=[Tm.AUDIO]),!((r=t.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(c=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&c!==void 0?c:[],B=[];for(const Y of F)if(this.isCallableTool(Y)){const Q=Y;B.push(await Q.tool())}else B.push(Y);B.length>0&&(t.config.tools=B);const q={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?k=I2(this.apiClient,q):k=D2(this.apiClient,q),delete k.config,P.send(JSON.stringify(k)),new _F(P,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const xF={turnComplete:!0};class _F{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=Xi(e.turns),t.isVertexAI()?n=n.map(o=>nd(o)):n=n.map(o=>Qm(o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const r of n){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!t.isVertexAI()&&!("id"in r))throw new Error(EF)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},xF),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:O2(t)}:e={realtimeInput:F2(t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function wF(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function MF(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yx=10;function Xx(i){var t,e,n;if(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let o=!1;for(const u of(e=i==null?void 0:i.tools)!==null&&e!==void 0?e:[])if(Hg(u)){o=!0;break}if(!o)return!0;const r=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Hg(i){return"callTool"in i&&typeof i.callTool=="function"}function Jx(i){var t;return!(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RF extends ql{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>{var n,o,r,u,c;const f=await this.processParamsForMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!pF(e)||Xx(e.config))return await this.generateContentInternal(f);if(gF(e))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,y;const A=Xi(f.contents),S=(r=(o=(n=f.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:Yx;let E=0;for(;E<S&&(h=await this.generateContentInternal(f),!(!h.functionCalls||h.functionCalls.length===0));){const b=h.candidates[0].content,x=[];for(const D of(c=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&c!==void 0?c:[])if(Hg(D)){const L=await D.callTool(h.functionCalls);x.push(...L)}E++,y={role:"user",parts:x},f.contents=Xi(f.contents),f.contents.push(b),f.contents.push(y),Jx(f.config)&&(A.push(b),A.push(y))}return Jx(f.config)&&(h.automaticFunctionCallingHistory=A),h},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),Xx(e.config)){const n=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var o;let r;const u=[];if(n!=null&&n.generatedImages)for(const f of n.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((o=f==null?void 0:f.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=f==null?void 0:f.safetyAttributes:u.push(f);let c;return r?c={generatedImages:u,positivePromptSafetyAttributes:r}:c={generatedImages:u},c}),this.list=async e=>{var n;const u={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((n=u.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new rp(Gl.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(u),u)},this.editImage=async e=>{const n={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(n.referenceImages=e.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async e=>{let n={numberOfImages:1,mode:"upscale"};e.config&&(n=Object.assign(Object.assign({},n),e.config));const o={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:n};return await this.upscaleImageInternal(o)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsForMcpUsage(t){var e,n,o;const r=(e=t.config)===null||e===void 0?void 0:e.tools;if(!r)return t;const u=await Promise.all(r.map(async f=>Hg(f)?await f.tool():f)),c={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:u})};if(c.config.tools=u,t.config&&t.config.tools&&j_(t.config.tools)){const f=(o=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&o!==void 0?o:{};let h=Object.assign({},f);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),tw(h),c.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return c}async initAfcToolsMap(t){var e,n,o;const r=new Map;for(const u of(n=(e=t.config)===null||e===void 0?void 0:e.tools)!==null&&n!==void 0?n:[])if(Hg(u)){const c=u,f=await c.tool();for(const h of(o=f.functionDeclarations)!==null&&o!==void 0?o:[]){if(!h.name)throw new Error("Function declaration name is required.");if(r.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);r.set(h.name,c)}}return r}async processAfcStream(t){var e,n,o;const r=(o=(n=(e=t.config)===null||e===void 0?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&o!==void 0?o:Yx;let u=!1,c=0;const f=await this.initAfcToolsMap(t);return function(h,y,A){var S,E;return $u(this,arguments,function*(){for(var b,x,D,N;c<r;){u&&(c++,u=!1);const k=yield he(h.processParamsForMcpUsage(A)),F=yield he(h.generateContentStreamInternal(k)),B=[],q=[];try{for(var L=!0,P=(x=void 0,Rf(F)),U;U=yield he(P.next()),b=U.done,!b;L=!0){N=U.value,L=!1;const Y=N;if(yield yield he(Y),Y.candidates&&(!((S=Y.candidates[0])===null||S===void 0)&&S.content)){q.push(Y.candidates[0].content);for(const Q of(E=Y.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(c<r&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(Q.functionCall.name)){const Z=yield he(y.get(Q.functionCall.name).callTool([Q.functionCall]));B.push(...Z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(Y){x={error:Y}}finally{try{!L&&!b&&(D=P.return)&&(yield he(D.call(P)))}finally{if(x)throw x.error}}if(B.length>0){u=!0;const Y=new of;Y.candidates=[{content:{role:"user",parts:B}}],yield yield he(Y);const Q=[];Q.push(...q),Q.push({role:"user",parts:B});const Z=Xi(A.contents).concat(Q);A.contents=Z}else break}})}(this,f,t)}async generateContentInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Vx(this.apiClient,t);return c=At("{model}:generateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=zx(y),S=new of;return Object.assign(S,A),S})}else{const h=Gx(this.apiClient,t);return c=At("{model}:generateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=Hx(y),S=new of;return Object.assign(S,A),S})}}async generateContentStreamInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Vx(this.apiClient,t);return c=At("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),u.then(function(A){return $u(this,arguments,function*(){var S,E,b,x;try{for(var D=!0,N=Rf(A),L;L=yield he(N.next()),S=L.done,!S;D=!0){x=L.value,D=!1;const U=zx(yield he(x.json())),k=new of;Object.assign(k,U),yield yield he(k)}}catch(P){E={error:P}}finally{try{!D&&!S&&(b=N.return)&&(yield he(b.call(N)))}finally{if(E)throw E.error}}})})}else{const h=Gx(this.apiClient,t);return c=At("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),u.then(function(A){return $u(this,arguments,function*(){var S,E,b,x;try{for(var D=!0,N=Rf(A),L;L=yield he(N.next()),S=L.done,!S;D=!0){x=L.value,D=!1;const U=Hx(yield he(x.json())),k=new of;Object.assign(k,U),yield yield he(k)}}catch(P){E={error:P}}finally{try{!D&&!S&&(b=N.return)&&(yield he(b.call(N)))}finally{if(E)throw E.error}}})})}}async embedContent(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Fk(this.apiClient,t);return c=At("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=HU(y),S=new Tx;return Object.assign(S,A),S})}else{const h=WL(this.apiClient,t);return c=At("{model}:batchEmbedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=vU(y),S=new Tx;return Object.assign(S,A),S})}}async generateImagesInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Bk(this.apiClient,t);return c=At("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=qU(y),S=new Sx;return Object.assign(S,A),S})}else{const h=ZL(this.apiClient,t);return c=At("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=SU(y),S=new Sx;return Object.assign(S,A),S})}}async editImageInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=Yk(this.apiClient,t);return r=At("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=$U(f),y=new WN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=Jk(this.apiClient,t);return r=At("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=YU(f),y=new QN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Kk(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>z0(y))}else{const h=jL(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>H0(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Qk(this.apiClient,t);return c=At("{models_url}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=WU(y),S=new Ex;return Object.assign(S,A),S})}else{const h=ek(this.apiClient,t);return c=At("{models_url}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=CU(y),S=new Ex;return Object.assign(S,A),S})}}async update(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=jk(this.apiClient,t);return c=At("{model}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>z0(y))}else{const h=ik(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>H0(y))}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=tU(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(()=>{const y=QU(),A=new Cx;return Object.assign(A,y),A})}else{const h=sk(this.apiClient,t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(()=>{const y=bU(),A=new Cx;return Object.assign(A,y),A})}}async countTokens(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=nU(this.apiClient,t);return c=At("{model}:countTokens",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=ZU(y),S=new bx;return Object.assign(S,A),S})}else{const h=ak(this.apiClient,t);return c=At("{model}:countTokens",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=xU(y),S=new bx;return Object.assign(S,A),S})}}async computeTokens(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=iU(this.apiClient,t);return r=At("{model}:computeTokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=jU(f),y=new ZN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=aU(this.apiClient,t);return c=At("{model}:predictLongRunning",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>iF(y))}else{const h=uk(this.apiClient,t);return c=At("{model}:predictLongRunning",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>RU(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["_url","operationName"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function DF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["_url","operationName"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function IF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["operationName"],e);const n=d(i,["resourceName"]);n!=null&&p(t,["_url","resourceName"],n);const o=d(i,["config"]);return o!=null&&p(t,["config"],o),t}function PF(i){const t={},e=d(i,["video","uri"]);e!=null&&p(t,["uri"],e);const n=d(i,["video","encodedVideo"]);n!=null&&p(t,["videoBytes"],Yo(n));const o=d(i,["encoding"]);return o!=null&&p(t,["mimeType"],o),t}function LF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],PF(e)),t}function kF(i){const t={},e=d(i,["generatedSamples"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>LF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function UF(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response","generateVideoResponse"]);return u!=null&&p(t,["response"],kF(u)),t}function FF(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["uri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],Yo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function OF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],FF(e)),t}function BF(i){const t={},e=d(i,["videos"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>OF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function Kx(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response"]);return u!=null&&p(t,["response"],BF(u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GF extends ql{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=e.name.split("/operations/")[0];let r;return n&&"httpOptions"in n&&(r=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:o,config:{httpOptions:r}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=DF(t);return c=At("{operationName}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Kx(y))}else{const h=NF(t);return c=At("{operationName}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>UF(y))}}async fetchPredictVideosOperationInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=IF(t);return r=At("{resourceName}:fetchPredictOperation",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>Kx(f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VF(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function ew(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],VF(e)),t}function HF(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],ew(n)),t}function zF(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>HF(o))),p(t,["speakerVoiceConfigs"],n)}return t}function qF(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],ew(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],zF(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function $F(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function YF(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function XF(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function JF(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],$F(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],YF(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],XF(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function KF(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>JF(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function WF(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function QF(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function ZF(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],QF(e)),t}function jF(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function tO(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],jF(e)),t}function eO(){return{}}function nO(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>WF(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],ZF(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],tO(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],eO());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function iO(i){const t={},e=d(i,["handle"]);if(e!=null&&p(t,["handle"],e),d(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Wx(){return{}}function sO(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function oO(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],sO(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function aO(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function rO(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],aO(n)),t}function lO(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function uO(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],qF(mT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],KF(bn(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let k=td(b);Array.isArray(k)&&(k=k.map(F=>nO(jc(F)))),p(t,["setup","tools"],k)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],iO(x));const D=d(i,["inputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","inputAudioTranscription"],Wx());const N=d(i,["outputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","outputAudioTranscription"],Wx());const L=d(i,["realtimeInputConfig"]);t!==void 0&&L!=null&&p(t,["setup","realtimeInputConfig"],oO(L));const P=d(i,["contextWindowCompression"]);t!==void 0&&P!=null&&p(t,["setup","contextWindowCompression"],rO(P));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],lO(U)),e}function cO(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],te(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],uO(o,e)),e}function dO(i,t,e){const n={},o=d(t,["expireTime"]);e!==void 0&&o!=null&&p(e,["expireTime"],o);const r=d(t,["newSessionExpireTime"]);e!==void 0&&r!=null&&p(e,["newSessionExpireTime"],r);const u=d(t,["uses"]);e!==void 0&&u!=null&&p(e,["uses"],u);const c=d(t,["liveConnectConstraints"]);e!==void 0&&c!=null&&p(e,["bidiGenerateContentSetup"],cO(i,c));const f=d(t,["lockAdditionalFields"]);return e!==void 0&&f!=null&&p(e,["fieldMask"],f),n}function fO(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],dO(i,n,e)),e}function hO(i){const t={},e=d(i,["name"]);return e!=null&&p(t,["name"],e),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pO(i){const t=[];for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const n=i[e];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const o=Object.keys(n).map(r=>`${e}.${r}`);t.push(...o)}else t.push(e)}return t.join(",")}function gO(i,t){let e=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const r=n.setup;typeof r=="object"&&r!==null?(i.bidiGenerateContentSetup=r,e=r):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const o=i.fieldMask;if(e){const r=pO(e);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)r?i.fieldMask=r:delete i.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];o.length>0&&(c=o.map(h=>u.includes(h)?`generationConfig.${h}`:h));const f=[];r&&f.push(r),c.length>0&&f.push(...c),f.length>0?i.fieldMask=f.join(","):delete i.fieldMask}else delete i.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?i.fieldMask=o.join(","):delete i.fieldMask;return i}class mO extends ql{constructor(t){super(),this.apiClient=t}async create(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=fO(this.apiClient,t);r=At("auth_tokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query;const f=gO(c,t.config);return o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),o.then(h=>hO(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","name"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function vO(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function AO(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],vO(e,t)),t}function TO(i){const t={},e=d(i,["textInput"]);e!=null&&p(t,["textInput"],e);const n=d(i,["output"]);return n!=null&&p(t,["output"],n),t}function SO(i){const t={};if(d(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const e=d(i,["examples"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>TO(o))),p(t,["examples","examples"],n)}return t}function EO(i,t){const e={};if(d(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const n=d(i,["tunedModelDisplayName"]);if(t!==void 0&&n!=null&&p(t,["displayName"],n),d(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=d(i,["epochCount"]);t!==void 0&&o!=null&&p(t,["tuningTask","hyperparameters","epochCount"],o);const r=d(i,["learningRateMultiplier"]);if(r!=null&&p(e,["tuningTask","hyperparameters","learningRateMultiplier"],r),d(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=d(i,["batchSize"]);t!==void 0&&u!=null&&p(t,["tuningTask","hyperparameters","batchSize"],u);const c=d(i,["learningRate"]);return t!==void 0&&c!=null&&p(t,["tuningTask","hyperparameters","learningRate"],c),e}function CO(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["trainingDataset"]);n!=null&&p(t,["tuningTask","trainingData"],SO(n));const o=d(i,["config"]);return o!=null&&p(t,["config"],EO(o,t)),t}function bO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","name"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function xO(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function _O(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],xO(e,t)),t}function wO(i,t){const e={},n=d(i,["gcsUri"]);t!==void 0&&n!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],n);const o=d(i,["vertexDatasetResource"]);if(t!==void 0&&o!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],o),d(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return e}function MO(i,t){const e={},n=d(i,["gcsUri"]);n!=null&&p(e,["validationDatasetUri"],n);const o=d(i,["vertexDatasetResource"]);return t!==void 0&&o!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],o),e}function RO(i,t){const e={},n=d(i,["validationDataset"]);t!==void 0&&n!=null&&p(t,["supervisedTuningSpec"],MO(n,e));const o=d(i,["tunedModelDisplayName"]);t!==void 0&&o!=null&&p(t,["tunedModelDisplayName"],o);const r=d(i,["description"]);t!==void 0&&r!=null&&p(t,["description"],r);const u=d(i,["epochCount"]);t!==void 0&&u!=null&&p(t,["supervisedTuningSpec","hyperParameters","epochCount"],u);const c=d(i,["learningRateMultiplier"]);t!==void 0&&c!=null&&p(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const f=d(i,["exportLastCheckpointOnly"]);t!==void 0&&f!=null&&p(t,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const h=d(i,["adapterSize"]);if(t!==void 0&&h!=null&&p(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),d(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return e}function NO(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["trainingDataset"]);n!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],wO(n,t));const o=d(i,["config"]);return o!=null&&p(t,["config"],RO(o,t)),t}function DO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["model"],e);const n=d(i,["name"]);return n!=null&&p(t,["endpoint"],n),t}function nw(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["state"]);n!=null&&p(t,["state"],P_(n));const o=d(i,["createTime"]);o!=null&&p(t,["createTime"],o);const r=d(i,["tuningTask","startTime"]);r!=null&&p(t,["startTime"],r);const u=d(i,["tuningTask","completeTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["description"]);f!=null&&p(t,["description"],f);const h=d(i,["baseModel"]);h!=null&&p(t,["baseModel"],h);const y=d(i,["_self"]);y!=null&&p(t,["tunedModel"],DO(y));const A=d(i,["distillationSpec"]);A!=null&&p(t,["distillationSpec"],A);const S=d(i,["experiment"]);S!=null&&p(t,["experiment"],S);const E=d(i,["labels"]);E!=null&&p(t,["labels"],E);const b=d(i,["pipelineJob"]);b!=null&&p(t,["pipelineJob"],b);const x=d(i,["satisfiesPzi"]);x!=null&&p(t,["satisfiesPzi"],x);const D=d(i,["satisfiesPzs"]);D!=null&&p(t,["satisfiesPzs"],D);const N=d(i,["serviceAccount"]);N!=null&&p(t,["serviceAccount"],N);const L=d(i,["tunedModelDisplayName"]);return L!=null&&p(t,["tunedModelDisplayName"],L),t}function IO(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["tunedModels"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>nw(r))),p(t,["tuningJobs"],o)}return t}function PO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);return r!=null&&p(t,["error"],r),t}function LO(i){const t={},e=d(i,["checkpointId"]);e!=null&&p(t,["checkpointId"],e);const n=d(i,["epoch"]);n!=null&&p(t,["epoch"],n);const o=d(i,["step"]);o!=null&&p(t,["step"],o);const r=d(i,["endpoint"]);return r!=null&&p(t,["endpoint"],r),t}function kO(i){const t={},e=d(i,["model"]);e!=null&&p(t,["model"],e);const n=d(i,["endpoint"]);n!=null&&p(t,["endpoint"],n);const o=d(i,["checkpoints"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(u=>LO(u))),p(t,["checkpoints"],r)}return t}function $0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["state"]);n!=null&&p(t,["state"],P_(n));const o=d(i,["createTime"]);o!=null&&p(t,["createTime"],o);const r=d(i,["startTime"]);r!=null&&p(t,["startTime"],r);const u=d(i,["endTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["error"]);f!=null&&p(t,["error"],f);const h=d(i,["description"]);h!=null&&p(t,["description"],h);const y=d(i,["baseModel"]);y!=null&&p(t,["baseModel"],y);const A=d(i,["tunedModel"]);A!=null&&p(t,["tunedModel"],kO(A));const S=d(i,["supervisedTuningSpec"]);S!=null&&p(t,["supervisedTuningSpec"],S);const E=d(i,["tuningDataStats"]);E!=null&&p(t,["tuningDataStats"],E);const b=d(i,["encryptionSpec"]);b!=null&&p(t,["encryptionSpec"],b);const x=d(i,["partnerModelTuningSpec"]);x!=null&&p(t,["partnerModelTuningSpec"],x);const D=d(i,["distillationSpec"]);D!=null&&p(t,["distillationSpec"],D);const N=d(i,["experiment"]);N!=null&&p(t,["experiment"],N);const L=d(i,["labels"]);L!=null&&p(t,["labels"],L);const P=d(i,["pipelineJob"]);P!=null&&p(t,["pipelineJob"],P);const U=d(i,["satisfiesPzi"]);U!=null&&p(t,["satisfiesPzi"],U);const k=d(i,["satisfiesPzs"]);k!=null&&p(t,["satisfiesPzs"],k);const F=d(i,["serviceAccount"]);F!=null&&p(t,["serviceAccount"],F);const B=d(i,["tunedModelDisplayName"]);return B!=null&&p(t,["tunedModelDisplayName"],B),t}function UO(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["tuningJobs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>$0(r))),p(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FO extends ql{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new rp(Gl.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let o="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?o=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(o=n.name.split("/operations/")[0]),{name:o,state:k0.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=bO(t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>$0(y))}else{const h=yO(t);return c=At("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>nw(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=_O(t);return c=At("tuningJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=UO(y),S=new xx;return Object.assign(S,A),S})}else{const h=AO(t);return c=At("tunedModels",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=IO(y),S=new xx;return Object.assign(S,A),S})}}async tuneInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=NO(t);return r=At("tuningJobs",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>$0(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=CO(t);return r=At("tunedModels",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>PO(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OO{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const BO=1024*1024*8,GO=3,VO=1e3,HO=2,x0="x-goog-upload-status";async function zO(i,t,e){var n,o,r;let u=0,c=0,f=new U0(new Response),h="upload";for(u=i.size;c<u;){const A=Math.min(BO,u-c),S=i.slice(c,c+A);c+A>=u&&(h+=", finalize");let E=0,b=VO;for(;E<GO&&(f=await e.request({path:"",body:S,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(c),"Content-Length":String(A)}}}),!(!((n=f==null?void 0:f.headers)===null||n===void 0)&&n[x0]));)E++,await $O(b),b=b*HO;if(c+=A,((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[x0])!=="active")break;if(u<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const y=await(f==null?void 0:f.json());if(((r=f==null?void 0:f.headers)===null||r===void 0?void 0:r[x0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return y.file}async function qO(i){return{size:i.size,type:i.type}}function $O(i){return new Promise(t=>setTimeout(t,i))}class YO{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await zO(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await qO(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XO{create(t,e,n){return new JO(t,e,n)}}class JO{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qx="x-goog-api-key";class KO{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(Qx)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Qx,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WO="gl-node/";class QO{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=KN(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const o=new KO(this.apiKey);this.apiClient=new dF({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:WO+"web",uploader:new YO,downloader:new OO}),this.models=new RF(this.apiClient),this.live=new bF(this.apiClient,o,new XO),this.batches=new vI(this.apiClient),this.chats=new EP(this.models,this.apiClient),this.caches=new AP(this.apiClient),this.files=new kP(this.apiClient),this.operations=new GF(this.apiClient),this.authTokens=new mO(this.apiClient),this.tunings=new FO(this.apiClient)}}const iw="AIzaSyClTdMj-LJS0K_Uwcmyw1PbbytaTgru_cU";let Y0=iw;console.log("🔑 [DEBUG] LLM Client - Estado inicial:",{hasEnvKey:!0,envKeyLength:iw.length,note:"API key será configurada via setRuntimeApiKey() se não estiver em env"});function Zx(i){Y0=i}const id={generateContent:async i=>{var t;console.log("🚀 [DEBUG] llmService.generateContent chamado com:",{model:i.model,contentsType:typeof i.contents,contentsLength:typeof i.contents=="string"?i.contents.length:"N/A",hasConfig:!!i.config,currentApiKeyLength:Y0.length});try{const n=await new QO({apiKey:Y0}).models.generateContent(i);return console.log("✅ [DEBUG] llmService response recebido:",{textLength:((t=n.text)==null?void 0:t.length)||0,hasText:!!n.text,finishReason:n.finishReason,hasSafetyRatings:!!n.safetyRatings,hasCandidates:!!n.candidates}),{response:{text:n.text||"",finishReason:n.finishReason,safetyRatings:n.safetyRatings,candidates:n.candidates}}}catch(e){throw console.error("❌ [DEBUG] llmService error:",e),e}}},ZO=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),M.jsx("path",{d:"M12 12v9"}),M.jsx("path",{d:"m16 16-4-4-4 4"})]}),sw=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),M.jsx("polyline",{points:"14 2 14 8 20 8"}),M.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),M.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),M.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]}),jO=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),M.jsx("polyline",{points:"7 10 12 15 17 10"}),M.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),tB=i=>M.jsx("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:M.jsx("path",{d:"m12 3-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9zM21 12l-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9zM3 12l-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9z"})}),X0=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),M.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),jx=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M3 12a9 9 0 0 1 9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),M.jsx("path",{d:"M21 3v5h-5"}),M.jsx("path",{d:"M21 12a9 9 0 0 1-9 9c-2.52 0-4.93-1-6.74-2.74L3 16"}),M.jsx("path",{d:"M3 21v-5h5"})]}),eB=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M12 8V4H8"}),M.jsx("rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}),M.jsx("path",{d:"M2 14h2"}),M.jsx("path",{d:"M20 14h2"}),M.jsx("path",{d:"M15 13v2"}),M.jsx("path",{d:"M9 13v2"})]}),nB=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"m8 11 2 2 4-4"}),M.jsx("circle",{cx:"11",cy:"11",r:"8"}),M.jsx("path",{d:"m21 21-4.3-4.3"})]}),J0=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("circle",{cx:"12",cy:"12",r:"10"}),M.jsx("polyline",{points:"12 6 12 12 16 14"})]}),iB=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("circle",{cx:"12",cy:"12",r:"10"}),M.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),M.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),sB=i=>M.jsx("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:M.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),oB=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}),M.jsx("path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"}),M.jsx("path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"}),M.jsx("path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375"}),M.jsx("path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5"}),M.jsx("path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396"}),M.jsx("path",{d:"M19.938 10.5a4 4 0 0 1 .585.396"}),M.jsx("path",{d:"M6 18a4 4 0 0 1-1.967-.516"}),M.jsx("path",{d:"M19.967 17.484A4 4 0 0 1 18 18"})]}),aB=i=>M.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[M.jsx("path",{d:"M3 12a9 9 0 0 1 9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),M.jsx("path",{d:"M21 3v5h-5"}),M.jsx("path",{d:"M21 12a9 9 0 0 1-9 9c-2.52 0-4.93-1-6.74-2.74L3 16"}),M.jsx("path",{d:"M3 21v-5h5"})]}),rB=({onFileSelect:i})=>{const[t,e]=at.useState(!1),n=at.useCallback(f=>{f.preventDefault(),f.stopPropagation(),e(!0)},[]),o=at.useCallback(f=>{f.preventDefault(),f.stopPropagation(),e(!1)},[]),r=at.useCallback(f=>{f.preventDefault(),f.stopPropagation()},[]),u=at.useCallback(f=>{if(f.preventDefault(),f.stopPropagation(),e(!1),f.dataTransfer.files&&f.dataTransfer.files.length>0){const h=f.dataTransfer.files[0];h.type==="application/pdf"?i(h):alert("Por favor, envie apenas arquivos PDF."),f.dataTransfer.clearData()}},[i]),c=f=>{f.target.files&&f.target.files.length>0&&i(f.target.files[0])};return M.jsxs("div",{onDragEnter:n,onDragLeave:o,onDragOver:r,onDrop:u,className:`w-full max-w-2xl mx-auto text-center p-8 border-2 border-dashed rounded-lg transition-colors
        ${t?"border-primary-500 bg-primary-50 dark:bg-primary-950/50":"border-slate-300 dark:border-slate-600 hover:border-primary-400"}`,children:[M.jsx("input",{id:"file-upload",type:"file",className:"sr-only",accept:"application/pdf",onChange:c}),M.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[M.jsx(ZO,{className:"mx-auto h-12 w-12 text-slate-400"}),M.jsx("p",{className:"mt-4 text-lg font-semibold text-slate-700 dark:text-slate-200",children:"Arraste e solte o arquivo PDF aqui"}),M.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"ou"}),M.jsx("div",{className:"mt-2 inline-block px-4 py-2 text-sm font-medium text-primary-600 dark:text-primary-400 rounded-md bg-primary-500/10 hover:bg-primary-500/20",children:"Escolha um arquivo do seu computador"})]})]})};var de=(i=>(i.PENDING="Pending",i.PROCESSING="Processing OCR",i.CORRECTING="AI Correction",i.COMPLETED="Completed",i.ERROR="Error",i))(de||{});const Yi=({className:i,children:t,...e})=>M.jsx("div",{className:`bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm ${i||""}`,...e,children:t}),lB=i=>{switch(i){case de.COMPLETED:return"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200";case de.PROCESSING:return"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 animate-pulse";case de.CORRECTING:return"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200 animate-pulse";case de.ERROR:return"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200";default:return"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}},uB=({results:i,isProcessing:t,isReformatting:e,progress:n,error:o,processingMessage:r,reformattingTimer:u=0,footnoteAnalysis:c,currentStatus:f})=>{const[h,y]=at.useState(1),A=i.find(x=>x.pageNumber===h),S=x=>{const D=Math.floor(x/60),N=x%60;return`${D}:${N.toString().padStart(2,"0")}`},E=()=>f||r||(e?`Phase 4: Formatting final document...${u>0?` (${S(u)})`:""}`:t?n.phase:"Processing completed"),b=()=>{if(e)return 95;if(n.total===0)return 0;const x=n.processed/n.total*80;return i.filter(N=>N.status===de.CORRECTING||N.status===de.PROCESSING).length===0&&n.processed===n.total?85:x};return i.length===0&&t?M.jsxs("div",{className:"w-full text-center",children:[M.jsx("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-primary-500 mx-auto"}),M.jsx("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:"Analisando o PDF..."}),M.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Isso pode levar alguns instantes."})]}):t&&n.phase.includes("Analyzing")&&c!==void 0?M.jsxs("div",{className:"w-full text-center flex flex-col items-center justify-center",children:[M.jsx(nB,{className:"w-16 h-16 text-primary-500"}),M.jsx("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:"Analyzing Footnotes..."}),M.jsxs("div",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400 min-h-[42px]",children:[c&&c.count>0&&M.jsxs("div",{className:"animate-fade-in",children:[M.jsxs("p",{children:[M.jsx("strong",{children:c.count})," notes found on pages: ",c.pages.join(", "),"."]}),M.jsx("p",{className:"mt-1",children:"Continuing to final formatting..."})]}),c&&c.count===0&&M.jsxs("div",{className:"animate-fade-in",children:[M.jsx("p",{children:"No footnotes found."}),M.jsx("p",{className:"mt-1",children:"Proceeding to finalization..."})]})]})]}):e?M.jsxs("div",{className:"w-full text-center flex flex-col items-center justify-center",children:[M.jsx(eB,{className:"w-16 h-16 text-primary-500 animate-bounce"}),M.jsxs("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:["Finalizing with AI...",u>0&&M.jsxs("span",{className:"ml-2 text-primary-600 dark:text-primary-400 font-mono",children:["(",S(u),")"]})]}),M.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Gathering text, removing artifacts and formatting the final document."})]}):M.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6",children:[M.jsxs("aside",{className:"w-full lg:w-1/4 xl:w-1/5",children:[M.jsx("h3",{className:"text-lg font-semibold mb-3 px-2 dark:text-slate-100",children:"Páginas"}),M.jsx("div",{className:"space-y-1 max-h-[60vh] overflow-y-auto pr-2",children:i.map(x=>M.jsxs("button",{onClick:()=>y(x.pageNumber),className:`w-full text-left p-2 rounded-md transition-colors flex justify-between items-center ${h===x.pageNumber?"bg-primary-100 dark:bg-primary-900/60 text-primary-800 dark:text-primary-100":"hover:bg-slate-100 dark:hover:bg-slate-700/50 dark:text-slate-300"}`,children:[M.jsxs("span",{className:"font-medium text-sm truncate pr-2",children:["Página ",x.pageNumber]}),M.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[x.changes&&x.status===de.COMPLETED&&M.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full",title:"AI made modifications to this page"}),x.method&&M.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${x.method==="AI OCR"?"bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200":x.method==="AI Correction"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200":"bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-200"}`,children:x.method}),M.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold w-[125px] text-center ${lB(x.status)}`,children:x.status})]})]},x.pageNumber))}),t&&M.jsxs("div",{className:"mt-4 px-2",children:[M.jsx("p",{className:"text-sm font-medium dark:text-slate-200",children:E()}),n.phaseProgress&&M.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1",children:n.phaseProgress}),M.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2.5 mt-2",children:M.jsx("div",{className:"bg-primary-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${b()}%`}})}),M.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mt-1",children:[M.jsxs("span",{children:[n.processed,"/",n.total," páginas"]}),M.jsxs("span",{children:[Math.round(b()),"%"]})]})]})]}),M.jsxs("main",{className:"w-full lg:w-3/4 xl:w-4/5",children:[A?M.jsxs("div",{className:"space-y-4 h-[70vh] overflow-auto",children:[M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-[45vh]",children:[M.jsxs(Yi,{className:"flex flex-col overflow-hidden",children:[M.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:M.jsxs("h4",{className:"font-semibold dark:text-slate-100",children:["Original (Página ",A.pageNumber,")"]})}),M.jsx("div",{className:"p-4 flex-grow overflow-auto bg-slate-50 dark:bg-slate-800/50",children:A.imageUrl?M.jsx("img",{src:A.imageUrl,alt:`Página ${A.pageNumber} do PDF`,className:"w-full h-auto object-contain"}):M.jsx("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Carregando imagem..."})})]}),M.jsxs(Yi,{className:"flex flex-col overflow-hidden",children:[M.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:[M.jsx("h4",{className:"font-semibold dark:text-slate-100",children:"Extracted Text"}),A.method&&M.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["(",A.method,")"]})]}),M.jsxs("div",{className:"p-4 flex-grow overflow-auto",children:[(A.status===de.PROCESSING||A.status===de.CORRECTING)&&M.jsxs("div",{className:"flex items-center justify-center h-full flex-col",children:[M.jsx("div",{className:"w-8 h-8 border-2 border-dashed rounded-full animate-spin border-primary-500"}),M.jsxs("p",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400",children:[A.status,"..."]})]}),A.status===de.ERROR&&M.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:M.jsx("p",{children:"Failed to process this page."})}),(A.status===de.COMPLETED||A.status===de.PENDING)&&M.jsx("pre",{className:"whitespace-pre-wrap text-sm font-sans dark:text-slate-300",children:A.text||"No text extracted."})]})]})]}),A.changes&&A.status===de.COMPLETED&&M.jsxs(Yi,{className:"flex flex-col max-h-[20vh]",children:[M.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:[M.jsxs("h4",{className:"font-semibold dark:text-slate-100 flex items-center gap-2",children:[M.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Modificações Feitas pela IA"]}),M.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Summary of corrections and improvements applied to text"})]}),M.jsx("div",{className:"p-4 overflow-auto",children:M.jsx("pre",{className:"whitespace-pre-wrap text-sm font-sans text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:A.changes})})]})]}):M.jsx("div",{className:"flex items-center justify-center h-[70vh]",children:M.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Selecione uma página para ver os resultados."})}),o&&M.jsx("div",{className:"mt-4 text-center text-red-500 bg-red-100 dark:bg-red-900/50 p-3 rounded-md",children:o})]})]})},cB=({steps:i,currentStep:t})=>M.jsx("nav",{"aria-label":"Progress",children:M.jsx("ol",{role:"list",className:"flex items-center justify-center",children:i.map((e,n)=>M.jsxs("li",{className:`relative ${n!==i.length-1?"pr-8 sm:pr-20":""}`,children:[n<t?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:M.jsx("div",{className:"h-0.5 w-full bg-primary-500"})}),M.jsxs("a",{href:"#",className:"relative flex h-8 w-8 items-center justify-center bg-primary-500 rounded-full hover:bg-primary-600",children:[M.jsx(X0,{className:"h-5 w-5 text-white","aria-hidden":"true"}),M.jsx("span",{className:"sr-only",children:e})]})]}):n===t?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:M.jsx("div",{className:"h-0.5 w-full bg-slate-200 dark:bg-slate-700"})}),M.jsxs("a",{href:"#",className:"relative flex h-8 w-8 items-center justify-center bg-white dark:bg-slate-800 border-2 border-primary-500 rounded-full","aria-current":"step",children:[M.jsx("span",{className:"h-2.5 w-2.5 bg-primary-500 rounded-full","aria-hidden":"true"}),M.jsx("span",{className:"sr-only",children:e})]})]}):M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:M.jsx("div",{className:"h-0.5 w-full bg-slate-200 dark:bg-slate-700"})}),M.jsx("div",{className:"relative flex h-8 w-8 items-center justify-center bg-white dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-full",children:M.jsx("span",{className:"sr-only",children:e})})]}),M.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 w-max text-center",children:M.jsx("span",{className:`text-xs font-medium ${n<=t?"text-primary-600 dark:text-primary-400":"text-slate-500 dark:text-slate-400"}`,children:e})})]},e))})}),kn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),K0=[.001,0,0,.001,0,0],_0=1.35,Ei={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},va={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ow="pdfjs_internal_editor_",Mt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Vt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},dB={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},An={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},zg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Le={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Pu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},jm={ERRORS:0,WARNINGS:1,INFOS:5},Em={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Pg={moveTo:0,lineTo:1,curveTo:2,closePath:3},fB={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ty=jm.WARNINGS;function hB(i){Number.isInteger(i)&&(ty=i)}function pB(){return ty}function ey(i){ty>=jm.INFOS&&console.log(`Info: ${i}`)}function Rt(i){ty>=jm.WARNINGS&&console.log(`Warning: ${i}`)}function ae(i){throw new Error(i)}function Ue(i,t){i||ae(t)}function gB(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function aw(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"){if(e.addDefaultProtocol&&i.startsWith("www.")){const o=i.match(/\./g);(o==null?void 0:o.length)>=2&&(i=`http://${i}`)}if(e.tryConvertEncoding)try{i=TB(i)}catch{}}const n=t?URL.parse(i,t):URL.parse(i);return gB(n)?n:null}function rw(i,t,e=!1){const n=URL.parse(i);return n?(n.hash=t,n.href):e&&aw(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Gt(i,t,e,n=!1){return Object.defineProperty(i,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const $l=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class t_ extends $l{constructor(t,e){super(t,"PasswordException"),this.code=e}}class w0 extends $l{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class W0 extends $l{constructor(t){super(t,"InvalidPDFException")}}class Cm extends $l{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class mB extends $l{constructor(t){super(t,"FormatError")}}class nr extends $l{constructor(t){super(t,"AbortException")}}function lw(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&ae("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const n=[];for(let o=0;o<t;o+=e){const r=Math.min(o+e,t),u=i.subarray(o,r);n.push(String.fromCharCode.apply(null,u))}return n.join("")}function lp(i){typeof i!="string"&&ae("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=i.charCodeAt(n)&255;return e}function yB(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function vB(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function AB(){try{return new Function(""),!0}catch{return!1}}class gn{static get isLittleEndian(){return Gt(this,"isLittleEndian",vB())}static get isEvalSupported(){return Gt(this,"isEvalSupported",AB())}static get isOffscreenCanvasSupported(){return Gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Gt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Gt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return Gt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const M0=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Ho,qg,Q0;class Ct{static makeHexColor(t,e,n){return`#${M0[t]}${M0[e]}${M0[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,n=0){const o=t[n],r=t[n+1];t[n]=o*e[0]+r*e[2]+e[4],t[n+1]=o*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const o=e[0],r=e[1],u=e[2],c=e[3],f=e[4],h=e[5];for(let y=0;y<6;y+=2){const A=t[n+y],S=t[n+y+1];t[n+y]=A*o+S*u+f,t[n+y+1]=A*r+S*c+h}}static applyInverseTransform(t,e){const n=t[0],o=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-o*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-n*e[1]+o*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,n){const o=e[0],r=e[1],u=e[2],c=e[3],f=e[4],h=e[5],y=t[0],A=t[1],S=t[2],E=t[3];let b=o*y+f,x=b,D=o*S+f,N=D,L=c*A+h,P=L,U=c*E+h,k=U;if(r!==0||u!==0){const F=r*y,B=r*S,q=u*A,Y=u*E;b+=q,N+=q,D+=Y,x+=Y,L+=F,k+=F,U+=B,P+=B}n[0]=Math.min(n[0],b,D,x,N),n[1]=Math.min(n[1],L,U,P,k),n[2]=Math.max(n[2],b,D,x,N),n[3]=Math.max(n[3],L,U,P,k)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],o=t[1],r=t[2],u=t[3],c=n**2+o**2,f=n*r+o*u,h=r**2+u**2,y=(c+h)/2,A=Math.sqrt(y**2-(c*h-f**2));e[0]=Math.sqrt(y+A||1),e[1]=Math.sqrt(y-A||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),o=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>o)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),u=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>u?null:[n,r,o,u]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,o,r){r[0]=Math.min(r[0],t,n),r[1]=Math.min(r[1],e,o),r[2]=Math.max(r[2],t,n),r[3]=Math.max(r[3],e,o)}static bezierBoundingBox(t,e,n,o,r,u,c,f,h){h[0]=Math.min(h[0],t,c),h[1]=Math.min(h[1],e,f),h[2]=Math.max(h[2],t,c),h[3]=Math.max(h[3],e,f),R(this,Ho,Q0).call(this,t,n,r,c,e,o,u,f,3*(-t+3*(n-r)+c),6*(t-2*n+r),3*(n-t),h),R(this,Ho,Q0).call(this,t,n,r,c,e,o,u,f,3*(-e+3*(o-u)+f),6*(e-2*o+u),3*(o-e),h)}}Ho=new WeakSet,qg=function(t,e,n,o,r,u,c,f,h,y){if(h<=0||h>=1)return;const A=1-h,S=h*h,E=S*h,b=A*(A*(A*t+3*h*e)+3*S*n)+E*o,x=A*(A*(A*r+3*h*u)+3*S*c)+E*f;y[0]=Math.min(y[0],b),y[1]=Math.min(y[1],x),y[2]=Math.max(y[2],b),y[3]=Math.max(y[3],x)},Q0=function(t,e,n,o,r,u,c,f,h,y,A,S){if(Math.abs(h)<1e-12){Math.abs(y)>=1e-12&&R(this,Ho,qg).call(this,t,e,n,o,r,u,c,f,-A/y,S);return}const E=y**2-4*A*h;if(E<0)return;const b=Math.sqrt(E),x=2*h;R(this,Ho,qg).call(this,t,e,n,o,r,u,c,f,(-y+b)/x,S),R(this,Ho,qg).call(this,t,e,n,o,r,u,c,f,(-y-b)/x,S)},w(Ct,Ho);function TB(i){return decodeURIComponent(escape(i))}let R0=null,e_=null;function SB(i){return R0||(R0=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,e_=new Map([["ﬅ","ſt"]])),i.replaceAll(R0,(t,e,n)=>e?e.normalize("NFKC"):e_.get(n))}function uw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),lw(i)}const TT="pdfjs_internal_id_";function EB(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,o,...r]=e;if(!i(n)&&!Number.isInteger(n)||!t(o))return!1;const u=r.length;let c=!0;switch(o.name){case"XYZ":if(u<2||u>3)return!1;break;case"Fit":case"FitB":return u===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(u>1)return!1;break;case"FitR":if(u!==4)return!1;c=!1;break;default:return!1}for(const f of r)if(!(typeof f=="number"||c&&f===null))return!1;return!0}function Un(i,t,e){return Math.min(Math.max(i,t),e)}function cw(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(lw(i))}function CB(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):lp(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});const oo="http://www.w3.org/2000/svg",Nr=class Nr{};ot(Nr,"CSS",96),ot(Nr,"PDF",72),ot(Nr,"PDF_TO_CSS_UNITS",Nr.CSS/Nr.PDF);let ir=Nr;async function up(i,t="text"){if(cf(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType=t,o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){if(o.status===200||o.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(o.response);return}e(o.responseText);return}n(new Error(o.statusText))}},o.send(null)})}class cp{constructor({viewBox:t,userUnit:e,scale:n,rotation:o,offsetX:r=0,offsetY:u=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=o,this.offsetX=r,this.offsetY=u,n*=e;const f=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let y,A,S,E;switch(o%=360,o<0&&(o+=360),o){case 180:y=-1,A=0,S=0,E=1;break;case 90:y=0,A=1,S=1,E=0;break;case 270:y=0,A=-1,S=-1,E=0;break;case 0:y=1,A=0,S=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(S=-S,E=-E);let b,x,D,N;y===0?(b=Math.abs(h-t[1])*n+r,x=Math.abs(f-t[0])*n+u,D=(t[3]-t[1])*n,N=(t[2]-t[0])*n):(b=Math.abs(f-t[0])*n+r,x=Math.abs(h-t[1])*n+u,D=(t[2]-t[0])*n,N=(t[3]-t[1])*n),this.transform=[y*n,A*n,S*n,E*n,b-y*n*f-S*n*h,x-A*n*f-E*n*h],this.width=D,this.height=N}get rawDims(){const t=this.viewBox;return Gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:o=this.offsetY,dontFlip:r=!1}={}){return new cp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:o,dontFlip:r})}convertToViewportPoint(t,e){const n=[t,e];return Ct.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];Ct.applyTransform(e,this.transform);const n=[t[2],t[3]];return Ct.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return Ct.applyInverseTransform(n,this.transform),n}}class ST extends $l{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function ny(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function ET(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function bB(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function xB(i,t="document.pdf"){if(typeof i!="string")return t;if(ny(i))return Rt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return t;const o=c=>{try{let f=decodeURIComponent(c);return f.includes("/")?(f=f.split("/").at(-1),f.test(/^\.pdf$/i)?f:c):f}catch{return c}},r=/\.pdf$/i,u=n.pathname.split("/").at(-1);if(r.test(u))return o(u);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const h of c)if(r.test(h))return o(h);const f=Array.from(n.searchParams.keys()).reverse();for(const h of f)if(r.test(h))return o(h)}if(n.hash){const f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(f)return o(f[0])}return t}class n_{constructor(){ot(this,"started",Object.create(null));ot(this,"times",[])}time(t){t in this.started&&Rt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Rt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:o,end:r}of this.times)t.push(`${n.padEnd(e)} ${r-o}ms
`);return t.join("")}}function cf(i,t){const e=t?URL.parse(i,t):URL.parse(i);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function fs(i){i.preventDefault()}function ke(i){i.preventDefault(),i.stopPropagation()}function _B(i){console.log("Deprecated API usage: "+i)}var Pf;class CT{static toDateObject(t){if(!t||typeof t!="string")return null;g(this,Pf)||C(this,Pf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=g(this,Pf).exec(t);if(!e)return null;const n=parseInt(e[1],10);let o=parseInt(e[2],10);o=o>=1&&o<=12?o-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let u=parseInt(e[4],10);u=u>=0&&u<=23?u:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let f=parseInt(e[6],10);f=f>=0&&f<=59?f:0;const h=e[7]||"Z";let y=parseInt(e[8],10);y=y>=0&&y<=23?y:0;let A=parseInt(e[9],10)||0;return A=A>=0&&A<=59?A:0,h==="-"?(u+=y,c+=A):h==="+"&&(u-=y,c-=A),new Date(Date.UTC(n,o,r,u,c,f))}}Pf=new WeakMap,w(CT,Pf);function wB(i,{scale:t=1,rotation:e=0}){const{width:n,height:o}=i.attributes.style,r=[0,0,parseInt(n),parseInt(o)];return new cp({viewBox:r,userUnit:1,scale:t,rotation:e})}function bT(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Rt(`Not a valid color format: "${i}"`),[0,0,0])}function MB(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;i.set(e,bT(n))}t.remove()}function Se(i){const{a:t,b:e,c:n,d:o,e:r,f:u}=i.getTransform();return[t,e,n,o,r,u]}function As(i){const{a:t,b:e,c:n,d:o,e:r,f:u}=i.getTransform().invertSelf();return[t,e,n,o,r,u]}function Vl(i,t,e=!1,n=!0){if(t instanceof cp){const{pageWidth:o,pageHeight:r}=t.rawDims,{style:u}=i,c=gn.isCSSRoundSupported,f=`var(--total-scale-factor) * ${o}px`,h=`var(--total-scale-factor) * ${r}px`,y=c?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,A=c?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!e||t.rotation%180===0?(u.width=y,u.height=A):(u.width=A,u.height=y)}n&&i.setAttribute("data-main-rotation",t.rotation)}class Vs{constructor(){const{pixelRatio:t}=Vs;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,o,r=-1){let u=1/0,c=1/0,f=1/0;n=Vs.capPixels(n,r),n>0&&(u=Math.sqrt(n/(t*e))),o!==-1&&(c=o/t,f=o/e);const h=Math.min(u,c,f);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const Z0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Aa,Ir,Oi,Ta,Lf,Xu,kf,Dm,dw,Bn,fw,hw,df,$g;const lo=class lo{constructor(t){w(this,Bn);w(this,Aa,null);w(this,Ir,null);w(this,Oi);w(this,Ta,null);w(this,Lf,null);w(this,Xu,null);C(this,Oi,t),g(lo,kf)||C(lo,kf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=C(this,Aa,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=g(this,Oi)._uiManager._signal;t.addEventListener("contextmenu",fs,{signal:e}),t.addEventListener("pointerdown",R(lo,Dm,dw),{signal:e});const n=C(this,Ta,document.createElement("div"));n.className="buttons",t.append(n);const o=g(this,Oi).toolbarPosition;if(o){const{style:r}=t,u=g(this,Oi)._uiManager.direction==="ltr"?1-o[0]:o[0];r.insetInlineEnd=`${100*u}%`,r.top=`calc(${100*o[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return g(this,Aa)}hide(){var t;g(this,Aa).classList.add("hidden"),(t=g(this,Ir))==null||t.hideDropdown()}show(){var t;g(this,Aa).classList.remove("hidden"),(t=g(this,Lf))==null||t.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=g(this,Oi),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",g(lo,kf)[t]),R(this,Bn,df).call(this,n),n.addEventListener("click",o=>{e.delete()},{signal:e._signal}),g(this,Ta).append(n)}async addAltText(t){const e=await t.render();R(this,Bn,df).call(this,e),g(this,Ta).append(e,g(this,Bn,$g)),C(this,Lf,t)}addColorPicker(t){C(this,Ir,t);const e=t.renderButton();R(this,Bn,df).call(this,e),g(this,Ta).append(e,g(this,Bn,$g))}async addEditSignatureButton(t){const e=C(this,Xu,await t.renderEditButton(g(this,Oi)));R(this,Bn,df).call(this,e),g(this,Ta).append(e,g(this,Bn,$g))}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(t){g(this,Xu)&&(g(this,Xu).title=t)}remove(){var t;g(this,Aa).remove(),(t=g(this,Ir))==null||t.destroy(),C(this,Ir,null)}};Aa=new WeakMap,Ir=new WeakMap,Oi=new WeakMap,Ta=new WeakMap,Lf=new WeakMap,Xu=new WeakMap,kf=new WeakMap,Dm=new WeakSet,dw=function(t){t.stopPropagation()},Bn=new WeakSet,fw=function(t){g(this,Oi)._focusEventsAllowed=!1,ke(t)},hw=function(t){g(this,Oi)._focusEventsAllowed=!0,ke(t)},df=function(t){const e=g(this,Oi)._uiManager._signal;t.addEventListener("focusin",R(this,Bn,fw).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",R(this,Bn,hw).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",fs,{signal:e})},$g=function(){const t=document.createElement("div");return t.className="divider",t},w(lo,Dm),w(lo,kf,null);let j0=lo;var Uf,Pr,Lr,sr,pw,gw,mw;class RB{constructor(t){w(this,sr);w(this,Uf,null);w(this,Pr,null);w(this,Lr);C(this,Lr,t)}show(t,e,n){const[o,r]=R(this,sr,gw).call(this,e,n),{style:u}=g(this,Pr)||C(this,Pr,R(this,sr,pw).call(this));t.append(g(this,Pr)),u.insetInlineEnd=`${100*o}%`,u.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,Pr).remove()}}Uf=new WeakMap,Pr=new WeakMap,Lr=new WeakMap,sr=new WeakSet,pw=function(){const t=C(this,Pr,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",fs,{signal:g(this,Lr)._signal});const e=C(this,Uf,document.createElement("div"));return e.className="buttons",t.append(e),R(this,sr,mw).call(this),t},gw=function(t,e){let n=0,o=0;for(const r of t){const u=r.y+r.height;if(u<n)continue;const c=r.x+(e?r.width:0);if(u>n){o=c,n=u;continue}e?c>o&&(o=c):c<o&&(o=c)}return[e?1-o:o,n]},mw=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=g(this,Lr)._signal;t.addEventListener("contextmenu",fs,{signal:n}),t.addEventListener("click",()=>{g(this,Lr).highlightSelection("floating_button")},{signal:n}),g(this,Uf).append(t)};function yw(i,t,e){for(const n of e)t.addEventListener(n,i[n].bind(i))}var Im;class NB{constructor(){w(this,Im,0)}get id(){return`${ow}${Rn(this,Im)._++}`}}Im=new WeakMap;var Ju,Ff,Sn,Ku,Yg;const DT=class DT{constructor(){w(this,Ku);w(this,Ju,uw());w(this,Ff,0);w(this,Sn,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),o=new Image;o.src=t;const r=o.decode().then(()=>(n.drawImage(o,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Gt(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:n,size:o,type:r}=t;return R(this,Ku,Yg).call(this,`${e}_${n}_${o}_${r}`,t)}async getFromUrl(t){return R(this,Ku,Yg).call(this,t,t)}async getFromBlob(t,e){const n=await e;return R(this,Ku,Yg).call(this,t,n)}async getFromId(t){g(this,Sn)||C(this,Sn,new Map);const e=g(this,Sn).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){g(this,Sn)||C(this,Sn,new Map);let n=g(this,Sn).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const o=new OffscreenCanvas(e.width,e.height);return o.getContext("2d").drawImage(e,0,0),n={bitmap:o.transferToImageBitmap(),id:`image_${g(this,Ju)}_${Rn(this,Ff)._++}`,refCounter:1,isSvg:!1},g(this,Sn).set(t,n),g(this,Sn).set(n.id,n),n}getSvgUrl(t){const e=g(this,Sn).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var o;g(this,Sn)||C(this,Sn,new Map);const e=g(this,Sn).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=r.convertToBlob()}(o=n.close)==null||o.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${g(this,Ju)}_`)}};Ju=new WeakMap,Ff=new WeakMap,Sn=new WeakMap,Ku=new WeakSet,Yg=async function(t,e){g(this,Sn)||C(this,Sn,new Map);let n=g(this,Sn).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${g(this,Ju)}_${Rn(this,Ff)._++}`,refCounter:0,isSvg:!1});let o;if(typeof e=="string"?(n.url=e,o=await up(e,"blob")):e instanceof File?o=n.file=e:e instanceof Blob&&(o=e),o.type==="image/svg+xml"){const r=DT._isSVGFittingCanvas,u=new FileReader,c=new Image,f=new Promise((h,y)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},u.onload=async()=>{const A=n.svgUrl=u.result;c.src=await r?`${A}#svgView(preserveAspectRatio(none))`:A},c.onerror=u.onerror=y});u.readAsDataURL(o),await f}else n.bitmap=await createImageBitmap(o);n.refCounter=1}catch(o){Rt(o),n=null}return g(this,Sn).set(t,n),n&&g(this,Sn).set(n.id,n),n};let tA=DT;var Me,Sa,Of,Te;class DB{constructor(t=128){w(this,Me,[]);w(this,Sa,!1);w(this,Of);w(this,Te,-1);C(this,Of,t)}add({cmd:t,undo:e,post:n,mustExec:o,type:r=NaN,overwriteIfSameType:u=!1,keepUndo:c=!1}){if(o&&t(),g(this,Sa))return;const f={cmd:t,undo:e,post:n,type:r};if(g(this,Te)===-1){g(this,Me).length>0&&(g(this,Me).length=0),C(this,Te,0),g(this,Me).push(f);return}if(u&&g(this,Me)[g(this,Te)].type===r){c&&(f.undo=g(this,Me)[g(this,Te)].undo),g(this,Me)[g(this,Te)]=f;return}const h=g(this,Te)+1;h===g(this,Of)?g(this,Me).splice(0,1):(C(this,Te,h),h<g(this,Me).length&&g(this,Me).splice(h)),g(this,Me).push(f)}undo(){if(g(this,Te)===-1)return;C(this,Sa,!0);const{undo:t,post:e}=g(this,Me)[g(this,Te)];t(),e==null||e(),C(this,Sa,!1),C(this,Te,g(this,Te)-1)}redo(){if(g(this,Te)<g(this,Me).length-1){C(this,Te,g(this,Te)+1),C(this,Sa,!0);const{cmd:t,post:e}=g(this,Me)[g(this,Te)];t(),e==null||e(),C(this,Sa,!1)}}hasSomethingToUndo(){return g(this,Te)!==-1}hasSomethingToRedo(){return g(this,Te)<g(this,Me).length-1}cleanType(t){if(g(this,Te)!==-1){for(let e=g(this,Te);e>=0;e--)if(g(this,Me)[e].type!==t){g(this,Me).splice(e+1,g(this,Te)-e),C(this,Te,e);return}g(this,Me).length=0,C(this,Te,-1)}}destroy(){C(this,Me,null)}}Me=new WeakMap,Sa=new WeakMap,Of=new WeakMap,Te=new WeakMap;var Pm,vw;class dp{constructor(t){w(this,Pm);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=gn.platform;for(const[n,o,r={}]of t)for(const u of n){const c=u.startsWith("mac+");e&&c?(this.callbacks.set(u.slice(4),{callback:o,options:r}),this.allKeys.add(u.split("+").at(-1))):!e&&!c&&(this.callbacks.set(u,{callback:o,options:r}),this.allKeys.add(u.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(R(this,Pm,vw).call(this,e));if(!n)return;const{callback:o,options:{bubbles:r=!1,args:u=[],checker:c=null}}=n;c&&!c(t,e)||(o.bind(t,...u,e)(),r||ke(e))}}Pm=new WeakSet,vw=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Lm=class Lm{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return MB(t),Gt(this,"_colors",t)}convert(t){const e=bT(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,o]of this._colors)if(o.every((r,u)=>r===e[u]))return Lm._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Ct.makeHexColor(...e):t}};ot(Lm,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let eA=Lm;var Wu,li,ze,ln,Qu,co,Zu,Bi,Ea,Ca,ju,kr,Es,ji,Ur,Bf,Gf,tc,Vf,Cs,ba,ec,xa,bs,km,_a,Hf,wa,Fr,Or,Ma,zf,We,jt,fo,Ra,Br,qf,$f,Na,xs,ho,Yf,Xf,Gi,lt,Xg,nA,Aw,Tw,Jg,Sw,Ew,Cw,iA,bw,sA,oA,xw,Nn,ao,_w,ww,aA,Mw,ff,rA;const Hu=class Hu{constructor(t,e,n,o,r,u,c,f,h,y,A,S,E,b,x){w(this,lt);w(this,Wu,new AbortController);w(this,li,null);w(this,ze,new Map);w(this,ln,new Map);w(this,Qu,null);w(this,co,null);w(this,Zu,null);w(this,Bi,new DB);w(this,Ea,null);w(this,Ca,null);w(this,ju,0);w(this,kr,new Set);w(this,Es,null);w(this,ji,null);w(this,Ur,new Set);ot(this,"_editorUndoBar",null);w(this,Bf,!1);w(this,Gf,!1);w(this,tc,!1);w(this,Vf,null);w(this,Cs,null);w(this,ba,null);w(this,ec,null);w(this,xa,!1);w(this,bs,null);w(this,km,new NB);w(this,_a,!1);w(this,Hf,!1);w(this,wa,null);w(this,Fr,null);w(this,Or,null);w(this,Ma,null);w(this,zf,null);w(this,We,Mt.NONE);w(this,jt,new Set);w(this,fo,null);w(this,Ra,null);w(this,Br,null);w(this,qf,null);w(this,$f,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});w(this,Na,[0,0]);w(this,xs,null);w(this,ho,null);w(this,Yf,null);w(this,Xf,null);w(this,Gi,null);const D=this._signal=g(this,Wu).signal;C(this,ho,t),C(this,Yf,e),C(this,Xf,n),C(this,Qu,o),C(this,Ra,r),this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:D}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:D}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:D}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:D}),u._on("setpreference",this.onSetPreference.bind(this),{signal:D}),u._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:D}),R(this,lt,Sw).call(this),R(this,lt,xw).call(this),R(this,lt,iA).call(this),C(this,co,c.annotationStorage),C(this,Vf,c.filterFactory),C(this,Br,f),C(this,ec,h||null),C(this,Bf,y),C(this,Gf,A),C(this,tc,S),C(this,zf,E||null),this.viewParameters={realScale:ir.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const t=Hu.prototype,e=u=>g(u,ho).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&u.hasSomethingToControl(),n=(u,{target:c})=>{if(c instanceof HTMLInputElement){const{type:f}=c;return f!=="text"&&f!=="number"}return!0},o=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new dp([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(u,{target:c})=>!(c instanceof HTMLButtonElement)&&g(u,ho).contains(c)&&!u.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(u,{target:c})=>!(c instanceof HTMLButtonElement)&&g(u,ho).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,n,o,r,u,c,f;(t=g(this,Gi))==null||t.resolve(),C(this,Gi,null),(e=g(this,Wu))==null||e.abort(),C(this,Wu,null),this._signal=null;for(const h of g(this,ln).values())h.destroy();g(this,ln).clear(),g(this,ze).clear(),g(this,Ur).clear(),(n=g(this,Ma))==null||n.clear(),C(this,li,null),g(this,jt).clear(),g(this,Bi).destroy(),(o=g(this,Qu))==null||o.destroy(),(r=g(this,Ra))==null||r.destroy(),(u=g(this,bs))==null||u.hide(),C(this,bs,null),(c=g(this,Or))==null||c.destroy(),C(this,Or,null),g(this,Cs)&&(clearTimeout(g(this,Cs)),C(this,Cs,null)),g(this,xs)&&(clearTimeout(g(this,xs)),C(this,xs,null)),(f=this._editorUndoBar)==null||f.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return g(this,zf)}get useNewAltTextFlow(){return g(this,Gf)}get useNewAltTextWhenAddingImage(){return g(this,tc)}get hcmFilter(){return Gt(this,"hcmFilter",g(this,Br)?g(this,Vf).addHCMFilter(g(this,Br).foreground,g(this,Br).background):"none")}get direction(){return Gt(this,"direction",getComputedStyle(g(this,ho)).direction)}get highlightColors(){return Gt(this,"highlightColors",g(this,ec)?new Map(g(this,ec).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColorNames(){return Gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),C(this,Ca,t)}setMainHighlightColorPicker(t){C(this,Or,t)}editAltText(t,e=!1){var n;(n=g(this,Qu))==null||n.editAltText(this,t,e)}getSignature(t){var e;(e=g(this,Ra))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return g(this,Ra)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":C(this,tc,e);break}}onPageChanging({pageNumber:t}){C(this,ju,t-1)}focusMainContainer(){g(this,ho).focus()}findParent(t,e){for(const n of g(this,ln).values()){const{x:o,y:r,width:u,height:c}=n.div.getBoundingClientRect();if(t>=o&&t<=o+u&&e>=r&&e<=r+c)return n}return null}disableUserSelect(t=!1){g(this,Yf).classList.toggle("noUserSelect",t)}addShouldRescale(t){g(this,Ur).add(t)}removeShouldRescale(t){g(this,Ur).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*ir.PDF_TO_CSS_UNITS;for(const n of g(this,Ur))n.onScaleChanging();(e=g(this,Ca))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:o,focusNode:r,focusOffset:u}=e,c=e.toString(),h=R(this,lt,Xg).call(this,e).closest(".textLayer"),y=this.getSelectionBoxes(h);if(!y)return;e.empty();const A=R(this,lt,nA).call(this,h),S=g(this,We)===Mt.NONE,E=()=>{A==null||A.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:n,anchorOffset:o,focusNode:r,focusOffset:u,text:c}),S&&this.showAllEditors("highlight",!0,!0)};if(S){this.switchToMode(Mt.HIGHLIGHT,E);return}E()}addToAnnotationStorage(t){!t.isEmpty()&&g(this,co)&&!g(this,co).has(t.id)&&g(this,co).setValue(t.id,t)}a11yAlert(t,e=null){const n=g(this,Xf);n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,g(this,xa)&&(C(this,xa,!1),R(this,lt,Jg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of g(this,jt))if(e.div.contains(t)){C(this,Fr,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!g(this,Fr))return;const[t,e]=g(this,Fr);C(this,Fr,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){R(this,lt,iA).call(this),R(this,lt,sA).call(this)}removeEditListeners(){R(this,lt,bw).call(this),R(this,lt,oA).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of g(this,ji))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of g(this,ji))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=g(this,li))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const o of g(this,jt)){const r=o.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const u of g(this,ji))if(u.isHandlingMimeForPasting(r.type)){u.paste(r,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(r){Rt(`paste: "${r.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const o=this.currentLayer;try{const r=[];for(const f of n){const h=await o.deserialize(f);if(!h)return;r.push(h)}const u=()=>{for(const f of r)R(this,lt,aA).call(this,f);R(this,lt,rA).call(this,r)},c=()=>{for(const f of r)f.remove()};this.addCommands({cmd:u,undo:c,mustExec:!0})}catch(r){Rt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,We)!==Mt.NONE&&!this.isEditorHandlingKeyboard&&Hu._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,xa)&&(C(this,xa,!1),R(this,lt,Jg).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(R(this,lt,Ew).call(this),R(this,lt,sA).call(this),R(this,lt,Nn).call(this,{isEditing:g(this,We)!==Mt.NONE,isEmpty:R(this,lt,ff).call(this),hasSomethingToUndo:g(this,Bi).hasSomethingToUndo(),hasSomethingToRedo:g(this,Bi).hasSomethingToRedo(),hasSelectedEditor:!1})):(R(this,lt,Cw).call(this),R(this,lt,oA).call(this),R(this,lt,Nn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!g(this,ji)){C(this,ji,t);for(const e of g(this,ji))R(this,lt,ao).call(this,e.defaultPropertiesToUpdate)}}getId(){return g(this,km).id}get currentLayer(){return g(this,ln).get(g(this,ju))}getLayer(t){return g(this,ln).get(t)}get currentPageIndex(){return g(this,ju)}addLayer(t){g(this,ln).set(t.pageIndex,t),g(this,_a)?t.enable():t.disable()}removeLayer(t){g(this,ln).delete(t.pageIndex)}async updateMode(t,e=null,n=!1,o=!1){var r,u,c;if(g(this,We)!==t&&!(g(this,Gi)&&(await g(this,Gi).promise,!g(this,Gi)))){if(C(this,Gi,Promise.withResolvers()),(r=g(this,Ca))==null||r.commitOrRemove(),C(this,We,t),t===Mt.NONE){this.setEditingState(!1),R(this,lt,ww).call(this),(u=this._editorUndoBar)==null||u.hide(),g(this,Gi).resolve();return}t===Mt.SIGNATURE&&await((c=g(this,Ra))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await R(this,lt,_w).call(this),this.unselectAll();for(const f of g(this,ln).values())f.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),g(this,Gi).resolve();return}for(const f of g(this,ze).values())f.annotationElementId===e||f.id===e?(this.setSelected(f),o&&f.enterInEditMode()):f.unselect();g(this,Gi).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==g(this,We)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){var n;if(g(this,ji)){switch(t){case Vt.CREATE:this.currentLayer.addNewEditor(e);return;case Vt.HIGHLIGHT_DEFAULT_COLOR:(n=g(this,Or))==null||n.updateColor(e);break;case Vt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,qf)||C(this,qf,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const o of g(this,jt))o.updateParams(t,e);for(const o of g(this,ji))o.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var r;for(const u of g(this,ze).values())u.editorType===t&&u.show(e);(((r=g(this,qf))==null?void 0:r.get(Vt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&R(this,lt,ao).call(this,[[Vt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(g(this,Hf)!==t){C(this,Hf,t);for(const e of g(this,ln).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of g(this,ze).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return g(this,ze).get(t)}addEditor(t){g(this,ze).set(t.id,t)}removeEditor(t){var e,n;t.div.contains(document.activeElement)&&(g(this,Cs)&&clearTimeout(g(this,Cs)),C(this,Cs,setTimeout(()=>{this.focusMainContainer(),C(this,Cs,null)},0))),g(this,ze).delete(t.id),t.annotationElementId&&((e=g(this,Ma))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!g(this,kr).has(t.annotationElementId))&&((n=g(this,co))==null||n.remove(t.id))}addDeletedAnnotationElement(t){g(this,kr).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return g(this,kr).has(t)}removeDeletedAnnotationElement(t){g(this,kr).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){g(this,li)!==t&&(C(this,li,t),t&&R(this,lt,ao).call(this,t.propertiesToUpdate))}updateUI(t){g(this,lt,Mw)===t&&R(this,lt,ao).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){R(this,lt,ao).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(g(this,jt).has(t)){g(this,jt).delete(t),t.unselect(),R(this,lt,Nn).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,jt).add(t),t.select(),R(this,lt,ao).call(this,t.propertiesToUpdate),R(this,lt,Nn).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.id}),(e=g(this,Ca))==null||e.commitOrRemove();for(const n of g(this,jt))n!==t&&n.unselect();g(this,jt).clear(),g(this,jt).add(t),t.select(),R(this,lt,ao).call(this,t.propertiesToUpdate),R(this,lt,Nn).call(this,{hasSelectedEditor:!0})}isSelected(t){return g(this,jt).has(t)}get firstSelectedEditor(){return g(this,jt).values().next().value}unselect(t){t.unselect(),g(this,jt).delete(t),R(this,lt,Nn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,jt).size!==0}get isEnterHandled(){return g(this,jt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;g(this,Bi).undo(),R(this,lt,Nn).call(this,{hasSomethingToUndo:g(this,Bi).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:R(this,lt,ff).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){g(this,Bi).redo(),R(this,lt,Nn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,Bi).hasSomethingToRedo(),isEmpty:R(this,lt,ff).call(this)})}addCommands(t){g(this,Bi).add(t),R(this,lt,Nn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:R(this,lt,ff).call(this)})}cleanUndoStack(t){g(this,Bi).cleanType(t)}delete(){var r;this.commitOrRemove();const t=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...g(this,jt)],n=()=>{var u;(u=this._editorUndoBar)==null||u.show(o,e.length===1?e[0].editorType:e.length);for(const c of e)c.remove()},o=()=>{for(const u of e)R(this,lt,aA).call(this,u)};this.addCommands({cmd:n,undo:o,mustExec:!0})}commitOrRemove(){var t;(t=g(this,li))==null||t.commitOrRemove()}hasSomethingToControl(){return g(this,li)||this.hasSelection}selectAll(){for(const t of g(this,jt))t.commit();R(this,lt,rA).call(this,g(this,ze).values())}unselectAll(){var t;if(!(g(this,li)&&(g(this,li).commitOrRemove(),g(this,We)!==Mt.NONE))&&!((t=g(this,Ca))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of g(this,jt))e.unselect();g(this,jt).clear(),R(this,lt,Nn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;g(this,Na)[0]+=t,g(this,Na)[1]+=e;const[o,r]=g(this,Na),u=[...g(this,jt)],c=1e3;g(this,xs)&&clearTimeout(g(this,xs)),C(this,xs,setTimeout(()=>{C(this,xs,null),g(this,Na)[0]=g(this,Na)[1]=0,this.addCommands({cmd:()=>{for(const f of u)g(this,ze).has(f.id)&&(f.translateInPage(o,r),f.translationDone())},undo:()=>{for(const f of u)g(this,ze).has(f.id)&&(f.translateInPage(-o,-r),f.translationDone())},mustExec:!1})},c));for(const f of u)f.translateInPage(t,e),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,Es,new Map);for(const t of g(this,jt))g(this,Es).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,Es))return!1;this.disableUserSelect(!1);const t=g(this,Es);C(this,Es,null);let e=!1;for(const[{x:o,y:r,pageIndex:u},c]of t)c.newX=o,c.newY=r,c.newPageIndex=u,e||(e=o!==c.savedX||r!==c.savedY||u!==c.savedPageIndex);if(!e)return!1;const n=(o,r,u,c)=>{if(g(this,ze).has(o.id)){const f=g(this,ln).get(c);f?o._setParentAndPosition(f,r,u):(o.pageIndex=c,o.x=r,o.y=u)}};return this.addCommands({cmd:()=>{for(const[o,{newX:r,newY:u,newPageIndex:c}]of t)n(o,r,u,c)},undo:()=>{for(const[o,{savedX:r,savedY:u,savedPageIndex:c}]of t)n(o,r,u,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(g(this,Es))for(const n of g(this,Es).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||g(this,jt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return g(this,li)===t}getActive(){return g(this,li)}getMode(){return g(this,We)}get imageManager(){return Gt(this,"imageManager",new tA)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let h=0,y=e.rangeCount;h<y;h++)if(!t.contains(e.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:o,width:r,height:u}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(h,y,A,S)=>({x:(y-o)/u,y:1-(h+A-n)/r,width:S/u,height:A/r});break;case"180":c=(h,y,A,S)=>({x:1-(h+A-n)/r,y:1-(y+S-o)/u,width:A/r,height:S/u});break;case"270":c=(h,y,A,S)=>({x:1-(y+S-o)/u,y:(h-n)/r,width:S/u,height:A/r});break;default:c=(h,y,A,S)=>({x:(h-n)/r,y:(y-o)/u,width:A/r,height:S/u});break}const f=[];for(let h=0,y=e.rangeCount;h<y;h++){const A=e.getRangeAt(h);if(!A.collapsed)for(const{x:S,y:E,width:b,height:x}of A.getClientRects())b===0||x===0||f.push(c(S,E,b,x))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:t,id:e}){(g(this,Zu)||C(this,Zu,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=g(this,Zu))==null||e.delete(t)}renderAnnotationElement(t){var o;const e=(o=g(this,Zu))==null?void 0:o.get(t.data.id);if(!e)return;const n=g(this,co).getRawValue(e);n&&(g(this,We)===Mt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){var r;const o=(r=g(this,Ma))==null?void 0:r.get(t);o&&(o.setCanvas(e,n),g(this,Ma).delete(t))}addMissingCanvas(t,e){(g(this,Ma)||C(this,Ma,new Map)).set(t,e)}};Wu=new WeakMap,li=new WeakMap,ze=new WeakMap,ln=new WeakMap,Qu=new WeakMap,co=new WeakMap,Zu=new WeakMap,Bi=new WeakMap,Ea=new WeakMap,Ca=new WeakMap,ju=new WeakMap,kr=new WeakMap,Es=new WeakMap,ji=new WeakMap,Ur=new WeakMap,Bf=new WeakMap,Gf=new WeakMap,tc=new WeakMap,Vf=new WeakMap,Cs=new WeakMap,ba=new WeakMap,ec=new WeakMap,xa=new WeakMap,bs=new WeakMap,km=new WeakMap,_a=new WeakMap,Hf=new WeakMap,wa=new WeakMap,Fr=new WeakMap,Or=new WeakMap,Ma=new WeakMap,zf=new WeakMap,We=new WeakMap,jt=new WeakMap,fo=new WeakMap,Ra=new WeakMap,Br=new WeakMap,qf=new WeakMap,$f=new WeakMap,Na=new WeakMap,xs=new WeakMap,ho=new WeakMap,Yf=new WeakMap,Xf=new WeakMap,Gi=new WeakMap,lt=new WeakSet,Xg=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},nA=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of g(this,ln).values())if(n.hasTextLayer(t))return n;return null},Aw=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=R(this,lt,Xg).call(this,t).closest(".textLayer"),o=this.getSelectionBoxes(n);o&&(g(this,bs)||C(this,bs,new RB(this)),g(this,bs).show(n,o,this.direction==="ltr"))},Tw=function(){var r,u,c;const t=document.getSelection();if(!t||t.isCollapsed){g(this,fo)&&((r=g(this,bs))==null||r.hide(),C(this,fo,null),R(this,lt,Nn).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===g(this,fo))return;const o=R(this,lt,Xg).call(this,t).closest(".textLayer");if(!o){g(this,fo)&&((u=g(this,bs))==null||u.hide(),C(this,fo,null),R(this,lt,Nn).call(this,{hasSelectedText:!1}));return}if((c=g(this,bs))==null||c.hide(),C(this,fo,e),R(this,lt,Nn).call(this,{hasSelectedText:!0}),!(g(this,We)!==Mt.HIGHLIGHT&&g(this,We)!==Mt.NONE)&&(g(this,We)===Mt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,xa,this.isShiftKeyDown),!this.isShiftKeyDown)){const f=g(this,We)===Mt.HIGHLIGHT?R(this,lt,nA).call(this,o):null;f==null||f.toggleDrawing();const h=new AbortController,y=this.combinedSignal(h),A=S=>{S.type==="pointerup"&&S.button!==0||(h.abort(),f==null||f.toggleDrawing(!0),S.type==="pointerup"&&R(this,lt,Jg).call(this,"main_toolbar"))};window.addEventListener("pointerup",A,{signal:y}),window.addEventListener("blur",A,{signal:y})}},Jg=function(t=""){g(this,We)===Mt.HIGHLIGHT?this.highlightSelection(t):g(this,Bf)&&R(this,lt,Aw).call(this)},Sw=function(){document.addEventListener("selectionchange",R(this,lt,Tw).bind(this),{signal:this._signal})},Ew=function(){if(g(this,ba))return;C(this,ba,new AbortController);const t=this.combinedSignal(g(this,ba));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Cw=function(){var t;(t=g(this,ba))==null||t.abort(),C(this,ba,null)},iA=function(){if(g(this,wa))return;C(this,wa,new AbortController);const t=this.combinedSignal(g(this,wa));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},bw=function(){var t;(t=g(this,wa))==null||t.abort(),C(this,wa,null)},sA=function(){if(g(this,Ea))return;C(this,Ea,new AbortController);const t=this.combinedSignal(g(this,Ea));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},oA=function(){var t;(t=g(this,Ea))==null||t.abort(),C(this,Ea,null)},xw=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Nn=function(t){Object.entries(t).some(([n,o])=>g(this,$f)[n]!==o)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,$f),t)}),g(this,We)===Mt.HIGHLIGHT&&t.hasSelectedEditor===!1&&R(this,lt,ao).call(this,[[Vt.HIGHLIGHT_FREE,!0]]))},ao=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},_w=async function(){if(!g(this,_a)){C(this,_a,!0);const t=[];for(const e of g(this,ln).values())t.push(e.enable());await Promise.all(t);for(const e of g(this,ze).values())e.enable()}},ww=function(){if(this.unselectAll(),g(this,_a)){C(this,_a,!1);for(const t of g(this,ln).values())t.disable();for(const t of g(this,ze).values())t.disable()}},aA=function(t){const e=g(this,ln).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Mw=function(){let t=null;for(t of g(this,jt));return t},ff=function(){if(g(this,ze).size===0)return!0;if(g(this,ze).size===1)for(const t of g(this,ze).values())return t.isEmpty();return!1},rA=function(t){for(const e of g(this,jt))e.unselect();g(this,jt).clear();for(const e of t)e.isEmpty()||(g(this,jt).add(e),e.select());R(this,lt,Nn).call(this,{hasSelectedEditor:this.hasSelection})},ot(Hu,"TRANSLATE_SMALL",1),ot(Hu,"TRANSLATE_BIG",10);let Hl=Hu;var Qe,_s,ts,nc,ws,ui,ic,Ms,Wn,po,Gr,Rs,Da,ds,hf,Kg;const Dn=class Dn{constructor(t){w(this,ds);w(this,Qe,null);w(this,_s,!1);w(this,ts,null);w(this,nc,null);w(this,ws,null);w(this,ui,null);w(this,ic,!1);w(this,Ms,null);w(this,Wn,null);w(this,po,null);w(this,Gr,null);w(this,Rs,!1);C(this,Wn,t),C(this,Rs,t._uiManager.useNewAltTextFlow),g(Dn,Da)||C(Dn,Da,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Dn._l10n??(Dn._l10n=t)}async render(){const t=C(this,ts,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=C(this,nc,document.createElement("span"));t.append(e),g(this,Rs)?(t.classList.add("new"),t.setAttribute("data-l10n-id",g(Dn,Da).missing),e.setAttribute("data-l10n-id",g(Dn,Da)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=g(this,Wn)._uiManager._signal;t.addEventListener("contextmenu",fs,{signal:n}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:n});const o=r=>{r.preventDefault(),g(this,Wn)._uiManager.editAltText(g(this,Wn)),g(this,Rs)&&g(this,Wn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,ds,hf)}})};return t.addEventListener("click",o,{capture:!0,signal:n}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(C(this,ic,!0),o(r))},{signal:n}),await R(this,ds,Kg).call(this),t}finish(){g(this,ts)&&(g(this,ts).focus({focusVisible:g(this,ic)}),C(this,ic,!1))}isEmpty(){return g(this,Rs)?g(this,Qe)===null:!g(this,Qe)&&!g(this,_s)}hasData(){return g(this,Rs)?g(this,Qe)!==null||!!g(this,po):this.isEmpty()}get guessedText(){return g(this,po)}async setGuessedText(t){g(this,Qe)===null&&(C(this,po,t),C(this,Gr,await Dn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),R(this,ds,Kg).call(this))}toggleAltTextBadge(t=!1){var e;if(!g(this,Rs)||g(this,Qe)){(e=g(this,Ms))==null||e.remove(),C(this,Ms,null);return}if(!g(this,Ms)){const n=C(this,Ms,document.createElement("div"));n.className="noAltTextBadge",g(this,Wn).div.append(n)}g(this,Ms).classList.toggle("hidden",!t)}serialize(t){let e=g(this,Qe);return!t&&g(this,po)===e&&(e=g(this,Gr)),{altText:e,decorative:g(this,_s),guessedText:g(this,po),textWithDisclaimer:g(this,Gr)}}get data(){return{altText:g(this,Qe),decorative:g(this,_s)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:o,cancel:r=!1}){n&&(C(this,po,n),C(this,Gr,o)),!(g(this,Qe)===t&&g(this,_s)===e)&&(r||(C(this,Qe,t),C(this,_s,e)),R(this,ds,Kg).call(this))}toggle(t=!1){g(this,ts)&&(!t&&g(this,ui)&&(clearTimeout(g(this,ui)),C(this,ui,null)),g(this,ts).disabled=!t)}shown(){g(this,Wn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,ds,hf)}})}destroy(){var t,e;(t=g(this,ts))==null||t.remove(),C(this,ts,null),C(this,nc,null),C(this,ws,null),(e=g(this,Ms))==null||e.remove(),C(this,Ms,null)}};Qe=new WeakMap,_s=new WeakMap,ts=new WeakMap,nc=new WeakMap,ws=new WeakMap,ui=new WeakMap,ic=new WeakMap,Ms=new WeakMap,Wn=new WeakMap,po=new WeakMap,Gr=new WeakMap,Rs=new WeakMap,Da=new WeakMap,ds=new WeakSet,hf=function(){return g(this,Qe)&&"added"||g(this,Qe)===null&&this.guessedText&&"review"||"missing"},Kg=async function(){var o,r,u;const t=g(this,ts);if(!t)return;if(g(this,Rs)){if(t.classList.toggle("done",!!g(this,Qe)),t.setAttribute("data-l10n-id",g(Dn,Da)[g(this,ds,hf)]),(o=g(this,nc))==null||o.setAttribute("data-l10n-id",g(Dn,Da)[`${g(this,ds,hf)}-label`]),!g(this,Qe)){(r=g(this,ws))==null||r.remove();return}}else{if(!g(this,Qe)&&!g(this,_s)){t.classList.remove("done"),(u=g(this,ws))==null||u.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=g(this,ws);if(!e){C(this,ws,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${g(this,Wn).id}`;const c=100,f=g(this,Wn)._uiManager._signal;f.addEventListener("abort",()=>{clearTimeout(g(this,ui)),C(this,ui,null)},{once:!0}),t.addEventListener("mouseenter",()=>{C(this,ui,setTimeout(()=>{C(this,ui,null),g(this,ws).classList.add("show"),g(this,Wn)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:f}),t.addEventListener("mouseleave",()=>{var h;g(this,ui)&&(clearTimeout(g(this,ui)),C(this,ui,null)),(h=g(this,ws))==null||h.classList.remove("show")},{signal:f})}g(this,_s)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=g(this,Qe)),e.parentNode||t.append(e);const n=g(this,Wn).getElementForAltText();n==null||n.setAttribute("aria-describedby",e.id)},w(Dn,Da,null),ot(Dn,"_l10n",null);let bm=Dn;var sc,Vr,Jf,Kf,Wf,Qf,Zf,go,Hr,mo,zr,yo,or,Rw,Nw,Dw;const IT=class IT{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:o=null,onPinching:r=null,onPinchEnd:u=null,signal:c}){w(this,or);w(this,sc);w(this,Vr,!1);w(this,Jf,null);w(this,Kf);w(this,Wf);w(this,Qf);w(this,Zf);w(this,go,null);w(this,Hr);w(this,mo,null);w(this,zr);w(this,yo,null);C(this,sc,t),C(this,Jf,n),C(this,Kf,e),C(this,Wf,o),C(this,Qf,r),C(this,Zf,u),C(this,zr,new AbortController),C(this,Hr,AbortSignal.any([c,g(this,zr).signal])),t.addEventListener("touchstart",R(this,or,Rw).bind(this),{passive:!1,signal:g(this,Hr)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Vs.pixelRatio}destroy(){var t,e;(t=g(this,zr))==null||t.abort(),C(this,zr,null),(e=g(this,go))==null||e.abort(),C(this,go,null)}};sc=new WeakMap,Vr=new WeakMap,Jf=new WeakMap,Kf=new WeakMap,Wf=new WeakMap,Qf=new WeakMap,Zf=new WeakMap,go=new WeakMap,Hr=new WeakMap,mo=new WeakMap,zr=new WeakMap,yo=new WeakMap,or=new WeakSet,Rw=function(t){var o,r,u;if((o=g(this,Kf))!=null&&o.call(this))return;if(t.touches.length===1){if(g(this,go))return;const c=C(this,go,new AbortController),f=AbortSignal.any([g(this,Hr),c.signal]),h=g(this,sc),y={capture:!0,signal:f,passive:!1},A=S=>{var E;S.pointerType==="touch"&&((E=g(this,go))==null||E.abort(),C(this,go,null))};h.addEventListener("pointerdown",S=>{S.pointerType==="touch"&&(ke(S),A(S))},y),h.addEventListener("pointerup",A,y),h.addEventListener("pointercancel",A,y);return}if(!g(this,yo)){C(this,yo,new AbortController);const c=AbortSignal.any([g(this,Hr),g(this,yo).signal]),f=g(this,sc),h={signal:c,capture:!1,passive:!1};f.addEventListener("touchmove",R(this,or,Nw).bind(this),h);const y=R(this,or,Dw).bind(this);f.addEventListener("touchend",y,h),f.addEventListener("touchcancel",y,h),h.capture=!0,f.addEventListener("pointerdown",ke,h),f.addEventListener("pointermove",ke,h),f.addEventListener("pointercancel",ke,h),f.addEventListener("pointerup",ke,h),(r=g(this,Wf))==null||r.call(this)}if(ke(t),t.touches.length!==2||(u=g(this,Jf))!=null&&u.call(this)){C(this,mo,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),C(this,mo,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},Nw=function(t){var U;if(!g(this,mo)||t.touches.length!==2)return;ke(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:o,screenY:r}=e,{screenX:u,screenY:c}=n,f=g(this,mo),{touch0X:h,touch0Y:y,touch1X:A,touch1Y:S}=f,E=A-h,b=S-y,x=u-o,D=c-r,N=Math.hypot(x,D)||1,L=Math.hypot(E,b)||1;if(!g(this,Vr)&&Math.abs(L-N)<=IT.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=o,f.touch0Y=r,f.touch1X=u,f.touch1Y=c,!g(this,Vr)){C(this,Vr,!0);return}const P=[(o+u)/2,(r+c)/2];(U=g(this,Qf))==null||U.call(this,P,L,N)},Dw=function(t){var e;t.touches.length>=2||(g(this,yo)&&(g(this,yo).abort(),C(this,yo,null),(e=g(this,Zf))==null||e.call(this)),g(this,mo)&&(ke(t),C(this,mo,null),C(this,Vr,!1)))};let xm=IT;var qr,es,me,oc,Ia,jf,$r,un,Yr,vo,Pa,th,Xr,ci,eh,Jr,Ao,Ns,ac,rc,Vi,Kr,nh,Um,xt,lA,ih,uA,Wg,Iw,Pw,cA,Qg,dA,Lw,kw,Uw,fA,Fw,hA,Ow,Bw,Gw,pA,pf;const Pt=class Pt{constructor(t){w(this,xt);w(this,qr,null);w(this,es,null);w(this,me,null);w(this,oc,!1);w(this,Ia,null);w(this,jf,"");w(this,$r,!1);w(this,un,null);w(this,Yr,null);w(this,vo,null);w(this,Pa,null);w(this,th,"");w(this,Xr,!1);w(this,ci,null);w(this,eh,!1);w(this,Jr,!1);w(this,Ao,!1);w(this,Ns,null);w(this,ac,0);w(this,rc,0);w(this,Vi,null);w(this,Kr,null);ot(this,"isSelected",!1);ot(this,"_isCopy",!1);ot(this,"_editToolbar",null);ot(this,"_initialOptions",Object.create(null));ot(this,"_initialData",null);ot(this,"_isVisible",!0);ot(this,"_uiManager",null);ot(this,"_focusEventsAllowed",!0);w(this,nh,!1);w(this,Um,Pt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:o,pageX:r,pageY:u}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,o],this.pageTranslation=[r,u];const[c,f]=this.parentDimensions;this.x=t.x/c,this.y=t.y/f,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Pt.prototype._resizeWithKeyboard,e=Hl.TRANSLATE_SMALL,n=Hl.TRANSLATE_BIG;return Gt(this,"_resizerKeyboardManager",new dp([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Pt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new IB({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Pt._l10n??(Pt._l10n=t),Pt._l10nResizer||(Pt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Pt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Pt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ae("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,nh)}set _isDraggable(t){var e;C(this,nh,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,Um)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):R(this,xt,pf).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(g(this,Xr)?C(this,Xr,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,o){const[r,u]=this.parentDimensions;[n,o]=this.screenToPageTranslation(n,o),this.x=(t+n)/r,this.y=(e+o)/u,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,o]=this.parentDimensions;this.setAt(t*n,e*o,this.width*n,this.height*o),this._onTranslated()}translate(t,e){R(this,xt,lA).call(this,this.parentDimensions,t,e)}translateInPage(t,e){g(this,ci)||C(this,ci,[this.x,this.y,this.width,this.height]),R(this,xt,lA).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){g(this,ci)||C(this,ci,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[o,r]}=this;if(this.x+=t/o,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:A,y:S}=this.div.getBoundingClientRect();this.parent.findNewParent(this,A,S)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:u,y:c}=this;const[f,h]=this.getBaseTranslation();u+=f,c+=h;const{style:y}=n;y.left=`${(100*u).toFixed(2)}%`,y.top=`${(100*c).toFixed(2)}%`,this._onTranslating(u,c),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!g(this,ci)&&(g(this,ci)[0]!==this.x||g(this,ci)[1]!==this.y)}get _hasBeenResized(){return!!g(this,ci)&&(g(this,ci)[2]!==this.width||g(this,ci)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Pt,o=n/t,r=n/e;switch(this.rotation){case 90:return[-o,r];case 180:return[o,r];case 270:return[o,-r];default:return[-o,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,o]}=this;let{x:r,y:u,width:c,height:f}=this;if(c*=n,f*=o,r*=n,u*=o,this._mustFixPosition)switch(t){case 0:r=Un(r,0,n-c),u=Un(u,0,o-f);break;case 90:r=Un(r,0,n-f),u=Un(u,c,o);break;case 180:r=Un(r,c,n),u=Un(u,f,o);break;case 270:r=Un(r,f,n),u=Un(u,0,o-c);break}this.x=r/=n,this.y=u/=o;const[h,y]=this.getBaseTranslation();r+=h,u+=y,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*u).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return R(n=Pt,ih,uA).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return R(n=Pt,ih,uA).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,o]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/n).toFixed(2)}%`,g(this,$r)||(r.height=`${(100*e/o).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,o=n.endsWith("%"),r=!g(this,$r)&&e.endsWith("%");if(o&&r)return;const[u,c]=this.parentDimensions;o||(t.width=`${(100*parseFloat(n)/u).toFixed(2)}%`),!g(this,$r)&&!r&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=g(this,me))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||g(this,Jr))return this._editToolbar;this._editToolbar=new j0(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=g(this,me))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return g(this,me)||(bm.initialize(Pt._l10n),C(this,me,new bm(this)),g(this,qr)&&(g(this,me).data=g(this,qr),C(this,qr,null))),g(this,me)}get altTextData(){var t;return(t=g(this,me))==null?void 0:t.data}set altTextData(t){g(this,me)&&(g(this,me).data=t)}get guessedAltText(){var t;return(t=g(this,me))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=g(this,me))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=g(this,me))==null?void 0:e.serialize(t)}hasAltText(){return!!g(this,me)&&!g(this,me).isEmpty()}hasAltTextData(){var t;return((t=g(this,me))==null?void 0:t.hasData())??!1}render(){var u;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=g(this,oc)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),R(this,xt,hA).call(this);const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[o,r]=this.getInitialTranslation();return this.translate(o,r),yw(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,Kr)||C(this,Kr,new xm({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:R(this,xt,Lw).bind(this),onPinching:R(this,xt,kw).bind(this),onPinchEnd:R(this,xt,Uw).bind(this),signal:this._uiManager._signal}))),(u=this._uiManager._editorUndoBar)==null||u.hide(),t}pointerdown(t){const{isMac:e}=gn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(C(this,Xr,!0),this._isDraggable){R(this,xt,Fw).call(this,t);return}R(this,xt,fA).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,Ns)&&clearTimeout(g(this,Ns)),C(this,Ns,setTimeout(()=>{var t;C(this,Ns,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const o=this.parentScale,[r,u]=this.pageDimensions,[c,f]=this.pageTranslation,h=t/o,y=e/o,A=this.x*r,S=this.y*u,E=this.width*r,b=this.height*u;switch(n){case 0:return[A+h+c,u-S-y-b+f,A+h+E+c,u-S-y+f];case 90:return[A+y+c,u-S+h+f,A+y+b+c,u-S+h+E+f];case 180:return[A-h-E+c,u-S+y+f,A-h+c,u-S+y+b+f];case 270:return[A-y-b+c,u-S-h-E+f,A-y+c,u-S-h+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,o,r,u]=t,c=r-n,f=u-o;switch(this.rotation){case 0:return[n,e-u,c,f];case 90:return[n,e-o,f,c];case 180:return[r,e-o,c,f];case 270:return[r,e-u,f,c];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),C(this,Jr,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),C(this,Jr,!1),!0):!1}isInEditMode(){return g(this,Jr)}shouldGetKeyboardEvents(){return g(this,Ao)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:o}=this.getClientDimensions(),{innerHeight:r,innerWidth:u}=window;return e<u&&o>0&&t<r&&n>0}rebuild(){R(this,xt,hA).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){ae("An editor must be serializable")}static async deserialize(t,e,n){const o=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});o.rotation=t.rotation,C(o,qr,t.accessibilityData),o._isCopy=t.isCopy||!1;const[r,u]=o.pageDimensions,[c,f,h,y]=o.getRectInCurrentCoords(t.rect,u);return o.x=c/r,o.y=f/u,o.width=h/r,o.height=y/u,o}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=g(this,Pa))==null||t.abort(),C(this,Pa,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),g(this,Ns)&&(clearTimeout(g(this,Ns)),C(this,Ns,null)),R(this,xt,pf).call(this),this.removeEditToolbar(),g(this,Vi)){for(const n of g(this,Vi).values())clearTimeout(n);C(this,Vi,null)}this.parent=null,(e=g(this,Kr))==null||e.destroy(),C(this,Kr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(R(this,xt,Iw).call(this),g(this,un).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),C(this,vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=g(this,un).children;if(!g(this,es)){C(this,es,Array.from(e));const u=R(this,xt,Ow).bind(this),c=R(this,xt,Bw).bind(this),f=this._uiManager._signal;for(const h of g(this,es)){const y=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",u,{signal:f}),h.addEventListener("blur",c,{signal:f}),h.addEventListener("focus",R(this,xt,Gw).bind(this,y),{signal:f}),h.setAttribute("data-l10n-id",Pt._l10nResizer[y])}}const n=g(this,es)[0];let o=0;for(const u of e){if(u===n)break;o++}const r=(360-this.rotation+this.parentRotation)%360/90*(g(this,es).length/4);if(r!==o){if(r<o)for(let c=0;c<o-r;c++)g(this,un).append(g(this,un).firstChild);else if(r>o)for(let c=0;c<r-o;c++)g(this,un).firstChild.before(g(this,un).lastChild);let u=0;for(const c of e){const h=g(this,es)[u++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Pt._l10nResizer[h])}}R(this,xt,pA).call(this,0),C(this,Ao,!0),g(this,un).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){g(this,Ao)&&R(this,xt,dA).call(this,g(this,th),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){R(this,xt,pf).call(this),this.div.focus()}select(){var t,e,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var o,r;(o=this.div)!=null&&o.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(e=this._editToolbar)==null||e.show(),(n=g(this,me))==null||n.toggleAltTextBadge(!1)}}unselect(){var t,e,n,o,r;this.isSelected&&(this.isSelected=!1,(t=g(this,un))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(o=this._editToolbar)==null||o.hide(),(r=g(this,me))==null||r.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return g(this,eh)}set isEditing(t){C(this,eh,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){C(this,$r,!0);const n=t/e,{style:o}=this.div;o.aspectRatio=n,o.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){g(this,Vi)||C(this,Vi,new Map);const{action:n}=t;let o=g(this,Vi).get(n);o&&clearTimeout(o),o=setTimeout(()=>{this._reportTelemetry(t),g(this,Vi).delete(n),g(this,Vi).size===0&&C(this,Vi,null)},Pt._telemetryTimeout),g(this,Vi).set(n,o);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),C(this,oc,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,oc,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};qr=new WeakMap,es=new WeakMap,me=new WeakMap,oc=new WeakMap,Ia=new WeakMap,jf=new WeakMap,$r=new WeakMap,un=new WeakMap,Yr=new WeakMap,vo=new WeakMap,Pa=new WeakMap,th=new WeakMap,Xr=new WeakMap,ci=new WeakMap,eh=new WeakMap,Jr=new WeakMap,Ao=new WeakMap,Ns=new WeakMap,ac=new WeakMap,rc=new WeakMap,Vi=new WeakMap,Kr=new WeakMap,nh=new WeakMap,Um=new WeakMap,xt=new WeakSet,lA=function([t,e],n,o){[n,o]=this.screenToPageTranslation(n,o),this.x+=n/t,this.y+=o/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},ih=new WeakSet,uA=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Wg=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},Iw=function(){if(g(this,un))return;C(this,un,document.createElement("div")),g(this,un).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const o=document.createElement("div");g(this,un).append(o),o.classList.add("resizer",n),o.setAttribute("data-resizer-name",n),o.addEventListener("pointerdown",R(this,xt,Pw).bind(this,n),{signal:e}),o.addEventListener("contextmenu",fs,{signal:e}),o.tabIndex=-1}this.div.prepend(g(this,un))},Pw=function(t,e){var y;e.preventDefault();const{isMac:n}=gn.platform;if(e.button!==0||e.ctrlKey&&n)return;(y=g(this,me))==null||y.toggle(!1);const o=this._isDraggable;this._isDraggable=!1,C(this,Yr,[e.screenX,e.screenY]);const r=new AbortController,u=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",R(this,xt,dA).bind(this,t),{passive:!0,capture:!0,signal:u}),window.addEventListener("touchmove",ke,{passive:!1,signal:u}),window.addEventListener("contextmenu",fs,{signal:u}),C(this,vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const h=()=>{var A;r.abort(),this.parent.togglePointerEvents(!0),(A=g(this,me))==null||A.toggle(!0),this._isDraggable=o,this.parent.div.style.cursor=c,this.div.style.cursor=f,R(this,xt,Qg).call(this)};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})},cA=function(t,e,n,o){this.width=n,this.height=o,this.x=t,this.y=e;const[r,u]=this.parentDimensions;this.setDims(r*n,u*o),this.fixAndSetPosition(),this._onResized()},Qg=function(){if(!g(this,vo))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:o}=g(this,vo);C(this,vo,null);const r=this.x,u=this.y,c=this.width,f=this.height;r===t&&u===e&&c===n&&f===o||this.addCommands({cmd:R(this,xt,cA).bind(this,r,u,c,f),undo:R(this,xt,cA).bind(this,t,e,n,o),mustExec:!0})},dA=function(t,e){const[n,o]=this.parentDimensions,r=this.x,u=this.y,c=this.width,f=this.height,h=Pt.MIN_SIZE/n,y=Pt.MIN_SIZE/o,A=R(this,xt,Wg).call(this,this.rotation),S=(G,$)=>[A[0]*G+A[2]*$,A[1]*G+A[3]*$],E=R(this,xt,Wg).call(this,360-this.rotation),b=(G,$)=>[E[0]*G+E[2]*$,E[1]*G+E[3]*$];let x,D,N=!1,L=!1;switch(t){case"topLeft":N=!0,x=(G,$)=>[0,0],D=(G,$)=>[G,$];break;case"topMiddle":x=(G,$)=>[G/2,0],D=(G,$)=>[G/2,$];break;case"topRight":N=!0,x=(G,$)=>[G,0],D=(G,$)=>[0,$];break;case"middleRight":L=!0,x=(G,$)=>[G,$/2],D=(G,$)=>[0,$/2];break;case"bottomRight":N=!0,x=(G,$)=>[G,$],D=(G,$)=>[0,0];break;case"bottomMiddle":x=(G,$)=>[G/2,$],D=(G,$)=>[G/2,0];break;case"bottomLeft":N=!0,x=(G,$)=>[0,$],D=(G,$)=>[G,0];break;case"middleLeft":L=!0,x=(G,$)=>[0,$/2],D=(G,$)=>[G,$/2];break}const P=x(c,f),U=D(c,f);let k=S(...U);const F=Pt._round(r+k[0]),B=Pt._round(u+k[1]);let q=1,Y=1,Q,Z;if(e.fromKeyboard)({deltaX:Q,deltaY:Z}=e);else{const{screenX:G,screenY:$}=e,[rt,vt]=g(this,Yr);[Q,Z]=this.screenToPageTranslation(G-rt,$-vt),g(this,Yr)[0]=G,g(this,Yr)[1]=$}if([Q,Z]=b(Q/n,Z/o),N){const G=Math.hypot(c,f);q=Y=Math.max(Math.min(Math.hypot(U[0]-P[0]-Q,U[1]-P[1]-Z)/G,1/c,1/f),h/c,y/f)}else L?q=Un(Math.abs(U[0]-P[0]-Q),h,1)/c:Y=Un(Math.abs(U[1]-P[1]-Z),y,1)/f;const ut=Pt._round(c*q),St=Pt._round(f*Y);k=S(...D(ut,St));const gt=F-k[0],yt=B-k[1];g(this,ci)||C(this,ci,[this.x,this.y,this.width,this.height]),this.width=ut,this.height=St,this.x=gt,this.y=yt,this.setDims(n*ut,o*St),this.fixAndSetPosition(),this._onResizing()},Lw=function(){var t;C(this,vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=g(this,me))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},kw=function(t,e,n){let r=.7*(n/e)+1-.7;if(r===1)return;const u=R(this,xt,Wg).call(this,this.rotation),c=(F,B)=>[u[0]*F+u[2]*B,u[1]*F+u[3]*B],[f,h]=this.parentDimensions,y=this.x,A=this.y,S=this.width,E=this.height,b=Pt.MIN_SIZE/f,x=Pt.MIN_SIZE/h;r=Math.max(Math.min(r,1/S,1/E),b/S,x/E);const D=Pt._round(S*r),N=Pt._round(E*r);if(D===S&&N===E)return;g(this,ci)||C(this,ci,[y,A,S,E]);const L=c(S/2,E/2),P=Pt._round(y+L[0]),U=Pt._round(A+L[1]),k=c(D/2,N/2);this.x=P-k[0],this.y=U-k[1],this.width=D,this.height=N,this.setDims(f*D,h*N),this.fixAndSetPosition(),this._onResizing()},Uw=function(){var t;(t=g(this,me))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),R(this,xt,Qg).call(this)},fA=function(t){const{isMac:e}=gn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Fw=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const o=new AbortController,r=this._uiManager.combinedSignal(o),u={capture:!0,passive:!1,signal:r},c=h=>{o.abort(),C(this,Ia,null),C(this,Xr,!1),this._uiManager.endDragSession()||R(this,xt,fA).call(this,h),n&&this._onStopDragging()};e&&(C(this,ac,t.clientX),C(this,rc,t.clientY),C(this,Ia,t.pointerId),C(this,jf,t.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:y,clientY:A,pointerId:S}=h;if(S!==g(this,Ia)){ke(h);return}const[E,b]=this.screenToPageTranslation(y-g(this,ac),A-g(this,rc));C(this,ac,y),C(this,rc,A),this._uiManager.dragSelectedEditors(E,b)},u),window.addEventListener("touchmove",ke,u),window.addEventListener("pointerdown",h=>{h.pointerType===g(this,jf)&&(g(this,Kr)||h.isPrimary)&&c(h),ke(h)},u));const f=h=>{if(!g(this,Ia)||g(this,Ia)===h.pointerId){c(h);return}ke(h)};window.addEventListener("pointerup",f,{signal:r}),window.addEventListener("blur",f,{signal:r})},hA=function(){if(g(this,Pa)||!this.div)return;C(this,Pa,new AbortController);const t=this._uiManager.combinedSignal(g(this,Pa));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Ow=function(t){Pt._resizerKeyboardManager.exec(this,t)},Bw=function(t){var e;g(this,Ao)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==g(this,un)&&R(this,xt,pf).call(this)},Gw=function(t){C(this,th,g(this,Ao)?t:"")},pA=function(t){if(g(this,es))for(const e of g(this,es))e.tabIndex=t},pf=function(){C(this,Ao,!1),R(this,xt,pA).call(this,-1),R(this,xt,Qg).call(this)},w(Pt,ih),ot(Pt,"_l10n",null),ot(Pt,"_l10nResizer",null),ot(Pt,"_borderLineWidth",-1),ot(Pt,"_colorManager",new eA),ot(Pt,"_zIndex",1),ot(Pt,"_telemetryTimeout",1e3);let fe=Pt;class IB extends fe{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const i_=3285377520,Fi=4294901760,Ts=65535;class Vw{constructor(t){this.h1=t?t&4294967295:i_,this.h2=t?t&4294967295:i_}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let x=0,D=t.length;x<D;x++){const N=t.charCodeAt(x);N<=255?e[n++]=N:(e[n++]=N>>>8,e[n++]=N&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const o=n>>2,r=n-o*4,u=new Uint32Array(e.buffer,0,o);let c=0,f=0,h=this.h1,y=this.h2;const A=3432918353,S=461845907,E=A&Ts,b=S&Ts;for(let x=0;x<o;x++)x&1?(c=u[x],c=c*A&Fi|c*E&Ts,c=c<<15|c>>>17,c=c*S&Fi|c*b&Ts,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(f=u[x],f=f*A&Fi|f*E&Ts,f=f<<15|f>>>17,f=f*S&Fi|f*b&Ts,y^=f,y=y<<13|y>>>19,y=y*5+3864292196);switch(c=0,r){case 3:c^=e[o*4+2]<<16;case 2:c^=e[o*4+1]<<8;case 1:c^=e[o*4],c=c*A&Fi|c*E&Ts,c=c<<15|c>>>17,c=c*S&Fi|c*b&Ts,o&1?h^=c:y^=c}this.h1=h,this.h2=y}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Fi|t*36045&Ts,e=e*4283543511&Fi|((e<<16|t>>>16)*2950163797&Fi)>>>16,t^=e>>>1,t=t*444984403&Fi|t*60499&Ts,e=e*3301882366&Fi|((e<<16|t>>>16)*3120437893&Fi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const gA=Object.freeze({map:null,hash:"",transfer:void 0});var Wr,Qr,cn,Fm,Hw;class xT{constructor(){w(this,Fm);w(this,Wr,!1);w(this,Qr,null);w(this,cn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=g(this,cn).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return g(this,cn).get(t)}remove(t){if(g(this,cn).delete(t),g(this,cn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of g(this,cn).values())if(e instanceof fe)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=g(this,cn).get(t);let o=!1;if(n!==void 0)for(const[r,u]of Object.entries(e))n[r]!==u&&(o=!0,n[r]=u);else o=!0,g(this,cn).set(t,e);o&&R(this,Fm,Hw).call(this),e instanceof fe&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return g(this,cn).has(t)}get size(){return g(this,cn).size}resetModified(){g(this,Wr)&&(C(this,Wr,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new zw(this)}get serializable(){if(g(this,cn).size===0)return gA;const t=new Map,e=new Vw,n=[],o=Object.create(null);let r=!1;for(const[u,c]of g(this,cn)){const f=c instanceof fe?c.serialize(!1,o):c;f&&(t.set(u,f),e.update(`${u}:${JSON.stringify(f)}`),r||(r=!!f.bitmap))}if(r)for(const u of t.values())u.bitmap&&n.push(u.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:gA}get editorStats(){let t=null;const e=new Map;for(const n of g(this,cn).values()){if(!(n instanceof fe))continue;const o=n.telemetryFinalData;if(!o)continue;const{type:r}=o;e.has(r)||e.set(r,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const u=t[r]||(t[r]=new Map);for(const[c,f]of Object.entries(o)){if(c==="type")continue;let h=u.get(c);h||(h=new Map,u.set(c,h));const y=h.get(f)??0;h.set(f,y+1)}}for(const[n,o]of e)t[n]=o.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){C(this,Qr,null)}get modifiedIds(){if(g(this,Qr))return g(this,Qr);const t=[];for(const e of g(this,cn).values())!(e instanceof fe)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return C(this,Qr,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return g(this,cn).entries()}}Wr=new WeakMap,Qr=new WeakMap,cn=new WeakMap,Fm=new WeakSet,Hw=function(){g(this,Wr)||(C(this,Wr,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var sh;class zw extends xT{constructor(e){super();w(this,sh);const{map:n,hash:o,transfer:r}=e.serializable,u=structuredClone(n,r?{transfer:r}:null);C(this,sh,{map:u,hash:o,transfer:r})}get print(){ae("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,sh)}get modifiedIds(){return Gt(this,"modifiedIds",{ids:new Set,hash:""})}}sh=new WeakMap;var lc;class PB{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){w(this,lc,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),g(this,lc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||g(this,lc).has(t.loadedName))){if(Ue(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:o,src:r,style:u}=t,c=new FontFace(o,r,u);this.addNativeFontFace(c);try{await c.load(),g(this,lc).add(o),n==null||n(t)}catch{Rt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}ae("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(o){throw Rt(`Failed to load font '${n.family}': '${o}'.`),t.disableFontFace=!0,o}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const o=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,o)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Gt(this,"isSyncFontLoadingSupported",kn||gn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ue(!o.done,"completeRequest() cannot be called twice."),o.done=!0;n.length>0&&n[0].done;){const r=n.shift();setTimeout(r.callback,0)}}const{loadingRequests:n}=this,o={done:!1,complete:e,callback:t};return n.push(o),o}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(U,k){return U.charCodeAt(k)<<24|U.charCodeAt(k+1)<<16|U.charCodeAt(k+2)<<8|U.charCodeAt(k+3)&255}function o(U,k,F,B){const q=U.substring(0,k),Y=U.substring(k+F);return q+B+Y}let r,u;const c=this._document.createElement("canvas");c.width=1,c.height=1;const f=c.getContext("2d");let h=0;function y(U,k){if(++h>30){Rt("Load test font never loaded."),k();return}if(f.font="30px "+U,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(y.bind(null,U,k))}const A=`lt${Date.now()}${this.loadTestFontId++}`;let S=this._loadTestFont;S=o(S,976,A.length,A);const b=16,x=1482184792;let D=n(S,b);for(r=0,u=A.length-3;r<u;r+=4)D=D-x+n(A,r)|0;r<A.length&&(D=D-x+n(A+"XXX",r)|0),S=o(S,b,4,yB(D));const N=`url(data:font/opentype;base64,${btoa(S)});`,L=`@font-face {font-family:"${A}";src:${N}}`;this.insertRule(L);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const U of[t.loadedName,A]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=U,P.append(k)}this._document.body.append(P),y(A,()=>{P.remove(),e.complete()})}}lc=new WeakMap;class LB{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${cw(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let o=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(o+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${o}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let o;try{o=t.get(n)}catch(u){Rt(`getPathGenerator - ignoring character: "${u}".`)}const r=new Path2D(o||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=r}}function kB(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(kn)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function UB(i){if(kn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return lp(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Lg(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const mA=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,FB=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",OB=EB.bind(null,mA,FB);var To,Om;class BB{constructor(){w(this,To,new Map);w(this,Om,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};g(this,Om).then(()=>{for(const[o]of g(this,To))o.call(this,n)})}addEventListener(t,e,n=null){let o=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:r}=n;if(r.aborted){Rt("LoopbackPort - cannot use an `aborted` signal.");return}const u=()=>this.removeEventListener(t,e);o=()=>r.removeEventListener("abort",u),r.addEventListener("abort",u)}g(this,To).set(e,o)}removeEventListener(t,e){const n=g(this,To).get(e);n==null||n(),g(this,To).delete(e)}terminate(){for(const[,t]of g(this,To))t==null||t();g(this,To).clear()}}To=new WeakMap,Om=new WeakMap;const kg={DATA:1,ERROR:2},Pe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function s_(){}function Jn(i){if(i instanceof nr||i instanceof W0||i instanceof t_||i instanceof Cm||i instanceof w0)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||ae('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new nr(i.message);case"InvalidPDFException":return new W0(i.message);case"PasswordException":return new t_(i.message,i.code);case"ResponseException":return new Cm(i.message,i.status,i.missing);case"UnknownErrorException":return new w0(i.message,i.details)}return new w0(i.message,i.toString())}var uc,Ji,qw,$w,Yw,Zg;class gf{constructor(t,e,n){w(this,Ji);w(this,uc,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",R(this,Ji,qw).bind(this),{signal:g(this,uc).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const o=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[o]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:o,data:e},n)}catch(u){r.reject(u)}return r.promise}sendWithStream(t,e,n,o){const r=this.streamId++,u=this.sourceName,c=this.targetName,f=this.comObj;return new ReadableStream({start:h=>{const y=Promise.withResolvers();return this.streamControllers[r]={controller:h,startCall:y,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:u,targetName:c,action:t,streamId:r,data:e,desiredSize:h.desiredSize},o),y.promise},pull:h=>{const y=Promise.withResolvers();return this.streamControllers[r].pullCall=y,f.postMessage({sourceName:u,targetName:c,stream:Pe.PULL,streamId:r,desiredSize:h.desiredSize}),y.promise},cancel:h=>{Ue(h instanceof Error,"cancel must have a valid reason");const y=Promise.withResolvers();return this.streamControllers[r].cancelCall=y,this.streamControllers[r].isClosed=!0,f.postMessage({sourceName:u,targetName:c,stream:Pe.CANCEL,streamId:r,reason:Jn(h)}),y.promise}},n)}destroy(){var t;(t=g(this,uc))==null||t.abort(),C(this,uc,null)}}uc=new WeakMap,Ji=new WeakSet,qw=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){R(this,Ji,Yw).call(this,t);return}if(t.callback){const n=t.callbackId,o=this.callbackCapabilities[n];if(!o)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===kg.DATA)o.resolve(t.data);else if(t.callback===kg.ERROR)o.reject(Jn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,o=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(u){r.postMessage({sourceName:n,targetName:o,callback:kg.DATA,callbackId:t.callbackId,data:u})},function(u){r.postMessage({sourceName:n,targetName:o,callback:kg.ERROR,callbackId:t.callbackId,reason:Jn(u)})});return}if(t.streamId){R(this,Ji,$w).call(this,t);return}e(t.data)},$w=function(t){const e=t.streamId,n=this.sourceName,o=t.sourceName,r=this.comObj,u=this,c=this.actionHandler[t.action],f={enqueue(h,y=1,A){if(this.isCancelled)return;const S=this.desiredSize;this.desiredSize-=y,S>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:o,stream:Pe.ENQUEUE,streamId:e,chunk:h},A)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:o,stream:Pe.CLOSE,streamId:e}),delete u.streamSinks[e])},error(h){Ue(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:o,stream:Pe.ERROR,streamId:e,reason:Jn(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[e]=f,Promise.try(c,t.data,f).then(function(){r.postMessage({sourceName:n,targetName:o,stream:Pe.START_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:Pe.START_COMPLETE,streamId:e,reason:Jn(h)})})},Yw=function(t){const e=t.streamId,n=this.sourceName,o=t.sourceName,r=this.comObj,u=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case Pe.START_COMPLETE:t.success?u.startCall.resolve():u.startCall.reject(Jn(t.reason));break;case Pe.PULL_COMPLETE:t.success?u.pullCall.resolve():u.pullCall.reject(Jn(t.reason));break;case Pe.PULL:if(!c){r.postMessage({sourceName:n,targetName:o,stream:Pe.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||s_).then(function(){r.postMessage({sourceName:n,targetName:o,stream:Pe.PULL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:Pe.PULL_COMPLETE,streamId:e,reason:Jn(h)})});break;case Pe.ENQUEUE:if(Ue(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(t.chunk);break;case Pe.CLOSE:if(Ue(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),R(this,Ji,Zg).call(this,u,e);break;case Pe.ERROR:Ue(u,"error should have stream controller"),u.controller.error(Jn(t.reason)),R(this,Ji,Zg).call(this,u,e);break;case Pe.CANCEL_COMPLETE:t.success?u.cancelCall.resolve():u.cancelCall.reject(Jn(t.reason)),R(this,Ji,Zg).call(this,u,e);break;case Pe.CANCEL:if(!c)break;const f=Jn(t.reason);Promise.try(c.onCancel||s_,f).then(function(){r.postMessage({sourceName:n,targetName:o,stream:Pe.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:Pe.CANCEL_COMPLETE,streamId:e,reason:Jn(h)})}),c.sinkCapability.reject(f),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Zg=async function(t,e){var n,o,r;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(o=t.pullCall)==null?void 0:o.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var oh;class Xw{constructor({enableHWA:t=!1}){w(this,oh,!1);C(this,oh,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!g(this,oh)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ae("Abstract method `_createCanvas` called.")}}oh=new WeakMap;class GB extends Xw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class Jw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class o_ extends Jw{async _fetch(t){const e=await up(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):lp(e)}}class Kw{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,o,r){return"none"}destroy(t=!1){}}var Zr,cc,So,Eo,En,jr,tl,ct,Tn,mf,Lu,jg,ku,Ww,yA,Uu,yf,vf,vA,Af;class VB extends Kw{constructor({docId:e,ownerDocument:n=globalThis.document}){super();w(this,ct);w(this,Zr);w(this,cc);w(this,So);w(this,Eo);w(this,En);w(this,jr);w(this,tl,0);C(this,Eo,e),C(this,En,n)}addFilter(e){if(!e)return"none";let n=g(this,ct,Tn).get(e);if(n)return n;const[o,r,u]=R(this,ct,jg).call(this,e),c=e.length===1?o:`${o}${r}${u}`;if(n=g(this,ct,Tn).get(c),n)return g(this,ct,Tn).set(e,n),n;const f=`g_${g(this,Eo)}_transfer_map_${Rn(this,tl)._++}`,h=R(this,ct,ku).call(this,f);g(this,ct,Tn).set(e,h),g(this,ct,Tn).set(c,h);const y=R(this,ct,Uu).call(this,f);return R(this,ct,vf).call(this,o,r,u,y),h}addHCMFilter(e,n){var b;const o=`${e}-${n}`,r="base";let u=g(this,ct,mf).get(r);if((u==null?void 0:u.key)===o||(u?((b=u.filter)==null||b.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},g(this,ct,mf).set(r,u)),!e||!n))return u.url;const c=R(this,ct,Af).call(this,e);e=Ct.makeHexColor(...c);const f=R(this,ct,Af).call(this,n);if(n=Ct.makeHexColor(...f),g(this,ct,Lu).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return u.url;const h=new Array(256);for(let x=0;x<=255;x++){const D=x/255;h[x]=D<=.03928?D/12.92:((D+.055)/1.055)**2.4}const y=h.join(","),A=`g_${g(this,Eo)}_hcm_filter`,S=u.filter=R(this,ct,Uu).call(this,A);R(this,ct,vf).call(this,y,y,y,S),R(this,ct,yA).call(this,S);const E=(x,D)=>{const N=c[x]/255,L=f[x]/255,P=new Array(D+1);for(let U=0;U<=D;U++)P[U]=N+U/D*(L-N);return P.join(",")};return R(this,ct,vf).call(this,E(0,5),E(1,5),E(2,5),S),u.url=R(this,ct,ku).call(this,A),u.url}addAlphaFilter(e){let n=g(this,ct,Tn).get(e);if(n)return n;const[o]=R(this,ct,jg).call(this,[e]),r=`alpha_${o}`;if(n=g(this,ct,Tn).get(r),n)return g(this,ct,Tn).set(e,n),n;const u=`g_${g(this,Eo)}_alpha_map_${Rn(this,tl)._++}`,c=R(this,ct,ku).call(this,u);g(this,ct,Tn).set(e,c),g(this,ct,Tn).set(r,c);const f=R(this,ct,Uu).call(this,u);return R(this,ct,vA).call(this,o,f),c}addLuminosityFilter(e){let n=g(this,ct,Tn).get(e||"luminosity");if(n)return n;let o,r;if(e?([o]=R(this,ct,jg).call(this,[e]),r=`luminosity_${o}`):r="luminosity",n=g(this,ct,Tn).get(r),n)return g(this,ct,Tn).set(e,n),n;const u=`g_${g(this,Eo)}_luminosity_map_${Rn(this,tl)._++}`,c=R(this,ct,ku).call(this,u);g(this,ct,Tn).set(e,c),g(this,ct,Tn).set(r,c);const f=R(this,ct,Uu).call(this,u);return R(this,ct,Ww).call(this,f),e&&R(this,ct,vA).call(this,o,f),c}addHighlightHCMFilter(e,n,o,r,u){var L;const c=`${n}-${o}-${r}-${u}`;let f=g(this,ct,mf).get(e);if((f==null?void 0:f.key)===c||(f?((L=f.filter)==null||L.remove(),f.key=c,f.url="none",f.filter=null):(f={key:c,url:"none",filter:null},g(this,ct,mf).set(e,f)),!n||!o))return f.url;const[h,y]=[n,o].map(R(this,ct,Af).bind(this));let A=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),S=Math.round(.2126*y[0]+.7152*y[1]+.0722*y[2]),[E,b]=[r,u].map(R(this,ct,Af).bind(this));S<A&&([A,S,E,b]=[S,A,b,E]),g(this,ct,Lu).style.color="";const x=(P,U,k)=>{const F=new Array(256),B=(S-A)/k,q=P/255,Y=(U-P)/(255*k);let Q=0;for(let Z=0;Z<=k;Z++){const ut=Math.round(A+Z*B),St=q+Z*Y;for(let gt=Q;gt<=ut;gt++)F[gt]=St;Q=ut+1}for(let Z=Q;Z<256;Z++)F[Z]=F[Q-1];return F.join(",")},D=`g_${g(this,Eo)}_hcm_${e}_filter`,N=f.filter=R(this,ct,Uu).call(this,D);return R(this,ct,yA).call(this,N),R(this,ct,vf).call(this,x(E[0],b[0],5),x(E[1],b[1],5),x(E[2],b[2],5),N),f.url=R(this,ct,ku).call(this,D),f.url}destroy(e=!1){var n,o,r,u;e&&((n=g(this,jr))!=null&&n.size)||((o=g(this,So))==null||o.parentNode.parentNode.remove(),C(this,So,null),(r=g(this,cc))==null||r.clear(),C(this,cc,null),(u=g(this,jr))==null||u.clear(),C(this,jr,null),C(this,tl,0))}}Zr=new WeakMap,cc=new WeakMap,So=new WeakMap,Eo=new WeakMap,En=new WeakMap,jr=new WeakMap,tl=new WeakMap,ct=new WeakSet,Tn=function(){return g(this,cc)||C(this,cc,new Map)},mf=function(){return g(this,jr)||C(this,jr,new Map)},Lu=function(){if(!g(this,So)){const e=g(this,En).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const o=g(this,En).createElementNS(oo,"svg");o.setAttribute("width",0),o.setAttribute("height",0),C(this,So,g(this,En).createElementNS(oo,"defs")),e.append(o),o.append(g(this,So)),g(this,En).body.append(e)}return g(this,So)},jg=function(e){if(e.length===1){const h=e[0],y=new Array(256);for(let S=0;S<256;S++)y[S]=h[S]/255;const A=y.join(",");return[A,A,A]}const[n,o,r]=e,u=new Array(256),c=new Array(256),f=new Array(256);for(let h=0;h<256;h++)u[h]=n[h]/255,c[h]=o[h]/255,f[h]=r[h]/255;return[u.join(","),c.join(","),f.join(",")]},ku=function(e){if(g(this,Zr)===void 0){C(this,Zr,"");const n=g(this,En).URL;n!==g(this,En).baseURI&&(ny(n)?Rt('#createUrl: ignore "data:"-URL for performance reasons.'):C(this,Zr,rw(n,"")))}return`url(${g(this,Zr)}#${e})`},Ww=function(e){const n=g(this,En).createElementNS(oo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},yA=function(e){const n=g(this,En).createElementNS(oo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},Uu=function(e){const n=g(this,En).createElementNS(oo,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),g(this,ct,Lu).append(n),n},yf=function(e,n,o){const r=g(this,En).createElementNS(oo,n);r.setAttribute("type","discrete"),r.setAttribute("tableValues",o),e.append(r)},vf=function(e,n,o,r){const u=g(this,En).createElementNS(oo,"feComponentTransfer");r.append(u),R(this,ct,yf).call(this,u,"feFuncR",e),R(this,ct,yf).call(this,u,"feFuncG",n),R(this,ct,yf).call(this,u,"feFuncB",o)},vA=function(e,n){const o=g(this,En).createElementNS(oo,"feComponentTransfer");n.append(o),R(this,ct,yf).call(this,o,"feFuncA",e)},Af=function(e){return g(this,ct,Lu).style.color=e,bT(getComputedStyle(g(this,ct,Lu)).getPropertyValue("color"))};class Qw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class a_ extends Qw{async _fetch(t){const e=await up(t,"arraybuffer");return new Uint8Array(e)}}class Zw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class r_ extends Zw{async _fetch(t){const e=await up(t,"arraybuffer");return new Uint8Array(e)}}kn&&Rt("Please use the `legacy` build in Node.js environments.");async function _T(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class HB extends Kw{}class zB extends Xw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class qB extends Jw{async _fetch(t){return _T(t)}}class $B extends Qw{async _fetch(t){return _T(t)}}class YB extends Zw{async _fetch(t){return _T(t)}}const hn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function AA(i,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],o=new Path2D;o.rect(t[0],t[1],e,n),i.clip(o)}class wT{isModifyingCurrentTransform(){return!1}getPattern(){ae("Abstract method `getPattern` called.")}}class XB extends wT{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,o){let r;if(o===hn.STROKE||o===hn.FILL){const u=e.current.getClippedPathBoundingBox(o,Se(t))||[0,0,0,0],c=Math.ceil(u[2]-u[0])||1,f=Math.ceil(u[3]-u[1])||1,h=e.cachedCanvases.getCanvas("pattern",c,f),y=h.context;y.clearRect(0,0,y.canvas.width,y.canvas.height),y.beginPath(),y.rect(0,0,y.canvas.width,y.canvas.height),y.translate(-u[0],-u[1]),n=Ct.transform(n,[1,0,0,1,u[0],u[1]]),y.transform(...e.baseTransform),this.matrix&&y.transform(...this.matrix),AA(y,this._bbox),y.fillStyle=this._createGradient(y),y.fill(),r=t.createPattern(h.canvas,"no-repeat");const A=new DOMMatrix(n);r.setTransform(A)}else AA(t,this._bbox),r=this._createGradient(t);return r}}function N0(i,t,e,n,o,r,u,c){const f=t.coords,h=t.colors,y=i.data,A=i.width*4;let S;f[e+1]>f[n+1]&&(S=e,e=n,n=S,S=r,r=u,u=S),f[n+1]>f[o+1]&&(S=n,n=o,o=S,S=u,u=c,c=S),f[e+1]>f[n+1]&&(S=e,e=n,n=S,S=r,r=u,u=S);const E=(f[e]+t.offsetX)*t.scaleX,b=(f[e+1]+t.offsetY)*t.scaleY,x=(f[n]+t.offsetX)*t.scaleX,D=(f[n+1]+t.offsetY)*t.scaleY,N=(f[o]+t.offsetX)*t.scaleX,L=(f[o+1]+t.offsetY)*t.scaleY;if(b>=L)return;const P=h[r],U=h[r+1],k=h[r+2],F=h[u],B=h[u+1],q=h[u+2],Y=h[c],Q=h[c+1],Z=h[c+2],ut=Math.round(b),St=Math.round(L);let gt,yt,G,$,rt,vt,V,j;for(let st=ut;st<=St;st++){if(st<D){const kt=st<b?0:(b-st)/(b-D);gt=E-(E-x)*kt,yt=P-(P-F)*kt,G=U-(U-B)*kt,$=k-(k-q)*kt}else{let kt;st>L?kt=1:D===L?kt=0:kt=(D-st)/(D-L),gt=x-(x-N)*kt,yt=F-(F-Y)*kt,G=B-(B-Q)*kt,$=q-(q-Z)*kt}let it;st<b?it=0:st>L?it=1:it=(b-st)/(b-L),rt=E-(E-N)*it,vt=P-(P-Y)*it,V=U-(U-Q)*it,j=k-(k-Z)*it;const dt=Math.round(Math.min(gt,rt)),Nt=Math.round(Math.max(gt,rt));let Et=A*st+dt*4;for(let kt=dt;kt<=Nt;kt++)it=(gt-kt)/(gt-rt),it<0?it=0:it>1&&(it=1),y[Et++]=yt-(yt-vt)*it|0,y[Et++]=G-(G-V)*it|0,y[Et++]=$-($-j)*it|0,y[Et++]=255}}function JB(i,t,e){const n=t.coords,o=t.colors;let r,u;switch(t.type){case"lattice":const c=t.verticesPerRow,f=Math.floor(n.length/c)-1,h=c-1;for(r=0;r<f;r++){let y=r*c;for(let A=0;A<h;A++,y++)N0(i,e,n[y],n[y+1],n[y+c],o[y],o[y+1],o[y+c]),N0(i,e,n[y+c+1],n[y+1],n[y+c],o[y+c+1],o[y+1],o[y+c])}break;case"triangles":for(r=0,u=n.length;r<u;r+=3)N0(i,e,n[r],n[r+1],n[r+2],o[r],o[r+1],o[r+2]);break;default:throw new Error("illegal figure")}}class KB extends wT{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const c=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,y=Math.ceil(this._bounds[3])-f,A=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(y*t[1]*1.1)),3e3),E=h/A,b=y/S,x={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-f,scaleX:1/E,scaleY:1/b},D=A+2*2,N=S+2*2,L=n.getCanvas("mesh",D,N),P=L.context,U=P.createImageData(A,S);if(e){const F=U.data;for(let B=0,q=F.length;B<q;B+=4)F[B]=e[0],F[B+1]=e[1],F[B+2]=e[2],F[B+3]=255}for(const F of this._figures)JB(U,F,x);return P.putImageData(U,2,2),{canvas:L.canvas,offsetX:c-2*E,offsetY:f-2*b,scaleX:E,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,o){AA(t,this._bbox);const r=new Float32Array(2);if(o===hn.SHADING)Ct.singularValueDecompose2dScale(Se(t),r);else if(this.matrix){Ct.singularValueDecompose2dScale(this.matrix,r);const[c,f]=r;Ct.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=c,r[1]*=f}else Ct.singularValueDecompose2dScale(e.baseTransform,r);const u=this._createMeshCanvas(r,o===hn.SHADING?null:this._background,e.cachedCanvases);return o!==hn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(u.offsetX,u.offsetY),t.scale(u.scaleX,u.scaleY),t.createPattern(u.canvas,"no-repeat")}}class WB extends wT{getPattern(){return"hotpink"}}function QB(i){switch(i[0]){case"RadialAxial":return new XB(i);case"Mesh":return new KB(i);case"Dummy":return new WB}throw new Error(`Unknown IR type: ${i[0]}`)}const l_={COLORED:1,UNCOLORED:2},Bm=class Bm{constructor(t,e,n,o){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=o}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:o,tilingType:r,color:u,canvasGraphicsFactory:c}=this;let{xstep:f,ystep:h}=this;f=Math.abs(f),h=Math.abs(h),ey("TilingType: "+r);const y=e[0],A=e[1],S=e[2],E=e[3],b=S-y,x=E-A,D=new Float32Array(2);Ct.singularValueDecompose2dScale(this.matrix,D);const[N,L]=D;Ct.singularValueDecompose2dScale(this.baseTransform,D);const P=N*D[0],U=L*D[1];let k=b,F=x,B=!1,q=!1;const Y=Math.ceil(f*P),Q=Math.ceil(h*U),Z=Math.ceil(b*P),ut=Math.ceil(x*U);Y>=Z?k=f:B=!0,Q>=ut?F=h:q=!0;const St=this.getSizeAndScale(k,this.ctx.canvas.width,P),gt=this.getSizeAndScale(F,this.ctx.canvas.height,U),yt=t.cachedCanvases.getCanvas("pattern",St.size,gt.size),G=yt.context,$=c.createCanvasGraphics(G);if($.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext($,o,u),G.translate(-St.scale*y,-gt.scale*A),$.transform(St.scale,0,0,gt.scale,0,0),G.save(),this.clipBbox($,y,A,S,E),$.baseTransform=Se($.ctx),$.executeOperatorList(n),$.endDrawing(),G.restore(),B||q){const rt=yt.canvas;B&&(k=f),q&&(F=h);const vt=this.getSizeAndScale(k,this.ctx.canvas.width,P),V=this.getSizeAndScale(F,this.ctx.canvas.height,U),j=vt.size,st=V.size,it=t.cachedCanvases.getCanvas("pattern-workaround",j,st),dt=it.context,Nt=B?Math.floor(b/f):0,Et=q?Math.floor(x/h):0;for(let kt=0;kt<=Nt;kt++)for(let Yt=0;Yt<=Et;Yt++)dt.drawImage(rt,j*kt,st*Yt,j,st,0,0,j,st);return{canvas:it.canvas,scaleX:vt.scale,scaleY:V.scale,offsetX:y,offsetY:A}}return{canvas:yt.canvas,scaleX:St.scale,scaleY:gt.scale,offsetX:y,offsetY:A}}getSizeAndScale(t,e,n){const o=Math.max(Bm.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*n);return r>=o?r=o:n=r/t,{scale:n,size:r}}clipBbox(t,e,n,o,r){const u=o-e,c=r-n;t.ctx.rect(e,n,u,c),Ct.axialAlignedBoundingBox([e,n,o,r],Se(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const o=t.ctx,r=t.current;switch(e){case l_.COLORED:const{fillStyle:u,strokeStyle:c}=this.ctx;o.fillStyle=r.fillColor=u,o.strokeStyle=r.strokeColor=c;break;case l_.UNCOLORED:o.fillStyle=o.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new mB(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,o){let r=n;o!==hn.SHADING&&(r=Ct.transform(r,e.baseTransform),this.matrix&&(r=Ct.transform(r,this.matrix)));const u=this.createPatternCanvas(e);let c=new DOMMatrix(r);c=c.translate(u.offsetX,u.offsetY),c=c.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(c),f}};ot(Bm,"MAX_PATTERN_SIZE",3e3);let TA=Bm;function ZB({src:i,srcPos:t=0,dest:e,width:n,height:o,nonBlackColor:r=4294967295,inverseDecode:u=!1}){const c=gn.isLittleEndian?4278190080:255,[f,h]=u?[r,c]:[c,r],y=n>>3,A=n&7,S=i.length;e=new Uint32Array(e.buffer);let E=0;for(let b=0;b<o;b++){for(const D=t+y;t<D;t++){const N=t<S?i[t]:255;e[E++]=N&128?h:f,e[E++]=N&64?h:f,e[E++]=N&32?h:f,e[E++]=N&16?h:f,e[E++]=N&8?h:f,e[E++]=N&4?h:f,e[E++]=N&2?h:f,e[E++]=N&1?h:f}if(A===0)continue;const x=t<S?i[t++]:255;for(let D=0;D<A;D++)e[E++]=x&1<<7-D?h:f}return{srcPos:t,destPos:E}}const u_=16,c_=100,jB=15,d_=10,jn=16,D0=new DOMMatrix,Ci=new Float32Array(2),Vu=new Float32Array([1/0,1/0,-1/0,-1/0]);function t3(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},i.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},i.transform=function(e,n,o,r,u,c){t.transform(e,n,o,r,u,c),this.__originalTransform(e,n,o,r,u,c)},i.setTransform=function(e,n,o,r,u,c){t.setTransform(e,n,o,r,u,c),this.__originalSetTransform(e,n,o,r,u,c)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},i.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},i.bezierCurveTo=function(e,n,o,r,u,c){t.bezierCurveTo(e,n,o,r,u,c),this.__originalBezierCurveTo(e,n,o,r,u,c)},i.rect=function(e,n,o,r){t.rect(e,n,o,r),this.__originalRect(e,n,o,r)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class e3{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let o;return this.cache[t]!==void 0?(o=this.cache[t],this.canvasFactory.reset(o,e,n)):(o=this.canvasFactory.create(e,n),this.cache[t]=o),o}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Ug(i,t,e,n,o,r,u,c,f,h){const[y,A,S,E,b,x]=Se(i);if(A===0&&S===0){const L=u*y+b,P=Math.round(L),U=c*E+x,k=Math.round(U),F=(u+f)*y+b,B=Math.abs(Math.round(F)-P)||1,q=(c+h)*E+x,Y=Math.abs(Math.round(q)-k)||1;return i.setTransform(Math.sign(y),0,0,Math.sign(E),P,k),i.drawImage(t,e,n,o,r,0,0,B,Y),i.setTransform(y,A,S,E,b,x),[B,Y]}if(y===0&&E===0){const L=c*S+b,P=Math.round(L),U=u*A+x,k=Math.round(U),F=(c+h)*S+b,B=Math.abs(Math.round(F)-P)||1,q=(u+f)*A+x,Y=Math.abs(Math.round(q)-k)||1;return i.setTransform(0,Math.sign(A),Math.sign(S),0,P,k),i.drawImage(t,e,n,o,r,0,0,Y,B),i.setTransform(y,A,S,E,b,x),[Y,B]}i.drawImage(t,e,n,o,r,u,c,f,h);const D=Math.hypot(y,A),N=Math.hypot(S,E);return[D*f,N*h]}class f_{constructor(t,e){ot(this,"alphaIsShape",!1);ot(this,"fontSize",0);ot(this,"fontSizeScale",1);ot(this,"textMatrix",null);ot(this,"textMatrixScale",1);ot(this,"fontMatrix",K0);ot(this,"leading",0);ot(this,"x",0);ot(this,"y",0);ot(this,"lineX",0);ot(this,"lineY",0);ot(this,"charSpacing",0);ot(this,"wordSpacing",0);ot(this,"textHScale",1);ot(this,"textRenderingMode",An.FILL);ot(this,"textRise",0);ot(this,"fillColor","#000000");ot(this,"strokeColor","#000000");ot(this,"patternFill",!1);ot(this,"patternStroke",!1);ot(this,"fillAlpha",1);ot(this,"strokeAlpha",1);ot(this,"lineWidth",1);ot(this,"activeSMask",null);ot(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Vu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=hn.FILL,e=null){const n=this.minMax.slice();if(t===hn.STROKE){e||ae("Stroke bounding box must include transform."),Ct.singularValueDecompose2dScale(e,Ci);const o=Ci[0]*this.lineWidth/2,r=Ci[1]*this.lineWidth/2;n[0]-=o,n[1]-=r,n[2]+=o,n[3]+=r}return n}updateClipFromPath(){const t=Ct.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Vu,0)}getClippedPathBoundingBox(t=hn.FILL,e=null){return Ct.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function h_(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,n=t.width,o=e%jn,r=(e-o)/jn,u=o===0?r:r+1,c=i.createImageData(n,jn);let f=0,h;const y=t.data,A=c.data;let S,E,b,x;if(t.kind===zg.GRAYSCALE_1BPP){const D=y.byteLength,N=new Uint32Array(A.buffer,0,A.byteLength>>2),L=N.length,P=n+7>>3,U=4294967295,k=gn.isLittleEndian?4278190080:255;for(S=0;S<u;S++){for(b=S<r?jn:o,h=0,E=0;E<b;E++){const F=D-f;let B=0;const q=F>P?n:F*8-7,Y=q&-8;let Q=0,Z=0;for(;B<Y;B+=8)Z=y[f++],N[h++]=Z&128?U:k,N[h++]=Z&64?U:k,N[h++]=Z&32?U:k,N[h++]=Z&16?U:k,N[h++]=Z&8?U:k,N[h++]=Z&4?U:k,N[h++]=Z&2?U:k,N[h++]=Z&1?U:k;for(;B<q;B++)Q===0&&(Z=y[f++],Q=128),N[h++]=Z&Q?U:k,Q>>=1}for(;h<L;)N[h++]=0;i.putImageData(c,0,S*jn)}}else if(t.kind===zg.RGBA_32BPP){for(E=0,x=n*jn*4,S=0;S<r;S++)A.set(y.subarray(f,f+x)),f+=x,i.putImageData(c,0,E),E+=jn;S<u&&(x=n*o*4,A.set(y.subarray(f,f+x)),i.putImageData(c,0,E))}else if(t.kind===zg.RGB_24BPP)for(b=jn,x=n*b,S=0;S<u;S++){for(S>=r&&(b=o,x=n*b),h=0,E=x;E--;)A[h++]=y[f++],A[h++]=y[f++],A[h++]=y[f++],A[h++]=255;i.putImageData(c,0,S*jn)}else throw new Error(`bad image kind: ${t.kind}`)}function p_(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,o=e%jn,r=(e-o)/jn,u=o===0?r:r+1,c=i.createImageData(n,jn);let f=0;const h=t.data,y=c.data;for(let A=0;A<u;A++){const S=A<r?jn:o;({srcPos:f}=ZB({src:h,srcPos:f,dest:y,width:n,height:S,nonBlackColor:0})),i.putImageData(c,0,A*jn)}}function af(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)i[n]!==void 0&&(t[n]=i[n]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function Fg(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function g_(i,t){if(t)return!0;Ct.singularValueDecompose2dScale(i,Ci);const e=Math.fround(Vs.pixelRatio*ir.PDF_TO_CSS_UNITS);return Ci[0]<=e&&Ci[1]<=e}const n3=["butt","round","square"],i3=["miter","round","bevel"],s3={},m_={};var hs,SA,EA,CA;const PT=class PT{constructor(t,e,n,o,r,{optionalContentConfig:u,markedContentStack:c=null},f,h){w(this,hs);this.ctx=t,this.current=new f_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=o,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=u,this.cachedCanvases=new e3(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:o=null}){const r=this.ctx.canvas.width,u=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=o||"#ffffff",this.ctx.fillRect(0,0,r,u),this.ctx.fillStyle=c,n){const f=this.cachedCanvases.getCanvas("transparent",r,u);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...Se(this.compositeCtx))}this.ctx.save(),Fg(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Se(this.ctx)}executeOperatorList(t,e,n,o){const r=t.argsArray,u=t.fnArray;let c=e||0;const f=r.length;if(f===c)return c;const h=f-c>d_&&typeof n=="function",y=h?Date.now()+jB:0;let A=0;const S=this.commonObjs,E=this.objs;let b;for(;;){if(o!==void 0&&c===o.nextBreakPoint)return o.breakIt(c,n),c;if(b=u[c],b!==Em.dependency)this[b].apply(this,r[c]);else for(const x of r[c]){const D=x.startsWith("g_")?S:E;if(!D.has(x))return D.get(x,n),c}if(c++,c===f)return c;if(h&&++A>d_){if(Date.now()>y)return n(),c;A=0}}}endDrawing(){R(this,hs,SA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),R(this,hs,EA).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,o=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),u=Math.max(Math.hypot(e[2],e[3]),1),c=n,f=o,h="prescale1",y,A;for(;r>2&&c>1||u>2&&f>1;){let S=c,E=f;r>2&&c>1&&(S=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),r/=c/S),u>2&&f>1&&(E=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,u/=f/E),y=this.cachedCanvases.getCanvas(h,S,E),A=y.context,A.clearRect(0,0,S,E),A.drawImage(t,0,0,c,f,0,0,S,E),t=y.canvas,c=S,f=E,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:f}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:o}=t,r=this.current.fillColor,u=this.current.patternFill,c=Se(e);let f,h,y,A;if((t.bitmap||t.data)&&t.count>1){const Y=t.bitmap||t.data.buffer;h=JSON.stringify(u?c:[c.slice(0,4),r]),f=this._cachedBitmapsMap.get(Y),f||(f=new Map,this._cachedBitmapsMap.set(Y,f));const Q=f.get(h);if(Q&&!u){const Z=Math.round(Math.min(c[0],c[2])+c[4]),ut=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:Q,offsetX:Z,offsetY:ut}}y=Q}y||(A=this.cachedCanvases.getCanvas("maskCanvas",n,o),p_(A.context,t));let S=Ct.transform(c,[1/n,0,0,-1/o,0,0]);S=Ct.transform(S,[1,0,0,1,0,-o]);const E=Vu.slice();Ct.axialAlignedBoundingBox([0,0,n,o],S,E);const[b,x,D,N]=E,L=Math.round(D-b)||1,P=Math.round(N-x)||1,U=this.cachedCanvases.getCanvas("fillCanvas",L,P),k=U.context,F=b,B=x;k.translate(-F,-B),k.transform(...S),y||(y=this._scaleImage(A.canvas,As(k)),y=y.img,f&&u&&f.set(h,y)),k.imageSmoothingEnabled=g_(Se(k),t.interpolate),Ug(k,y,0,0,y.width,y.height,0,0,n,o),k.globalCompositeOperation="source-in";const q=Ct.transform(As(k),[1,0,0,1,-F,-B]);return k.fillStyle=u?r.getPattern(e,this,q,hn.FILL):r,k.fillRect(0,0,n,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(h,U.canvas)),{canvas:U.canvas,offsetX:Math.round(F),offsetY:Math.round(B)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=n3[t]}setLineJoin(t){this.ctx.lineJoin=i3[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;const r=this.ctx=o.context;r.setTransform(this.suspendedCtx.getTransform()),af(this.suspendedCtx,r),t3(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),af(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,o){const r=o[0],u=o[1],c=o[2]-r,f=o[3]-u;c===0||f===0||(this.genericComposeSMask(e.context,n,c,f,e.subtype,e.backdrop,e.transferMap,r,u,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,o,r,u,c,f,h,y,A){let S=t.canvas,E=f-y,b=h-A;if(u)if(E<0||b<0||E+n>S.width||b+o>S.height){const D=this.cachedCanvases.getCanvas("maskExtension",n,o),N=D.context;N.drawImage(S,-E,-b),N.globalCompositeOperation="destination-atop",N.fillStyle=u,N.fillRect(0,0,n,o),N.globalCompositeOperation="source-over",S=D.canvas,E=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const D=new Path2D;D.rect(E,b,n,o),t.clip(D),t.globalCompositeOperation="destination-atop",t.fillStyle=u,t.fillRect(E,b,n,o),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const x=new Path2D;x.rect(f,h,n,o),e.clip(x),e.globalCompositeOperation="destination-in",e.drawImage(S,E,b,n,o,f,h,n,o),e.restore()}save(){this.inSMaskMode&&af(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&af(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,o,r,u){this.ctx.transform(t,e,n,o,r,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){let[o]=e;if(!n){o||(o=e[0]=new Path2D),this[t](o);return}if(!(o instanceof Path2D)){const r=e[0]=new Path2D;for(let u=0,c=o.length;u<c;)switch(o[u++]){case Pg.moveTo:r.moveTo(o[u++],o[u++]);break;case Pg.lineTo:r.lineTo(o[u++],o[u++]);break;case Pg.curveTo:r.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);break;case Pg.closePath:r.closePath();break;default:Rt(`Unrecognized drawing path operator: ${o[u-1]}`);break}o=r}Ct.axialAlignedBoundingBox(n,Se(this.ctx),this.current.minMax),this[t](o)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const n=this.ctx,o=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const r=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=o.getPattern(n,this,As(n),hn.STROKE),r){const u=new Path2D;u.addPath(t,n.getTransform().invertSelf().multiplySelf(r)),t=u}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(hn.STROKE,Se(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const n=this.ctx,o=this.current.fillColor,r=this.current.patternFill;let u=!1;if(r){const f=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=o.getPattern(n,this,As(n),hn.FILL),f){const h=new Path2D;h.addPath(t,n.getTransform().invertSelf().multiplySelf(f)),t=h}u=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),u&&n.restore(),e&&this.consumePath(t,c)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=s3}eoClip(){this.pendingClip=m_}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const n=new Path2D,o=e.getTransform().invertSelf();for(const{transform:r,x:u,y:c,fontSize:f,path:h}of t)n.addPath(h,new DOMMatrix(r).preMultiplySelf(o).translate(u,c).scale(f,-f));e.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var y;const n=this.commonObjs.get(t),o=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=n.fontMatrix||K0,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Rt("Invalid font matrix for font "+t),e<0?(e=-e,o.fontDirection=-1):o.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const r=n.loadedName||"sans-serif",u=((y=n.systemFontInfo)==null?void 0:y.css)||`"${r}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const f=n.italic?"italic":"normal";let h=e;e<u_?h=u_:e>c_&&(h=c_),this.current.fontSizeScale=e/h,this.ctx.font=`${f} ${c} ${h}px ${u}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,o,r){const u=this.ctx,c=this.current,f=c.font,h=c.textRenderingMode,y=c.fontSize/c.fontSizeScale,A=h&An.FILL_STROKE_MASK,S=!!(h&An.ADD_TO_PATH_FLAG),E=c.patternFill&&!f.missingFile,b=c.patternStroke&&!f.missingFile;let x;if((f.disableFontFace||S||E||b)&&(x=f.getPathGenerator(this.commonObjs,t)),f.disableFontFace||E||b){u.save(),u.translate(e,n),u.scale(y,-y);let D;if((A===An.FILL||A===An.FILL_STROKE)&&(o?(D=u.getTransform(),u.setTransform(...o),u.fill(R(this,hs,CA).call(this,x,D,o))):u.fill(x)),A===An.STROKE||A===An.FILL_STROKE)if(r){D||(D=u.getTransform()),u.setTransform(...r);const{a:N,b:L,c:P,d:U}=D,k=Ct.inverseTransform(r),F=Ct.transform([N,L,P,U,0,0],k);Ct.singularValueDecompose2dScale(F,Ci),u.lineWidth*=Math.max(Ci[0],Ci[1])/y,u.stroke(R(this,hs,CA).call(this,x,D,r))}else u.lineWidth/=y,u.stroke(x);u.restore()}else(A===An.FILL||A===An.FILL_STROKE)&&u.fillText(t,e,n),(A===An.STROKE||A===An.FILL_STROKE)&&u.strokeText(t,e,n);S&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Se(u),x:e,y:n,fontSize:y,path:x})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let o=3;o<e.length;o+=4)if(e[o]>0&&e[o]<255){n=!0;break}return Gt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const o=e.fontSize;if(o===0)return;const r=this.ctx,u=e.fontSizeScale,c=e.charSpacing,f=e.wordSpacing,h=e.fontDirection,y=e.textHScale*h,A=t.length,S=n.vertical,E=S?1:-1,b=n.defaultVMetrics,x=o*e.fontMatrix[0],D=e.textRenderingMode===An.FILL&&!n.disableFontFace&&!e.patternFill;r.save(),e.textMatrix&&r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),h>0?r.scale(y,-1):r.scale(y,1);let N,L;if(e.patternFill){r.save();const B=e.fillColor.getPattern(r,this,As(r),hn.FILL);N=Se(r),r.restore(),r.fillStyle=B}if(e.patternStroke){r.save();const B=e.strokeColor.getPattern(r,this,As(r),hn.STROKE);L=Se(r),r.restore(),r.strokeStyle=B}let P=e.lineWidth;const U=e.textMatrixScale;if(U===0||P===0){const B=e.textRenderingMode&An.FILL_STROKE_MASK;(B===An.STROKE||B===An.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=U;if(u!==1&&(r.scale(u,u),P/=u),r.lineWidth=P,n.isInvalidPDFjsFont){const B=[];let q=0;for(const Y of t)B.push(Y.unicode),q+=Y.width;r.fillText(B.join(""),0,0),e.x+=q*x*y,r.restore(),this.compose();return}let k=0,F;for(F=0;F<A;++F){const B=t[F];if(typeof B=="number"){k+=E*B*o/1e3;continue}let q=!1;const Y=(B.isSpace?f:0)+c,Q=B.fontChar,Z=B.accent;let ut,St,gt=B.width;if(S){const G=B.vmetric||b,$=-(B.vmetric?G[1]:gt*.5)*x,rt=G[2]*x;gt=G?-G[0]:gt,ut=$/u,St=(k+rt)/u}else ut=k/u,St=0;if(n.remeasure&&gt>0){const G=r.measureText(Q).width*1e3/o*u;if(gt<G&&this.isFontSubpixelAAEnabled){const $=gt/G;q=!0,r.save(),r.scale($,1),ut/=$}else gt!==G&&(ut+=(gt-G)/2e3*o/u)}if(this.contentVisible&&(B.isInFont||n.missingFile)){if(D&&!Z)r.fillText(Q,ut,St);else if(this.paintChar(Q,ut,St,N,L),Z){const G=ut+o*Z.offset.x/u,$=St-o*Z.offset.y/u;this.paintChar(Z.fontChar,G,$,N,L)}}const yt=S?gt*x-Y*h:gt*x+Y*h;k+=yt,q&&r.restore()}S?e.y-=k:e.x+=k*y,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,o=n.font,r=n.fontSize,u=n.fontDirection,c=o.vertical?1:-1,f=n.charSpacing,h=n.wordSpacing,y=n.textHScale*u,A=n.fontMatrix||K0,S=t.length,E=n.textRenderingMode===An.INVISIBLE;let b,x,D,N;if(!(E||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),n.textMatrix&&e.transform(...n.textMatrix),e.translate(n.x,n.y+n.textRise),e.scale(y,u),b=0;b<S;++b){if(x=t[b],typeof x=="number"){N=c*x*r/1e3,this.ctx.translate(N,0),n.x+=N*y;continue}const L=(x.isSpace?h:0)+f,P=o.charProcOperatorList[x.operatorListId];P?this.contentVisible&&(this.save(),e.scale(r,r),e.transform(...A),this.executeOperatorList(P),this.restore()):Rt(`Type3 character "${x.operatorListId}" is not available.`);const U=[x.width,0];Ct.applyTransform(U,A),D=U[0]*r+L,e.translate(D,0),n.x+=D*y}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,o,r,u){const c=new Path2D;c.rect(n,o,r-n,u-o),this.ctx.clip(c),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=this.baseTransform||Se(this.ctx),o={createCanvasGraphics:r=>new PT(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new TA(t,this.ctx,o,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=QB(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,As(e),hn.SHADING);const o=As(e);if(o){const{width:r,height:u}=e.canvas,c=Vu.slice();Ct.axialAlignedBoundingBox([0,0,r,u],o,c);const[f,h,y,A]=c;this.ctx.fillRect(f,h,y-f,A-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ae("Should not call beginInlineImage")}beginImageData(){ae("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Se(this.ctx),e)){Ct.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[n,o,r,u]=e,c=new Path2D;c.rect(n,o,r-n,u-o),this.ctx.clip(c),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ey("TODO: Support non-isolated groups."),t.knockout&&Rt("Knockout groups not supported.");const n=Se(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=Vu.slice();Ct.axialAlignedBoundingBox(t.bbox,Se(e),o);const r=[0,0,e.canvas.width,e.canvas.height];o=Ct.intersect(o,r)||[0,0,0,0];const u=Math.floor(o[0]),c=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),h=Math.max(Math.ceil(o[3])-c,1);this.current.startNewPathAndClipBox([0,0,f,h]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const A=this.cachedCanvases.getCanvas(y,f,h),S=A.context;S.translate(-u,-c),S.transform(...n);let E=new Path2D;const[b,x,D,N]=t.bbox;if(E.rect(b,x,D-b,N-x),t.matrix){const L=new Path2D;L.addPath(E,new DOMMatrix(t.matrix)),E=L}S.clip(E),t.smask?this.smaskStack.push({canvas:A.canvas,context:S,offsetX:u,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(u,c),e.save()),af(e,S),this.ctx=S,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const o=Se(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);const r=Vu.slice();Ct.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],o,r),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,n,o,r){if(R(this,hs,SA).call(this),Fg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const u=e[2]-e[0],c=e[3]-e[1];if(r&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=u,e[3]=c,Ct.singularValueDecompose2dScale(Se(this.ctx),Ci);const{viewportScale:f}=this,h=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(c*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(h,y);const{canvas:A,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(Ci[0],0,0,-Ci[1],0,c*Ci[1]),Fg(this.ctx)}else{Fg(this.ctx),this.endPath();const f=new Path2D;f.rect(e[0],e[1],u,c),this.ctx.clip(f)}}this.current=new f_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...o)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),R(this,hs,EA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,o=this._createMaskCanvas(t),r=o.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,o.offsetX,o.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,o=0,r,u){if(!this.contentVisible)return;t=this.getObject(t.data,t);const c=this.ctx;c.save();const f=Se(c);c.transform(e,n,o,r,0,0);const h=this._createMaskCanvas(t);c.setTransform(1,0,0,1,h.offsetX-f[4],h.offsetY-f[5]);for(let y=0,A=u.length;y<A;y+=2){const S=Ct.transform(f,[e,n,o,r,u[y],u[y+1]]);c.drawImage(h.canvas,S[4],S[5])}c.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,o=this.current.patternFill;for(const r of t){const{data:u,width:c,height:f,transform:h}=r,y=this.cachedCanvases.getCanvas("maskCanvas",c,f),A=y.context;A.save();const S=this.getObject(u,r);p_(A,S),A.globalCompositeOperation="source-in",A.fillStyle=o?n.getPattern(A,this,As(e),hn.FILL):n,A.fillRect(0,0,c,f),A.restore(),e.save(),e.transform(...h),e.scale(1,-1),Ug(e,y.canvas,0,0,c,f,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Rt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,o){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){Rt("Dependent image isn't ready yet");return}const u=r.width,c=r.height,f=[];for(let h=0,y=o.length;h<y;h+=2)f.push({transform:[e,0,0,n,o[h],o[h+1]],x:0,y:0,w:u,h:c});this.paintInlineImageXObjectGroup(r,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:o}=t,r=this.cachedCanvases.getCanvas("inlineImage",n,o),u=r.context;return u.filter=this.current.transferMaps,u.drawImage(e,0,0),u.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,o=this.ctx;this.save();const{filter:r}=o;r!=="none"&&r!==""&&(o.filter="none"),o.scale(1/e,-1/n);let u;if(t.bitmap)u=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)u=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;h_(h,t),u=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(u,As(o));o.imageSmoothingEnabled=g_(Se(o),t.interpolate),Ug(o,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const r=t.width,u=t.height,f=this.cachedCanvases.getCanvas("inlineImage",r,u).context;h_(f,t),o=this.applyTransferMapsToCanvas(f)}for(const r of e)n.save(),n.transform(...r.transform),n.scale(1,-1),Ug(n,o,r.x,r.y,r.w,r.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const o=this.ctx;this.pendingClip&&(n||(this.pendingClip===m_?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Se(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),o=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,o)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:o,d:r}=this.ctx.getTransform();let u,c;if(n===0&&o===0){const f=Math.abs(e),h=Math.abs(r);if(f===h)if(t===0)u=c=1/f;else{const y=f*t;u=c=y<1?1/y:1}else if(t===0)u=1/f,c=1/h;else{const y=f*t,A=h*t;u=y<1?1/y:1,c=A<1?1/A:1}}else{const f=Math.abs(e*r-n*o),h=Math.hypot(e,n),y=Math.hypot(o,r);if(t===0)u=y/f,c=h/f;else{const A=t*f;u=y>A?y/A:1,c=h>A?h/A:1}}this._cachedScaleForStroking[0]=u,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:o}}=this,[r,u]=this.getScaleForStroking();if(r===u){n.lineWidth=(o||1)*r,n.stroke(t);return}const c=n.getLineDash();e&&n.save(),n.scale(r,u),D0.a=1/r,D0.d=1/u;const f=new Path2D;if(f.addPath(t,D0),c.length>0){const h=Math.max(r,u);n.setLineDash(c.map(y=>y/h)),n.lineDashOffset/=h}n.lineWidth=o||1,n.stroke(f),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};hs=new WeakSet,SA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},EA=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},CA=function(t,e,n){const o=new Path2D;return o.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),o};let Yu=PT;for(const i in Em)Yu.prototype[i]!==void 0&&(Yu.prototype[Em[i]]=Yu.prototype[i]);var ah,rh;class Bs{static get workerPort(){return g(this,ah)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");C(this,ah,t)}static get workerSrc(){return g(this,rh)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");C(this,rh,t)}}ah=new WeakMap,rh=new WeakMap,w(Bs,ah,null),w(Bs,rh,"");var dc,lh;class o3{constructor({parsedData:t,rawData:e}){w(this,dc);w(this,lh);C(this,dc,t),C(this,lh,e)}getRaw(){return g(this,lh)}get(t){return g(this,dc).get(t)??null}[Symbol.iterator](){return g(this,dc).entries()}}dc=new WeakMap,lh=new WeakMap;const Fu=Symbol("INTERNAL");var uh,ch,dh,fc;class a3{constructor(t,{name:e,intent:n,usage:o,rbGroups:r}){w(this,uh,!1);w(this,ch,!1);w(this,dh,!1);w(this,fc,!0);C(this,uh,!!(t&Ei.DISPLAY)),C(this,ch,!!(t&Ei.PRINT)),this.name=e,this.intent=n,this.usage=o,this.rbGroups=r}get visible(){if(g(this,dh))return g(this,fc);if(!g(this,fc))return!1;const{print:t,view:e}=this.usage;return g(this,uh)?(e==null?void 0:e.viewState)!=="OFF":g(this,ch)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==Fu&&ae("Internal method `_setVisible` called."),C(this,dh,n),C(this,fc,e)}}uh=new WeakMap,ch=new WeakMap,dh=new WeakMap,fc=new WeakMap;var La,se,hc,pc,fh,bA;class r3{constructor(t,e=Ei.DISPLAY){w(this,fh);w(this,La,null);w(this,se,new Map);w(this,hc,null);w(this,pc,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,C(this,pc,t.order);for(const n of t.groups)g(this,se).set(n.id,new a3(e,n));if(t.baseState==="OFF")for(const n of g(this,se).values())n._setVisible(Fu,!1);for(const n of t.on)g(this,se).get(n)._setVisible(Fu,!0);for(const n of t.off)g(this,se).get(n)._setVisible(Fu,!1);C(this,hc,this.getHash())}}isVisible(t){if(g(this,se).size===0)return!0;if(!t)return ey("Optional content group not defined."),!0;if(t.type==="OCG")return g(this,se).has(t.id)?g(this,se).get(t.id).visible:(Rt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return R(this,fh,bA).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!g(this,se).has(e))return Rt(`Optional content group not found: ${e}`),!0;if(g(this,se).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!g(this,se).has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!g(this,se).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!g(this,se).has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!g(this,se).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!g(this,se).has(e))return Rt(`Optional content group not found: ${e}`),!0;if(g(this,se).get(e).visible)return!1}return!0}return Rt(`Unknown optional content policy ${t.policy}.`),!0}return Rt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var r;const o=g(this,se).get(t);if(!o){Rt(`Optional content group not found: ${t}`);return}if(n&&e&&o.rbGroups.length)for(const u of o.rbGroups)for(const c of u)c!==t&&((r=g(this,se).get(c))==null||r._setVisible(Fu,!1,!0));o._setVisible(Fu,!!e,!0),C(this,La,null)}setOCGState({state:t,preserveRB:e}){let n;for(const o of t){switch(o){case"ON":case"OFF":case"Toggle":n=o;continue}const r=g(this,se).get(o);if(r)switch(n){case"ON":this.setVisibility(o,!0,e);break;case"OFF":this.setVisibility(o,!1,e);break;case"Toggle":this.setVisibility(o,!r.visible,e);break}}C(this,La,null)}get hasInitialVisibility(){return g(this,hc)===null||this.getHash()===g(this,hc)}getOrder(){return g(this,se).size?g(this,pc)?g(this,pc).slice():[...g(this,se).keys()]:null}getGroup(t){return g(this,se).get(t)||null}getHash(){if(g(this,La)!==null)return g(this,La);const t=new Vw;for(const[e,n]of g(this,se))t.update(`${e}:${n.visible}`);return C(this,La,t.hexdigest())}[Symbol.iterator](){return g(this,se).entries()}}La=new WeakMap,se=new WeakMap,hc=new WeakMap,pc=new WeakMap,fh=new WeakSet,bA=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let o=1;o<e;o++){const r=t[o];let u;if(Array.isArray(r))u=R(this,fh,bA).call(this,r);else if(g(this,se).has(r))u=g(this,se).get(r).visible;else return Rt(`Optional content group not found: ${r}`),!0;switch(n){case"And":if(!u)return!1;break;case"Or":if(u)return!0;break;case"Not":return!u;default:return!0}}return n==="And"};class l3{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Ue(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:o,initialData:r,progressiveDone:u,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=u,this._contentDispositionFilename=c,(r==null?void 0:r.length)>0){const f=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=o,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((f,h)=>{this._onReceiveData({begin:f,chunk:h})}),t.addProgressListener((f,h)=>{this._onProgress({loaded:f,total:h})}),t.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const o=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(n),!0)});Ue(o,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,o,r;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(r=(o=this._fullRequestReader)==null?void 0:o.onProgress)==null||r.call(o,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ue(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new u3(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new c3(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class u3{constructor(t,e,n=!1,o=null){this._stream=t,this._done=n||!1,this._filename=ET(o)?o:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class c3{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function d3(i){let t=!0,e=n("filename\\*","i").exec(i);if(e){e=e[1];let y=c(e);return y=unescape(y),y=f(y),y=h(y),r(y)}if(e=u(i),e){const y=h(e);return r(y)}if(e=n("filename","i").exec(i),e){e=e[1];let y=c(e);return y=h(y),r(y)}function n(y,A){return new RegExp("(?:^|;)\\s*"+y+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',A)}function o(y,A){if(y){if(!/^[\x00-\xFF]+$/.test(A))return A;try{const S=new TextDecoder(y,{fatal:!0}),E=lp(A);A=S.decode(E),t=!1}catch{}}return A}function r(y){return t&&/[\x80-\xff]/.test(y)&&(y=o("utf-8",y),t&&(y=o("iso-8859-1",y))),y}function u(y){const A=[];let S;const E=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(S=E.exec(y))!==null;){let[,x,D,N]=S;if(x=parseInt(x,10),x in A){if(x===0)break;continue}A[x]=[D,N]}const b=[];for(let x=0;x<A.length&&x in A;++x){let[D,N]=A[x];N=c(N),D&&(N=unescape(N),x===0&&(N=f(N))),b.push(N)}return b.join("")}function c(y){if(y.startsWith('"')){const A=y.slice(1).split('\\"');for(let S=0;S<A.length;++S){const E=A[S].indexOf('"');E!==-1&&(A[S]=A[S].slice(0,E),A.length=S+1),A[S]=A[S].replaceAll(/\\(.)/g,"$1")}y=A.join('"')}return y}function f(y){const A=y.indexOf("'");if(A===-1)return y;const S=y.slice(0,A),b=y.slice(A+1).replace(/^[^']*'/,"");return o(S,b)}function h(y){return!y.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(y)?y:y.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(A,S,E,b){if(E==="q"||E==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,D){return String.fromCharCode(parseInt(D,16))}),o(S,b);try{b=atob(b)}catch{}return o(S,b)})}return""}function jw(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const n in t){const o=t[n];o!==void 0&&e.append(n,o)}return e}function iy(i){var t;return((t=URL.parse(i))==null?void 0:t.origin)??null}function tM({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:n}){const o={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(o.suggestedLength=r,r<=2*e)||n||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function eM(i){const t=i.get("Content-Disposition");if(t){let e=d3(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(ET(e))return e}return null}function fp(i,t){return new Cm(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function nM(i){return i===200||i===206}function iM(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function sM(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Rt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class f3{constructor(t){ot(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=jw(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ue(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new p3(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class h3{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),o=e.url;fetch(o,iM(n,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=iy(r.url),!nM(r.status))throw fp(r.status,o);this._reader=r.body.getReader(),this._headersCapability.resolve();const u=r.headers,{allowRangeRequests:c,suggestedLength:f}=tM({responseHeaders:u,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=f||this._contentLength,this._filename=eM(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new nr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:sM(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class p3{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const o=t.source;this._withCredentials=o.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${n-1}`);const u=o.url;fetch(u,iM(r,this._withCredentials,this._abortController)).then(c=>{const f=iy(c.url);if(f!==t._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${t._responseOrigin}".`);if(!nM(c.status))throw fp(c.status,u);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:sM(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const I0=200,P0=206;function g3(i){const t=i.response;return typeof t!="string"?t:lp(t).buffer}class m3{constructor({url:t,httpHeaders:e,withCredentials:n}){ot(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=jw(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,o=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,u]of this.headers)e.setRequestHeader(r,u);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),o.expectedStatus=P0):o.expectedStatus=I0,e.responseType="arraybuffer",Ue(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),o.onHeadersReceived=t.onHeadersReceived,o.onDone=t.onDone,o.onError=t.onError,o.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var o;const n=this.pendingRequests[t];n&&((o=n.onProgress)==null||o.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const o=n.xhr;if(o.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),o.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],o.status===0&&this.isHttp){n.onError(o.status);return}const r=o.status||I0;if(!(r===I0&&n.expectedStatus===P0)&&r!==n.expectedStatus){n.onError(o.status);return}const c=g3(o);if(r===P0){const f=o.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(Rt('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(o.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class y3{constructor(t){this._source=t,this._manager=new m3(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ue(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v3(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new A3(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class v3{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=iy(e.responseURL);const n=e.getAllResponseHeaders(),o=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[f,...h]=c.split(": ");return[f,h.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:u}=tM({responseHeaders:o,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=eM(o),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=fp(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class A3{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=iy((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=fp(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const T3=/^[a-z][a-z0-9\-+.]+:/i;function S3(i){if(T3.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class E3{constructor(t){this.source=t,this.url=S3(t.url),Ue(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ue(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new C3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new b3(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class C3{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(o=>{this._contentLength=o.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},o=>{o.code==="ENOENT"&&(o=fp(0,this._url.href)),this._storedError=o,this._headersCapability.reject(o)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new nr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b3{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const o=t.source;this._isStreamingSupported=!o.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const rf=Symbol("INITIAL_DATA");var di,hh,xA;class oM{constructor(){w(this,hh);w(this,di,Object.create(null))}get(t,e=null){if(e){const o=R(this,hh,xA).call(this,t);return o.promise.then(()=>e(o.data)),null}const n=g(this,di)[t];if(!n||n.data===rf)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=g(this,di)[t];return!!e&&e.data!==rf}delete(t){const e=g(this,di)[t];return!e||e.data===rf?!1:(delete g(this,di)[t],!0)}resolve(t,e=null){const n=R(this,hh,xA).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in g(this,di)){const{data:n}=g(this,di)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}C(this,di,Object.create(null))}*[Symbol.iterator](){for(const t in g(this,di)){const{data:e}=g(this,di)[t];e!==rf&&(yield[t,e])}}}di=new WeakMap,hh=new WeakSet,xA=function(t){var e;return(e=g(this,di))[t]||(e[t]={...Promise.withResolvers(),data:rf})};const x3=1e5,y_=30;var x_,ka,Qn,ph,gh,el,Co,mh,yh,nl,gc,mc,Ua,yc,vh,vc,il,Ah,Th,Ac,sl,Sh,Fa,Tc,qo,aM,rM,_A,xi,tm,wA,lM,uM;const Ve=class Ve{constructor({textContentSource:t,container:e,viewport:n}){w(this,qo);w(this,ka,Promise.withResolvers());w(this,Qn,null);w(this,ph,!1);w(this,gh,!!((x_=globalThis.FontInspector)!=null&&x_.enabled));w(this,el,null);w(this,Co,null);w(this,mh,0);w(this,yh,0);w(this,nl,null);w(this,gc,null);w(this,mc,0);w(this,Ua,0);w(this,yc,Object.create(null));w(this,vh,[]);w(this,vc,null);w(this,il,[]);w(this,Ah,new WeakMap);w(this,Th,null);var f;if(t instanceof ReadableStream)C(this,vc,t);else if(typeof t=="object")C(this,vc,new ReadableStream({start(h){h.enqueue(t),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');C(this,Qn,C(this,gc,e)),C(this,Ua,n.scale*Vs.pixelRatio),C(this,mc,n.rotation),C(this,Co,{div:null,properties:null,ctx:null});const{pageWidth:o,pageHeight:r,pageX:u,pageY:c}=n.rawDims;C(this,Th,[1,0,0,-1,-u,c+r]),C(this,yh,o),C(this,mh,r),R(f=Ve,xi,lM).call(f),Vl(e,n),g(this,ka).promise.finally(()=>{g(Ve,Tc).delete(this),C(this,Co,null),C(this,yc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=gn.platform;return Gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{g(this,nl).read().then(({value:e,done:n})=>{if(n){g(this,ka).resolve();return}g(this,el)??C(this,el,e.lang),Object.assign(g(this,yc),e.styles),R(this,qo,aM).call(this,e.items),t()},g(this,ka).reject)};return C(this,nl,g(this,vc).getReader()),g(Ve,Tc).add(this),t(),g(this,ka).promise}update({viewport:t,onBefore:e=null}){var r;const n=t.scale*Vs.pixelRatio,o=t.rotation;if(o!==g(this,mc)&&(e==null||e(),C(this,mc,o),Vl(g(this,gc),{rotation:o})),n!==g(this,Ua)){e==null||e(),C(this,Ua,n);const u={div:null,properties:null,ctx:R(r=Ve,xi,tm).call(r,g(this,el))};for(const c of g(this,il))u.properties=g(this,Ah).get(c),u.div=c,R(this,qo,_A).call(this,u)}}cancel(){var e;const t=new nr("TextLayer task cancelled.");(e=g(this,nl))==null||e.cancel(t).catch(()=>{}),C(this,nl,null),g(this,ka).reject(t)}get textDivs(){return g(this,il)}get textContentItemsStr(){return g(this,vh)}static cleanup(){if(!(g(this,Tc).size>0)){g(this,Ac).clear();for(const{canvas:t}of g(this,sl).values())t.remove();g(this,sl).clear()}}};ka=new WeakMap,Qn=new WeakMap,ph=new WeakMap,gh=new WeakMap,el=new WeakMap,Co=new WeakMap,mh=new WeakMap,yh=new WeakMap,nl=new WeakMap,gc=new WeakMap,mc=new WeakMap,Ua=new WeakMap,yc=new WeakMap,vh=new WeakMap,vc=new WeakMap,il=new WeakMap,Ah=new WeakMap,Th=new WeakMap,Ac=new WeakMap,sl=new WeakMap,Sh=new WeakMap,Fa=new WeakMap,Tc=new WeakMap,qo=new WeakSet,aM=function(t){var o,r;if(g(this,ph))return;(r=g(this,Co)).ctx??(r.ctx=R(o=Ve,xi,tm).call(o,g(this,el)));const e=g(this,il),n=g(this,vh);for(const u of t){if(e.length>x3){Rt("Ignoring additional textDivs for performance reasons."),C(this,ph,!0);return}if(u.str===void 0){if(u.type==="beginMarkedContentProps"||u.type==="beginMarkedContent"){const c=g(this,Qn);C(this,Qn,document.createElement("span")),g(this,Qn).classList.add("markedContent"),u.id!==null&&g(this,Qn).setAttribute("id",`${u.id}`),c.append(g(this,Qn))}else u.type==="endMarkedContent"&&C(this,Qn,g(this,Qn).parentNode);continue}n.push(u.str),R(this,qo,rM).call(this,u)}},rM=function(t){var x;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};g(this,il).push(e);const o=Ct.transform(g(this,Th),t.transform);let r=Math.atan2(o[1],o[0]);const u=g(this,yc)[t.fontName];u.vertical&&(r+=Math.PI/2);let c=g(this,gh)&&u.fontSubstitution||u.fontFamily;c=Ve.fontFamilyMap.get(c)||c;const f=Math.hypot(o[2],o[3]),h=f*R(x=Ve,xi,uM).call(x,c,u,g(this,el));let y,A;r===0?(y=o[4],A=o[5]-h):(y=o[4]+h*Math.sin(r),A=o[5]-h*Math.cos(r));const S="calc(var(--total-scale-factor) *",E=e.style;g(this,Qn)===g(this,gc)?(E.left=`${(100*y/g(this,yh)).toFixed(2)}%`,E.top=`${(100*A/g(this,mh)).toFixed(2)}%`):(E.left=`${S}${y.toFixed(2)}px)`,E.top=`${S}${A.toFixed(2)}px)`),E.fontSize=`${S}${(g(Ve,Fa)*f).toFixed(2)}px)`,E.fontFamily=c,n.fontSize=f,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,g(this,gh)&&(e.dataset.fontName=u.fontSubstitutionLoadedName||t.fontName),r!==0&&(n.angle=r*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const D=Math.abs(t.transform[0]),N=Math.abs(t.transform[3]);D!==N&&Math.max(D,N)/Math.min(D,N)>1.5&&(b=!0)}if(b&&(n.canvasWidth=u.vertical?t.height:t.width),g(this,Ah).set(e,n),g(this,Co).div=e,g(this,Co).properties=n,R(this,qo,_A).call(this,g(this,Co)),n.hasText&&g(this,Qn).append(e),n.hasEOL){const D=document.createElement("br");D.setAttribute("role","presentation"),g(this,Qn).append(D)}},_A=function(t){var c;const{div:e,properties:n,ctx:o}=t,{style:r}=e;let u="";if(g(Ve,Fa)>1&&(u=`scale(${1/g(Ve,Fa)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:f}=r,{canvasWidth:h,fontSize:y}=n;R(c=Ve,xi,wA).call(c,o,y*g(this,Ua),f);const{width:A}=o.measureText(e.textContent);A>0&&(u=`scaleX(${h*g(this,Ua)/A}) ${u}`)}n.angle!==0&&(u=`rotate(${n.angle}deg) ${u}`),u.length>0&&(r.transform=u)},xi=new WeakSet,tm=function(t=null){let e=g(this,sl).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,sl).set(t,e),g(this,Sh).set(e,{size:0,family:""})}return e},wA=function(t,e,n){const o=g(this,Sh).get(t);e===o.size&&n===o.family||(t.font=`${e}px ${n}`,o.size=e,o.family=n)},lM=function(){if(g(this,Fa)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),C(this,Fa,t.getBoundingClientRect().height),t.remove()},uM=function(t,e,n){const o=g(this,Ac).get(t);if(o)return o;const r=R(this,xi,tm).call(this,n);r.canvas.width=r.canvas.height=y_,R(this,xi,wA).call(this,r,y_,t);const u=r.measureText(""),c=u.fontBoundingBoxAscent,f=Math.abs(u.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let h=.8;return c?h=c/(c+f):(gn.platform.isFirefox&&Rt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?h=e.ascent:e.descent&&(h=1+e.descent)),g(this,Ac).set(t,h),h},w(Ve,xi),w(Ve,Ac,new Map),w(Ve,sl,new Map),w(Ve,Sh,new WeakMap),w(Ve,Fa,null),w(Ve,Tc,new Set);let Nf=Ve;class Df{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function o(r){var f;if(!r)return;let u=null;const c=r.name;if(c==="#text")u=r.value;else if(Df.shouldBuildText(c))(f=r==null?void 0:r.attributes)!=null&&f.textContent?u=r.attributes.textContent:r.value&&(u=r.value);else return;if(u!==null&&e.push({str:u}),!!r.children)for(const h of r.children)o(h)}return o(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const _3=100;function cM(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new MA,{docId:e}=t,n=i.url?kB(i.url):null,o=i.data?UB(i.data):null,r=i.httpHeaders||null,u=i.withCredentials===!0,c=i.password??null,f=i.range instanceof dM?i.range:null,h=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let y=i.worker instanceof If?i.worker:null;const A=i.verbosity,S=typeof i.docBaseUrl=="string"&&!ny(i.docBaseUrl)?i.docBaseUrl:null,E=Lg(i.cMapUrl),b=i.cMapPacked!==!1,x=i.CMapReaderFactory||(kn?qB:o_),D=Lg(i.iccUrl),N=Lg(i.standardFontDataUrl),L=i.StandardFontDataFactory||(kn?$B:a_),P=Lg(i.wasmUrl),U=i.WasmFactory||(kn?YB:r_),k=i.stopAtErrors!==!0,F=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,B=i.isEvalSupported!==!1,q=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!kn,Y=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!kn&&(gn.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,Z=typeof i.disableFontFace=="boolean"?i.disableFontFace:kn,ut=i.fontExtraProperties===!0,St=i.enableXfa===!0,gt=i.ownerDocument||globalThis.document,yt=i.disableRange===!0,G=i.disableStream===!0,$=i.disableAutoFetch===!0,rt=i.pdfBug===!0,vt=i.CanvasFactory||(kn?zB:GB),V=i.FilterFactory||(kn?HB:VB),j=i.enableHWA===!0,st=i.useWasm!==!1,it=f?f.length:i.length??NaN,dt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!kn&&!Z,Nt=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(x===o_&&L===a_&&U===r_&&E&&N&&P&&cf(E,document.baseURI)&&cf(N,document.baseURI)&&cf(P,document.baseURI)),Et=null;hB(A);const kt={canvasFactory:new vt({ownerDocument:gt,enableHWA:j}),filterFactory:new V({docId:e,ownerDocument:gt}),cMapReaderFactory:Nt?null:new x({baseUrl:E,isCompressed:b}),standardFontDataFactory:Nt?null:new L({baseUrl:N}),wasmFactory:Nt?null:new U({baseUrl:P})};y||(y=If.create({verbosity:A,port:Bs.workerPort}),t._worker=y);const Yt={docId:e,apiVersion:"5.3.93",data:o,password:c,disableAutoFetch:$,rangeChunkSize:h,length:it,docBaseUrl:S,enableXfa:St,evaluatorOptions:{maxImageSize:F,disableFontFace:Z,ignoreErrors:k,isEvalSupported:B,isOffscreenCanvasSupported:q,isImageDecoderSupported:Y,canvasMaxAreaInBytes:Q,fontExtraProperties:ut,useSystemFonts:dt,useWasm:st,useWorkerFetch:Nt,cMapUrl:E,iccUrl:D,standardFontDataUrl:N,wasmUrl:P}},_i={ownerDocument:gt,pdfBug:rt,styleElement:Et,loadingParams:{disableAutoFetch:$,enableXfa:St}};return y.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(y.destroyed)throw new Error("Worker was destroyed");const rr=y.messageHandler.sendWithPromise("GetDocRequest",Yt,o?[o.buffer]:null);let wi;if(f)wi=new l3(f,{disableRange:yt,disableStream:G});else if(!o){if(!n)throw new Error("getDocument - no `url` parameter provided.");const zs=cf(n)?f3:kn?E3:y3;wi=new zs({url:n,length:it,httpHeaders:r,withCredentials:u,rangeChunkSize:h,disableRange:yt,disableStream:G})}return rr.then(zs=>{if(t.destroyed)throw new Error("Loading aborted");if(y.destroyed)throw new Error("Worker was destroyed");const Ht=new gf(e,zs,y.port),Hn=new R3(Ht,t,wi,_i,kt);t._transport=Hn,Ht.send("Ready",null)})}).catch(t._capability.reject),t}var Gm;const Vm=class Vm{constructor(){ot(this,"_capability",Promise.withResolvers());ot(this,"_transport",null);ot(this,"_worker",null);ot(this,"docId",`d${Rn(Vm,Gm)._++}`);ot(this,"destroyed",!1);ot(this,"onPassword",null);ot(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,n,o;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(r){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,r}this._transport=null,(o=this._worker)==null||o.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Gm=new WeakMap,w(Vm,Gm,0);let MA=Vm;var ol,Eh,Ch,bh,xh;class dM{constructor(t,e,n=!1,o=null){w(this,ol,Promise.withResolvers());w(this,Eh,[]);w(this,Ch,[]);w(this,bh,[]);w(this,xh,[]);this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=o}addRangeListener(t){g(this,xh).push(t)}addProgressListener(t){g(this,bh).push(t)}addProgressiveReadListener(t){g(this,Ch).push(t)}addProgressiveDoneListener(t){g(this,Eh).push(t)}onDataRange(t,e){for(const n of g(this,xh))n(t,e)}onDataProgress(t,e){g(this,ol).promise.then(()=>{for(const n of g(this,bh))n(t,e)})}onDataProgressiveRead(t){g(this,ol).promise.then(()=>{for(const e of g(this,Ch))e(t)})}onDataProgressiveDone(){g(this,ol).promise.then(()=>{for(const t of g(this,Eh))t()})}transportReady(){g(this,ol).resolve()}requestDataRange(t,e){ae("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}ol=new WeakMap,Eh=new WeakMap,Ch=new WeakMap,bh=new WeakMap,xh=new WeakMap;class w3{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var bo,al,Tf;class M3{constructor(t,e,n,o=!1){w(this,al);w(this,bo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=o?new n_:null,this._pdfBug=o,this.commonObjs=n.commonObjs,this.objs=new oM,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:o=0,dontFlip:r=!1}={}){return new cp({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:o,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:o=va.ENABLE,transform:r=null,background:u=null,optionalContentConfigPromise:c=null,annotationCanvasMap:f=null,pageColors:h=null,printAnnotationStorage:y=null,isEditing:A=!1}){var U,k;(U=this._stats)==null||U.time("Overall");const S=this._transport.getRenderingIntent(n,o,y,A),{renderingIntent:E,cacheKey:b}=S;C(this,bo,!1),c||(c=this._transport.getOptionalContentConfig(E));let x=this._intentStates.get(b);x||(x=Object.create(null),this._intentStates.set(b,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const D=!!(E&Ei.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(k=this._stats)==null||k.time("Page Request"),this._pumpOperatorList(S));const N=F=>{var B;x.renderTasks.delete(L),D&&C(this,bo,!0),R(this,al,Tf).call(this),F?(L.capability.reject(F),this._abortOperatorList({intentState:x,reason:F instanceof Error?F:new Error(F)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(B=globalThis.Stats)!=null&&B.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new RA({callback:N,params:{canvasContext:t,viewport:e,transform:r,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!D,pdfBug:this._pdfBug,pageColors:h});(x.renderTasks||(x.renderTasks=new Set)).add(L);const P=L.task;return Promise.all([x.displayReadyCapability.promise,c]).then(([F,B])=>{var q;if(this.destroyed){N();return}if((q=this._stats)==null||q.time("Rendering"),!(B.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:F,optionalContentConfig:B}),L.operatorListChanged()}).catch(N),P}getOperatorList({intent:t="display",annotationMode:e=va.ENABLE,printAnnotationStorage:n=null,isEditing:o=!1}={}){var h;function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(f))}const u=this._transport.getRenderingIntent(t,e,n,o,!0);let c=this._intentStates.get(u.cacheKey);c||(c=Object.create(null),this._intentStates.set(u.cacheKey,c));let f;return c.opListReadCapability||(f=Object.create(null),f.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(f),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(u)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(o){return o.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Df.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,o){function r(){u.read().then(function({value:f,done:h}){if(h){n(c);return}c.lang??(c.lang=f.lang),Object.assign(c.styles,f.styles),c.items.push(...f.items),r()},o)}const u=e.getReader(),c={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),C(this,bo,!1),Promise.all(t)}cleanup(t=!1){C(this,bo,!0);const e=R(this,al,Tf).call(this);return t&&e&&this._stats&&(this._stats=new n_),e}_startRenderPage(t,e){var o,r;const n=this._intentStates.get(e);n&&((o=this._stats)==null||o.timeEnd("Page Request"),(r=n.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let n=0,o=t.length;n<o;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&R(this,al,Tf).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:o}){const{map:r,transfer:u}=n,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:o},u).getReader(),h=this._intentStates.get(e);h.streamReader=f;const y=()=>{f.read().then(({value:A,done:S})=>{if(S){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(A,h),y())},A=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const S of h.renderTasks)S.operatorListChanged();R(this,al,Tf).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(A);else if(h.opListReadCapability)h.opListReadCapability.reject(A);else throw A}})};y()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof ST){let o=_3;e.extraDelay>0&&e.extraDelay<1e3&&(o+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},o);return}}if(t.streamReader.cancel(new nr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[o,r]of this._intentStates)if(r===t){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}bo=new WeakMap,al=new WeakSet,Tf=function(){if(!g(this,bo)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,bo,!1),!0};var Oa,ns,xo,rl,Hm,ll,ul,Gn,em,fM,hM,Sf,Sc,nm;const ge=class ge{constructor({name:t=null,port:e=null,verbosity:n=pB()}={}){w(this,Gn);w(this,Oa,Promise.withResolvers());w(this,ns,null);w(this,xo,null);w(this,rl,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(g(ge,ul).has(e))throw new Error("Cannot use more than one PDFWorker per port.");g(ge,ul).set(e,this),R(this,Gn,fM).call(this,e)}else R(this,Gn,hM).call(this)}get promise(){return g(this,Oa).promise}get port(){return g(this,xo)}get messageHandler(){return g(this,ns)}destroy(){var t,e;this.destroyed=!0,(t=g(this,rl))==null||t.terminate(),C(this,rl,null),g(ge,ul).delete(g(this,xo)),C(this,xo,null),(e=g(this,ns))==null||e.destroy(),C(this,ns,null)}static create(t){const e=g(this,ul).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new ge(t)}static get workerSrc(){if(Bs.workerSrc)return Bs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Gt(this,"_setupFakeWorkerGlobal",(async()=>g(this,Sc,nm)?g(this,Sc,nm):(await import(this.workerSrc)).WorkerMessageHandler)())}};Oa=new WeakMap,ns=new WeakMap,xo=new WeakMap,rl=new WeakMap,Hm=new WeakMap,ll=new WeakMap,ul=new WeakMap,Gn=new WeakSet,em=function(){g(this,Oa).resolve(),g(this,ns).send("configure",{verbosity:this.verbosity})},fM=function(t){C(this,xo,t),C(this,ns,new gf("main","worker",t)),g(this,ns).on("ready",()=>{}),R(this,Gn,em).call(this)},hM=function(){if(g(ge,ll)||g(ge,Sc,nm)){R(this,Gn,Sf).call(this);return}let{workerSrc:t}=ge;try{ge._isSameOrigin(window.location,t)||(t=ge._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new gf("main","worker",e),o=()=>{r.abort(),n.destroy(),e.terminate(),this.destroyed?g(this,Oa).reject(new Error("Worker was destroyed")):R(this,Gn,Sf).call(this)},r=new AbortController;e.addEventListener("error",()=>{g(this,rl)||o()},{signal:r.signal}),n.on("test",c=>{if(r.abort(),this.destroyed||!c){o();return}C(this,ns,n),C(this,xo,e),C(this,rl,e),R(this,Gn,em).call(this)}),n.on("ready",c=>{if(r.abort(),this.destroyed){o();return}try{u()}catch{R(this,Gn,Sf).call(this)}});const u=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};u();return}catch{ey("The worker has been disabled.")}R(this,Gn,Sf).call(this)},Sf=function(){g(ge,ll)||(Rt("Setting up fake worker."),C(ge,ll,!0)),ge._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){g(this,Oa).reject(new Error("Worker was destroyed"));return}const e=new BB;C(this,xo,e);const n=`fake${Rn(ge,Hm)._++}`,o=new gf(n+"_worker",n,e);t.setup(o,e),C(this,ns,new gf(n,n+"_worker",e)),R(this,Gn,em).call(this)}).catch(t=>{g(this,Oa).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Sc=new WeakSet,nm=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},w(ge,Sc),w(ge,Hm,0),w(ge,ll,!1),w(ge,ul,new WeakMap),kn&&(C(ge,ll,!0),Bs.workerSrc||(Bs.workerSrc="./pdf.worker.mjs")),ge._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const o=new URL(e,n);return n.origin===o.origin},ge._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},ge.fromPort=t=>{if(_B("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return ge.create(t)};let If=ge;var _o,Ds,Ec,Cc,wo,cl,Ef;class R3{constructor(t,e,n,o,r){w(this,cl);w(this,_o,new Map);w(this,Ds,new Map);w(this,Ec,new Map);w(this,Cc,new Map);w(this,wo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new oM,this.fontLoader=new PB({ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this.loadingParams=o.loadingParams,this._params=o,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Gt(this,"annotationStorage",new xT)}getRenderingIntent(t,e=va.ENABLE,n=null,o=!1,r=!1){let u=Ei.DISPLAY,c=gA;switch(t){case"any":u=Ei.ANY;break;case"display":break;case"print":u=Ei.PRINT;break;default:Rt(`getRenderingIntent - invalid intent: ${t}`)}const f=u&Ei.PRINT&&n instanceof zw?n:this.annotationStorage;switch(e){case va.DISABLE:u+=Ei.ANNOTATIONS_DISABLE;break;case va.ENABLE:break;case va.ENABLE_FORMS:u+=Ei.ANNOTATIONS_FORMS;break;case va.ENABLE_STORAGE:u+=Ei.ANNOTATIONS_STORAGE,c=f.serializable;break;default:Rt(`getRenderingIntent - invalid annotationMode: ${e}`)}o&&(u+=Ei.IS_EDITING),r&&(u+=Ei.OPLIST);const{ids:h,hash:y}=f.modifiedIds,A=[u,c.hash,y];return{renderingIntent:u,cacheKey:A.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=g(this,wo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const o of g(this,Ds).values())t.push(o._destroy());g(this,Ds).clear(),g(this,Ec).clear(),g(this,Cc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var o,r;this.commonObjs.clear(),this.fontLoader.clear(),g(this,_o).clear(),this.filterFactory.destroy(),Nf.cleanup(),(o=this._networkStream)==null||o.cancelAllRequests(new nr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,o)=>{Ue(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},o.onPull=()=>{this._fullReader.read().then(function({value:r,done:u}){if(u){o.close();return}Ue(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{o.error(r)})},o.onCancel=r=>{this._fullReader.cancel(r),o.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:o,isRangeSupported:r,contentLength:u}=this._fullReader;return(!o||!r)&&(this._lastProgress&&((c=e.onProgress)==null||c.call(e,this._lastProgress)),this._fullReader.onProgress=f=>{var h;(h=e.onProgress)==null||h.call(e,{loaded:f.loaded,total:f.total})}),{isStreamingSupported:o,isRangeSupported:r,contentLength:u}}),t.on("GetRangeReader",(n,o)=>{Ue(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(n.begin,n.end);if(!r){o.close();return}o.onPull=()=>{r.read().then(function({value:u,done:c}){if(c){o.close();return}Ue(u instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(u),1,[u])}).catch(u=>{o.error(u)})},o.onCancel=u=>{r.cancel(u),o.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new w3(n,this))}),t.on("DocException",n=>{e._capability.reject(Jn(n))}),t.on("PasswordRequest",n=>{C(this,wo,Promise.withResolvers());try{if(!e.onPassword)throw Jn(n);const o=r=>{r instanceof Error?g(this,wo).reject(r):g(this,wo).resolve({password:r})};e.onPassword(o,n.code)}catch(o){g(this,wo).reject(o)}return g(this,wo).promise}),t.on("DataLoaded",n=>{var o;(o=e.onProgress)==null||o.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;g(this,Ds).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,o,r])=>{var u;if(this.destroyed||this.commonObjs.has(n))return null;switch(o){case"Font":if("error"in r){const y=r.error;Rt(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=this._params.pdfBug&&((u=globalThis.FontInspector)!=null&&u.enabled)?(y,A)=>globalThis.FontInspector.fontAdded(y,A):null,f=new LB(r,c);this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&(f.data=null),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:h}=r;Ue(h,"The imageRef must be defined.");for(const y of g(this,Ds).values())for(const[,A]of y.objs)if((A==null?void 0:A.ref)===h)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,r);break;default:throw new Error(`Got unknown common object type ${o}`)}return null}),t.on("obj",([n,o,r,u])=>{var f;if(this.destroyed)return;const c=g(this,Ds).get(o);if(!c.objs.has(n)){if(c._intentStates.size===0){(f=u==null?void 0:u.bitmap)==null||f.close();return}switch(r){case"Image":case"Pattern":c.objs.resolve(n,u);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",n=>{var o;this.destroyed||(o=e.onProgress)==null||o.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const o=this[n.type];if(!o)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return o.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Rt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=g(this,Ec).get(e);if(n)return n;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&g(this,Cc).set(r.refStr,t);const u=new M3(e,r,this,this._params.pdfBug);return g(this,Ds).set(e,u),u});return g(this,Ec).set(e,o),o}getPageIndex(t){return mA(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return R(this,cl,Ef).call(this,"GetFieldObjects")}hasJSActions(){return R(this,cl,Ef).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return R(this,cl,Ef).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return R(this,cl,Ef).call(this,"GetOptionalContentConfig").then(e=>new r3(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=g(this,_o).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(o=>{var r,u;return{info:o[0],metadata:o[1]?new o3(o[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((u=this._fullReader)==null?void 0:u.contentLength)??null}});return g(this,_o).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of g(this,Ds).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),g(this,_o).clear(),this.filterFactory.destroy(!0),Nf.cleanup()}}cachedPageNumber(t){if(!mA(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return g(this,Cc).get(e)??null}}_o=new WeakMap,Ds=new WeakMap,Ec=new WeakMap,Cc=new WeakMap,wo=new WeakMap,cl=new WeakSet,Ef=function(t,e=null){const n=g(this,_o).get(t);if(n)return n;const o=this.messageHandler.sendWithPromise(t,e);return g(this,_o).set(t,o),o};var Ba;class N3{constructor(t){w(this,Ba,null);ot(this,"onContinue",null);ot(this,"onError",null);C(this,Ba,t)}get promise(){return g(this,Ba).capability.promise}cancel(t=0){g(this,Ba).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=g(this,Ba).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=g(this,Ba);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Ba=new WeakMap;var Ga,dl;const Dr=class Dr{constructor({callback:t,params:e,objs:n,commonObjs:o,annotationCanvasMap:r,operatorList:u,pageIndex:c,canvasFactory:f,filterFactory:h,useRequestAnimationFrame:y=!1,pdfBug:A=!1,pageColors:S=null}){w(this,Ga,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=o,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=u,this._pageIndex=c,this.canvasFactory=f,this.filterFactory=h,this._pdfBug=A,this.pageColors=S,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=y===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new N3(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var c,f;if(this.cancelled)return;if(this._canvas){if(g(Dr,dl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Dr,dl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:o,transform:r,background:u}=this.params;this.gfx=new Yu(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:o,transparency:t,background:u}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(t=null,e=0){var n,o,r;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),g(this,Ga)&&(window.cancelAnimationFrame(g(this,Ga)),C(this,Ga,null)),g(Dr,dl).delete(this._canvas),t||(t=new ST(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(r=(o=this.task).onError)==null||r.call(o,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?C(this,Ga,window.requestAnimationFrame(()=>{C(this,Ga,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Dr,dl).delete(this._canvas),this.callback())))}};Ga=new WeakMap,dl=new WeakMap,w(Dr,dl,new WeakSet);let RA=Dr;const D3="5.3.93",I3="cbeef3233";function v_(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function lf(i){return Math.max(0,Math.min(255,255*i))}class A_{static CMYK_G([t,e,n,o]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+o)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=lf(t),[t,t,t]}static G_HTML([t]){const e=v_(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(lf)}static RGB_HTML(t){return`#${t.map(v_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,o]){return["RGB",1-Math.min(1,t+o),1-Math.min(1,n+o),1-Math.min(1,e+o)]}static CMYK_rgb([t,e,n,o]){return[lf(1-Math.min(1,t+o)),lf(1-Math.min(1,n+o)),lf(1-Math.min(1,e+o))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const o=1-t,r=1-e,u=1-n,c=Math.min(o,r,u);return["CMYK",o,r,u,c]}}class P3{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const o=this._createSVG("svg:svg");return o.setAttribute("version","1.1"),n||(o.setAttribute("width",`${t}px`),o.setAttribute("height",`${e}px`)),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox",`0 0 ${t} ${e}`),o}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ae("Abstract method `_createSVG` called.")}}class _m extends P3{_createSVG(t){return document.createElementNS(oo,t)}}class pM{static setupStorage(t,e,n,o,r){const u=o.getValue(e,{value:null});switch(n.name){case"textarea":if(u.value!==null&&(t.textContent=u.value),r==="print")break;t.addEventListener("input",c=>{o.setValue(e,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(u.value===n.attributes.xfaOn?t.setAttribute("checked",!0):u.value===n.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",c=>{o.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(u.value!==null&&t.setAttribute("value",u.value),r==="print")break;t.addEventListener("input",c=>{o.setValue(e,{value:c.target.value})})}break;case"select":if(u.value!==null){t.setAttribute("value",u.value);for(const c of n.children)c.attributes.value===u.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const f=c.target.options,h=f.selectedIndex===-1?"":f[f.selectedIndex].value;o.setValue(e,{value:h})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:o,linkService:r}){const{attributes:u}=e,c=t instanceof HTMLAnchorElement;u.type==="radio"&&(u.name=`${u.name}-${o}`);for(const[f,h]of Object.entries(u))if(h!=null)switch(f){case"class":h.length&&t.setAttribute(f,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!c||f!=="href"&&f!=="newWindow")&&t.setAttribute(f,h)}c&&r.addLinkAttributes(t,u.href,u.newWindow),n&&u.dataId&&this.setupStorage(t,u.dataId,e,n)}static render(t){var A,S;const e=t.annotationStorage,n=t.linkService,o=t.xfaHtml,r=t.intent||"display",u=document.createElement(o.name);o.attributes&&this.setAttributes({html:u,element:o,intent:r,linkService:n});const c=r!=="richText",f=t.div;if(f.append(u),t.viewport){const E=`matrix(${t.viewport.transform.join(",")})`;f.style.transform=E}c&&f.setAttribute("class","xfaLayer xfaFont");const h=[];if(o.children.length===0){if(o.value){const E=document.createTextNode(o.value);u.append(E),c&&Df.shouldBuildText(o.name)&&h.push(E)}return{textDivs:h}}const y=[[o,-1,u]];for(;y.length>0;){const[E,b,x]=y.at(-1);if(b+1===E.children.length){y.pop();continue}const D=E.children[++y.at(-1)[1]];if(D===null)continue;const{name:N}=D;if(N==="#text"){const P=document.createTextNode(D.value);h.push(P),x.append(P);continue}const L=(A=D==null?void 0:D.attributes)!=null&&A.xmlns?document.createElementNS(D.attributes.xmlns,N):document.createElement(N);if(x.append(L),D.attributes&&this.setAttributes({html:L,element:D,storage:e,intent:r,linkService:n}),((S=D.children)==null?void 0:S.length)>0)y.push([D,-1,L]);else if(D.value){const P=document.createTextNode(D.value);c&&Df.shouldBuildText(N)&&h.push(P),L.append(P)}}for(const E of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))E.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const L3=9,zl=new WeakSet;class T_{static create(t){switch(t.data.annotationType){case Le.LINK:return new gM(t);case Le.TEXT:return new k3(t);case Le.WIDGET:switch(t.data.fieldType){case"Tx":return new U3(t);case"Btn":return t.data.radioButton?new vM(t):t.data.checkBox?new O3(t):new B3(t);case"Ch":return new G3(t);case"Sig":return new F3(t)}return new Yl(t);case Le.POPUP:return new DA(t);case Le.FREETEXT:return new CM(t);case Le.LINE:return new H3(t);case Le.SQUARE:return new z3(t);case Le.CIRCLE:return new q3(t);case Le.POLYLINE:return new bM(t);case Le.CARET:return new Y3(t);case Le.INK:return new MT(t);case Le.POLYGON:return new $3(t);case Le.HIGHLIGHT:return new xM(t);case Le.UNDERLINE:return new X3(t);case Le.SQUIGGLY:return new J3(t);case Le.STRIKEOUT:return new K3(t);case Le.STAMP:return new _M(t);case Le.FILEATTACHMENT:return new W3(t);default:return new Ne(t)}}}var fl,bc,xc,_h,NA;const LT=class LT{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:o=!1}={}){w(this,_h);w(this,fl,null);w(this,bc,!1);w(this,xc,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),o&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return LT._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;g(this,fl)||C(this,fl,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&R(this,_h,NA).call(this,e),(n=g(this,xc))==null||n.popup.updateEdited(t)}resetEdited(){var t;g(this,fl)&&(R(this,_h,NA).call(this,g(this,fl).rect),(t=g(this,xc))==null||t.popup.resetEdited(),C(this,fl,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:o}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Yl||(r.tabIndex=0);const{style:u}=r;if(u.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof DA){const{rotation:x}=e;return!e.hasOwnCanvas&&x!==0&&this.setRotation(x,r),r}const{width:c,height:f}=this;if(!t&&e.borderStyle.width>0){u.borderWidth=`${e.borderStyle.width}px`;const x=e.borderStyle.horizontalCornerRadius,D=e.borderStyle.verticalCornerRadius;if(x>0||D>0){const L=`calc(${x}px * var(--total-scale-factor)) / calc(${D}px * var(--total-scale-factor))`;u.borderRadius=L}else if(this instanceof vM){const L=`calc(${c}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;u.borderRadius=L}switch(e.borderStyle.style){case Pu.SOLID:u.borderStyle="solid";break;case Pu.DASHED:u.borderStyle="dashed";break;case Pu.BEVELED:Rt("Unimplemented border style: beveled");break;case Pu.INSET:Rt("Unimplemented border style: inset");break;case Pu.UNDERLINE:u.borderBottomStyle="solid";break}const N=e.borderColor||null;N?(C(this,bc,!0),u.borderColor=Ct.makeHexColor(N[0]|0,N[1]|0,N[2]|0)):u.borderWidth=0}const h=Ct.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:y,pageHeight:A,pageX:S,pageY:E}=o.rawDims;u.left=`${100*(h[0]-S)/y}%`,u.top=`${100*(h[1]-E)/A}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(u.width=`${100*c/y}%`,u.height=`${100*f/A}%`):this.setRotation(b,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:o}=this.parent.viewport.rawDims;let{width:r,height:u}=this;t%180!==0&&([r,u]=[u,r]),e.style.width=`${100*r/n}%`,e.style.height=`${100*u/o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,o)=>{const r=o.detail[e],u=r[0],c=r.slice(1);o.target.style[n]=A_[`${u}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:A_[`${u}_rgb`](c)})};return Gt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,o=n%2===1;this.container.style.visibility=o?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:o,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const o of Object.keys(e.detail)){const r=t[o]||n[o];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[o,r]of Object.entries(e)){const u=n[o];if(u){const c={detail:{[o]:r},target:t};u(c),delete e[o]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,o,r]=this.data.rect.map(x=>Math.fround(x));if(t.length===8){const[x,D,N,L]=t.subarray(2,6);if(o===x&&r===D&&e===N&&n===L)return}const{style:u}=this.container;let c;if(g(this,bc)){const{borderColor:x,borderWidth:D}=u;u.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${D}">`],this.container.classList.add("hasBorder")}const f=o-e,h=r-n,{svgFactory:y}=this,A=y.createElement("svg");A.classList.add("quadrilateralsContainer"),A.setAttribute("width",0),A.setAttribute("height",0),A.role="none";const S=y.createElement("defs");A.append(S);const E=y.createElement("clipPath"),b=`clippath_${this.data.id}`;E.setAttribute("id",b),E.setAttribute("clipPathUnits","objectBoundingBox"),S.append(E);for(let x=2,D=t.length;x<D;x+=8){const N=t[x],L=t[x+1],P=t[x+2],U=t[x+3],k=y.createElement("rect"),F=(P-e)/f,B=(r-L)/h,q=(N-P)/f,Y=(L-U)/h;k.setAttribute("x",F),k.setAttribute("y",B),k.setAttribute("width",q),k.setAttribute("height",Y),E.append(k),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${B}" width="${q}" height="${Y}"/>`)}g(this,bc)&&(c.push("</g></svg>')"),u.backgroundImage=c.join("")),this.container.append(A),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:t}=this,e=C(this,xc,new DA({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){ae("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const o=this._fieldObjects[t];if(o)for(const{page:r,id:u,exportValues:c}of o){if(r===-1||u===e)continue;const f=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${u}"]`);if(h&&!zl.has(h)){Rt(`_getElementsByName - element not allowed: ${u}`);continue}n.push({id:u,exportValue:f,domElement:h})}return n}for(const o of document.getElementsByName(t)){const{exportValue:r}=o,u=o.getAttribute("data-element-id");u!==e&&zl.has(o)&&n.push({id:u,exportValue:r,domElement:o})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};fl=new WeakMap,bc=new WeakMap,xc=new WeakMap,_h=new WeakSet,NA=function(t){const{container:{style:e},data:{rect:n,rotation:o},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:u,pageX:c,pageY:f}}}}=this;n==null||n.splice(0,4,...t),e.left=`${100*(t[0]-c)/r}%`,e.top=`${100*(u-t[3]+f)/u}%`,o===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/u}%`):this.setRotation(o)};let Ne=LT;var bi,wr,mM,yM;class gM extends Ne{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});w(this,bi);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,o=document.createElement("a");o.setAttribute("data-element-id",e.id);let r=!1;return e.url?(n.addLinkAttributes(o,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(o,e.action),r=!0):e.attachment?(R(this,bi,mM).call(this,o,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(R(this,bi,yM).call(this,o,e.setOCGState),r=!0):e.dest?(this._bindLink(o,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(o,e),r=!0),e.resetForm?(this._bindResetFormAction(o,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(o,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(o),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&R(this,bi,wr).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),R(this,bi,wr).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const o=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(n.actions)){const u=o.get(r);u&&(e[u]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),R(this,bi,wr).call(this)}_bindResetFormAction(e,n){const o=e.onclick;if(o||(e.href=this.linkService.getAnchorUrl("")),R(this,bi,wr).call(this),!this._fieldObjects){Rt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),o||(e.onclick=()=>!1);return}e.onclick=()=>{var A;o==null||o();const{fields:r,refs:u,include:c}=n,f=[];if(r.length!==0||u.length!==0){const S=new Set(u);for(const E of r){const b=this._fieldObjects[E]||[];for(const{id:x}of b)S.add(x)}for(const E of Object.values(this._fieldObjects))for(const b of E)S.has(b.id)===c&&f.push(b)}else for(const S of Object.values(this._fieldObjects))f.push(...S);const h=this.annotationStorage,y=[];for(const S of f){const{id:E}=S;switch(y.push(E),S.type){case"text":{const x=S.defaultValue||"";h.setValue(E,{value:x});break}case"checkbox":case"radiobutton":{const x=S.defaultValue===S.exportValues;h.setValue(E,{value:x});break}case"combobox":case"listbox":{const x=S.defaultValue||"";h.setValue(E,{value:x});break}default:continue}const b=document.querySelector(`[data-element-id="${E}"]`);if(b){if(!zl.has(b)){Rt(`_bindResetFormAction - element not allowed: ${E}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:y,name:"ResetForm"}})),!1}}}bi=new WeakSet,wr=function(){this.container.setAttribute("data-internal-link","")},mM=function(e,n,o=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(n.content,n.filename,o),!1},R(this,bi,wr).call(this)},yM=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),R(this,bi,wr).call(this)};class k3 extends Ne{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Yl extends Ne{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return gn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,o,r){n.includes("mouse")?t.addEventListener(n,u=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:r(u),shift:u.shiftKey,modifier:this._getKeyModifier(u)}})}):t.addEventListener(n,u=>{var c;if(n==="blur"){if(!e.focused||!u.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}r&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:r(u)}}))})}_setEventListeners(t,e,n,o){var r,u,c;for(const[f,h]of n)(h==="Action"||(r=this.data.actions)!=null&&r[h])&&((h==="Focus"||h==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,f,h,o),h==="Focus"&&!((u=this.data.actions)!=null&&u.Blur)?this._setEventListener(t,e,"blur","Blur",null):h==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Ct.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,o=this.data.defaultAppearanceData.fontSize||L3,r=t.style;let u;const c=2,f=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),y=Math.round(h/(_0*o))||1,A=h/y;u=Math.min(o,f(A/_0))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);u=Math.min(o,f(h/_0))}r.fontSize=`calc(${u}px * var(--total-scale-factor))`,r.color=Ct.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class U3 extends Yl{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,o){const r=this.annotationStorage;for(const u of this._getElementsByName(t.name,t.id))u.domElement&&(u.domElement[e]=n),r.setValue(u.id,{[o]:n})}render(){var o,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const u=t.getValue(e,{value:this.data.fieldValue});let c=u.value||"";const f=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;f&&c.length>f&&(c=c.slice(0,f));let h=u.formattedValue||((o=this.data.textContent)==null?void 0:o.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const y={userValue:c,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",h??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),zl.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const A=this.data.dateFormat||this.data.timeFormat;A&&(n.title=A),this._setRequired(n,this.data.required),f&&(n.maxLength=f),n.addEventListener("input",E=>{t.setValue(e,{value:E.target.value}),this.setPropertyOnSiblings(n,"value",E.target.value,"value"),y.formattedValue=null}),n.addEventListener("resetform",E=>{const b=this.data.defaultFieldValue??"";n.value=y.userValue=b,y.formattedValue=null});let S=E=>{const{formattedValue:b}=y;b!=null&&(E.target.value=b),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{var D;if(y.focused)return;const{target:x}=b;y.userValue&&(x.value=y.userValue),y.lastCommittedValue=x.value,y.commitKey=1,(D=this.data.actions)!=null&&D.Focus||(y.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const x={value(D){y.userValue=D.detail.value??"",t.setValue(e,{value:y.userValue.toString()}),D.target.value=y.userValue},formattedValue(D){const{formattedValue:N}=D.detail;y.formattedValue=N,N!=null&&D.target!==document.activeElement&&(D.target.value=N),t.setValue(e,{formattedValue:N})},selRange(D){D.target.setSelectionRange(...D.detail.selRange)},charLimit:D=>{var U;const{charLimit:N}=D.detail,{target:L}=D;if(N===0){L.removeAttribute("maxLength");return}L.setAttribute("maxLength",N);let P=y.userValue;!P||P.length<=N||(P=P.slice(0,N),L.value=y.userValue=P,t.setValue(e,{value:P}),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:L.selectionStart,selEnd:L.selectionEnd}}))}};this._dispatchEventFromSandbox(x,b)}),n.addEventListener("keydown",b=>{var N;y.commitKey=1;let x=-1;if(b.key==="Escape"?x=0:b.key==="Enter"&&!this.data.multiLine?x=2:b.key==="Tab"&&(y.commitKey=3),x===-1)return;const{value:D}=b.target;y.lastCommittedValue!==D&&(y.lastCommittedValue=D,y.userValue=D,(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:x,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const E=S;S=null,n.addEventListener("blur",b=>{var D,N;if(!y.focused||!b.relatedTarget)return;(D=this.data.actions)!=null&&D.Blur||(y.focused=!1);const{value:x}=b.target;y.userValue=x,y.lastCommittedValue!==x&&((N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:y.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),E(b)}),(r=this.data.actions)!=null&&r.Keystroke&&n.addEventListener("beforeinput",b=>{var F;y.lastCommittedValue=null;const{data:x,target:D}=b,{value:N,selectionStart:L,selectionEnd:P}=D;let U=L,k=P;switch(b.inputType){case"deleteWordBackward":{const B=N.substring(0,L).match(/\w*[^\w]*$/);B&&(U-=B[0].length);break}case"deleteWordForward":{const B=N.substring(L).match(/^[^\w]*\w*/);B&&(k+=B[0].length);break}case"deleteContentBackward":L===P&&(U-=1);break;case"deleteContentForward":L===P&&(k+=1);break}b.preventDefault(),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,change:x||"",willCommit:!1,selStart:U,selEnd:k}})}),this._setEventListeners(n,y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(S&&n.addEventListener("blur",S),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/f;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class F3 extends Yl{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class O3 extends Yl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let o=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof o=="string"&&(o=o!=="Off",t.setValue(n,{value:o})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return zl.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,o&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",u=>{const{name:c,checked:f}=u.target;for(const h of this._getElementsByName(c,n)){const y=f&&h.exportValue===e.exportValue;h.domElement&&(h.domElement.checked=y),t.setValue(h.id,{value:y})}t.setValue(n,{value:f})}),r.addEventListener("resetform",u=>{const c=e.defaultFieldValue||"Off";u.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",u=>{const c={value(f){f.target.checked=f.detail.value!=="Off",t.setValue(n,{value:f.target.checked})}};this._dispatchEventFromSandbox(c,u)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class vM extends Yl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let o=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof o=="string"&&(o=o!==e.buttonValue,t.setValue(n,{value:o})),o)for(const u of this._getElementsByName(e.fieldName,n))t.setValue(u.id,{value:!1});const r=document.createElement("input");if(zl.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,o&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",u=>{const{name:c,checked:f}=u.target;for(const h of this._getElementsByName(c,n))t.setValue(h.id,{value:!1});t.setValue(n,{value:f})}),r.addEventListener("resetform",u=>{const c=e.defaultFieldValue;u.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const u=e.buttonValue;r.addEventListener("updatefromsandbox",c=>{const f={value:h=>{const y=u===h.detail.value;for(const A of this._getElementsByName(h.target.name)){const S=y&&A.id===n;A.domElement&&(A.domElement.checked=S),t.setValue(A.id,{value:S})}}};this._dispatchEventFromSandbox(f,c)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class B3 extends gM{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class G3 extends Yl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),o=document.createElement("select");zl.add(o),o.setAttribute("data-element-id",e),o.disabled=this.data.readOnly,this._setRequired(o,this.data.required),o.name=this.data.fieldName,o.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(o.size=this.data.options.length,this.data.multiSelect&&(o.multiple=!0)),o.addEventListener("resetform",y=>{const A=this.data.defaultFieldValue;for(const S of o.options)S.selected=S.value===A});for(const y of this.data.options){const A=document.createElement("option");A.textContent=y.displayValue,A.value=y.exportValue,n.value.includes(y.exportValue)&&(A.setAttribute("selected",!0),r=!1),o.append(A)}let u=null;if(r){const y=document.createElement("option");y.value=" ",y.setAttribute("hidden",!0),y.setAttribute("selected",!0),o.prepend(y),u=()=>{y.remove(),o.removeEventListener("input",u),u=null},o.addEventListener("input",u)}const c=y=>{const A=y?"value":"textContent",{options:S,multiple:E}=o;return E?Array.prototype.filter.call(S,b=>b.selected).map(b=>b[A]):S.selectedIndex===-1?null:S[S.selectedIndex][A]};let f=c(!1);const h=y=>{const A=y.target.options;return Array.prototype.map.call(A,S=>({displayValue:S.textContent,exportValue:S.value}))};return this.enableScripting&&this.hasJSActions?(o.addEventListener("updatefromsandbox",y=>{const A={value(S){u==null||u();const E=S.detail.value,b=new Set(Array.isArray(E)?E:[E]);for(const x of o.options)x.selected=b.has(x.value);t.setValue(e,{value:c(!0)}),f=c(!1)},multipleSelection(S){o.multiple=!0},remove(S){const E=o.options,b=S.detail.remove;E[b].selected=!1,o.remove(b),E.length>0&&Array.prototype.findIndex.call(E,D=>D.selected)===-1&&(E[0].selected=!0),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},clear(S){for(;o.length!==0;)o.remove(0);t.setValue(e,{value:null,items:[]}),f=c(!1)},insert(S){const{index:E,displayValue:b,exportValue:x}=S.detail.insert,D=o.children[E],N=document.createElement("option");N.textContent=b,N.value=x,D?D.before(N):o.append(N),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},items(S){const{items:E}=S.detail;for(;o.length!==0;)o.remove(0);for(const b of E){const{displayValue:x,exportValue:D}=b,N=document.createElement("option");N.textContent=x,N.value=D,o.append(N)}o.options.length>0&&(o.options[0].selected=!0),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},indices(S){const E=new Set(S.detail.indices);for(const b of S.target.options)b.selected=E.has(b.index);t.setValue(e,{value:c(!0)}),f=c(!1)},editable(S){S.target.disabled=!S.detail.editable}};this._dispatchEventFromSandbox(A,y)}),o.addEventListener("input",y=>{var E;const A=c(!0),S=c(!1);t.setValue(e,{value:A}),y.preventDefault(),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,change:S,changeEx:A,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(o,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],y=>y.target.value)):o.addEventListener("input",function(y){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(o),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class DA extends Ne{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Ne._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new V3({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const o of this.elements)o.popup=e,o.container.ariaHasPopup="dialog",n.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(o=>`${TT}${o}`).join(",")),this.container}}var _c,zm,qm,wc,Mc,be,Mo,hl,wh,Mh,Rc,Ro,is,No,Rh,Do,Nh,pl,gl,re,im,IA,AM,TM,SM,EM,sm,om,PA;class V3{constructor({container:t,color:e,elements:n,titleObj:o,modificationDate:r,contentsObj:u,richText:c,parent:f,rect:h,parentRect:y,open:A}){w(this,re);w(this,_c,R(this,re,SM).bind(this));w(this,zm,R(this,re,PA).bind(this));w(this,qm,R(this,re,om).bind(this));w(this,wc,R(this,re,sm).bind(this));w(this,Mc,null);w(this,be,null);w(this,Mo,null);w(this,hl,null);w(this,wh,null);w(this,Mh,null);w(this,Rc,null);w(this,Ro,!1);w(this,is,null);w(this,No,null);w(this,Rh,null);w(this,Do,null);w(this,Nh,null);w(this,pl,null);w(this,gl,!1);var S;C(this,be,t),C(this,Nh,o),C(this,Mo,u),C(this,Do,c),C(this,Mh,f),C(this,Mc,e),C(this,Rh,h),C(this,Rc,y),C(this,wh,n),C(this,hl,CT.toDateObject(r)),this.trigger=n.flatMap(E=>E.getElementsToTriggerPopup());for(const E of this.trigger)E.addEventListener("click",g(this,wc)),E.addEventListener("mouseenter",g(this,qm)),E.addEventListener("mouseleave",g(this,zm)),E.classList.add("popupTriggerArea");for(const E of n)(S=E.container)==null||S.addEventListener("keydown",g(this,_c));g(this,be).hidden=!0,A&&R(this,re,sm).call(this)}render(){if(g(this,is))return;const t=C(this,is,document.createElement("div"));if(t.className="popup",g(this,Mc)){const r=t.style.outlineColor=Ct.makeHexColor(...g(this,Mc));t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=g(this,Nh),t.append(e),g(this,hl)){const r=document.createElement("time");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,hl).valueOf()})),r.dateTime=g(this,hl).toISOString(),e.append(r)}const o=g(this,re,im);if(o)pM.render({xfaHtml:o,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(g(this,Mo));t.append(r)}g(this,be).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const o=t.split(/(?:\r\n?|\n)/);for(let r=0,u=o.length;r<u;++r){const c=o[r];n.append(document.createTextNode(c)),r<u-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;g(this,pl)||C(this,pl,{contentsObj:g(this,Mo),richText:g(this,Do)}),t&&C(this,No,null),e&&(C(this,Do,R(this,re,TM).call(this,e)),C(this,Mo,null)),(n=g(this,is))==null||n.remove(),C(this,is,null)}resetEdited(){var t;g(this,pl)&&({contentsObj:Rn(this,Mo)._,richText:Rn(this,Do)._}=g(this,pl),C(this,pl,null),(t=g(this,is))==null||t.remove(),C(this,is,null),C(this,No,null))}forceHide(){C(this,gl,this.isVisible),g(this,gl)&&(g(this,be).hidden=!0)}maybeShow(){g(this,gl)&&(g(this,is)||R(this,re,om).call(this),C(this,gl,!1),g(this,be).hidden=!1)}get isVisible(){return g(this,be).hidden===!1}}_c=new WeakMap,zm=new WeakMap,qm=new WeakMap,wc=new WeakMap,Mc=new WeakMap,be=new WeakMap,Mo=new WeakMap,hl=new WeakMap,wh=new WeakMap,Mh=new WeakMap,Rc=new WeakMap,Ro=new WeakMap,is=new WeakMap,No=new WeakMap,Rh=new WeakMap,Do=new WeakMap,Nh=new WeakMap,pl=new WeakMap,gl=new WeakMap,re=new WeakSet,im=function(){const t=g(this,Do),e=g(this,Mo);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&g(this,Do).html||null},IA=function(){var t,e,n;return((n=(e=(t=g(this,re,im))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},AM=function(){var t,e,n;return((n=(e=(t=g(this,re,im))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},TM=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},o={style:{color:g(this,re,AM),fontSize:g(this,re,IA)?`calc(${g(this,re,IA)}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:o});return n},SM=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&g(this,Ro))&&R(this,re,sm).call(this)},EM=function(){if(g(this,No)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:o,pageY:r}}}=g(this,Mh);let u=!!g(this,Rc),c=u?g(this,Rc):g(this,Rh);for(const b of g(this,wh))if(!c||Ct.intersect(b.data.rect,c)!==null){c=b.data.rect,u=!0;break}const f=Ct.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),y=u?c[2]-c[0]+5:0,A=f[0]+y,S=f[1];C(this,No,[100*(A-o)/e,100*(S-r)/n]);const{style:E}=g(this,be);E.left=`${g(this,No)[0]}%`,E.top=`${g(this,No)[1]}%`},sm=function(){C(this,Ro,!g(this,Ro)),g(this,Ro)?(R(this,re,om).call(this),g(this,be).addEventListener("click",g(this,wc)),g(this,be).addEventListener("keydown",g(this,_c))):(R(this,re,PA).call(this),g(this,be).removeEventListener("click",g(this,wc)),g(this,be).removeEventListener("keydown",g(this,_c)))},om=function(){g(this,is)||this.render(),this.isVisible?g(this,Ro)&&g(this,be).classList.add("focused"):(R(this,re,EM).call(this),g(this,be).hidden=!1,g(this,be).style.zIndex=parseInt(g(this,be).style.zIndex)+1e3)},PA=function(){g(this,be).classList.remove("focused"),!(g(this,Ro)||!this.isVisible)&&(g(this,be).hidden=!0,g(this,be).style.zIndex=parseInt(g(this,be).style.zIndex)-1e3)};class CM extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Mt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Dh;class H3 extends Ne{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Dh,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=C(this,Dh,this.svgFactory.createElement("svg:line"));return u.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),u.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),u.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),u.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),u.setAttribute("stroke-width",e.borderStyle.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),r.append(u),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Dh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dh=new WeakMap;var Ih;class z3 extends Ne{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Ih,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=e.borderStyle.width,c=C(this,Ih,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",u/2),c.setAttribute("y",u/2),c.setAttribute("width",n-u),c.setAttribute("height",o-u),c.setAttribute("stroke-width",u||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Ih)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ih=new WeakMap;var Ph;class q3 extends Ne{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Ph,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=e.borderStyle.width,c=C(this,Ph,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",o/2),c.setAttribute("rx",n/2-u/2),c.setAttribute("ry",o/2-u/2),c.setAttribute("stroke-width",u||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Ph)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ph=new WeakMap;var Lh;class bM extends Ne{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Lh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:o,popupRef:r},width:u,height:c}=this;if(!n)return this.container;const f=this.svgFactory.create(u,c,!0);let h=[];for(let A=0,S=n.length;A<S;A+=2){const E=n[A]-e[0],b=e[3]-n[A+1];h.push(`${E},${b}`)}h=h.join(" ");const y=C(this,Lh,this.svgFactory.createElement(this.svgElementName));return y.setAttribute("points",h),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),f.append(y),this.container.append(f),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Lh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lh=new WeakMap;class $3 extends bM{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y3 extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var kh,ml,Uh,LA;class MT extends Ne{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Uh);w(this,kh,null);w(this,ml,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Mt.HIGHLIGHT:Mt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:o,borderStyle:r,popupRef:u}}=this,{transform:c,width:f,height:h}=R(this,Uh,LA).call(this,n,e),y=this.svgFactory.create(f,h,!0),A=C(this,kh,this.svgFactory.createElement("svg:g"));y.append(A),A.setAttribute("stroke-width",r.width||1),A.setAttribute("stroke-linecap","round"),A.setAttribute("stroke-linejoin","round"),A.setAttribute("stroke-miterlimit",10),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),A.setAttribute("transform",c);for(let S=0,E=o.length;S<E;S++){const b=this.svgFactory.createElement(this.svgElementName);g(this,ml).push(b),b.setAttribute("points",o[S].join(",")),A.append(b)}return!u&&this.hasPopupData&&this._createPopup(),this.container.append(y),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:o,rect:r}=e,u=g(this,kh);if(n>=0&&u.setAttribute("stroke-width",n||1),o)for(let c=0,f=g(this,ml).length;c<f;c++)g(this,ml)[c].setAttribute("points",o[c].join(","));if(r){const{transform:c,width:f,height:h}=R(this,Uh,LA).call(this,this.data.rotation,r);u.parentElement.setAttribute("viewBox",`0 0 ${f} ${h}`),u.setAttribute("transform",c)}}getElementsToTriggerPopup(){return g(this,ml)}addHighlightArea(){this.container.classList.add("highlightArea")}}kh=new WeakMap,ml=new WeakMap,Uh=new WeakSet,LA=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class xM extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Mt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class X3 extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class J3 extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class K3 extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class _M extends Ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Mt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Fh,Oh,kA;class W3 extends Ne{constructor(e){var o;super(e,{isRenderable:!0});w(this,Oh);w(this,Fh,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(o=this.linkService.eventBus)==null||o.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let o;n.hasAppearance||n.fillAlpha===0?o=document.createElement("div"):(o=document.createElement("img"),o.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(o.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),o.addEventListener("dblclick",R(this,Oh,kA).bind(this)),C(this,Fh,o);const{isMac:r}=gn.platform;return e.addEventListener("keydown",u=>{u.key==="Enter"&&(r?u.metaKey:u.ctrlKey)&&R(this,Oh,kA).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():o.classList.add("popupTriggerArea"),e.append(o),e}getElementsToTriggerPopup(){return g(this,Fh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fh=new WeakMap,Oh=new WeakSet,kA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Bh,yl,Va,Gh,ar,FA,OA;const kT=class kT{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:o,page:r,viewport:u,structTreeLayer:c}){w(this,ar);w(this,Bh,null);w(this,yl,null);w(this,Va,new Map);w(this,Gh,null);this.div=t,C(this,Bh,e),C(this,yl,n),C(this,Gh,c||null),this.page=r,this.viewport=u,this.zIndex=0,this._annotationEditorUIManager=o}hasEditableAnnotations(){return g(this,Va).size>0}async render(t){var u;const{annotations:e}=t,n=this.div;Vl(n,this.viewport);const o=new Map,r={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new _m,annotationStorage:t.annotationStorage||new xT,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const f=c.annotationType===Le.POPUP;if(f){const A=o.get(c.id);if(!A)continue;r.elements=A}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;r.data=c;const h=T_.create(r);if(!h.isRenderable)continue;if(!f&&c.popupRef){const A=o.get(c.popupRef);A?A.push(h):o.set(c.popupRef,[h])}const y=h.render();c.hidden&&(y.style.visibility="hidden"),await R(this,ar,FA).call(this,y,c.id,r.elements),h._isEditable&&(g(this,Va).set(h.data.id,h),(u=this._annotationEditorUIManager)==null||u.renderAnnotationElement(h))}R(this,ar,OA).call(this)}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new _m,parent:this};for(const o of t){o.borderStyle||(o.borderStyle=kT._defaultBorderStyle),n.data=o;const r=T_.create(n);if(!r.isRenderable)continue;const u=r.render();await R(this,ar,FA).call(this,u,o.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,Vl(e,{rotation:t.rotation}),R(this,ar,OA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(g(this,Va).values())}getEditableAnnotation(t){return g(this,Va).get(t)}static get _defaultBorderStyle(){return Gt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Pu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Bh=new WeakMap,yl=new WeakMap,Va=new WeakMap,Gh=new WeakMap,ar=new WeakSet,FA=async function(t,e,n){var c,f;const o=t.firstChild||t,r=o.id=`${TT}${e}`,u=await((c=g(this,Gh))==null?void 0:c.getAriaAttributes(r));if(u)for(const[h,y]of u)o.setAttribute(h,y);n?n.at(-1).container.after(t):(this.div.append(t),(f=g(this,Bh))==null||f.moveElementInDOM(this.div,t,o,!1))},OA=function(){var e;if(!g(this,yl))return;const t=this.div;for(const[n,o]of g(this,yl)){const r=t.querySelector(`[data-annotation-id="${n}"]`);if(!r)continue;o.className="annotationContent";const{firstChild:u}=r;u?u.nodeName==="CANVAS"?u.replaceWith(o):u.classList.contains("annotationContent")?u.after(o):u.before(o):r.append(o);const c=g(this,Va).get(n);c&&(c._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(n,r.id,o),c._hasNoCanvas=!1):c.canvas=o)}g(this,yl).clear()};let UA=kT;const Og=/\r\n?|\n/g;var ss,fi,Vh,vl,hi,Fe,wM,MM,RM,am,zo,rm,lm,NM,GA,DM;const ce=class ce extends fe{constructor(e){super({...e,name:"freeTextEditor"});w(this,Fe);w(this,ss);w(this,fi,"");w(this,Vh,`${this.id}-editor`);w(this,vl,null);w(this,hi);C(this,ss,e.color||ce._defaultColor||fe._defaultLineColor),C(this,hi,e.fontSize||ce._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const e=ce.prototype,n=u=>u.isEmpty(),o=Hl.TRANSLATE_SMALL,r=Hl.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new dp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-o,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[o,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-o],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,o],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:n}]]))}static initialize(e,n){fe.initialize(e,n);const o=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(o.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Vt.FREETEXT_SIZE:ce._defaultFontSize=n;break;case Vt.FREETEXT_COLOR:ce._defaultColor=n;break}}updateParams(e,n){switch(e){case Vt.FREETEXT_SIZE:R(this,Fe,wM).call(this,n);break;case Vt.FREETEXT_COLOR:R(this,Fe,MM).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Vt.FREETEXT_SIZE,ce._defaultFontSize],[Vt.FREETEXT_COLOR,ce._defaultColor||fe._defaultLineColor]]}get propertiesToUpdate(){return[[Vt.FREETEXT_SIZE,g(this,hi)],[Vt.FREETEXT_COLOR,g(this,ss)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-ce._internalPadding*e,-(ce._internalPadding+g(this,hi))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),C(this,vl,new AbortController);const e=this._uiManager.combinedSignal(g(this,vl));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,Vh)),this._isDraggable=!0,(e=g(this,vl))==null||e.abort(),C(this,vl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=g(this,fi),n=C(this,fi,R(this,Fe,RM).call(this).trimEnd());if(e===n)return;const o=r=>{if(C(this,fi,r),!r){this.remove();return}R(this,Fe,lm).call(this),this._uiManager.rebuild(this),R(this,Fe,am).call(this)};this.addCommands({cmd:()=>{o(n)},undo:()=>{o(e)},mustExec:!1}),R(this,Fe,am).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ce._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,n;(this._isCopy||this.annotationElementId)&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,Vh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:o}=this.editorDiv;if(o.fontSize=`calc(${g(this,hi)}px * var(--total-scale-factor))`,o.color=g(this,ss),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,u]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[f,h]=this.getInitialTranslation();[f,h]=this.pageTranslationToScreen(f,h);const[y,A]=this.pageDimensions,[S,E]=this.pageTranslation;let b,x;switch(this.rotation){case 0:b=e+(c[0]-S)/y,x=n+this.height-(c[1]-E)/A;break;case 90:b=e+(c[0]-S)/y,x=n-(c[1]-E)/A,[f,h]=[h,-f];break;case 180:b=e-this.width+(c[0]-S)/y,x=n-(c[1]-E)/A,[f,h]=[-f,-h];break;case 270:b=e+(c[0]-S-this.height*A)/y,x=n+(c[1]-E-this.width*y)/A,[f,h]=[-h,f];break}this.setAt(b*r,x*u,f,h)}else this._moveAfterPaste(e,n);R(this,Fe,lm).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var b,x,D;const n=e.clipboardData||window.clipboardData,{types:o}=n;if(o.length===1&&o[0]==="text/plain")return;e.preventDefault();const r=R(b=ce,zo,GA).call(b,n.getData("text")||"").replaceAll(Og,`
`);if(!r)return;const u=window.getSelection();if(!u.rangeCount)return;this.editorDiv.normalize(),u.deleteFromDocument();const c=u.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),u.collapseToStart();return}const{startContainer:f,startOffset:h}=c,y=[],A=[];if(f.nodeType===Node.TEXT_NODE){const N=f.parentElement;if(A.push(f.nodeValue.slice(h).replaceAll(Og,"")),N!==this.editorDiv){let L=y;for(const P of this.editorDiv.childNodes){if(P===N){L=A;continue}L.push(R(x=ce,zo,rm).call(x,P))}}y.push(f.nodeValue.slice(0,h).replaceAll(Og,""))}else if(f===this.editorDiv){let N=y,L=0;for(const P of this.editorDiv.childNodes)L++===h&&(N=A),N.push(R(D=ce,zo,rm).call(D,P))}C(this,fi,`${y.join(`
`)}${r}${A.join(`
`)}`),R(this,Fe,lm).call(this);const S=new Range;let E=Math.sumPrecise(y.map(N=>N.length));for(const{firstChild:N}of this.editorDiv.childNodes)if(N.nodeType===Node.TEXT_NODE){const L=N.nodeValue.length;if(E<=L){S.setStart(N,E),S.setEnd(N,E);break}E-=L}u.removeAllRanges(),u.addRange(S)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,o){var c;let r=null;if(e instanceof CM){const{data:{defaultAppearanceData:{fontSize:f,fontColor:h},rect:y,rotation:A,id:S,popupRef:E},textContent:b,textPosition:x,parent:{page:{pageNumber:D}}}=e;if(!b||b.length===0)return null;r=e={annotationType:Mt.FREETEXT,color:Array.from(h),fontSize:f,value:b.join(`
`),position:x,pageIndex:D-1,rect:y.slice(0),rotation:A,annotationElementId:S,id:S,deleted:!1,popupRef:E}}const u=await super.deserialize(e,n,o);return C(u,hi,e.fontSize),C(u,ss,Ct.makeHexColor(...e.color)),C(u,fi,R(c=ce,zo,GA).call(c,e.value)),u._initialData=r,u}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=ce._internalPadding*this.parentScale,o=this.getRect(n,n),r=fe._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:g(this,ss)),u={annotationType:Mt.FREETEXT,color:r,fontSize:g(this,hi),value:R(this,Fe,NM).call(this),pageIndex:this.pageIndex,rect:o,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(u.isCopy=!0,u):this.annotationElementId&&!R(this,Fe,DM).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:o}=n;o.fontSize=`calc(${g(this,hi)}px * var(--total-scale-factor))`,o.color=g(this,ss),n.replaceChildren();for(const u of g(this,fi).split(`
`)){const c=document.createElement("div");c.append(u?document.createTextNode(u):document.createElement("br")),n.append(c)}const r=ce._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:g(this,fi)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};ss=new WeakMap,fi=new WeakMap,Vh=new WeakMap,vl=new WeakMap,hi=new WeakMap,Fe=new WeakSet,wM=function(e){const n=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-g(this,hi))*this.parentScale),C(this,hi,r),R(this,Fe,am).call(this)},o=g(this,hi);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},MM=function(e){const n=r=>{C(this,ss,this.editorDiv.style.color=r)},o=g(this,ss);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},RM=function(){var o;const e=[];this.editorDiv.normalize();let n=null;for(const r of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(R(o=ce,zo,rm).call(o,r)),n=r);return e.join(`
`)},am=function(){const[e,n]=this.parentDimensions;let o;if(this.isAttachedToDOM)o=this.div.getBoundingClientRect();else{const{currentLayer:r,div:u}=this,c=u.style.display,f=u.classList.contains("hidden");u.classList.remove("hidden"),u.style.display="hidden",r.div.append(this.div),o=u.getBoundingClientRect(),u.remove(),u.style.display=c,u.classList.toggle("hidden",f)}this.rotation%180===this.parentRotation%180?(this.width=o.width/e,this.height=o.height/n):(this.width=o.height/e,this.height=o.width/n),this.fixAndSetPosition()},zo=new WeakSet,rm=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Og,"")},lm=function(){if(this.editorDiv.replaceChildren(),!!g(this,fi))for(const e of g(this,fi).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},NM=function(){return g(this,fi).replaceAll(" "," ")},GA=function(e){return e.replaceAll(" "," ")},DM=function(e){const{value:n,fontSize:o,color:r,pageIndex:u}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==o||e.color.some((c,f)=>c!==r[f])||e.pageIndex!==u},w(ce,zo),ot(ce,"_freeTextDefaultContent",""),ot(ce,"_internalPadding",0),ot(ce,"_defaultColor",null),ot(ce,"_defaultFontSize",10),ot(ce,"_type","freetext"),ot(ce,"_editorType",Mt.FREETEXT);let BA=ce;class ft{toSVGPath(){ae("Abstract method `toSVGPath` must be implemented.")}get box(){ae("Abstract getter `box` must be implemented.")}serialize(t,e){ae("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,o,r,u){u||(u=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)u[c]=e+t[c]*o,u[c+1]=n+t[c+1]*r;return u}static _rescaleAndSwap(t,e,n,o,r,u){u||(u=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)u[c]=e+t[c+1]*o,u[c+1]=n+t[c]*r;return u}static _translate(t,e,n,o){o||(o=new Float32Array(t.length));for(let r=0,u=t.length;r<u;r+=2)o[r]=e+t[r],o[r+1]=n+t[r+1];return o}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,o,r){switch(r){case 90:return[1-e/n,t/o];case 180:return[1-t/n,1-e/o];case 270:return[e/n,1-t/o];default:return[t/n,e/o]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,o,r,u){return[(t+5*n)/6,(e+5*o)/6,(5*n+r)/6,(5*o+u)/6,(n+r)/2,(o+u)/2]}}ot(ft,"PRECISION",1e-4);var pi,os,Nc,Dc,Is,Ft,Al,Tl,Hh,zh,Ic,Pc,Ha,qh,$m,Ym,$e,Cf,IM,PM,LM,kM,UM,FM;const uo=class uo{constructor({x:t,y:e},n,o,r,u,c=0){w(this,$e);w(this,pi);w(this,os,[]);w(this,Nc);w(this,Dc);w(this,Is,[]);w(this,Ft,new Float32Array(18));w(this,Al);w(this,Tl);w(this,Hh);w(this,zh);w(this,Ic);w(this,Pc);w(this,Ha,[]);C(this,pi,n),C(this,Pc,r*o),C(this,Dc,u),g(this,Ft).set([NaN,NaN,NaN,NaN,t,e],6),C(this,Nc,c),C(this,zh,g(uo,qh)*o),C(this,Hh,g(uo,Ym)*o),C(this,Ic,o),g(this,Ha).push(t,e)}isEmpty(){return isNaN(g(this,Ft)[8])}add({x:t,y:e}){var Y;C(this,Al,t),C(this,Tl,e);const[n,o,r,u]=g(this,pi);let[c,f,h,y]=g(this,Ft).subarray(8,12);const A=t-h,S=e-y,E=Math.hypot(A,S);if(E<g(this,Hh))return!1;const b=E-g(this,zh),x=b/E,D=x*A,N=x*S;let L=c,P=f;c=h,f=y,h+=D,y+=N,(Y=g(this,Ha))==null||Y.push(t,e);const U=-N/b,k=D/b,F=U*g(this,Pc),B=k*g(this,Pc);return g(this,Ft).set(g(this,Ft).subarray(2,8),0),g(this,Ft).set([h+F,y+B],4),g(this,Ft).set(g(this,Ft).subarray(14,18),12),g(this,Ft).set([h-F,y-B],16),isNaN(g(this,Ft)[6])?(g(this,Is).length===0&&(g(this,Ft).set([c+F,f+B],2),g(this,Is).push(NaN,NaN,NaN,NaN,(c+F-n)/r,(f+B-o)/u),g(this,Ft).set([c-F,f-B],14),g(this,os).push(NaN,NaN,NaN,NaN,(c-F-n)/r,(f-B-o)/u)),g(this,Ft).set([L,P,c,f,h,y],6),!this.isEmpty()):(g(this,Ft).set([L,P,c,f,h,y],6),Math.abs(Math.atan2(P-f,L-c)-Math.atan2(N,D))<Math.PI/2?([c,f,h,y]=g(this,Ft).subarray(2,6),g(this,Is).push(NaN,NaN,NaN,NaN,((c+h)/2-n)/r,((f+y)/2-o)/u),[c,f,L,P]=g(this,Ft).subarray(14,18),g(this,os).push(NaN,NaN,NaN,NaN,((L+c)/2-n)/r,((P+f)/2-o)/u),!0):([L,P,c,f,h,y]=g(this,Ft).subarray(0,6),g(this,Is).push(((L+5*c)/6-n)/r,((P+5*f)/6-o)/u,((5*c+h)/6-n)/r,((5*f+y)/6-o)/u,((c+h)/2-n)/r,((f+y)/2-o)/u),[h,y,c,f,L,P]=g(this,Ft).subarray(12,18),g(this,os).push(((L+5*c)/6-n)/r,((P+5*f)/6-o)/u,((5*c+h)/6-n)/r,((5*f+y)/6-o)/u,((c+h)/2-n)/r,((f+y)/2-o)/u),!0))}toSVGPath(){if(this.isEmpty())return"";const t=g(this,Is),e=g(this,os);if(isNaN(g(this,Ft)[6])&&!this.isEmpty())return R(this,$e,IM).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let o=6;o<t.length;o+=6)isNaN(t[o])?n.push(`L${t[o+4]} ${t[o+5]}`):n.push(`C${t[o]} ${t[o+1]} ${t[o+2]} ${t[o+3]} ${t[o+4]} ${t[o+5]}`);R(this,$e,LM).call(this,n);for(let o=e.length-6;o>=6;o-=6)isNaN(e[o])?n.push(`L${e[o+4]} ${e[o+5]}`):n.push(`C${e[o]} ${e[o+1]} ${e[o+2]} ${e[o+3]} ${e[o+4]} ${e[o+5]}`);return R(this,$e,PM).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,o,r,u){return new OM(t,e,n,o,r,u)}getOutlines(){var A;const t=g(this,Is),e=g(this,os),n=g(this,Ft),[o,r,u,c]=g(this,pi),f=new Float32Array((((A=g(this,Ha))==null?void 0:A.length)??0)+2);for(let S=0,E=f.length-2;S<E;S+=2)f[S]=(g(this,Ha)[S]-o)/u,f[S+1]=(g(this,Ha)[S+1]-r)/c;if(f[f.length-2]=(g(this,Al)-o)/u,f[f.length-1]=(g(this,Tl)-r)/c,isNaN(n[6])&&!this.isEmpty())return R(this,$e,kM).call(this,f);const h=new Float32Array(g(this,Is).length+24+g(this,os).length);let y=t.length;for(let S=0;S<y;S+=2){if(isNaN(t[S])){h[S]=h[S+1]=NaN;continue}h[S]=t[S],h[S+1]=t[S+1]}y=R(this,$e,FM).call(this,h,y);for(let S=e.length-6;S>=6;S-=6)for(let E=0;E<6;E+=2){if(isNaN(e[S+E])){h[y]=h[y+1]=NaN,y+=2;continue}h[y]=e[S+E],h[y+1]=e[S+E+1],y+=2}return R(this,$e,UM).call(this,h,y),this.newFreeDrawOutline(h,f,g(this,pi),g(this,Ic),g(this,Nc),g(this,Dc))}};pi=new WeakMap,os=new WeakMap,Nc=new WeakMap,Dc=new WeakMap,Is=new WeakMap,Ft=new WeakMap,Al=new WeakMap,Tl=new WeakMap,Hh=new WeakMap,zh=new WeakMap,Ic=new WeakMap,Pc=new WeakMap,Ha=new WeakMap,qh=new WeakMap,$m=new WeakMap,Ym=new WeakMap,$e=new WeakSet,Cf=function(){const t=g(this,Ft).subarray(4,6),e=g(this,Ft).subarray(16,18),[n,o,r,u]=g(this,pi);return[(g(this,Al)+(t[0]-e[0])/2-n)/r,(g(this,Tl)+(t[1]-e[1])/2-o)/u,(g(this,Al)+(e[0]-t[0])/2-n)/r,(g(this,Tl)+(e[1]-t[1])/2-o)/u]},IM=function(){const[t,e,n,o]=g(this,pi),[r,u,c,f]=R(this,$e,Cf).call(this);return`M${(g(this,Ft)[2]-t)/n} ${(g(this,Ft)[3]-e)/o} L${(g(this,Ft)[4]-t)/n} ${(g(this,Ft)[5]-e)/o} L${r} ${u} L${c} ${f} L${(g(this,Ft)[16]-t)/n} ${(g(this,Ft)[17]-e)/o} L${(g(this,Ft)[14]-t)/n} ${(g(this,Ft)[15]-e)/o} Z`},PM=function(t){const e=g(this,os);t.push(`L${e[4]} ${e[5]} Z`)},LM=function(t){const[e,n,o,r]=g(this,pi),u=g(this,Ft).subarray(4,6),c=g(this,Ft).subarray(16,18),[f,h,y,A]=R(this,$e,Cf).call(this);t.push(`L${(u[0]-e)/o} ${(u[1]-n)/r} L${f} ${h} L${y} ${A} L${(c[0]-e)/o} ${(c[1]-n)/r}`)},kM=function(t){const e=g(this,Ft),[n,o,r,u]=g(this,pi),[c,f,h,y]=R(this,$e,Cf).call(this),A=new Float32Array(36);return A.set([NaN,NaN,NaN,NaN,(e[2]-n)/r,(e[3]-o)/u,NaN,NaN,NaN,NaN,(e[4]-n)/r,(e[5]-o)/u,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,h,y,NaN,NaN,NaN,NaN,(e[16]-n)/r,(e[17]-o)/u,NaN,NaN,NaN,NaN,(e[14]-n)/r,(e[15]-o)/u],0),this.newFreeDrawOutline(A,t,g(this,pi),g(this,Ic),g(this,Nc),g(this,Dc))},UM=function(t,e){const n=g(this,os);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},FM=function(t,e){const n=g(this,Ft).subarray(4,6),o=g(this,Ft).subarray(16,18),[r,u,c,f]=g(this,pi),[h,y,A,S]=R(this,$e,Cf).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-r)/c,(n[1]-u)/f,NaN,NaN,NaN,NaN,h,y,NaN,NaN,NaN,NaN,A,S,NaN,NaN,NaN,NaN,(o[0]-r)/c,(o[1]-u)/f],e),e+=24},w(uo,qh,8),w(uo,$m,2),w(uo,Ym,g(uo,qh)+g(uo,$m));let wm=uo;var Lc,Sl,Io,$h,gi,Yh,Re,Xm,BM;class OM extends ft{constructor(e,n,o,r,u,c){super();w(this,Xm);w(this,Lc);w(this,Sl,new Float32Array(4));w(this,Io);w(this,$h);w(this,gi);w(this,Yh);w(this,Re);C(this,Re,e),C(this,gi,n),C(this,Lc,o),C(this,Yh,r),C(this,Io,u),C(this,$h,c),this.lastPoint=[NaN,NaN],R(this,Xm,BM).call(this,c);const[f,h,y,A]=g(this,Sl);for(let S=0,E=e.length;S<E;S+=2)e[S]=(e[S]-f)/y,e[S+1]=(e[S+1]-h)/A;for(let S=0,E=n.length;S<E;S+=2)n[S]=(n[S]-f)/y,n[S+1]=(n[S+1]-h)/A}toSVGPath(){const e=[`M${g(this,Re)[4]} ${g(this,Re)[5]}`];for(let n=6,o=g(this,Re).length;n<o;n+=6){if(isNaN(g(this,Re)[n])){e.push(`L${g(this,Re)[n+4]} ${g(this,Re)[n+5]}`);continue}e.push(`C${g(this,Re)[n]} ${g(this,Re)[n+1]} ${g(this,Re)[n+2]} ${g(this,Re)[n+3]} ${g(this,Re)[n+4]} ${g(this,Re)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,o,r],u){const c=o-e,f=r-n;let h,y;switch(u){case 0:h=ft._rescale(g(this,Re),e,r,c,-f),y=ft._rescale(g(this,gi),e,r,c,-f);break;case 90:h=ft._rescaleAndSwap(g(this,Re),e,n,c,f),y=ft._rescaleAndSwap(g(this,gi),e,n,c,f);break;case 180:h=ft._rescale(g(this,Re),o,n,-c,f),y=ft._rescale(g(this,gi),o,n,-c,f);break;case 270:h=ft._rescaleAndSwap(g(this,Re),o,r,-c,-f),y=ft._rescaleAndSwap(g(this,gi),o,r,-c,-f);break}return{outline:Array.from(h),points:[Array.from(y)]}}get box(){return g(this,Sl)}newOutliner(e,n,o,r,u,c=0){return new wm(e,n,o,r,u,c)}getNewOutline(e,n){const[o,r,u,c]=g(this,Sl),[f,h,y,A]=g(this,Lc),S=u*y,E=c*A,b=o*y+f,x=r*A+h,D=this.newOutliner({x:g(this,gi)[0]*S+b,y:g(this,gi)[1]*E+x},g(this,Lc),g(this,Yh),e,g(this,$h),n??g(this,Io));for(let N=2;N<g(this,gi).length;N+=2)D.add({x:g(this,gi)[N]*S+b,y:g(this,gi)[N+1]*E+x});return D.getOutlines()}}Lc=new WeakMap,Sl=new WeakMap,Io=new WeakMap,$h=new WeakMap,gi=new WeakMap,Yh=new WeakMap,Re=new WeakMap,Xm=new WeakSet,BM=function(e){const n=g(this,Re);let o=n[4],r=n[5];const u=[o,r,o,r];let c=o,f=r;const h=e?Math.max:Math.min;for(let A=6,S=n.length;A<S;A+=6){const E=n[A+4],b=n[A+5];if(isNaN(n[A]))Ct.pointBoundingBox(E,b,u),f<b?(c=E,f=b):f===b&&(c=h(c,E));else{const x=[1/0,1/0,-1/0,-1/0];Ct.bezierBoundingBox(o,r,...n.slice(A,A+6),x),Ct.rectBoundingBox(...x,u),f<x[3]?(c=x[2],f=x[3]):f===x[3]&&(c=h(c,x[2]))}o=E,r=b}const y=g(this,Sl);y[0]=u[0]-g(this,Io),y[1]=u[1]-g(this,Io),y[2]=u[2]-u[0]+2*g(this,Io),y[3]=u[3]-u[1]+2*g(this,Io),this.lastPoint=[c,f]};var Xh,Jh,za,as,Vn,GM,um,VM,HM,HA;class VA{constructor(t,e=0,n=0,o=!0){w(this,Vn);w(this,Xh);w(this,Jh);w(this,za,[]);w(this,as,[]);const r=[1/0,1/0,-1/0,-1/0],u=10**-4;for(const{x:E,y:b,width:x,height:D}of t){const N=Math.floor((E-e)/u)*u,L=Math.ceil((E+x+e)/u)*u,P=Math.floor((b-e)/u)*u,U=Math.ceil((b+D+e)/u)*u,k=[N,P,U,!0],F=[L,P,U,!1];g(this,za).push(k,F),Ct.rectBoundingBox(N,P,L,U,r)}const c=r[2]-r[0]+2*n,f=r[3]-r[1]+2*n,h=r[0]-n,y=r[1]-n,A=g(this,za).at(o?-1:-2),S=[A[0],A[2]];for(const E of g(this,za)){const[b,x,D]=E;E[0]=(b-h)/c,E[1]=(x-y)/f,E[2]=(D-y)/f}C(this,Xh,new Float32Array([h,y,c,f])),C(this,Jh,S)}getOutlines(){g(this,za).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of g(this,za))e[3]?(t.push(...R(this,Vn,HA).call(this,e)),R(this,Vn,VM).call(this,e)):(R(this,Vn,HM).call(this,e),t.push(...R(this,Vn,HA).call(this,e)));return R(this,Vn,GM).call(this,t)}}Xh=new WeakMap,Jh=new WeakMap,za=new WeakMap,as=new WeakMap,Vn=new WeakSet,GM=function(t){const e=[],n=new Set;for(const u of t){const[c,f,h]=u;e.push([c,f,u],[c,h,u])}e.sort((u,c)=>u[1]-c[1]||u[0]-c[0]);for(let u=0,c=e.length;u<c;u+=2){const f=e[u][2],h=e[u+1][2];f.push(h),h.push(f),n.add(f),n.add(h)}const o=[];let r;for(;n.size>0;){const u=n.values().next().value;let[c,f,h,y,A]=u;n.delete(u);let S=c,E=f;for(r=[c,h],o.push(r);;){let b;if(n.has(y))b=y;else if(n.has(A))b=A;else break;n.delete(b),[c,f,h,y,A]=b,S!==c&&(r.push(S,E,c,E===f?f:h),S=c),E=E===f?h:f}r.push(S,E)}return new Q3(o,g(this,Xh),g(this,Jh))},um=function(t){const e=g(this,as);let n=0,o=e.length-1;for(;n<=o;){const r=n+o>>1,u=e[r][0];if(u===t)return r;u<t?n=r+1:o=r-1}return o+1},VM=function([,t,e]){const n=R(this,Vn,um).call(this,t);g(this,as).splice(n,0,[t,e])},HM=function([,t,e]){const n=R(this,Vn,um).call(this,t);for(let o=n;o<g(this,as).length;o++){const[r,u]=g(this,as)[o];if(r!==t)break;if(r===t&&u===e){g(this,as).splice(o,1);return}}for(let o=n-1;o>=0;o--){const[r,u]=g(this,as)[o];if(r!==t)break;if(r===t&&u===e){g(this,as).splice(o,1);return}}},HA=function(t){const[e,n,o]=t,r=[[e,n,o]],u=R(this,Vn,um).call(this,o);for(let c=0;c<u;c++){const[f,h]=g(this,as)[c];for(let y=0,A=r.length;y<A;y++){const[,S,E]=r[y];if(!(h<=S||E<=f)){if(S>=f){if(E>h)r[y][1]=h;else{if(A===1)return[];r.splice(y,1),y--,A--}continue}r[y][2]=f,E>h&&r.push([e,h,E])}}}return r};var Kh,kc;class Q3 extends ft{constructor(e,n,o){super();w(this,Kh);w(this,kc);C(this,kc,e),C(this,Kh,n),this.lastPoint=o}toSVGPath(){const e=[];for(const n of g(this,kc)){let[o,r]=n;e.push(`M${o} ${r}`);for(let u=2;u<n.length;u+=2){const c=n[u],f=n[u+1];c===o?(e.push(`V${f}`),r=f):f===r&&(e.push(`H${c}`),o=c)}e.push("Z")}return e.join(" ")}serialize([e,n,o,r],u){const c=[],f=o-e,h=r-n;for(const y of g(this,kc)){const A=new Array(y.length);for(let S=0;S<y.length;S+=2)A[S]=e+y[S]*f,A[S+1]=r-y[S+1]*h;c.push(A)}return c}get box(){return g(this,Kh)}get classNamesForOutlining(){return["highlightOutline"]}}Kh=new WeakMap,kc=new WeakMap;class zA extends wm{newFreeDrawOutline(t,e,n,o,r,u){return new Z3(t,e,n,o,r,u)}}class Z3 extends OM{newOutliner(t,e,n,o,r,u=0){return new zA(t,e,n,o,r,u)}}var mi,El,Uc,qe,Wh,Fc,Po,Qh,qa,rs,Oc,Zh,oe,qA,$A,YA,Mr,zM,ya;const Kn=class Kn{constructor({editor:t=null,uiManager:e=null}){w(this,oe);w(this,mi,null);w(this,El,null);w(this,Uc);w(this,qe,null);w(this,Wh,!1);w(this,Fc,!1);w(this,Po,null);w(this,Qh);w(this,qa,null);w(this,rs,null);w(this,Oc);var n,o;t?(C(this,Fc,!1),C(this,Oc,Vt.HIGHLIGHT_COLOR),C(this,Po,t)):(C(this,Fc,!0),C(this,Oc,Vt.HIGHLIGHT_DEFAULT_COLOR)),C(this,rs,(t==null?void 0:t._uiManager)||e),C(this,Qh,g(this,rs)._eventBus),C(this,Uc,((n=t==null?void 0:t.color)==null?void 0:n.toUpperCase())||((o=g(this,rs))==null?void 0:o.highlightColors.values().next().value)||"#FFFF98"),g(Kn,Zh)||C(Kn,Zh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Gt(this,"_keyboardManager",new dp([[["Escape","mac+Escape"],Kn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Kn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Kn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Kn.prototype._moveToPrevious],[["Home","mac+Home"],Kn.prototype._moveToBeginning],[["End","mac+End"],Kn.prototype._moveToEnd]]))}renderButton(){const t=C(this,mi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",g(this,Po)&&(t.ariaControls=`${g(this,Po).id}_colorpicker_dropdown`);const e=g(this,rs)._signal;t.addEventListener("click",R(this,oe,Mr).bind(this),{signal:e}),t.addEventListener("keydown",R(this,oe,YA).bind(this),{signal:e});const n=C(this,El,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=g(this,Uc),t.append(n),t}renderMainDropdown(){const t=C(this,qe,R(this,oe,qA).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===g(this,mi)){R(this,oe,Mr).call(this,t);return}const e=t.target.getAttribute("data-color");e&&R(this,oe,$A).call(this,e,t)}_moveToNext(t){var e,n;if(!g(this,oe,ya)){R(this,oe,Mr).call(this,t);return}if(t.target===g(this,mi)){(e=g(this,qe).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=g(this,qe))==null?void 0:e.firstChild)||t.target===g(this,mi)){g(this,oe,ya)&&this._hideDropdownFromKeyboard();return}g(this,oe,ya)||R(this,oe,Mr).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!g(this,oe,ya)){R(this,oe,Mr).call(this,t);return}(e=g(this,qe).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!g(this,oe,ya)){R(this,oe,Mr).call(this,t);return}(e=g(this,qe).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=g(this,qe))==null||t.classList.add("hidden"),g(this,mi).ariaExpanded="false",(e=g(this,qa))==null||e.abort(),C(this,qa,null)}_hideDropdownFromKeyboard(){var t;if(!g(this,Fc)){if(!g(this,oe,ya)){(t=g(this,Po))==null||t.unselect();return}this.hideDropdown(),g(this,mi).focus({preventScroll:!0,focusVisible:g(this,Wh)})}}updateColor(t){if(g(this,El)&&(g(this,El).style.backgroundColor=t),!g(this,qe))return;const e=g(this,rs).highlightColors.values();for(const n of g(this,qe).children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=g(this,mi))==null||t.remove(),C(this,mi,null),C(this,El,null),(e=g(this,qe))==null||e.remove(),C(this,qe,null)}};mi=new WeakMap,El=new WeakMap,Uc=new WeakMap,qe=new WeakMap,Wh=new WeakMap,Fc=new WeakMap,Po=new WeakMap,Qh=new WeakMap,qa=new WeakMap,rs=new WeakMap,Oc=new WeakMap,Zh=new WeakMap,oe=new WeakSet,qA=function(){const t=document.createElement("div"),e=g(this,rs)._signal;t.addEventListener("contextmenu",fs,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),g(this,Po)&&(t.id=`${g(this,Po).id}_colorpicker_dropdown`);for(const[n,o]of g(this,rs).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",o),r.title=n,r.setAttribute("data-l10n-id",g(Kn,Zh)[n]);const u=document.createElement("span");r.append(u),u.className="swatch",u.style.backgroundColor=o,r.ariaSelected=o===g(this,Uc),r.addEventListener("click",R(this,oe,$A).bind(this,o),{signal:e}),t.append(r)}return t.addEventListener("keydown",R(this,oe,YA).bind(this),{signal:e}),t},$A=function(t,e){e.stopPropagation(),g(this,Qh).dispatch("switchannotationeditorparams",{source:this,type:g(this,Oc),value:t})},YA=function(t){Kn._keyboardManager.exec(this,t)},Mr=function(t){if(g(this,oe,ya)){this.hideDropdown();return}if(C(this,Wh,t.detail===0),g(this,qa)||(C(this,qa,new AbortController),window.addEventListener("pointerdown",R(this,oe,zM).bind(this),{signal:g(this,rs).combinedSignal(g(this,qa))})),g(this,mi).ariaExpanded="true",g(this,qe)){g(this,qe).classList.remove("hidden");return}const e=C(this,qe,R(this,oe,qA).call(this));g(this,mi).append(e)},zM=function(t){var e;(e=g(this,qe))!=null&&e.contains(t.target)||this.hideDropdown()},ya=function(){return g(this,qe)&&!g(this,qe).classList.contains("hidden")},w(Kn,Zh,null);let Mm=Kn;var Bc,jh,Lo,Cl,tp,Zn,ep,np,bl,Hi,yi,dn,Gc,ko,Cn,Vc,zi,ip,Dt,XA,cm,qM,$M,YM,JA,Rr,$i,Ou,XM,dm,bf,JM,KM,WM,QM,ZM;const Kt=class Kt extends fe{constructor(e){super({...e,name:"highlightEditor"});w(this,Dt);w(this,Bc,null);w(this,jh,0);w(this,Lo);w(this,Cl,null);w(this,tp,null);w(this,Zn,null);w(this,ep,null);w(this,np,0);w(this,bl,null);w(this,Hi,null);w(this,yi,null);w(this,dn,!1);w(this,Gc,null);w(this,ko);w(this,Cn,null);w(this,Vc,"");w(this,zi);w(this,ip,"");this.color=e.color||Kt._defaultColor,C(this,zi,e.thickness||Kt._defaultThickness),C(this,ko,e.opacity||Kt._defaultOpacity),C(this,Lo,e.boxes||null),C(this,ip,e.methodOfCreation||""),C(this,Vc,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(C(this,dn,!0),R(this,Dt,cm).call(this,e),R(this,Dt,Rr).call(this)):g(this,Lo)&&(C(this,Bc,e.anchorNode),C(this,jh,e.anchorOffset),C(this,ep,e.focusNode),C(this,np,e.focusOffset),R(this,Dt,XA).call(this),R(this,Dt,Rr).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=Kt.prototype;return Gt(this,"_keyboardManager",new dp([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,dn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:g(this,zi),methodOfCreation:g(this,ip)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var o;fe.initialize(e,n),Kt._defaultColor||(Kt._defaultColor=((o=n.highlightColors)==null?void 0:o.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Vt.HIGHLIGHT_DEFAULT_COLOR:Kt._defaultColor=n;break;case Vt.HIGHLIGHT_THICKNESS:Kt._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return g(this,Gc)}updateParams(e,n){switch(e){case Vt.HIGHLIGHT_COLOR:R(this,Dt,qM).call(this,n);break;case Vt.HIGHLIGHT_THICKNESS:R(this,Dt,$M).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Vt.HIGHLIGHT_DEFAULT_COLOR,Kt._defaultColor],[Vt.HIGHLIGHT_THICKNESS,Kt._defaultThickness]]}get propertiesToUpdate(){return[[Vt.HIGHLIGHT_COLOR,this.color||Kt._defaultColor],[Vt.HIGHLIGHT_THICKNESS,g(this,zi)||Kt._defaultThickness],[Vt.HIGHLIGHT_FREE,g(this,dn)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",C(this,tp,new Mm({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(R(this,Dt,bf).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,R(this,Dt,bf).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){R(this,Dt,JA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,Dt,Rr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var o;let n=!1;this.parent&&!e?R(this,Dt,JA).call(this):e&&(R(this,Dt,Rr).call(this,e),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var r,u,c;const{drawLayer:n}=this.parent;let o;g(this,dn)?(e=(e-this.rotation+360)%360,o=R(r=Kt,$i,Ou).call(r,g(this,Hi).box,e)):o=R(u=Kt,$i,Ou).call(u,[this.x,this.y,this.width,this.height],e),n.updateProperties(g(this,yi),{bbox:o,root:{"data-main-rotation":e}}),n.updateProperties(g(this,Cn),{bbox:R(c=Kt,$i,Ou).call(c,g(this,Zn).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();g(this,Vc)&&(e.setAttribute("aria-label",g(this,Vc)),e.setAttribute("role","mark")),g(this,dn)?e.classList.add("free"):this.div.addEventListener("keydown",R(this,Dt,XM).bind(this),{signal:this._uiManager._signal});const n=C(this,bl,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=g(this,Cl);const[o,r]=this.parentDimensions;return this.setDims(this.width*o,this.height*r),yw(this,g(this,bl),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,Cn),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,Cn),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:R(this,Dt,dm).call(this,!0);break;case 1:case 3:R(this,Dt,dm).call(this,!1);break}}select(){var e;super.select(),g(this,Cn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,Cn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),g(this,Cn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,Cn),{rootClass:{selected:!1}}),g(this,dn)||R(this,Dt,dm).call(this,!1))}get _mustFixPosition(){return!g(this,dn)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(g(this,yi),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(g(this,Cn),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:o,x:r,y:u}){const{x:c,y:f,width:h,height:y}=o.getBoundingClientRect(),A=new AbortController,S=e.combinedSignal(A),E=b=>{A.abort(),R(this,$i,QM).call(this,e,b)};window.addEventListener("blur",E,{signal:S}),window.addEventListener("pointerup",E,{signal:S}),window.addEventListener("pointerdown",ke,{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",fs,{signal:S}),o.addEventListener("pointermove",R(this,$i,WM).bind(this,e),{signal:S}),this._freeHighlight=new zA({x:r,y:u},[c,f,h,y],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,o){var x,D,N,L;let r=null;if(e instanceof xM){const{data:{quadPoints:P,rect:U,rotation:k,id:F,color:B,opacity:q,popupRef:Y},parent:{page:{pageNumber:Q}}}=e;r=e={annotationType:Mt.HIGHLIGHT,color:Array.from(B),opacity:q,quadPoints:P,boxes:null,pageIndex:Q-1,rect:U.slice(0),rotation:k,annotationElementId:F,id:F,deleted:!1,popupRef:Y}}else if(e instanceof MT){const{data:{inkLists:P,rect:U,rotation:k,id:F,color:B,borderStyle:{rawWidth:q},popupRef:Y},parent:{page:{pageNumber:Q}}}=e;r=e={annotationType:Mt.HIGHLIGHT,color:Array.from(B),thickness:q,inkLists:P,boxes:null,pageIndex:Q-1,rect:U.slice(0),rotation:k,annotationElementId:F,id:F,deleted:!1,popupRef:Y}}const{color:u,quadPoints:c,inkLists:f,opacity:h}=e,y=await super.deserialize(e,n,o);y.color=Ct.makeHexColor(...u),C(y,ko,h||1),f&&C(y,zi,e.thickness),y._initialData=r;const[A,S]=y.pageDimensions,[E,b]=y.pageTranslation;if(c){const P=C(y,Lo,[]);for(let U=0;U<c.length;U+=8)P.push({x:(c[U]-E)/A,y:1-(c[U+1]-b)/S,width:(c[U+2]-c[U])/A,height:(c[U+1]-c[U+5])/S});R(x=y,Dt,XA).call(x),R(D=y,Dt,Rr).call(D),y.rotate(y.rotation)}else if(f){C(y,dn,!0);const P=f[0],U={x:P[0]-E,y:S-(P[1]-b)},k=new zA(U,[0,0,A,S],1,g(y,zi)/2,!0,.001);for(let q=0,Y=P.length;q<Y;q+=2)U.x=P[q]-E,U.y=S-(P[q+1]-b),k.add(U);const{id:F,clipPathId:B}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:y.color,"fill-opacity":y._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);R(N=y,Dt,cm).call(N,{highlightOutlines:k.getOutlines(),highlightId:F,clipPathId:B}),R(L=y,Dt,Rr).call(L),y.rotate(y.parentRotation)}return y}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),o=fe._colorManager.convert(this.color),r={annotationType:Mt.HIGHLIGHT,color:o,opacity:g(this,ko),thickness:g(this,zi),quadPoints:R(this,Dt,JM).call(this),outlines:R(this,Dt,KM).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:R(this,Dt,bf).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!R(this,Dt,ZM).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Bc=new WeakMap,jh=new WeakMap,Lo=new WeakMap,Cl=new WeakMap,tp=new WeakMap,Zn=new WeakMap,ep=new WeakMap,np=new WeakMap,bl=new WeakMap,Hi=new WeakMap,yi=new WeakMap,dn=new WeakMap,Gc=new WeakMap,ko=new WeakMap,Cn=new WeakMap,Vc=new WeakMap,zi=new WeakMap,ip=new WeakMap,Dt=new WeakSet,XA=function(){const e=new VA(g(this,Lo),.001);C(this,Hi,e.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,Hi).box;const n=new VA(g(this,Lo),.0025,.001,this._uiManager.direction==="ltr");C(this,Zn,n.getOutlines());const{lastPoint:o}=g(this,Zn);C(this,Gc,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},cm=function({highlightOutlines:e,highlightId:n,clipPathId:o}){var A,S;if(C(this,Hi,e),C(this,Zn,e.getNewOutline(g(this,zi)/2+1.5,.0025)),n>=0)C(this,yi,n),C(this,Cl,o),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),C(this,Cn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,Zn).box,path:{d:g(this,Zn).toSVGPath()}},!0));else if(this.parent){const E=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,yi),{bbox:R(A=Kt,$i,Ou).call(A,g(this,Hi).box,(E-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,Cn),{bbox:R(S=Kt,$i,Ou).call(S,g(this,Zn).box,E),path:{d:g(this,Zn).toSVGPath()}})}const[u,c,f,h]=e.box;switch(this.rotation){case 0:this.x=u,this.y=c,this.width=f,this.height=h;break;case 90:{const[E,b]=this.parentDimensions;this.x=c,this.y=1-u,this.width=f*b/E,this.height=h*E/b;break}case 180:this.x=1-u,this.y=1-c,this.width=f,this.height=h;break;case 270:{const[E,b]=this.parentDimensions;this.x=1-c,this.y=u,this.width=f*b/E,this.height=h*E/b;break}}const{lastPoint:y}=g(this,Zn);C(this,Gc,[(y[0]-u)/f,(y[1]-c)/h])},qM=function(e){const n=(u,c)=>{var f,h;this.color=u,C(this,ko,c),(f=this.parent)==null||f.drawLayer.updateProperties(g(this,yi),{root:{fill:u,"fill-opacity":c}}),(h=g(this,tp))==null||h.updateColor(u)},o=this.color,r=g(this,ko);this.addCommands({cmd:n.bind(this,e,Kt._defaultOpacity),undo:n.bind(this,o,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},$M=function(e){const n=g(this,zi),o=r=>{C(this,zi,r),R(this,Dt,YM).call(this,r)};this.addCommands({cmd:o.bind(this,e),undo:o.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},YM=function(e){if(!g(this,dn))return;R(this,Dt,cm).call(this,{highlightOutlines:g(this,Hi).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)},JA=function(){g(this,yi)===null||!this.parent||(this.parent.drawLayer.remove(g(this,yi)),C(this,yi,null),this.parent.drawLayer.remove(g(this,Cn)),C(this,Cn,null))},Rr=function(e=this.parent){g(this,yi)===null&&({id:Rn(this,yi)._,clipPathId:Rn(this,Cl)._}=e.drawLayer.draw({bbox:g(this,Hi).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":g(this,ko)},rootClass:{highlight:!0,free:g(this,dn)},path:{d:g(this,Hi).toSVGPath()}},!1,!0),C(this,Cn,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,dn)},bbox:g(this,Zn).box,path:{d:g(this,Zn).toSVGPath()}},g(this,dn))),g(this,bl)&&(g(this,bl).style.clipPath=g(this,Cl)))},$i=new WeakSet,Ou=function([e,n,o,r],u){switch(u){case 90:return[1-n-r,e,r,o];case 180:return[1-e-o,1-n-r,o,r];case 270:return[n,1-e-o,r,o]}return[e,n,o,r]},XM=function(e){Kt._keyboardManager.exec(this,e)},dm=function(e){if(!g(this,Bc))return;const n=window.getSelection();e?n.setPosition(g(this,Bc),g(this,jh)):n.setPosition(g(this,ep),g(this,np))},bf=function(){return g(this,dn)?this.rotation:0},JM=function(){if(g(this,dn))return null;const[e,n]=this.pageDimensions,[o,r]=this.pageTranslation,u=g(this,Lo),c=new Float32Array(u.length*8);let f=0;for(const{x:h,y,width:A,height:S}of u){const E=h*e+o,b=(1-y)*n+r;c[f]=c[f+4]=E,c[f+1]=c[f+3]=b,c[f+2]=c[f+6]=E+A*e,c[f+5]=c[f+7]=b-S*n,f+=8}return c},KM=function(e){return g(this,Hi).serialize(e,R(this,Dt,bf).call(this))},WM=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},QM=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},ZM=function(e){const{color:n}=this._initialData;return e.color.some((o,r)=>o!==n[r])},w(Kt,$i),ot(Kt,"_defaultColor",null),ot(Kt,"_defaultOpacity",1),ot(Kt,"_defaultThickness",12),ot(Kt,"_type","highlight"),ot(Kt,"_editorType",Mt.HIGHLIGHT),ot(Kt,"_freeHighlightId",-1),ot(Kt,"_freeHighlight",null),ot(Kt,"_freeHighlightClipId","");let Rm=Kt;var xl;class jM{constructor(){w(this,xl,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){g(this,xl)[t]=e}toSVGProperties(){const t=g(this,xl);return C(this,xl,Object.create(null)),{root:t}}reset(){C(this,xl,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){ae("Not implemented")}}xl=new WeakMap;var vi,Hc,Ze,_l,wl,$a,Ya,Xa,Ml,qt,KA,WA,QA,xf,tR,fm,_f,Bu;const ht=class ht extends fe{constructor(e){super(e);w(this,qt);w(this,vi,null);w(this,Hc);ot(this,"_drawId",null);C(this,Hc,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(R(this,qt,KA).call(this,e),R(this,qt,xf).call(this))}static _mergeSVGProperties(e,n){const o=new Set(Object.keys(e));for(const[r,u]of Object.entries(n))o.has(r)?Object.assign(e[r],u):e[r]=u;return e}static getDefaultDrawingOptions(e){ae("Not implemented")}static get typesMap(){ae("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const o=this.typesMap.get(e);o&&this._defaultDrawingOptions.updateProperty(o,n),this._currentParent&&(g(ht,Ze).updateProperty(o,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const o=this.constructor.typesMap.get(e);o&&this._updateProperty(e,o,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[o,r]of this.typesMap)e.push([o,n[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[o,r]of this.constructor.typesMap)e.push([o,n[r]]);return e}_updateProperty(e,n,o){const r=this._drawingOptions,u=r[n],c=f=>{var y;r.updateProperty(n,f);const h=g(this,vi).updateProperty(n,f);h&&R(this,qt,_f).call(this,h),(y=this.parent)==null||y.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:c.bind(this,o),undo:c.bind(this,u),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(g(this,vi).getPathResizingSVGProperties(R(this,qt,fm).call(this)),{bbox:R(this,qt,Bu).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(g(this,vi).getPathResizedSVGProperties(R(this,qt,fm).call(this)),{bbox:R(this,qt,Bu).call(this)}))}_onTranslating(e,n){var o;(o=this.parent)==null||o.drawLayer.updateProperties(this._drawId,{bbox:R(this,qt,Bu).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(g(this,vi).getPathTranslatedSVGProperties(R(this,qt,fm).call(this),this.parentDimensions),{bbox:R(this,qt,Bu).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,Hc)&&(C(this,Hc,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){R(this,qt,QA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,qt,xf).call(this),R(this,qt,_f).call(this,g(this,vi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var o;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),R(this,qt,QA).call(this)):e&&(this._uiManager.addShouldRescale(this),R(this,qt,xf).call(this,e),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties({bbox:R(this,qt,Bu).call(this)},g(this,vi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&R(this,qt,_f).call(this,g(this,vi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,n;this._isCopy&&(e=this.x,n=this.y);const o=super.render();o.classList.add("draw");const r=document.createElement("div");o.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[u,c]=this.parentDimensions;return this.setDims(this.width*u,this.height*c),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,n),o}static createDrawerInstance(e,n,o,r,u){ae("Not implemented")}static startDrawing(e,n,o,r){var D;const{target:u,offsetX:c,offsetY:f,pointerId:h,pointerType:y}=r;if(g(ht,Ya)&&g(ht,Ya)!==y)return;const{viewport:{rotation:A}}=e,{width:S,height:E}=u.getBoundingClientRect(),b=C(ht,_l,new AbortController),x=e.combinedSignal(b);if(g(ht,$a)||C(ht,$a,h),g(ht,Ya)??C(ht,Ya,y),window.addEventListener("pointerup",N=>{var L;g(ht,$a)===N.pointerId?this._endDraw(N):(L=g(ht,Xa))==null||L.delete(N.pointerId)},{signal:x}),window.addEventListener("pointercancel",N=>{var L;g(ht,$a)===N.pointerId?this._currentParent.endDrawingSession():(L=g(ht,Xa))==null||L.delete(N.pointerId)},{signal:x}),window.addEventListener("pointerdown",N=>{g(ht,Ya)===N.pointerType&&((g(ht,Xa)||C(ht,Xa,new Set)).add(N.pointerId),g(ht,Ze).isCancellable()&&(g(ht,Ze).removeLastElement(),g(ht,Ze).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",fs,{signal:x}),u.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),u.addEventListener("touchmove",N=>{N.timeStamp===g(ht,Ml)&&ke(N)},{signal:x}),e.toggleDrawing(),(D=n._editorUndoBar)==null||D.hide(),g(ht,Ze)){e.drawLayer.updateProperties(this._currentDrawId,g(ht,Ze).startNew(c,f,S,E,A));return}n.updateUIForDefaultProperties(this),C(ht,Ze,this.createDrawerInstance(c,f,S,E,A)),C(ht,wl,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(g(ht,wl).toSVGProperties(),g(ht,Ze).defaultSVGProperties),!0,!1)}static _drawMove(e){var u;if(C(ht,Ml,-1),!g(ht,Ze))return;const{offsetX:n,offsetY:o,pointerId:r}=e;if(g(ht,$a)===r){if(((u=g(ht,Xa))==null?void 0:u.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(ht,Ze).add(n,o)),C(ht,Ml,e.timeStamp),ke(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,C(ht,Ze,null),C(ht,wl,null),C(ht,Ya,null),C(ht,Ml,NaN)),g(ht,_l)&&(g(ht,_l).abort(),C(ht,_l,null),C(ht,$a,NaN),C(ht,Xa,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,g(ht,Ze).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const o=g(ht,Ze),r=this._currentDrawId,u=o.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(r,o.setLastElement(u))},undo:()=>{n.drawLayer.updateProperties(r,o.removeLastElement())},mustExec:!1,type:Vt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Vt.DRAW_STEP),!g(ht,Ze).isEmpty()){const{pageDimensions:[o,r],scale:u}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(ht,Ze).getOutlines(o*u,r*u,u,this._INNER_MARGIN),drawingOptions:g(ht,wl),mustBeCommitted:!e});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,o,r,u,c){ae("Not implemented")}static async deserialize(e,n,o){var A,S;const{rawDims:{pageWidth:r,pageHeight:u,pageX:c,pageY:f}}=n.viewport,h=this.deserializeDraw(c,f,r,u,this._INNER_MARGIN,e),y=await super.deserialize(e,n,o);return y.createDrawingOptions(e),R(A=y,qt,KA).call(A,{drawOutlines:h}),R(S=y,qt,xf).call(S),y.onScaleChanging(),y.rotate(),y}serializeDraw(e){const[n,o]=this.pageTranslation,[r,u]=this.pageDimensions;return g(this,vi).serialize([n,o,r,u],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};vi=new WeakMap,Hc=new WeakMap,Ze=new WeakMap,_l=new WeakMap,wl=new WeakMap,$a=new WeakMap,Ya=new WeakMap,Xa=new WeakMap,Ml=new WeakMap,qt=new WeakSet,KA=function({drawOutlines:e,drawId:n,drawingOptions:o}){C(this,vi,e),this._drawingOptions||(this._drawingOptions=o),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=R(this,qt,WA).call(this,e,this.parent),R(this,qt,_f).call(this,e.box)},WA=function(e,n){const{id:o}=n.drawLayer.draw(ht._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return o},QA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},xf=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=R(this,qt,WA).call(this,g(this,vi),e)}},tR=function([e,n,o,r]){const{parentDimensions:[u,c],rotation:f}=this;switch(f){case 90:return[n,1-e,o*(c/u),r*(u/c)];case 180:return[1-e,1-n,o,r];case 270:return[1-n,e,o*(c/u),r*(u/c)];default:return[e,n,o,r]}},fm=function(){const{x:e,y:n,width:o,height:r,parentDimensions:[u,c],rotation:f}=this;switch(f){case 90:return[1-n,e,o*(u/c),r*(c/u)];case 180:return[1-e,1-n,o,r];case 270:return[n,1-e,o*(u/c),r*(c/u)];default:return[e,n,o,r]}},_f=function(e){if([this.x,this.y,this.width,this.height]=R(this,qt,tR).call(this,e),this.div){this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)}this._onResized()},Bu=function(){const{x:e,y:n,width:o,height:r,rotation:u,parentRotation:c,parentDimensions:[f,h]}=this;switch((u*4+c)/90){case 1:return[1-n-r,e,r,o];case 2:return[1-e-o,1-n-r,o,r];case 3:return[n,1-e-o,r,o];case 4:return[e,n-o*(f/h),r*(h/f),o*(f/h)];case 5:return[1-n,e,o*(f/h),r*(h/f)];case 6:return[1-e-r*(h/f),1-n,r*(h/f),o*(f/h)];case 7:return[n-o*(f/h),1-e-r*(h/f),o*(f/h),r*(h/f)];case 8:return[e-o,n-r,o,r];case 9:return[1-n,e-o,r,o];case 10:return[1-e,1-n,o,r];case 11:return[n-r,1-e,r,o];case 12:return[e-r*(h/f),n,r*(h/f),o*(f/h)];case 13:return[1-n-o*(f/h),e-r*(h/f),o*(f/h),r*(h/f)];case 14:return[1-e,1-n-o*(f/h),r*(h/f),o*(f/h)];case 15:return[n,1-e,o*(f/h),r*(h/f)];default:return[e,n,o,r]}},ot(ht,"_currentDrawId",-1),ot(ht,"_currentParent",null),w(ht,Ze,null),w(ht,_l,null),w(ht,wl,null),w(ht,$a,NaN),w(ht,Ya,null),w(ht,Xa,null),w(ht,Ml,NaN),ot(ht,"_INNER_MARGIN",3);let Nm=ht;var Ps,je,tn,Rl,zc,In,fn,qi,Nl,Dl,Il,qc,hm;class j3{constructor(t,e,n,o,r,u){w(this,qc);w(this,Ps,new Float64Array(6));w(this,je);w(this,tn);w(this,Rl);w(this,zc);w(this,In);w(this,fn,"");w(this,qi,0);w(this,Nl,new hp);w(this,Dl);w(this,Il);C(this,Dl,n),C(this,Il,o),C(this,Rl,r),C(this,zc,u),[t,e]=R(this,qc,hm).call(this,t,e);const c=C(this,je,[NaN,NaN,NaN,NaN,t,e]);C(this,In,[t,e]),C(this,tn,[{line:c,points:g(this,In)}]),g(this,Ps).set(c,0)}updateProperty(t,e){t==="stroke-width"&&C(this,zc,e)}isEmpty(){return!g(this,tn)||g(this,tn).length===0}isCancellable(){return g(this,In).length<=10}add(t,e){[t,e]=R(this,qc,hm).call(this,t,e);const[n,o,r,u]=g(this,Ps).subarray(2,6),c=t-r,f=e-u;return Math.hypot(g(this,Dl)*c,g(this,Il)*f)<=2?null:(g(this,In).push(t,e),isNaN(n)?(g(this,Ps).set([r,u,t,e],2),g(this,je).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(g(this,Ps)[0])&&g(this,je).splice(6,6),g(this,Ps).set([n,o,r,u,t,e],0),g(this,je).push(...ft.createBezierPoints(n,o,r,u,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(g(this,In).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,o,r){C(this,Dl,n),C(this,Il,o),C(this,Rl,r),[t,e]=R(this,qc,hm).call(this,t,e);const u=C(this,je,[NaN,NaN,NaN,NaN,t,e]);C(this,In,[t,e]);const c=g(this,tn).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),g(this,tn).push({line:u,points:g(this,In)}),g(this,Ps).set(u,0),C(this,qi,0),this.toSVGPath(),null}getLastElement(){return g(this,tn).at(-1)}setLastElement(t){return g(this,tn)?(g(this,tn).push(t),C(this,je,t.line),C(this,In,t.points),C(this,qi,0),{path:{d:this.toSVGPath()}}):g(this,Nl).setLastElement(t)}removeLastElement(){if(!g(this,tn))return g(this,Nl).removeLastElement();g(this,tn).pop(),C(this,fn,"");for(let t=0,e=g(this,tn).length;t<e;t++){const{line:n,points:o}=g(this,tn)[t];C(this,je,n),C(this,In,o),C(this,qi,0),this.toSVGPath()}return{path:{d:g(this,fn)}}}toSVGPath(){const t=ft.svgRound(g(this,je)[4]),e=ft.svgRound(g(this,je)[5]);if(g(this,In).length===2)return C(this,fn,`${g(this,fn)} M ${t} ${e} Z`),g(this,fn);if(g(this,In).length<=6){const o=g(this,fn).lastIndexOf("M");C(this,fn,`${g(this,fn).slice(0,o)} M ${t} ${e}`),C(this,qi,6)}if(g(this,In).length===4){const o=ft.svgRound(g(this,je)[10]),r=ft.svgRound(g(this,je)[11]);return C(this,fn,`${g(this,fn)} L ${o} ${r}`),C(this,qi,12),g(this,fn)}const n=[];g(this,qi)===0&&(n.push(`M ${t} ${e}`),C(this,qi,6));for(let o=g(this,qi),r=g(this,je).length;o<r;o+=6){const[u,c,f,h,y,A]=g(this,je).slice(o,o+6).map(ft.svgRound);n.push(`C${u} ${c} ${f} ${h} ${y} ${A}`)}return C(this,fn,g(this,fn)+n.join(" ")),C(this,qi,g(this,je).length),g(this,fn)}getOutlines(t,e,n,o){const r=g(this,tn).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),g(this,Nl).build(g(this,tn),t,e,n,g(this,Rl),g(this,zc),o),C(this,Ps,null),C(this,je,null),C(this,tn,null),C(this,fn,null),g(this,Nl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ps=new WeakMap,je=new WeakMap,tn=new WeakMap,Rl=new WeakMap,zc=new WeakMap,In=new WeakMap,fn=new WeakMap,qi=new WeakMap,Nl=new WeakMap,Dl=new WeakMap,Il=new WeakMap,qc=new WeakSet,hm=function(t,e){return ft._normalizePoint(t,e,g(this,Dl),g(this,Il),g(this,Rl))};var Pn,sp,op,Ai,Ls,ks,$c,Yc,Pl,pn,ro,eR,nR,iR;class hp extends ft{constructor(){super(...arguments);w(this,pn);w(this,Pn);w(this,sp,0);w(this,op);w(this,Ai);w(this,Ls);w(this,ks);w(this,$c);w(this,Yc);w(this,Pl)}build(e,n,o,r,u,c,f){C(this,Ls,n),C(this,ks,o),C(this,$c,r),C(this,Yc,u),C(this,Pl,c),C(this,op,f??0),C(this,Ai,e),R(this,pn,nR).call(this)}get thickness(){return g(this,Pl)}setLastElement(e){return g(this,Ai).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,Ai).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of g(this,Ai)){if(e.push(`M${ft.svgRound(n[4])} ${ft.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12&&isNaN(n[6])){e.push(`L${ft.svgRound(n[10])} ${ft.svgRound(n[11])}`);continue}for(let o=6,r=n.length;o<r;o+=6){const[u,c,f,h,y,A]=n.subarray(o,o+6).map(ft.svgRound);e.push(`C${u} ${c} ${f} ${h} ${y} ${A}`)}}return e.join("")}serialize([e,n,o,r],u){const c=[],f=[],[h,y,A,S]=R(this,pn,eR).call(this);let E,b,x,D,N,L,P,U,k;switch(g(this,Yc)){case 0:k=ft._rescale,E=e,b=n+r,x=o,D=-r,N=e+h*o,L=n+(1-y-S)*r,P=e+(h+A)*o,U=n+(1-y)*r;break;case 90:k=ft._rescaleAndSwap,E=e,b=n,x=o,D=r,N=e+y*o,L=n+h*r,P=e+(y+S)*o,U=n+(h+A)*r;break;case 180:k=ft._rescale,E=e+o,b=n,x=-o,D=r,N=e+(1-h-A)*o,L=n+y*r,P=e+(1-h)*o,U=n+(y+S)*r;break;case 270:k=ft._rescaleAndSwap,E=e+o,b=n+r,x=-o,D=-r,N=e+(1-y-S)*o,L=n+(1-h-A)*r,P=e+(1-y)*o,U=n+(1-h)*r;break}for(const{line:F,points:B}of g(this,Ai))c.push(k(F,E,b,x,D,u?new Array(F.length):null)),f.push(k(B,E,b,x,D,u?new Array(B.length):null));return{lines:c,points:f,rect:[N,L,P,U]}}static deserialize(e,n,o,r,u,{paths:{lines:c,points:f},rotation:h,thickness:y}){const A=[];let S,E,b,x,D;switch(h){case 0:D=ft._rescale,S=-e/o,E=n/r+1,b=1/o,x=-1/r;break;case 90:D=ft._rescaleAndSwap,S=-n/r,E=-e/o,b=1/r,x=1/o;break;case 180:D=ft._rescale,S=e/o+1,E=-n/r,b=-1/o,x=1/r;break;case 270:D=ft._rescaleAndSwap,S=n/r+1,E=e/o+1,b=-1/r,x=-1/o;break}if(!c){c=[];for(const L of f){const P=L.length;if(P===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,L[0],L[1]]));continue}if(P===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,L[0],L[1],NaN,NaN,NaN,NaN,L[2],L[3]]));continue}const U=new Float32Array(3*(P-2));c.push(U);let[k,F,B,q]=L.subarray(0,4);U.set([NaN,NaN,NaN,NaN,k,F],0);for(let Y=4;Y<P;Y+=2){const Q=L[Y],Z=L[Y+1];U.set(ft.createBezierPoints(k,F,B,q,Q,Z),(Y-2)*3),[k,F,B,q]=[B,q,Q,Z]}}}for(let L=0,P=c.length;L<P;L++)A.push({line:D(c[L].map(U=>U??NaN),S,E,b,x),points:D(f[L].map(U=>U??NaN),S,E,b,x)});const N=new this.prototype.constructor;return N.build(A,o,r,1,h,y,u),N}get box(){return g(this,Pn)}updateProperty(e,n){return e==="stroke-width"?R(this,pn,iR).call(this,n):null}updateParentDimensions([e,n],o){const[r,u]=R(this,pn,ro).call(this);C(this,Ls,e),C(this,ks,n),C(this,$c,o);const[c,f]=R(this,pn,ro).call(this),h=c-r,y=f-u,A=g(this,Pn);return A[0]-=h,A[1]-=y,A[2]+=2*h,A[3]+=2*y,A}updateRotation(e){return C(this,sp,e),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,Pn).map(ft.svgRound).join(" ")}get defaultProperties(){const[e,n]=g(this,Pn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=g(this,Pn);let o=0,r=0,u=0,c=0,f=0,h=0;switch(g(this,sp)){case 90:r=n/e,u=-e/n,f=e;break;case 180:o=-1,c=-1,f=e,h=n;break;case 270:r=-n/e,u=e/n,h=n;break;default:return""}return`matrix(${o} ${r} ${u} ${c} ${ft.svgRound(f)} ${ft.svgRound(h)})`}getPathResizingSVGProperties([e,n,o,r]){const[u,c]=R(this,pn,ro).call(this),[f,h,y,A]=g(this,Pn);if(Math.abs(y-u)<=ft.PRECISION||Math.abs(A-c)<=ft.PRECISION){const D=e+o/2-(f+y/2),N=n+r/2-(h+A/2);return{path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:`${this.rotationTransform} translate(${D} ${N})`}}}const S=(o-2*u)/(y-2*u),E=(r-2*c)/(A-2*c),b=y/o,x=A/r;return{path:{"transform-origin":`${ft.svgRound(f)} ${ft.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${x}) translate(${ft.svgRound(u)} ${ft.svgRound(c)}) scale(${S} ${E}) translate(${ft.svgRound(-u)} ${ft.svgRound(-c)})`}}}getPathResizedSVGProperties([e,n,o,r]){const[u,c]=R(this,pn,ro).call(this),f=g(this,Pn),[h,y,A,S]=f;if(f[0]=e,f[1]=n,f[2]=o,f[3]=r,Math.abs(A-u)<=ft.PRECISION||Math.abs(S-c)<=ft.PRECISION){const N=e+o/2-(h+A/2),L=n+r/2-(y+S/2);for(const{line:P,points:U}of g(this,Ai))ft._translate(P,N,L,P),ft._translate(U,N,L,U);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const E=(o-2*u)/(A-2*u),b=(r-2*c)/(S-2*c),x=-E*(h+u)+e+u,D=-b*(y+c)+n+c;if(E!==1||b!==1||x!==0||D!==0)for(const{line:N,points:L}of g(this,Ai))ft._rescale(N,x,D,E,b,N),ft._rescale(L,x,D,E,b,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],o){const[r,u]=o,c=g(this,Pn),f=e-c[0],h=n-c[1];if(g(this,Ls)===r&&g(this,ks)===u)for(const{line:y,points:A}of g(this,Ai))ft._translate(y,f,h,y),ft._translate(A,f,h,A);else{const y=g(this,Ls)/r,A=g(this,ks)/u;C(this,Ls,r),C(this,ks,u);for(const{line:S,points:E}of g(this,Ai))ft._rescale(S,f,h,y,A,S),ft._rescale(E,f,h,y,A,E);c[2]*=y,c[3]*=A}return c[0]=e,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`}}}get defaultSVGProperties(){const e=g(this,Pn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(e[0])} ${ft.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}Pn=new WeakMap,sp=new WeakMap,op=new WeakMap,Ai=new WeakMap,Ls=new WeakMap,ks=new WeakMap,$c=new WeakMap,Yc=new WeakMap,Pl=new WeakMap,pn=new WeakSet,ro=function(e=g(this,Pl)){const n=g(this,op)+e/2*g(this,$c);return g(this,Yc)%180===0?[n/g(this,Ls),n/g(this,ks)]:[n/g(this,ks),n/g(this,Ls)]},eR=function(){const[e,n,o,r]=g(this,Pn),[u,c]=R(this,pn,ro).call(this,0);return[e+u,n+c,o-2*u,r-2*c]},nR=function(){const e=C(this,Pn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of g(this,Ai)){if(r.length<=12){for(let f=4,h=r.length;f<h;f+=6)Ct.pointBoundingBox(r[f],r[f+1],e);continue}let u=r[4],c=r[5];for(let f=6,h=r.length;f<h;f+=6){const[y,A,S,E,b,x]=r.subarray(f,f+6);Ct.bezierBoundingBox(u,c,y,A,S,E,b,x,e),u=b,c=x}}const[n,o]=R(this,pn,ro).call(this);e[0]=Un(e[0]-n,0,1),e[1]=Un(e[1]-o,0,1),e[2]=Un(e[2]+n,0,1),e[3]=Un(e[3]+o,0,1),e[2]-=e[0],e[3]-=e[1]},iR=function(e){const[n,o]=R(this,pn,ro).call(this);C(this,Pl,e);const[r,u]=R(this,pn,ro).call(this),[c,f]=[r-n,u-o],h=g(this,Pn);return h[0]-=c,h[1]-=f,h[2]+=2*c,h[3]+=2*f,h};class sy extends jM{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:fe._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new sy(this._viewParameters);return t.updateAll(this),t}}var Jm,sR;const zu=class zu extends Nm{constructor(e){super({...e,name:"inkEditor"});w(this,Jm);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,n){fe.initialize(e,n),this._defaultDrawingOptions=new sy(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Gt(this,"typesMap",new Map([[Vt.INK_THICKNESS,"stroke-width"],[Vt.INK_COLOR,"stroke"],[Vt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,o,r,u){return new j3(e,n,o,r,u,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,o,r,u,c){return hp.deserialize(e,n,o,r,u,c)}static async deserialize(e,n,o){let r=null;if(e instanceof MT){const{data:{inkLists:c,rect:f,rotation:h,id:y,color:A,opacity:S,borderStyle:{rawWidth:E},popupRef:b},parent:{page:{pageNumber:x}}}=e;r=e={annotationType:Mt.INK,color:Array.from(A),thickness:E,opacity:S,paths:{points:c},boxes:null,pageIndex:x-1,rect:f.slice(0),rotation:h,annotationElementId:y,id:y,deleted:!1,popupRef:b}}const u=await super.deserialize(e,n,o);return u._initialData=r,u}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:o}=this;n.updateSVGProperty("stroke-width"),o.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:o}){this._drawingOptions=zu.getDefaultDrawingOptions({stroke:Ct.makeHexColor(...e),"stroke-width":n,"stroke-opacity":o})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:o,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:u,"stroke-opacity":c,"stroke-width":f}}=this,h={annotationType:Mt.INK,color:fe._colorManager.convert(u),opacity:c,thickness:f,paths:{lines:n,points:o},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!R(this,Jm,sR).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){const{points:n,rect:o}=this.serializeDraw(!1);return e.updateEdited({rect:o,thickness:this._drawingOptions["stroke-width"],points:n}),null}};Jm=new WeakSet,sR=function(e){const{color:n,thickness:o,opacity:r,pageIndex:u}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,f)=>c!==n[f])||e.thickness!==o||e.opacity!==r||e.pageIndex!==u},ot(zu,"_type","ink"),ot(zu,"_editorType",Mt.INK),ot(zu,"_defaultDrawingOptions",null);let ZA=zu;class jA extends hp{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Bg=8,uf=3;var Ll,Wt,tT,ls,oR,aR,eT,pm,rR,lR,uR,nT,iT,cR;class Vo{static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:o},r,u,c,f){let h=new OffscreenCanvas(1,1),y=h.getContext("2d",{alpha:!1});const A=200,S=y.font=`${n} ${o} ${A}px ${e}`,{actualBoundingBoxLeft:E,actualBoundingBoxRight:b,actualBoundingBoxAscent:x,actualBoundingBoxDescent:D,fontBoundingBoxAscent:N,fontBoundingBoxDescent:L,width:P}=y.measureText(t),U=1.5,k=Math.ceil(Math.max(Math.abs(E)+Math.abs(b)||0,P)*U),F=Math.ceil(Math.max(Math.abs(x)+Math.abs(D)||A,Math.abs(N)+Math.abs(L)||A)*U);h=new OffscreenCanvas(k,F),y=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),y.font=S,y.filter="grayscale(1)",y.fillStyle="white",y.fillRect(0,0,k,F),y.fillStyle="black",y.fillText(t,k*(U-1)/2,F*(3-U)/2);const B=R(this,Wt,nT).call(this,y.getImageData(0,0,k,F).data),q=R(this,Wt,uR).call(this,B),Y=R(this,Wt,iT).call(this,q),Q=R(this,Wt,eT).call(this,B,k,F,Y);return this.processDrawnLines({lines:{curves:Q,width:k,height:F},pageWidth:r,pageHeight:u,rotation:c,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(t,e,n,o,r){const[u,c,f]=R(this,Wt,cR).call(this,t),[h,y]=R(this,Wt,lR).call(this,u,c,f,Math.hypot(c,f)*g(this,Ll).sigmaSFactor,g(this,Ll).sigmaR,g(this,Ll).kernelSize),A=R(this,Wt,iT).call(this,y),S=R(this,Wt,eT).call(this,h,c,f,A);return this.processDrawnLines({lines:{curves:S,width:c,height:f},pageWidth:e,pageHeight:n,rotation:o,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:o,innerMargin:r,mustSmooth:u,areContours:c}){o%180!==0&&([e,n]=[n,e]);const{curves:f,width:h,height:y}=t,A=t.thickness??0,S=[],E=Math.min(e/h,n/y),b=E/e,x=E/n,D=[];for(const{points:L}of f){const P=u?R(this,Wt,rR).call(this,L):L;if(!P)continue;D.push(P);const U=P.length,k=new Float32Array(U),F=new Float32Array(3*(U===2?2:U-2));if(S.push({line:F,points:k}),U===2){k[0]=P[0]*b,k[1]=P[1]*x,F.set([NaN,NaN,NaN,NaN,k[0],k[1]],0);continue}let[B,q,Y,Q]=P;B*=b,q*=x,Y*=b,Q*=x,k.set([B,q,Y,Q],0),F.set([NaN,NaN,NaN,NaN,B,q],0);for(let Z=4;Z<U;Z+=2){const ut=k[Z]=P[Z]*b,St=k[Z+1]=P[Z+1]*x;F.set(ft.createBezierPoints(B,q,Y,Q,ut,St),(Z-2)*3),[B,q,Y,Q]=[Y,Q,ut,St]}}if(S.length===0)return null;const N=c?new jA:new hp;return N.build(S,e,n,1,o,c?0:A,r),{outline:N,newCurves:D,areContours:c,thickness:A,width:h,height:y}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:o,height:r}){let u=1/0,c=-1/0,f=0;for(const P of t){f+=P.length;for(let U=2,k=P.length;U<k;U++){const F=P[U]-P[U-2];u=Math.min(u,F),c=Math.max(c,F)}}let h;u>=-128&&c<=127?h=Int8Array:u>=-32768&&c<=32767?h=Int16Array:h=Int32Array;const y=t.length,A=Bg+uf*y,S=new Uint32Array(A);let E=0;S[E++]=A*Uint32Array.BYTES_PER_ELEMENT+(f-2*y)*h.BYTES_PER_ELEMENT,S[E++]=0,S[E++]=o,S[E++]=r,S[E++]=e?0:1,S[E++]=Math.max(0,Math.floor(n??0)),S[E++]=y,S[E++]=h.BYTES_PER_ELEMENT;for(const P of t)S[E++]=P.length-2,S[E++]=P[0],S[E++]=P[1];const b=new CompressionStream("deflate-raw"),x=b.writable.getWriter();await x.ready,x.write(S);const D=h.prototype.constructor;for(const P of t){const U=new D(P.length-2);for(let k=2,F=P.length;k<F;k++)U[k-2]=P[k]-P[k-2];x.write(U)}x.close();const N=await new Response(b.readable).arrayBuffer(),L=new Uint8Array(N);return cw(L)}static async decompressSignature(t){try{const e=CB(t),{readable:n,writable:o}=new DecompressionStream("deflate-raw"),r=o.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let u=null,c=0;for await(const P of n)u||(u=new Uint8Array(new Uint32Array(P.buffer,0,4)[0])),u.set(P,c),c+=P.length;const f=new Uint32Array(u.buffer,0,u.length>>2),h=f[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const y=f[2],A=f[3],S=f[4]===0,E=f[5],b=f[6],x=f[7],D=[],N=(Bg+uf*b)*Uint32Array.BYTES_PER_ELEMENT;let L;switch(x){case Int8Array.BYTES_PER_ELEMENT:L=new Int8Array(u.buffer,N);break;case Int16Array.BYTES_PER_ELEMENT:L=new Int16Array(u.buffer,N);break;case Int32Array.BYTES_PER_ELEMENT:L=new Int32Array(u.buffer,N);break}c=0;for(let P=0;P<b;P++){const U=f[uf*P+Bg],k=new Float32Array(U+2);D.push(k);for(let F=0;F<uf-1;F++)k[F]=f[uf*P+Bg+F+1];for(let F=0;F<U;F++)k[F+2]=k[F]+L[c++]}return{areContours:S,thickness:E,outlines:D,width:y,height:A}}catch(e){return Rt(`decompressSignature: ${e}`),null}}}Ll=new WeakMap,Wt=new WeakSet,tT=function(t,e,n,o){return n-=t,o-=e,n===0?o>0?0:4:n===1?o+6:2-o},ls=new WeakMap,oR=function(t,e,n,o,r,u,c){const f=R(this,Wt,tT).call(this,n,o,r,u);for(let h=0;h<8;h++){const y=(-h+f-c+16)%8,A=g(this,ls)[2*y],S=g(this,ls)[2*y+1];if(t[(n+A)*e+(o+S)]!==0)return y}return-1},aR=function(t,e,n,o,r,u,c){const f=R(this,Wt,tT).call(this,n,o,r,u);for(let h=0;h<8;h++){const y=(h+f+c+16)%8,A=g(this,ls)[2*y],S=g(this,ls)[2*y+1];if(t[(n+A)*e+(o+S)]!==0)return y}return-1},eT=function(t,e,n,o){const r=t.length,u=new Int32Array(r);for(let y=0;y<r;y++)u[y]=t[y]<=o?1:0;for(let y=1;y<n-1;y++)u[y*e]=u[y*e+e-1]=0;for(let y=0;y<e;y++)u[y]=u[e*n-1-y]=0;let c=1,f;const h=[];for(let y=1;y<n-1;y++){f=1;for(let A=1;A<e-1;A++){const S=y*e+A,E=u[S];if(E===0)continue;let b=y,x=A;if(E===1&&u[S-1]===0)c+=1,x-=1;else if(E>=1&&u[S+1]===0)c+=1,x+=1,E>1&&(f=E);else{E!==1&&(f=Math.abs(E));continue}const D=[A,y],N=x===A+1,L={isHole:N,points:D,id:c,parent:0};h.push(L);let P;for(const Z of h)if(Z.id===f){P=Z;break}P?P.isHole?L.parent=N?P.parent:f:L.parent=N?f:P.parent:L.parent=N?f:0;const U=R(this,Wt,oR).call(this,u,e,y,A,b,x,0);if(U===-1){u[S]=-c,u[S]!==1&&(f=Math.abs(u[S]));continue}let k=g(this,ls)[2*U],F=g(this,ls)[2*U+1];const B=y+k,q=A+F;b=B,x=q;let Y=y,Q=A;for(;;){const Z=R(this,Wt,aR).call(this,u,e,Y,Q,b,x,1);k=g(this,ls)[2*Z],F=g(this,ls)[2*Z+1];const ut=Y+k,St=Q+F;D.push(St,ut);const gt=Y*e+Q;if(u[gt+1]===0?u[gt]=-c:u[gt]===1&&(u[gt]=c),ut===y&&St===A&&Y===B&&Q===q){u[S]!==1&&(f=Math.abs(u[S]));break}else b=Y,x=Q,Y=ut,Q=St}}}return h},pm=function(t,e,n,o){if(n-e<=4){for(let B=e;B<n-2;B+=2)o.push(t[B],t[B+1]);return}const r=t[e],u=t[e+1],c=t[n-4]-r,f=t[n-3]-u,h=Math.hypot(c,f),y=c/h,A=f/h,S=y*u-A*r,E=f/c,b=1/h,x=Math.atan(E),D=Math.cos(x),N=Math.sin(x),L=b*(Math.abs(D)+Math.abs(N)),P=b*(1-L+L**2),U=Math.max(Math.atan(Math.abs(N+D)*P),Math.atan(Math.abs(N-D)*P));let k=0,F=e;for(let B=e+2;B<n-2;B+=2){const q=Math.abs(S-y*t[B+1]+A*t[B]);q>k&&(F=B,k=q)}k>(h*U)**2?(R(this,Wt,pm).call(this,t,e,F+2,o),R(this,Wt,pm).call(this,t,F,n,o)):o.push(r,u)},rR=function(t){const e=[],n=t.length;return R(this,Wt,pm).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e},lR=function(t,e,n,o,r,u){const c=new Float32Array(u**2),f=-2*o**2,h=u>>1;for(let x=0;x<u;x++){const D=(x-h)**2;for(let N=0;N<u;N++)c[x*u+N]=Math.exp((D+(N-h)**2)/f)}const y=new Float32Array(256),A=-2*r**2;for(let x=0;x<256;x++)y[x]=Math.exp(x**2/A);const S=t.length,E=new Uint8Array(S),b=new Uint32Array(256);for(let x=0;x<n;x++)for(let D=0;D<e;D++){const N=x*e+D,L=t[N];let P=0,U=0;for(let F=0;F<u;F++){const B=x+F-h;if(!(B<0||B>=n))for(let q=0;q<u;q++){const Y=D+q-h;if(Y<0||Y>=e)continue;const Q=t[B*e+Y],Z=c[F*u+q]*y[Math.abs(Q-L)];P+=Q*Z,U+=Z}}const k=E[N]=Math.round(P/U);b[k]++}return[E,b]},uR=function(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e},nT=function(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let o=-1/0,r=1/0;for(let c=0,f=n.length;c<f;c++){if(t[(c<<2)+3]===0){o=n[c]=255;continue}const y=n[c]=t[c<<2];y>o&&(o=y),y<r&&(r=y)}const u=255/(o-r);for(let c=0;c<e;c++)n[c]=(n[c]-r)*u;return n},iT=function(t){let e,n=-1/0,o=-1/0;const r=t.findIndex(f=>f!==0);let u=r,c=r;for(e=r;e<256;e++){const f=t[e];f>n&&(e-u>o&&(o=e-u,c=e-1),n=f,u=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e},cR=function(t){const e=t,{width:n,height:o}=t,{maxDim:r}=g(this,Ll);let u=n,c=o;if(n>r||o>r){let S=n,E=o,b=Math.log2(Math.max(n,o)/r);const x=Math.floor(b);b=b===x?x-1:x;for(let N=0;N<b;N++){u=Math.ceil(S/2),c=Math.ceil(E/2);const L=new OffscreenCanvas(u,c);L.getContext("2d").drawImage(t,0,0,S,E,0,0,u,c),S=u,E=c,t!==e&&t.close(),t=L.transferToImageBitmap()}const D=Math.min(r/u,r/c);u=Math.round(u*D),c=Math.round(c*D)}const h=new OffscreenCanvas(u,c).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(t,0,0,t.width,t.height,0,0,u,c);const y=h.getImageData(0,0,u,c).data;return[R(this,Wt,nT).call(this,y),u,c]},w(Vo,Wt),w(Vo,Ll,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),w(Vo,ls,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class RT extends jM{constructor(){super(),super.updateProperties({fill:fe._defaultLineColor,"stroke-width":0})}clone(){const t=new RT;return t.updateAll(this),t}}class NT extends sy{constructor(t){super(t),super.updateProperties({stroke:fe._defaultLineColor,"stroke-width":1})}clone(){const t=new NT(this._viewParameters);return t.updateAll(this),t}}var Ja,Us,Ka,kl;const ri=class ri extends Nm{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});w(this,Ja,!1);w(this,Us,null);w(this,Ka,null);w(this,kl,null);this._willKeepAspectRatio=!0,C(this,Ka,e.signatureData||null),C(this,Us,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,n){fe.initialize(e,n),this._defaultDrawingOptions=new RT,this._defaultDrawnSignatureOptions=new NT(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Gt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!g(this,Us)}}static computeTelemetryFinalData(e){const n=e.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,n;const{_isCopy:o}=this;if(o&&(this._isCopy=!1,e=this.x,n=this.y),super.render(),this._drawId===null)if(g(this,Ka)){const{lines:r,mustSmooth:u,areContours:c,description:f,uuid:h,heightInPage:y}=g(this,Ka),{rawDims:{pageWidth:A,pageHeight:S},rotation:E}=this.parent.viewport,b=Vo.processDrawnLines({lines:r,pageWidth:A,pageHeight:S,rotation:E,innerMargin:ri._INNER_MARGIN,mustSmooth:u,areContours:c});this.addSignature(b,y,f,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return o&&(this._isCopy=!0,this._moveAfterPaste(e,n)),this.div}setUuid(e){C(this,kl,e),this.addEditToolbar()}getUuid(){return g(this,kl)}get description(){return g(this,Us)}set description(e){C(this,Us,e),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:n,thickness:o,width:r,height:u}=g(this,Ka),c=Math.max(r,u),f=Vo.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:o,width:r,height:u},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:f.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,n,o,r){const{x:u,y:c}=this,{outline:f}=C(this,Ka,e);C(this,Ja,f instanceof jA),this.description=o,this.div.setAttribute("data-l10n-args",JSON.stringify({description:o}));let h;g(this,Ja)?h=ri.getDefaultDrawingOptions():(h=ri._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":f.thickness})),this._addOutlines({drawOutlines:f,drawingOptions:h});const[y,A]=this.parentDimensions,[,S]=this.pageDimensions;let E=n/S;E=E>=1?.5:E,this.width*=E/this.height,this.width>=1&&(E*=.9/this.width,this.width=.9),this.height=E,this.setDims(y*this.width,A*this.height),this.x=u,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!o}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:n,pageHeight:o},rotation:r}=this.parent.viewport;return Vo.process(e,n,o,r,ri._INNER_MARGIN)}getFromText(e,n){const{rawDims:{pageWidth:o,pageHeight:r},rotation:u}=this.parent.viewport;return Vo.extractContoursFromText(e,n,o,r,u,ri._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:n,pageHeight:o},rotation:r}=this.parent.viewport;return Vo.processDrawnLines({lines:e,pageWidth:n,pageHeight:o,rotation:r,innerMargin:ri._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:n}){e?this._drawingOptions=ri.getDefaultDrawingOptions():(this._drawingOptions=ri._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:n,points:o,rect:r}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":u}}=this,c={annotationType:Mt.SIGNATURE,isSignature:!0,areContours:g(this,Ja),color:[0,0,0],thickness:g(this,Ja)?0:u,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(c.paths={lines:n,points:o},c.uuid=g(this,kl),c.isCopy=!0):c.lines=n,g(this,Us)&&(c.accessibilityData={type:"Figure",alt:g(this,Us)}),c}static deserializeDraw(e,n,o,r,u,c){return c.areContours?jA.deserialize(e,n,o,r,u,c):hp.deserialize(e,n,o,r,u,c)}static async deserialize(e,n,o){var u;const r=await super.deserialize(e,n,o);return C(r,Ja,e.areContours),C(r,Us,((u=e.accessibilityData)==null?void 0:u.alt)||""),C(r,kl,e.uuid),r}};Ja=new WeakMap,Us=new WeakMap,Ka=new WeakMap,kl=new WeakMap,ot(ri,"_type","signature"),ot(ri,"_editorType",Mt.SIGNATURE),ot(ri,"_defaultDrawingOptions",null);let sT=ri;var ye,en,Wa,Uo,Qa,Xc,Fo,Ul,Fs,Ti,Jc,$t,wf,Mf,gm,mm,ym,aT,vm,dR;class oT extends fe{constructor(e){super({...e,name:"stampEditor"});w(this,$t);w(this,ye,null);w(this,en,null);w(this,Wa,null);w(this,Uo,null);w(this,Qa,null);w(this,Xc,"");w(this,Fo,null);w(this,Ul,!1);w(this,Fs,null);w(this,Ti,!1);w(this,Jc,!1);C(this,Uo,e.bitmapUrl),C(this,Qa,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,n){fe.initialize(e,n)}static isHandlingMimeForPasting(e){return Z0.includes(e)}static paste(e,n){n.pasteEditor({mode:Mt.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:o}=this._uiManager;if(!o)throw new Error("No ML.");if(!await o.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:u,height:c}=e||this.copyCanvas(null,null,!0).imageData,f=await o.guess({name:"altText",request:{data:r,width:u,height:c,channels:r.length/(u*c)}});if(!f)throw new Error("No response from the AI service.");if(f.error)throw new Error("Error from the AI service.");if(f.cancel)return null;if(!f.output)throw new Error("No valid response from the AI service.");const h=f.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var e;g(this,en)&&(C(this,ye,null),this._uiManager.imageManager.deleteId(g(this,en)),(e=g(this,Fo))==null||e.remove(),C(this,Fo,null),g(this,Fs)&&(clearTimeout(g(this,Fs)),C(this,Fs,null))),super.remove()}rebuild(){if(!this.parent){g(this,en)&&R(this,$t,gm).call(this);return}super.rebuild(),this.div!==null&&(g(this,en)&&g(this,Fo)===null&&R(this,$t,gm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(g(this,Wa)||g(this,ye)||g(this,Uo)||g(this,Qa)||g(this,en)||g(this,Ul))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;return this._isCopy&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),g(this,Ul)||(g(this,ye)?R(this,$t,mm).call(this):R(this,$t,gm).call(this)),this._isCopy&&this._moveAfterPaste(e,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,n){const{id:o,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,n);n.remove(),o&&this._uiManager.imageManager.isValidId(o)&&(C(this,en,o),r&&C(this,ye,r),C(this,Ul,!1),R(this,$t,mm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,Fs)!==null&&clearTimeout(g(this,Fs)),C(this,Fs,setTimeout(()=>{C(this,Fs,null),R(this,$t,aT).call(this)},200))}copyCanvas(e,n,o=!1){var E;e||(e=224);const{width:r,height:u}=g(this,ye),c=new Vs;let f=g(this,ye),h=r,y=u,A=null;if(n){if(r>n||u>n){const q=Math.min(n/r,n/u);h=Math.floor(r*q),y=Math.floor(u*q)}A=document.createElement("canvas");const b=A.width=Math.ceil(h*c.sx),x=A.height=Math.ceil(y*c.sy);g(this,Ti)||(f=R(this,$t,ym).call(this,b,x));const D=A.getContext("2d");D.filter=this._uiManager.hcmFilter;let N="white",L="#cfcfd8";this._uiManager.hcmFilter!=="none"?L="black":(E=window.matchMedia)!=null&&E.call(window,"(prefers-color-scheme: dark)").matches&&(N="#8f8f9d",L="#42414d");const P=15,U=P*c.sx,k=P*c.sy,F=new OffscreenCanvas(U*2,k*2),B=F.getContext("2d");B.fillStyle=N,B.fillRect(0,0,U*2,k*2),B.fillStyle=L,B.fillRect(0,0,U,k),B.fillRect(U,k,U,k),D.fillStyle=D.createPattern(F,"repeat"),D.fillRect(0,0,b,x),D.drawImage(f,0,0,f.width,f.height,0,0,b,x)}let S=null;if(o){let b,x;if(c.symmetric&&f.width<e&&f.height<e)b=f.width,x=f.height;else if(f=g(this,ye),r>e||u>e){const L=Math.min(e/r,e/u);b=Math.floor(r*L),x=Math.floor(u*L),g(this,Ti)||(f=R(this,$t,ym).call(this,b,x))}const N=new OffscreenCanvas(b,x).getContext("2d",{willReadFrequently:!0});N.drawImage(f,0,0,f.width,f.height,0,0,b,x),S={width:b,height:x,data:N.getImageData(0,0,b,x).data}}return{canvas:A,width:h,height:y,imageData:S}}static async deserialize(e,n,o){var D;let r=null,u=!1;if(e instanceof _M){const{data:{rect:N,rotation:L,id:P,structParent:U,popupRef:k},container:F,parent:{page:{pageNumber:B}},canvas:q}=e;let Y,Q;q?(delete e.canvas,{id:Y,bitmap:Q}=o.imageManager.getFromCanvas(F.id,q),q.remove()):(u=!0,e._hasNoCanvas=!0);const Z=((D=await n._structTree.getAriaAttributes(`${TT}${P}`))==null?void 0:D.get("aria-label"))||"";r=e={annotationType:Mt.STAMP,bitmapId:Y,bitmap:Q,pageIndex:B-1,rect:N.slice(0),rotation:L,annotationElementId:P,id:P,deleted:!1,accessibilityData:{decorative:!1,altText:Z},isSvg:!1,structParent:U,popupRef:k}}const c=await super.deserialize(e,n,o),{rect:f,bitmap:h,bitmapUrl:y,bitmapId:A,isSvg:S,accessibilityData:E}=e;u?(o.addMissingCanvas(e.id,c),C(c,Ul,!0)):A&&o.imageManager.isValidId(A)?(C(c,en,A),h&&C(c,ye,h)):C(c,Uo,y),C(c,Ti,S);const[b,x]=c.pageDimensions;return c.width=(f[2]-f[0])/b,c.height=(f[3]-f[1])/x,E&&(c.altTextData=E),c._initialData=r,C(c,Jc,!!r),c}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const o={annotationType:Mt.STAMP,bitmapId:g(this,en),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:g(this,Ti),structTreeParentId:this._structTreeParentId};if(e)return o.bitmapUrl=R(this,$t,vm).call(this,!0),o.accessibilityData=this.serializeAltText(!0),o.isCopy=!0,o;const{decorative:r,altText:u}=this.serializeAltText(!1);if(!r&&u&&(o.accessibilityData={type:"Figure",alt:u}),this.annotationElementId){const f=R(this,$t,dR).call(this,o);if(f.isSame)return null;f.isSameAltText?delete o.accessibilityData:o.accessibilityData.structParent=this._initialData.structParent??-1}if(o.id=this.annotationElementId,n===null)return o;n.stamps||(n.stamps=new Map);const c=g(this,Ti)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!n.stamps.has(g(this,en)))n.stamps.set(g(this,en),{area:c,serialized:o}),o.bitmap=R(this,$t,vm).call(this,!1);else if(g(this,Ti)){const f=n.stamps.get(g(this,en));c>f.area&&(f.area=c,f.serialized.bitmap.close(),f.serialized.bitmap=R(this,$t,vm).call(this,!1))}return o}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}ye=new WeakMap,en=new WeakMap,Wa=new WeakMap,Uo=new WeakMap,Qa=new WeakMap,Xc=new WeakMap,Fo=new WeakMap,Ul=new WeakMap,Fs=new WeakMap,Ti=new WeakMap,Jc=new WeakMap,$t=new WeakSet,wf=function(e,n=!1){if(!e){this.remove();return}C(this,ye,e.bitmap),n||(C(this,en,e.id),C(this,Ti,e.isSvg)),e.file&&C(this,Xc,e.file.name),R(this,$t,mm).call(this)},Mf=function(){if(C(this,Wa,null),this._uiManager.enableWaiting(!1),!!g(this,Fo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,ye)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,ye)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},gm=function(){if(g(this,en)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,en)).then(o=>R(this,$t,wf).call(this,o,!0)).finally(()=>R(this,$t,Mf).call(this));return}if(g(this,Uo)){const o=g(this,Uo);C(this,Uo,null),this._uiManager.enableWaiting(!0),C(this,Wa,this._uiManager.imageManager.getFromUrl(o).then(r=>R(this,$t,wf).call(this,r)).finally(()=>R(this,$t,Mf).call(this)));return}if(g(this,Qa)){const o=g(this,Qa);C(this,Qa,null),this._uiManager.enableWaiting(!0),C(this,Wa,this._uiManager.imageManager.getFromFile(o).then(r=>R(this,$t,wf).call(this,r)).finally(()=>R(this,$t,Mf).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Z0.join(",");const n=this._uiManager._signal;C(this,Wa,new Promise(o=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),R(this,$t,wf).call(this,r)}o()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),o()},{signal:n})}).finally(()=>R(this,$t,Mf).call(this))),e.click()},mm=function(){var A;const{div:e}=this;let{width:n,height:o}=g(this,ye);const[r,u]=this.pageDimensions,c=.75;if(this.width)n=this.width*r,o=this.height*u;else if(n>c*r||o>c*u){const S=Math.min(c*r/n,c*u/o);n*=S,o*=S}const[f,h]=this.parentDimensions;this.setDims(n*f/r,o*h/u),this._uiManager.enableWaiting(!1);const y=C(this,Fo,document.createElement("canvas"));y.setAttribute("role","img"),this.addContainer(y),this.width=n/r,this.height=o/u,(A=this._initialOptions)!=null&&A.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),R(this,$t,aT).call(this),g(this,Jc)||(this.parent.addUndoableEditor(this),C(this,Jc,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,Xc)&&this.div.setAttribute("aria-description",g(this,Xc)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},ym=function(e,n){const{width:o,height:r}=g(this,ye);let u=o,c=r,f=g(this,ye);for(;u>2*e||c>2*n;){const h=u,y=c;u>2*e&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const A=new OffscreenCanvas(u,c);A.getContext("2d").drawImage(f,0,0,h,y,0,0,u,c),f=A.transferToImageBitmap()}return f},aT=function(){const[e,n]=this.parentDimensions,{width:o,height:r}=this,u=new Vs,c=Math.ceil(o*e*u.sx),f=Math.ceil(r*n*u.sy),h=g(this,Fo);if(!h||h.width===c&&h.height===f)return;h.width=c,h.height=f;const y=g(this,Ti)?g(this,ye):R(this,$t,ym).call(this,c,f),A=h.getContext("2d");A.filter=this._uiManager.hcmFilter,A.drawImage(y,0,0,y.width,y.height,0,0,c,f)},vm=function(e){if(e){if(g(this,Ti)){const r=this._uiManager.imageManager.getSvgUrl(g(this,en));if(r)return r}const n=document.createElement("canvas");return{width:n.width,height:n.height}=g(this,ye),n.getContext("2d").drawImage(g(this,ye),0,0),n.toDataURL()}if(g(this,Ti)){const[n,o]=this.pageDimensions,r=Math.round(this.width*n*ir.PDF_TO_CSS_UNITS),u=Math.round(this.height*o*ir.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,u);return c.getContext("2d").drawImage(g(this,ye),0,0,g(this,ye).width,g(this,ye).height,0,0,r,u),c.transferToImageBitmap()}return structuredClone(g(this,ye))},dR=function(e){var c;const{pageIndex:n,accessibilityData:{altText:o}}=this._initialData,r=e.pageIndex===n,u=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===o;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&u,isSameAltText:u}},ot(oT,"_type","stamp"),ot(oT,"_editorType",Mt.STAMP);var Fl,Kc,Os,Za,Oo,Si,ja,Wc,Ol,us,Bo,nn,Go,tr,Qc,mt,er,ve,fR,Ss,lT,uT,Am;const Zi=class Zi{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:o,accessibilityManager:r,annotationLayer:u,drawLayer:c,textLayer:f,viewport:h,l10n:y}){w(this,ve);w(this,Fl);w(this,Kc,!1);w(this,Os,null);w(this,Za,null);w(this,Oo,null);w(this,Si,new Map);w(this,ja,!1);w(this,Wc,!1);w(this,Ol,!1);w(this,us,null);w(this,Bo,null);w(this,nn,null);w(this,Go,null);w(this,tr,null);w(this,Qc,-1);w(this,mt);const A=[...g(Zi,er).values()];if(!Zi._initialized){Zi._initialized=!0;for(const S of A)S.initialize(y,t)}t.registerEditorTypes(A),C(this,mt,t),this.pageIndex=e,this.div=n,C(this,Fl,r),C(this,Os,u),this.viewport=h,C(this,nn,f),this.drawLayer=c,this._structTree=o,g(this,mt).addLayer(this)}get isEmpty(){return g(this,Si).size===0}get isInvisible(){return this.isEmpty&&g(this,mt).getMode()===Mt.NONE}updateToolbar(t){g(this,mt).updateToolbar(t)}updateMode(t=g(this,mt).getMode()){switch(R(this,ve,Am).call(this),t){case Mt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Mt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Mt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of g(Zi,er).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=g(this,nn))==null?void 0:e.div)}setEditingState(t){g(this,mt).setEditingState(t)}addCommands(t){g(this,mt).addCommands(t)}cleanUndoStack(t){g(this,mt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=g(this,Os))==null||e.div.classList.toggle("disabled",!t)}async enable(){var n;C(this,Ol,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(n=g(this,tr))==null||n.abort(),C(this,tr,null);const t=new Set;for(const o of g(this,Si).values())o.enableEditing(),o.show(!0),o.annotationElementId&&(g(this,mt).removeChangedExistingAnnotation(o),t.add(o.annotationElementId));if(!g(this,Os)){C(this,Ol,!1);return}const e=g(this,Os).getEditableAnnotations();for(const o of e){if(o.hide(),g(this,mt).isDeletedAnnotationElement(o.data.id)||t.has(o.data.id))continue;const r=await this.deserialize(o);r&&(this.addOrRebuild(r),r.enableEditing())}C(this,Ol,!1)}disable(){var o;if(C(this,Wc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),g(this,nn)&&!g(this,tr)){C(this,tr,new AbortController);const r=g(this,mt).combinedSignal(g(this,tr));g(this,nn).div.addEventListener("pointerdown",u=>{const{clientX:f,clientY:h,timeStamp:y}=u,A=g(this,Qc);if(y-A>500){C(this,Qc,y);return}C(this,Qc,-1);const{classList:S}=this.div;S.toggle("getElements",!0);const E=document.elementsFromPoint(f,h);if(S.toggle("getElements",!1),!this.div.contains(E[0]))return;let b;const x=new RegExp(`^${ow}[0-9]+$`);for(const N of E)if(x.test(N.id)){b=N.id;break}if(!b)return;const D=g(this,Si).get(b);(D==null?void 0:D.annotationElementId)===null&&(u.stopPropagation(),u.preventDefault(),D.dblclick())},{signal:r,capture:!0})}const t=new Map,e=new Map;for(const r of g(this,Si).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);(o=this.getEditableAnnotation(r.annotationElementId))==null||o.show(),r.remove()}if(g(this,Os)){const r=g(this,Os).getEditableAnnotations();for(const u of r){const{id:c}=u.data;if(g(this,mt).isDeletedAnnotationElement(c))continue;let f=e.get(c);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=t.get(c),f&&(g(this,mt).addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}R(this,ve,Am).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of g(Zi,er).values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Wc,!1)}getEditableAnnotation(t){var e;return((e=g(this,Os))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){g(this,mt).getActive()!==t&&g(this,mt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=g(this,nn))!=null&&t.div&&!g(this,Go)){C(this,Go,new AbortController);const e=g(this,mt).combinedSignal(g(this,Go));g(this,nn).div.addEventListener("pointerdown",R(this,ve,fR).bind(this),{signal:e}),g(this,nn).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=g(this,nn))!=null&&t.div&&g(this,Go)&&(g(this,Go).abort(),C(this,Go,null),g(this,nn).div.classList.remove("highlighting"))}enableClick(){if(g(this,Za))return;C(this,Za,new AbortController);const t=g(this,mt).combinedSignal(g(this,Za));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=g(this,Za))==null||t.abort(),C(this,Za,null)}attach(t){g(this,Si).set(t.id,t);const{annotationElementId:e}=t;e&&g(this,mt).isDeletedAnnotationElement(e)&&g(this,mt).removeDeletedAnnotationElement(t)}detach(t){var e;g(this,Si).delete(t.id),(e=g(this,Fl))==null||e.removePointerInTextLayer(t.contentDiv),!g(this,Wc)&&t.annotationElementId&&g(this,mt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),g(this,mt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(g(this,mt).addDeletedAnnotationElement(t.annotationElementId),fe.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),g(this,mt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!g(this,Ol)),g(this,mt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!g(this,Oo)&&(t._focusEventsAllowed=!1,C(this,Oo,setTimeout(()=>{C(this,Oo,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:g(this,mt)._signal}),e.focus())},0))),t._structTreeParentId=(n=g(this,Fl))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return g(this,mt).getId()}combinedSignal(t){return g(this,mt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=g(this,ve,Ss))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await g(this,mt).updateMode(t.mode);const{offsetX:n,offsetY:o}=R(this,ve,uT).call(this),r=this.getNextId(),u=R(this,ve,lT).call(this,{parent:this,id:r,x:n,y:o,uiManager:g(this,mt),isCentered:!0,...e});u&&this.add(u)}async deserialize(t){var e;return await((e=g(Zi,er).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,g(this,mt)))||null}createAndAddNewEditor(t,e,n={}){const o=this.getNextId(),r=R(this,ve,lT).call(this,{parent:this,id:o,x:t.offsetX,y:t.offsetY,uiManager:g(this,mt),isCentered:e,...n});return r&&this.add(r),r}addNewEditor(t={}){this.createAndAddNewEditor(R(this,ve,uT).call(this),!0,t)}setSelected(t){g(this,mt).setSelected(t)}toggleSelected(t){g(this,mt).toggleSelected(t)}unselect(t){g(this,mt).unselect(t)}pointerup(t){var o;const{isMac:e}=gn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!g(this,ja)||(C(this,ja,!1),(o=g(this,ve,Ss))!=null&&o.isDrawer&&g(this,ve,Ss).supportMultipleDrawings))return;if(!g(this,Kc)){C(this,Kc,!0);return}const n=g(this,mt).getMode();if(n===Mt.STAMP||n===Mt.SIGNATURE){g(this,mt).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var o;if(g(this,mt).getMode()===Mt.HIGHLIGHT&&this.enableTextSelection(),g(this,ja)){C(this,ja,!1);return}const{isMac:e}=gn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(C(this,ja,!0),(o=g(this,ve,Ss))!=null&&o.isDrawer){this.startDrawingSession(t);return}const n=g(this,mt).getActive();C(this,Kc,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),g(this,us)){g(this,ve,Ss).startDrawing(this,g(this,mt),!1,t);return}g(this,mt).setCurrentDrawingSession(this),C(this,us,new AbortController);const e=g(this,mt).combinedSignal(g(this,us));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(C(this,Bo,null),this.commitOrRemove())},{signal:e}),g(this,ve,Ss).startDrawing(this,g(this,mt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&C(this,Bo,e);return}g(this,Bo)&&setTimeout(()=>{var e;(e=g(this,Bo))==null||e.focus(),C(this,Bo,null)},0)}endDrawingSession(t=!1){return g(this,us)?(g(this,mt).setCurrentDrawingSession(null),g(this,us).abort(),C(this,us,null),C(this,Bo,null),g(this,ve,Ss).endDrawing(t)):null}findNewParent(t,e,n){const o=g(this,mt).findParent(e,n);return o===null||o===this?!1:(o.changeParent(t),!0)}commitOrRemove(){return g(this,us)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,us)&&g(this,ve,Ss).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=g(this,mt).getActive())==null?void 0:t.parent)===this&&(g(this,mt).commitOrRemove(),g(this,mt).setActiveEditor(null)),g(this,Oo)&&(clearTimeout(g(this,Oo)),C(this,Oo,null));for(const n of g(this,Si).values())(e=g(this,Fl))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,g(this,Si).clear(),g(this,mt).removeLayer(this)}render({viewport:t}){this.viewport=t,Vl(this.div,t);for(const e of g(this,mt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){g(this,mt).commitOrRemove(),R(this,ve,Am).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Vl(this.div,{rotation:n}),e!==n)for(const o of g(this,Si).values())o.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return g(this,mt).viewParameters.realScale}};Fl=new WeakMap,Kc=new WeakMap,Os=new WeakMap,Za=new WeakMap,Oo=new WeakMap,Si=new WeakMap,ja=new WeakMap,Wc=new WeakMap,Ol=new WeakMap,us=new WeakMap,Bo=new WeakMap,nn=new WeakMap,Go=new WeakMap,tr=new WeakMap,Qc=new WeakMap,mt=new WeakMap,er=new WeakMap,ve=new WeakSet,fR=function(t){g(this,mt).unselectAll();const{target:e}=t;if(e===g(this,nn).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&g(this,nn).div.contains(e)){const{isMac:n}=gn.platform;if(t.button!==0||t.ctrlKey&&n)return;g(this,mt).showAllEditors("highlight",!0,!0),g(this,nn).div.classList.add("free"),this.toggleDrawing(),Rm.startHighlighting(this,g(this,mt).direction==="ltr",{target:g(this,nn).div,x:t.x,y:t.y}),g(this,nn).div.addEventListener("pointerup",()=>{g(this,nn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,mt)._signal}),t.preventDefault()}},Ss=function(){return g(Zi,er).get(g(this,mt).getMode())},lT=function(t){const e=g(this,ve,Ss);return e?new e.prototype.constructor(t):null},uT=function(){const{x:t,y:e,width:n,height:o}=this.div.getBoundingClientRect(),r=Math.max(0,t),u=Math.max(0,e),c=Math.min(window.innerWidth,t+n),f=Math.min(window.innerHeight,e+o),h=(r+c)/2-t,y=(u+f)/2-e,[A,S]=this.viewport.rotation%180===0?[h,y]:[y,h];return{offsetX:A,offsetY:S}},Am=function(){for(const t of g(this,Si).values())t.isEmpty()&&t.remove()},ot(Zi,"_initialized",!1),w(Zi,er,new Map([BA,ZA,oT,Rm,sT].map(t=>[t._editorType,t])));let rT=Zi;var cs,Ln,Bl,ap,Km,hR,Hs,dT,pR,fT;const He=class He{constructor({pageIndex:t}){w(this,Hs);w(this,cs,null);w(this,Ln,new Map);w(this,Bl,new Map);this.pageIndex=t}setParent(t){if(!g(this,cs)){C(this,cs,t);return}if(g(this,cs)!==t){if(g(this,Ln).size>0)for(const e of g(this,Ln).values())e.remove(),t.append(e);C(this,cs,t)}}static get _svgFactory(){return Gt(this,"_svgFactory",new _m)}draw(t,e=!1,n=!1){const o=Rn(He,ap)._++,r=R(this,Hs,dT).call(this),u=He._svgFactory.createElement("defs");r.append(u);const c=He._svgFactory.createElement("path");u.append(c);const f=`path_p${this.pageIndex}_${o}`;c.setAttribute("id",f),c.setAttribute("vector-effect","non-scaling-stroke"),e&&g(this,Bl).set(o,c);const h=n?R(this,Hs,pR).call(this,u,f):null,y=He._svgFactory.createElement("use");return r.append(y),y.setAttribute("href",`#${f}`),this.updateProperties(r,t),g(this,Ln).set(o,r),{id:o,clipPathId:`url(#${h})`}}drawOutline(t,e){const n=Rn(He,ap)._++,o=R(this,Hs,dT).call(this),r=He._svgFactory.createElement("defs");o.append(r);const u=He._svgFactory.createElement("path");r.append(u);const c=`path_p${this.pageIndex}_${n}`;u.setAttribute("id",c),u.setAttribute("vector-effect","non-scaling-stroke");let f;if(e){const A=He._svgFactory.createElement("mask");r.append(A),f=`mask_p${this.pageIndex}_${n}`,A.setAttribute("id",f),A.setAttribute("maskUnits","objectBoundingBox");const S=He._svgFactory.createElement("rect");A.append(S),S.setAttribute("width","1"),S.setAttribute("height","1"),S.setAttribute("fill","white");const E=He._svgFactory.createElement("use");A.append(E),E.setAttribute("href",`#${c}`),E.setAttribute("stroke","none"),E.setAttribute("fill","black"),E.setAttribute("fill-rule","nonzero"),E.classList.add("mask")}const h=He._svgFactory.createElement("use");o.append(h),h.setAttribute("href",`#${c}`),f&&h.setAttribute("mask",`url(#${f})`);const y=h.cloneNode();return o.append(y),h.classList.add("mainOutline"),y.classList.add("secondaryOutline"),this.updateProperties(o,t),g(this,Ln).set(n,o),n}finalizeDraw(t,e){g(this,Bl).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var f;if(!e)return;const{root:n,bbox:o,rootClass:r,path:u}=e,c=typeof t=="number"?g(this,Ln).get(t):t;if(c){if(n&&R(this,Hs,fT).call(this,c,n),o&&R(f=He,Km,hR).call(f,c,o),r){const{classList:h}=c;for(const[y,A]of Object.entries(r))h.toggle(y,A)}if(u){const y=c.firstChild.firstChild;R(this,Hs,fT).call(this,y,u)}}}updateParent(t,e){if(e===this)return;const n=g(this,Ln).get(t);n&&(g(e,cs).append(n),g(this,Ln).delete(t),g(e,Ln).set(t,n))}remove(t){g(this,Bl).delete(t),g(this,cs)!==null&&(g(this,Ln).get(t).remove(),g(this,Ln).delete(t))}destroy(){C(this,cs,null);for(const t of g(this,Ln).values())t.remove();g(this,Ln).clear(),g(this,Bl).clear()}};cs=new WeakMap,Ln=new WeakMap,Bl=new WeakMap,ap=new WeakMap,Km=new WeakSet,hR=function(t,[e,n,o,r]){const{style:u}=t;u.top=`${100*n}%`,u.left=`${100*e}%`,u.width=`${100*o}%`,u.height=`${100*r}%`},Hs=new WeakSet,dT=function(){const t=He._svgFactory.create(1,1,!0);return g(this,cs).append(t),t.setAttribute("aria-hidden",!0),t},pR=function(t,e){const n=He._svgFactory.createElement("clipPath");t.append(n);const o=`clip_${e}`;n.setAttribute("id",o),n.setAttribute("clipPathUnits","objectBoundingBox");const r=He._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),o},fT=function(t,e){for(const[n,o]of Object.entries(e))o===null?t.removeAttribute(n):t.setAttribute(n,o)},w(He,Km),w(He,ap,0);let cT=He;globalThis._pdfjsTestingUtils={HighlightOutliner:VA};globalThis.pdfjsLib={AbortException:nr,AnnotationEditorLayer:rT,AnnotationEditorParamsType:Vt,AnnotationEditorType:Mt,AnnotationEditorUIManager:Hl,AnnotationLayer:UA,AnnotationMode:va,AnnotationType:Le,build:I3,ColorPicker:Mm,createValidAbsoluteUrl:aw,DOMSVGFactory:_m,DrawLayer:cT,FeatureTest:gn,fetchData:up,getDocument:cM,getFilenameFromUrl:bB,getPdfFilenameFromUrl:xB,getUuid:uw,getXfaPageViewport:wB,GlobalWorkerOptions:Bs,ImageKind:zg,InvalidPDFException:W0,isDataScheme:ny,isPdfFile:ET,isValidExplicitDest:OB,MathClamp:Un,noContextMenu:fs,normalizeUnicode:SB,OPS:Em,OutputScale:Vs,PasswordResponses:fB,PDFDataRangeTransport:dM,PDFDateString:CT,PDFWorker:If,PermissionFlag:dB,PixelsPerInch:ir,RenderingCancelledException:ST,ResponseException:Cm,setLayerDimensions:Vl,shadow:Gt,SignatureExtractor:Vo,stopEvent:ke,SupportedImageMimeTypes:Z0,TextLayer:Nf,TouchManager:xm,updateUrlHash:rw,Util:Ct,VerbosityLevel:jm,version:D3,XfaLayer:pM};const tG="gemini-2.5-flash";function Zc(){try{const i=localStorage.getItem("selectedModel");if(i)return i}catch{}return tG}const oy=async(i,t=3,e=1e3)=>{var r;let n=0,o=e;for(;;)try{console.log(`🔄 [DEBUG] withRetry tentativa ${n+1}/${t+1}...`);const u=new Promise((f,h)=>{setTimeout(()=>h(new Error("API call timeout after 60 seconds")),6e4)}),c=await Promise.race([i(),u]);return console.log("✅ [DEBUG] withRetry sucesso na tentativa",n+1),c}catch(u){console.log(`❌ [DEBUG] withRetry erro na tentativa ${n+1}:`,u.message||u);const c=u.toString().includes("429")||u.toString().includes("RESOURCE_EXHAUSTED"),f=(r=u.message)==null?void 0:r.includes("timeout");if((c||f)&&n<t)console.warn(`${f?"Timeout":"Rate limit"} hit on attempt ${n+1}. Retrying in ${o}ms...`),await new Promise(h=>setTimeout(h,o)),n++,o*=2;else throw console.error(`API call failed after ${n} retries or for a non-retriable error.`,u),u}};async function S_(i){console.log("🔍 [DEBUG] findProblematicPages iniciado, texto length:",i.length),console.log("🔍 [DEBUG] Iniciando análise local...");const t=eG(i);console.log("🔍 [DEBUG] Análise local encontrou:",t.issues),console.log("🔍 [DEBUG] Páginas problemáticas localmente:",t.problematicPages);try{return console.log("🔍 [DEBUG] Iniciando withRetry para chamada à AI..."),await oy(async()=>{var f;console.log("🔍 [DEBUG] Preparando prompt para AI...");const e=`You are a document analysis expert specializing in PDF text extraction quality. Analyze the provided text for extraction problems that require OCR correction.

      CRITICAL: Be MORE SENSITIVE to quality issues. Look for:
      
      **ALWAYS FLAG FOR OCR if you find:**
      - Pages with poor formatting (weird line breaks, spacing issues)
      - Text that looks like it came from a scanned document
      - Missing spaces between words or odd character spacing
      - Any signs that this came from image-to-text conversion rather than native PDF text
      - Broken paragraph structure or awkward text flow
      - Mixed fonts or inconsistent character rendering
      
      **ALSO FLAG:**
      - Garbled or nonsensical text
      - Incomplete tables/lists  
      - Pages with very little text (under 200 chars)
      - Missing punctuation or formatting
      - Footnote markers without corresponding text
      
      **BE AGGRESSIVE**: When in doubt, flag the page for OCR. It's better to re-process a good page than miss a poor extraction.
      
      Document has page breaks marked '--- END OF PAGE X ---'.
      
      Return JSON array of page numbers needing OCR. If text quality seems poor overall, consider flagging ALL pages.
      
      Example: [1, 2, 3] for a 3-page document with quality issues`;console.log("🔍 [DEBUG] Fazendo chamada para llmService.generateContent...");const n=await id.generateContent({model:Zc(),contents:i,config:{systemInstruction:e,temperature:.1,responseMimeType:"application/json",responseSchema:{type:Gs.ARRAY,items:{type:Gs.INTEGER}}}});console.log("🔍 [DEBUG] llmService.generateContent concluído com sucesso!"),console.log("✅ [DEBUG] findProblematicPages response recebido:",{text:n.response.text,finishReason:n.response.finishReason,hasSafetyRatings:!!n.response.safetyRatings,textLength:((f=n.response.text)==null?void 0:f.length)||0});const o=n.response.text;if(!o)return console.warn("❌ [API_EMPTY_RESPONSE] Enhanced analysis returned empty text. Diagnostic info:",{finishReason:n.response.finishReason,safetyRatings:n.response.safetyRatings,candidates:n.response.candidates}),console.warn("Using local analysis fallback."),t.problematicPages;const r=o.replace(/^```json\n?/,"").replace(/```$/,""),u=JSON.parse(r),c=[...new Set([...u,...t.problematicPages])];if(console.log("📋 [DEBUG] Páginas problemáticas detectadas:",c),console.log("🔍 [DEBUG] Detalhes da análise:",{aiDetected:u,localDetected:t.problematicPages,combined:c,reasons:t.issues}),!Array.isArray(c)||!c.every(h=>typeof h=="number"))throw new Error("Invalid format for problematic pages.");return c})}catch(e){return console.error("Error in findProblematicPages after retries:",e),console.warn("Using local analysis as fallback"),t.problematicPages.length>0?t.problematicPages:[]}}function eG(i){const t=[],e=[];return i.split(/--- END OF PAGE \d+ ---/).forEach((o,r)=>{const u=r+1,c=[],f=o.trim();if(f.length===0)return;f.length<200&&(c.push("Texto muito curto"),e.push(u));const h=f.match(/\w\n\w/g);h&&h.length>3&&(c.push("Quebras de linha suspeitas"),e.push(u));const y=f.match(/[a-z][A-Z]/g);y&&y.length>5&&(c.push("Possível falta de espaços"),e.push(u));const A=f.match(/[^\w\s\-.,;:'"!?()[\]{}]/g);A&&A.length>f.length*.05&&(c.push("Muitos caracteres especiais"),e.push(u));const S=f.match(/\b\w{1,2}\b/g);S&&S.length>f.split(/\s+/).length*.3&&(c.push("Palavras muito fragmentadas"),e.push(u)),c.length>0&&t.push(`Página ${u}: ${c.join(", ")}`)}),{issues:t,problematicPages:[...new Set(e)]}}async function nG(i){try{return await oy(async()=>{const t={inlineData:{mimeType:"image/jpeg",data:i}},e={text:`You are a precise OCR engine. Extract and correct all text from this image with maximum accuracy.

CRITICAL OCR RULES:
1. **Character Precision**: Be extremely careful with similar characters:
   - Do NOT confuse "la" with "1a" 
   - Do NOT confuse "Il" with "11"
   - Do NOT confuse "O" with "0" 
   - Do NOT confuse "S" with "5"
   - Verify each character in context
2. **Full Transcription**: Extract ALL text including headers, body, footers, margins
3. **Footnote Detection**: Find ANY footnote markers (numbers, symbols, letters: ¹, ², *, [1], (a), 14-1, etc.) and wrap as <fn>X</fn>
4. **Structure Preservation**: Maintain original paragraphs and formatting
5. **Context Validation**: Use surrounding words to verify character accuracy

OUTPUT FORMAT:
Provide the extracted text, then document findings:

---OCR ANALYSIS---
• Character corrections: "1a" → "la", "Il" → "Il" (verified)
• Found footnote marker "¹" after "document" 
• Extracted margin text: "Definition notes"
• Total characters: X
---END ANALYSIS---

For clean extractions: "---CLEAN EXTRACTION---"`},n=await id.generateContent({model:Zc(),contents:{parts:[t,e]},config:{temperature:.1}}),o=n.response.text;if(!o)throw console.error("❌ [API_EMPTY_RESPONSE] AI API response for text extraction was empty. Diagnostic info:",{finishReason:n.response.finishReason,safetyRatings:n.response.safetyRatings,candidates:n.response.candidates}),new Error("AI API response for text extraction was empty.");const r=o.match(/---OCR ANALYSIS---([\s\S]*?)---END ANALYSIS---/),u=o.match(/---CLEAN EXTRACTION---/);let c="";return r?c=r[1].trim():u?c="Clean extraction - no issues found":c="OCR analysis not provided",{text:o.replace(/---OCR ANALYSIS---[\s\S]*?---END ANALYSIS---/,"").replace(/---CLEAN EXTRACTION---/,"").trim(),changes:c}})}catch(t){throw console.error("Error in extractTextFromImage after retries:",t),new Error("AI API failed to extract text from image.")}}async function iG(i,t){if(!i||i.trim()==="")return{text:i,changes:"No text to process"};try{return await oy(async()=>{const e={inlineData:{mimeType:"image/jpeg",data:t}},n={text:`This is the text extracted from the page's text layer: 

${i}`},r=await id.generateContent({model:Zc(),contents:{parts:[e,n]},config:{systemInstruction:`You are a precision document analyst. Compare the page image with extracted text to make accurate corrections while avoiding character substitution errors.

CRITICAL ACCURACY RULES:
1. **Character Precision**: Be extremely careful with similar characters:
   - Verify "la" vs "1a" by context (usually "la" in words)
   - Check "Il" vs "11" by examining surrounding letters
   - Distinguish "O" vs "0" based on context (letters vs numbers)
   - Validate "S" vs "5" using word patterns
2. **Context Validation**: Use surrounding words to verify character accuracy
3. **Conservative Approach**: Only change text if you're absolutely certain

YOUR PROCESS:
1. **CHARACTER VERIFICATION**: Double-check each suspicious character using context
2. **FOOTNOTE DETECTION**: Find ANY footnote markers (numbers, symbols, letters: ¹, [2], (3), *, a, 14-1, etc.) and add <fn> tags
3. **STRUCTURAL FIXES**: Correct obvious OCR errors verified by image
4. **CHANGE DOCUMENTATION**: Record all modifications made

OUTPUT FORMAT:
Provide corrected text with <fn> tags, then add:

---CHANGES MADE---
• Verified "la" characters (no changes needed)
• Added footnote marker <fn>X</fn> after "word"
• Fixed verified OCR error: "articel" → "article"
• Fixed spacing in "Section1.1" to "Section 1.1"
---END CHANGES---

If no changes were needed, write "---NO CHANGES NEEDED---"`,temperature:.1}}),u=r.response.text;if(!u)throw console.error("❌ [API_EMPTY_RESPONSE] AI API response for text processing was empty. Diagnostic info:",{finishReason:r.response.finishReason,safetyRatings:r.response.safetyRatings,candidates:r.response.candidates}),new Error("AI API response for text processing was empty.");const c=u.match(/---CHANGES MADE---([\s\S]*?)---END CHANGES---/),f=u.match(/---NO CHANGES NEEDED---/);let h="";return c?h=c[1].trim():f?h="No changes needed":h="Changes summary not provided",{text:u.replace(/---CHANGES MADE---[\s\S]*?---END CHANGES---/,"").replace(/---NO CHANGES NEEDED---/,"").trim(),changes:h}})}catch(e){throw console.error("Error in processPageWithText after retries:",e),new Error("AI API failed to process page text after multiple attempts.")}}async function E_(i){console.log(`🔍 [REFORMAT_DEBUG] Starting final document reformatting. Text length: ${i.length} chars.`),console.log("🔍 [REFORMAT_DEBUG] Raw text preview (first 300 chars):",i.substring(0,300));const t=Date.now();if(i.length>5e4)return console.log(`🔍 [REFORMAT_DEBUG] Large document detected (${i.length} chars), using chunks`),sG(i);console.log("🔍 [REFORMAT_DEBUG] Small document, processing in single request");const n=new Promise((o,r)=>{setTimeout(()=>{console.log("❌ [REFORMAT_DEBUG] Timeout reached after 180 seconds"),r(new Error("reformatDocumentText timed out after 180 seconds."))},18e4)});try{return await Promise.race([n,oy(async()=>{var f,h,y,A,S,E,b,x;console.log("🔍 [REFORMAT_DEBUG] Sending single request to Gemini API for final formatting..."),console.log("🔍 [REFORMAT_DEBUG] Using model:",Zc()),console.log("🔍 [REFORMAT_DEBUG] Request text length:",i.length);const o=`You are an expert document formatter. Your task is to clean and format a raw text document while preserving its original structure and readability.

CRITICAL FORMATTING RULES:

1. **PRESERVE ORIGINAL STRUCTURE**:
   - Keep all headings exactly as they appear (SECTION A, CHAPTER 1, Section 1.1, etc.)
   - Maintain proper spacing between sections (blank lines between major sections)
   - Preserve numbered lists, bullet points, and paragraph breaks
   - Keep sub-sections and definitions properly indented
   - **NEVER merge paragraphs into one continuous block of text**

2. **CLEAN THE TEXT**:
   - Remove page break markers ('--- END OF PAGE X ---')
   - Remove duplicate headers/footers that appear on multiple pages
   - Fix obvious OCR errors while preserving content

3. **HANDLE FOOTNOTES**:
   - **Detect all potential footnote markers**: This includes superscript numbers (¹), numbers in brackets ([1]), numbers in parentheses ((1)), asterisks (*), and simple numbers following a word (word1, word2).
   - **Convert ALL footnote references** to the format: {{footnotenumberX}}Y{{-footnotenumberX}}, where X is a sequential counter (1, 2, 3...) and Y is the original marker (e.g., 1, 2, *, a).
   - **Convert ALL footnote definitions** (usually at the bottom of a page) to the format: {{footnoteX}}Y Footnote text here{{-footnoteX}}.
   - **Renumber all footnotes sequentially** starting from 1. The X in the tags must be sequential.
   - Ensure every reference tag {{footnotenumberX}} has a corresponding definition tag {{footnoteX}}.

4. **OUTPUT FORMAT**:
   - Return clean, readable text that matches the original document structure
   - Use proper line breaks and spacing
   - Maintain professional document formatting
   - Each article, section, and paragraph should be clearly separated`;console.log("🔍 [REFORMAT_DEBUG] Making API call to llmService.generateContent...");const r=await id.generateContent({model:Zc(),contents:i,config:{systemInstruction:o,temperature:.2,maxOutputTokens:8192}});console.log("🔍 [REFORMAT_DEBUG] API response received"),console.log("🔍 [REFORMAT_DEBUG] Response type:",typeof r),console.log("🔍 [REFORMAT_DEBUG] Response keys:",Object.keys(r||{})),console.log("🔍 [REFORMAT_DEBUG] Response.response.text type:",typeof((f=r==null?void 0:r.response)==null?void 0:f.text)),console.log("🔍 [REFORMAT_DEBUG] Response.response.text length:",((y=(h=r==null?void 0:r.response)==null?void 0:h.text)==null?void 0:y.length)||0),console.log("🔍 [REFORMAT_DEBUG] Response.response.text preview (first 300 chars):",((S=(A=r==null?void 0:r.response)==null?void 0:A.text)==null?void 0:S.substring(0,300))||"EMPTY"),console.log("🔍 [REFORMAT_DEBUG] Response finishReason:",(E=r==null?void 0:r.response)==null?void 0:E.finishReason),console.log("🔍 [REFORMAT_DEBUG] Response safetyRatings:",(b=r==null?void 0:r.response)==null?void 0:b.safetyRatings);const u=Date.now()-t;console.log(`✅ [REFORMAT_DEBUG] Final formatting completed in ${u}ms. Output length: ${((x=r.response.text)==null?void 0:x.length)||0}`);const c=r.response.text;if(!c)throw console.log("❌ [REFORMAT_DEBUG] API response.response.text is empty or null. Diagnostic info:",{finishReason:r.response.finishReason,safetyRatings:r.response.safetyRatings,candidates:r.response.candidates}),new Error("API response for reformatting was empty.");return console.log("✅ [REFORMAT_DEBUG] Returning formatted text, length:",c.length),c})])}catch(o){return console.error("[ERROR] Final formatting failed after retries:",o),console.log("[INFO] Fallback: Returning original, unformatted text."),i.replace(/--- END OF PAGE \d+ ---/g,`
`)}}async function sG(i){console.log(`[INFO] Document is large (${i.length} chars). Processing in chunks.`);const t=i.split(/(?=--- END OF PAGE \d+ ---)/g),e=[];console.log(`[INFO] Split document into ${t.length} chunks.`);for(let n=0;n<t.length;n++){const o=t[n];if(o.trim().length!==0){console.log(`[INFO] Formatting chunk ${n+1}/${t.length} (${o.length} chars)...`);try{const u=await id.generateContent({model:Zc(),contents:o,config:{systemInstruction:`You are an expert document formatter. Your task is to clean and format this text chunk.
      - Remove page break markers ('--- END OF PAGE X ---').
      - Fix obvious OCR errors and spacing issues.
      - Preserve all {{footnote...}} tags and other structural elements exactly as they are.
      - Return only the cleaned text for this chunk. Do not add extra commentary.`,temperature:.1}});e.push(u.response.text||o)}catch(r){console.error(`[ERROR] Failed to format chunk ${n+1}. Using original text for this chunk.`,r),e.push(o)}}}return console.log(`[SUCCESS] All ${t.length} chunks have been processed. Reassembling document.`),e.join(`
`).replace(/--- END OF PAGE \d+ ---/g,`
`)}const oG=(i={},t=0)=>{const[e,n]=at.useState(i),[o,r]=at.useState(null),[u,c]=at.useState(t),[f,h]=at.useState(null),y=at.useRef(null);at.useEffect(()=>{const U=Object.keys(e).find(k=>e[k].isActive);U&&h(U)},[e]),at.useEffect(()=>{if(Object.values(e).some(k=>k.isActive)||o)return y.current=setInterval(()=>{const k=Date.now();n(F=>{const B={...F};return Object.keys(B).forEach(q=>{B[q].isActive&&B[q].startTime&&(B[q].elapsedTime=k-B[q].startTime)}),B}),o&&c(k-o)},100),()=>{y.current&&clearInterval(y.current)}},[e,o]);const A=at.useCallback(()=>{const U=Date.now();r(U),c(0)},[]),S=at.useCallback(()=>{o&&c(Date.now()-o),r(null),h(null)},[o]),E=at.useCallback((U,k)=>{const F=Date.now();n(B=>{const q={...B};return Object.keys(q).forEach(Y=>{q[Y].isActive&&(q[Y].isActive=!1,q[Y].endTime=F,q[Y].duration=F-(q[Y].startTime||F))}),q}),n(B=>({...B,[U]:{id:U,name:k,startTime:F,endTime:null,duration:0,isActive:!0,elapsedTime:0}})),h(U)},[]),b=at.useCallback(U=>{const k=Date.now();n(F=>{const B=F[U];return B?{...F,[U]:{...B,isActive:!1,endTime:k,duration:B.startTime?k-B.startTime:0,elapsedTime:B.startTime?k-B.startTime:0}}:F}),f===U&&h(null)},[f]),x=at.useCallback((U,k)=>{n(F=>{const B=F[U];return B?{...F,[U]:{...B,name:`${B.name.split(" - ")[0]} - ${k}`}}:F})},[]),D=at.useCallback(()=>{n({}),r(null),c(0),h(null),y.current&&clearInterval(y.current)},[]),N=at.useCallback(()=>({totalTime:u,activeStep:f,steps:e,averages:{}}),[u,f,e]),L=at.useCallback(U=>{if(U<1e3)return`${Math.round(U)}ms`;const k=Math.floor(U/1e3),F=Math.floor(k/60),B=Math.floor(F/60);return B>0?`${B}:${(F%60).toString().padStart(2,"0")}:${(k%60).toString().padStart(2,"0")}`:F>0?`${F}:${(k%60).toString().padStart(2,"0")}`:`${k}s`},[]),P=at.useCallback((U,k,F)=>{const B=e[U];if(!B||!B.startTime||F===0)return"Calculando...";const q=Date.now()-B.startTime,Y=q/(F/100),Q=Y-q,Z=Object.values(e).filter(yt=>yt.endTime&&yt.duration>0),ut=Z.length>0?Z.reduce((yt,G)=>yt+G.duration,0)/Z.length:Y,St=k-Object.keys(e).length,gt=Q+St*ut;return L(Math.max(0,gt))},[e,L]);return{timers:e,totalElapsed:u,activeStep:f,startTotal:A,stopTotal:S,startStep:E,stopStep:b,updateStepProgress:x,reset:D,getStats:N,formatTime:L,getEstimatedTimeRemaining:P}},aG=i=>{const[t,e]=at.useState(null),n=at.useCallback(c=>{try{const f=window.localStorage.getItem(i);if(f){const h=JSON.parse(f);if(h.fileInfo&&h.fileInfo.name===c.name&&h.fileInfo.size===c.size&&h.fileInfo.lastModified===c.lastModified)return console.log(`Found and loaded existing process state for: ${c.name}`),e(h),h.processData}}catch(f){console.error(`Error reading state from localStorage for key "${i}":`,f)}return console.log(`No existing process state found for: ${c.name}`),e(null),null},[i]),o=at.useCallback((c,f)=>{try{const h={processData:c,fileInfo:{name:f.name,size:f.size,lastModified:f.lastModified},timestamp:Date.now()};window.localStorage.setItem(i,JSON.stringify(h)),e(h)}catch(h){console.error(`Error saving state to localStorage for key "${i}":`,h)}},[i]),r=at.useCallback(()=>{try{window.localStorage.removeItem(i),e(null)}catch(c){console.error(`Error clearing state from localStorage for key "${i}":`,c)}},[i]),u=at.useCallback(c=>{try{const f=window.localStorage.getItem(i);if(f){const h=JSON.parse(f);if(h.fileInfo&&h.fileInfo.name===c.name&&h.fileInfo.size===c.size&&h.fileInfo.lastModified===c.lastModified)return!0}}catch(f){console.error(`Error checking saved state from localStorage for key "${i}":`,f)}return!1},[i]);return{persistedProcessState:(t==null?void 0:t.processData)??null,loadState:n,saveState:o,clearState:r,hasSavedState:u}};class On{constructor(){this.baseUrl="http://localhost:3001/api/debug",this.enabled=!0}static getInstance(){return On.instance||(On.instance=new On),On.instance}async sendRequest(t,e,n="POST"){if(this.enabled)try{const o=new AbortController,r=setTimeout(()=>o.abort(),5e3),u={method:n,headers:{"Content-Type":"application/json"},signal:o.signal};e&&n!=="GET"&&(u.body=JSON.stringify(e));const c=await fetch(`${this.baseUrl}${t}`,u);return clearTimeout(r),await c.json()}catch(o){console.error("Failed to send debug data:",o)}}async log(t,e,n,o="frontend"){await this.sendRequest("/log",{level:t,message:e,data:n,source:o}),(t==="error"?console.error:t==="warn"?console.warn:t==="debug"?console.debug:console.log)(`[${t.toUpperCase()}] ${o}: ${e}`,n||"")}error(t,e,n="frontend"){const o=t instanceof Error?t.message:t,r=t instanceof Error?t.stack:void 0;this.sendRequest("/error",{error:o,stack:r,context:e,source:n}),console.error(`[ERROR] ${n}: ${o}`,{stack:r,context:e})}async getLogs(t){const e=new URLSearchParams;t!=null&&t.level&&e.set("level",t.level),t!=null&&t.source&&e.set("source",t.source),t!=null&&t.limit&&e.set("limit",t.limit.toString());const n=e.toString()?`?${e}`:"";return this.sendRequest(`/logs${n}`,void 0,"GET")}async getErrors(t){const e=t?`?limit=${t}`:"";return this.sendRequest(`/errors${e}`,void 0,"GET")}async getStatus(){return this.sendRequest("/status",void 0,"GET")}async clearLogs(){return this.sendRequest("/logs",void 0,"DELETE")}async clearErrors(){return this.sendRequest("/errors",void 0,"DELETE")}async clearAll(){return this.sendRequest("/all",void 0,"DELETE")}setupGlobalErrorHandling(){window.addEventListener("error",t=>{this.error(t.error||t.message,{filename:t.filename,lineno:t.lineno,colno:t.colno},"global-error")}),window.addEventListener("unhandledrejection",t=>{this.error(t.reason,{type:"unhandled-promise-rejection"},"global-promise")})}setEnabled(t){this.enabled=t}}const rn=On.getInstance();function rG(){return at.useEffect(()=>{rn.setupGlobalErrorHandling()},[]),{log:rn.log.bind(rn),error:rn.error.bind(rn),getLogs:rn.getLogs.bind(rn),getErrors:rn.getErrors.bind(rn),getStatus:rn.getStatus.bind(rn),clearLogs:rn.clearLogs.bind(rn),clearErrors:rn.clearErrors.bind(rn),clearAll:rn.clearAll.bind(rn)}}Bs.workerSrc="https://unpkg.com/pdfjs-dist@5.3.93/build/pdf.worker.min.mjs";const C_=i=>new Promise(t=>setTimeout(t,i)),L0={results:[],isProcessing:!1,isReformatting:!1,formattedText:null,progress:{processed:0,total:0,phase:"Ready",phaseProgress:""},error:null,footnoteAnalysis:null,processingTime:null,stepTimers:{},totalElapsed:0,isCompleted:!1,processingMessage:null,reformattingTimer:0,currentStatus:null},b_="pdfProcessState",lG=()=>{const[i,t]=at.useState(L0),[e,n]=at.useState(null),{saveState:o,loadState:r,clearState:u,hasSavedState:c}=aG(b_),f=oG(i.stepTimers,i.totalElapsed),h=On.getInstance(),y=at.useCallback(N=>{t(L=>{const P={...L,...N};return e&&o(P,e),P})},[e,o]),A=at.useCallback(async(N,L="info",P)=>{const k=`[${new Date().toLocaleTimeString()}] ${N}`;console.log(`[${L.toUpperCase()}] ${k}`,P||""),Promise.resolve().then(async()=>{try{await h.log(L,k,P,"PDF-Processor")}catch(F){console.error("Failed to send log to debug server:",F)}})},[h]),S=at.useCallback(()=>{e&&u(),t(L0),f.reset(),n(null);try{h.clearLogs(),h.clearErrors()}catch(L){console.error("Failed to clear debug logs:",L)}},[u,f,h,e]),E=at.useCallback(async N=>{var U,k,F,B,q;let L=i.results;const P=i.results.filter(Y=>Y.status!==de.PENDING).length;await A(`🔧 startProcessing called: startFrom=${P}, currentResults=${i.results.length}`,"info"),await A(`🔧 Timer state: totalElapsed=${f.totalElapsed}, activeStep=${f.activeStep}`,"info"),P===0?(await A(`--- Starting new process for ${N.name} ---`,"info"),f.startTotal()):(await A(`--- Resuming process for ${N.name} from page ${P+1} ---`,"info"),f.startTotal()),y({isProcessing:!0});try{const Y=new Uint8Array(await N.arrayBuffer()),Q=await cM(Y).promise,Z=Q.numPages;P===0?(L=Array.from({length:Z},($,rt)=>({pageNumber:rt+1,status:de.PENDING,text:null,imageUrl:null,method:null})),y({results:L,progress:{processed:0,total:Z,phase:"Phase 1: Extracting text",phaseProgress:""}})):(i.progress.total===0||i.progress.total!==Z)&&y({progress:{...i.progress,total:Z,processed:P}});const ut=(U=i.stepTimers.phase1)==null?void 0:U.endTime,St=L.every($=>$.status!==de.PENDING);if(await A(`🔧 Phase 1 check: phase1Complete=${!!ut}, allPagesExtracted=${St}, startFrom=${P}, total=${Z}`,"info"),!ut&&!St){f.startStep("phase1","Phase 1: Extracting text"),await A(`🚀 Phase 1: Starting initial extraction from ${Z} pages...`,"info");for(let $=P+1;$<=Z;$++){const rt=await Q.getPage($),vt=rt.getViewport({scale:1.5}),V=document.createElement("canvas"),j=V.getContext("2d");if(!j)throw new Error("Could not get canvas context");V.height=vt.height,V.width=vt.width;const it=(await rt.getTextContent()).items.map(dt=>dt.str).join(" ").trim();if(it.length>200)L[$-1]={...L[$-1],text:it,status:de.COMPLETED,method:"Quick Text"};else{await rt.render({canvasContext:j,viewport:vt}).promise;const dt=V.toDataURL("image/jpeg");L[$-1]={...L[$-1],imageUrl:dt,text:it,status:de.PROCESSING}}y({results:[...L],progress:{processed:$,total:Z,phase:i.progress.phase||"Phase 1: Extracting text",phaseProgress:`${$}/${Z} pages extracted`}}),await C_(1)}await A("✅ Phase 1 completed","info"),f.stopStep("phase1")}const gt=(k=i.stepTimers.phase2)==null?void 0:k.endTime;await A(`🔧 Phase 2 check: phase2Complete=${!!gt}`,"info");const yt=L.filter($=>$.status!==de.COMPLETED);if(!gt&&yt.length>0){f.startStep("phase2","Phase 2: AI analyzing document"),await A("🧠 Phase 2: AI analyzing document for extraction errors...","info");const $=yt.map(vt=>`--- PAGE ${vt.pageNumber} ---
${vt.text||""}`).join(`

`),rt=await S_($);L.forEach(vt=>{rt.includes(vt.pageNumber)&&(vt.status=de.CORRECTING)}),y({results:[...L]}),await A(`🎯 Found ${rt.length} pages needing correction.`,"info",{pages:rt}),f.stopStep("phase2")}const G=L.filter($=>$.status===de.CORRECTING);if(G.length>0&&!((F=i.stepTimers.phase3)!=null&&F.endTime)){f.startStep("phase3",`Phase 3: AI correction (${G.length} pages)`),await A(`⚡ Phase 3: Starting AI correction for ${G.length} pages...`,"info");for(const $ of G){const rt=$.pageNumber-1;await A(`🤖 Correcting page ${$.pageNumber}...`,"debug");const{text:vt,imageUrl:V}=$;let j=null,st=null;if(V){const it=V.split(",")[1],dt=vt&&vt.length>50?await iG(vt,it):await nG(it);j=dt.text,st=dt.changes}else j=vt,st="No image for AI OCR, relying on text analysis.";L[rt]={...L[rt],text:j,status:de.COMPLETED,changes:st,method:V&&vt&&vt.length>50?"AI Correction":V?"AI OCR":"Quick Text"},y({results:[...L]})}await A("🎉 Phase 3 completed","info"),f.stopStep("phase3")}if(!((B=i.stepTimers.phase4)!=null&&B.endTime)){f.startStep("phase4","Phase 4: AI formatting final document"),await A("🎨 Phase 4: AI formatting final document...","info"),y({isReformatting:!0,error:null});const $=L.map(j=>j.text?`${j.text}

--- PAGE ${j.pageNumber} ---

`:"").join("");if($.trim().length===0)throw new Error("No text to reformat.");const rt=await E_($),vt=/<fn>.*?<\/fn>|{{footnote\d+/g,V={count:((q=rt.match(vt))==null?void 0:q.length)||0,pages:[]};y({formattedText:rt,footnoteAnalysis:V}),await A("🎉 PROCESSING COMPLETE!","info"),f.stopStep("phase4")}}catch(Y){await A(`❌ ERROR: ${Y.message||Y}`,"error",{stack:Y.stack}),y({error:Y.message||"An unknown error occurred."})}finally{y({isProcessing:!1,isReformatting:!1,processingTime:f.totalElapsed/1e3,isCompleted:!0}),f.stopTotal()}},[i,y,A,f]),b=at.useCallback(async N=>{var L,P,U,k;await A("🚀 Iniciando continuação do processamento...","info"),f.activeStep||(f.startTotal(),await A("⏱️ Timer reativado para continuar contagem","info")),y({isProcessing:!0});try{let F=[...N.results];if(!((L=N.stepTimers.phase2)!=null&&L.endTime)){console.log("🚀 ANTES de stepTimers.startStep"),f.startStep("phase2","Phase 2: AI analyzing document"),console.log("🚀 DEPOIS de stepTimers.startStep"),await A("🧠 Phase 2: AI analyzing document for extraction errors...","info"),await A("⚡ [DEBUG] Linha 275 executada com sucesso!","info"),await A("🔍 [DEBUG] Preparando análise AI - criando textForAnalysis...","info");const q=F.map(Q=>`--- PAGE ${Q.pageNumber} ---
${Q.text||""}`).join(`

`);await A(`🔍 [DEBUG] textForAnalysis criado - Length: ${q.length}`,"info"),await A("🔍 [DEBUG] Chamando findProblematicPages...","info");const Y=await S_(q);await A(`🔍 [DEBUG] findProblematicPages retornou: ${JSON.stringify(Y)}`,"info"),F.forEach(Q=>{Y.includes(Q.pageNumber)&&(Q.status=de.CORRECTING)}),y({results:[...F]}),await A(`🎯 Found ${Y.length} pages needing correction.`,"info",{pages:Y}),f.stopStep("phase2")}const B=F.filter(q=>q.status===de.CORRECTING);if(B.length>0&&!((P=N.stepTimers.phase3)!=null&&P.endTime)){f.startStep("phase3",`Phase 3: AI correction (${B.length} pages)`),await A(`⚡ Phase 3: AI correcting ${B.length} problematic pages...`,"info");for(const q of B)await A(`🔧 Correcting page ${q.pageNumber}...`,"info"),q.status=de.COMPLETED,q.method="AI Correction",y({results:[...F]}),await C_(100);f.stopStep("phase3")}if(!((U=N.stepTimers.phase4)!=null&&U.endTime)&&!N.formattedText){f.startStep("phase4","Phase 4: Final formatting"),y({isReformatting:!0,error:null,currentStatus:"🔄 Preparing final document formatting..."}),await A("📝 Phase 4: Formatting final document...","info");const q=F.map(St=>St.text||"").join(`

`);console.log("🔍 [PHASE4_DEBUG] rawTextToReformat length:",q.length),console.log("🔍 [PHASE4_DEBUG] rawTextToReformat preview (first 500 chars):",q.substring(0,500)),console.log("🔍 [PHASE4_DEBUG] accumulatedResults count:",F.length),console.log("🔍 [PHASE4_DEBUG] accumulatedResults with text:",F.filter(St=>St.text&&St.text.length>0).length);const Y=Math.ceil(q.length/8e3);y({currentStatus:`📊 Analyzing ${q.length} characters (est. ${Y}s)`}),await A(`📊 Debug: Processando ${q.length} caracteres de ${F.length} páginas (est. ${Y}s)`,"info"),q.length<50&&await A(`⚠️ AVISO: Texto muito curto para reformatação (${q.length} chars)`,"warn"),y({currentStatus:"🤖 Sending to AI for final formatting..."}),await A("🤖 Enviando para IA para formatação final...","info");const Q=await E_(q);if(console.log("🔍 [PHASE4_DEBUG] finalFormattedText length:",(Q==null?void 0:Q.length)||0),console.log("🔍 [PHASE4_DEBUG] finalFormattedText preview (first 500 chars):",(Q==null?void 0:Q.substring(0,500))||"EMPTY"),!Q||Q.length===0)throw y({currentStatus:"❌ Final formatting failed - empty result",error:"Final formatting returned empty text"}),await A("❌ ERRO: reformatDocumentText retornou texto vazio!","error"),new Error("Final formatting returned empty text");y({currentStatus:"✅ Analyzing formatted document..."}),await A(`✅ Formatação recebida com sucesso (${Q.length} chars)`,"info");const Z=/<fn>.*?<\/fn>|{{footnote\d+/g,ut={count:((k=Q.match(Z))==null?void 0:k.length)||0,pages:[]};y({formattedText:Q,footnoteAnalysis:ut,currentStatus:"🎉 Document formatting complete!"}),await A(`🎉 PROCESSING COMPLETE! Final text: ${Q.length} chars`,"info"),f.stopStep("phase4")}}catch(F){await A(`❌ ERROR: ${F.message||F}`,"error",{stack:F.stack}),y({error:F.message||"An unknown error occurred."})}finally{y({isProcessing:!1,isReformatting:!1,processingTime:f.totalElapsed/1e3,isCompleted:!0}),f.stopTotal()}},[y,A,f]),x=at.useCallback(async(N,L=!1)=>{var U,k,F,B,q;n(N),await A(`🚀 processPdf chamado para: ${N.name} (${N.size} bytes)${L?" [FORÇAR REPROCESSAMENTO]":""}`,"info",{fileSize:N.size,apiKeyConfigured:!0,forceReprocess:L});const P=L?null:r(N);if(P)if(await A("📂 Estado salvo encontrado - verificando compatibilidade...","info"),t(P),P.formattedText)await A(`✅ Processo já estava completo. Restaurado: ${N.name}`,"info");else{const Y=((U=P.progress)==null?void 0:U.total)||0,Q=((k=P.progress)==null?void 0:k.processed)||0;if(Y===0&&P.results&&P.results.length>0){const Z={...P,progress:{...P.progress,total:P.results.length,processed:Q}};t(Z),await A(`🔧 Corrigido total de páginas: ${P.results.length} páginas`,"info")}await A(`🔄 Retomando processo para: ${N.name} (Progresso: ${((F=P.progress)==null?void 0:F.processed)||0}/${((B=P.progress)==null?void 0:B.total)||((q=P.results)==null?void 0:q.length)||0})`,"info"),await E(N)}else L?(await A(`🔄 Reprocessando do zero: ${N.name}`,"info"),u()):await A(`🆕 Iniciando novo processamento para: ${N.name}`,"info"),t(L0),await E(N)},[r,E,A,u]);at.useEffect(()=>{(i.stepTimers!==f.timers||i.totalElapsed!==f.totalElapsed)&&y({stepTimers:f.timers,totalElapsed:f.totalElapsed})},[f.timers,f.totalElapsed,y,i.stepTimers,i.totalElapsed]),at.useEffect(()=>{let N=null;return i.isReformatting?N=setInterval(()=>{y({reformattingTimer:i.reformattingTimer+1})},1e3):i.reformattingTimer>0&&y({reformattingTimer:0}),()=>{N&&clearInterval(N)}},[i.isReformatting,i.reformattingTimer,y]);const D=at.useCallback(async()=>{var N,L,P,U,k,F;try{await A("🔍 Verificando estado salvo no localStorage...","info");const B=localStorage.getItem(b_);if(!B)return await A("❌ Nenhum estado salvo encontrado no localStorage","warn"),!1;await A("📄 Estado encontrado, analisando estrutura...","info");const q=JSON.parse(B);if(!q.processData||!q.fileInfo)return await A("⚠️ Estrutura de dados inválida no localStorage","warn",{hasProcessData:!!q.processData,hasFileInfo:!!q.fileInfo,keys:Object.keys(q)}),!1;await A("✅ Estrutura válida encontrada, restaurando estado...","info",{fileName:q.fileInfo.name,progress:`${((N=q.processData.progress)==null?void 0:N.processed)||0}/${((L=q.processData.progress)==null?void 0:L.total)||0}`,phase:((P=q.processData.progress)==null?void 0:P.phase)||"unknown",isCompleted:q.processData.isCompleted,resultsCount:((U=q.processData.results)==null?void 0:U.length)||0});const Y={...q.processData,progress:{...q.processData.progress,total:((k=q.processData.progress)==null?void 0:k.total)||((F=q.processData.results)==null?void 0:F.length)||0}};await A(`🔧 Estado corrigido - Progresso final: ${Y.progress.processed}/${Y.progress.total}`,"info"),t(Y);const Q=new File([],q.fileInfo.name,{type:"application/pdf",lastModified:q.fileInfo.lastModified});return n(Q),await A(`🎉 Processo retomado com sucesso: ${q.fileInfo.name}`,"info"),!Y.isCompleted&&!Y.formattedText&&(await A(`🔄 Continuando processamento automaticamente da página ${Y.progress.processed+1}...`,"info"),await b(Y)),!0}catch(B){await A(`❌ Erro ao retomar processo: ${B}`,"error",{error:B instanceof Error?B.message:String(B)}),console.error("Erro ao retomar do localStorage:",B)}return!1},[A]);return{...i,processPdf:x,clear:S,stepTimers:f,resumeFromLocalStorage:D,continueProcessingFromState:b,hasSavedState:c}},Fn=({className:i,variant:t="default",size:e="default",...n})=>{const o="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",r={default:"bg-primary-600 text-primary-foreground hover:bg-primary-600/90 focus-visible:ring-primary-500 dark:bg-primary-500 dark:hover:bg-primary-500/90",outline:"border border-slate-300 dark:border-slate-700 bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 focus-visible:ring-slate-400 dark:focus-visible:ring-slate-500"},u={default:"px-4 py-2",sm:"px-3 py-1.5"};return M.jsx("button",{className:`${o} ${r[t]} ${u[e]} ${i||""}`,...n})},uG=({text:i})=>{const t=()=>{navigator.clipboard.writeText(i)};return M.jsxs("div",{className:"w-full h-full flex flex-col",children:[M.jsxs("div",{className:"flex justify-between items-center mb-3",children:[M.jsx("h3",{className:"text-lg font-semibold dark:text-slate-100",children:"Resultado Final"}),M.jsx(Fn,{variant:"outline",size:"sm",onClick:t,children:"Copiar Texto"})]}),M.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"Abaixo está o texto final processado pela IA. Você pode revisar, copiar ou fazer o download como um arquivo .txt."}),M.jsx("div",{className:"flex-grow bg-slate-50 dark:bg-slate-900/50 rounded-md ring-1 ring-slate-200 dark:ring-slate-700 h-[50vh] min-h-[300px]",children:M.jsx("textarea",{readOnly:!0,className:"w-full h-full p-4 bg-transparent border-0 resize-none focus:ring-0 text-sm font-sans dark:text-slate-300",value:i})})]})};function cG({stepId:i,timers:t,formatTime:e,isActive:n,isCompleted:o}){const r=t[i];return!r&&!n?null:M.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${n?"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200":o?"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:[M.jsx(J0,{className:"w-3 h-3"}),M.jsx("span",{className:"font-mono",children:r?e(r.isActive?r.elapsedTime:r.duration):"0s"}),n&&M.jsx("div",{className:"w-1 h-1 bg-current rounded-full animate-pulse"})]})}function dG({currentStep:i,isProcessing:t,isReformatting:e,progress:n,pagesWithAICorrection:o,debugLogs:r,timers:u={},formatTime:c=f=>`${Math.round(f/1e3)}s`}){const h=(()=>{const E=r.slice(-10).join(" ");return e||E.includes("Phase 4")||E.includes("🎨")?4:E.includes("Phase 3")||E.includes("⚡")?3:E.includes("Phase 2")||E.includes("🧠")?2:t||E.includes("Phase 1")||E.includes("🚀")?1:0})(),y=[{id:1,name:"Text Extraction",icon:sw,description:"Extracting text from PDF pages using built-in text layer",status:h>1?"completed":h===1?"active":"pending",details:n.phaseProgress||`${n.processed}/${n.total} pages processed`},{id:2,name:"AI Analysis",icon:oB,description:"AI analyzing document to identify pages with extraction errors",status:h>2?"completed":h===2?"active":"pending",details:o.length>0?`${o.length} pages need AI correction`:"All pages extracted cleanly"},{id:3,name:"AI Correction",icon:sB,description:"Reprocessing problematic pages with AI for maximum accuracy",status:h>3?"completed":h===3?"active":"pending",details:o.length>0?`Pages ${o.join(", ")} corrected`:"No corrections needed"},{id:4,name:"Final Formatting",icon:X0,description:"AI consolidating and formatting the complete document",status:h>4?"completed":h===4||e?"active":"pending",details:"Cleaning text, removing artifacts, applying final structure"}],A=E=>{switch(E){case"completed":return M.jsx(X0,{className:"w-5 h-5 text-green-500"});case"active":return M.jsx(J0,{className:"w-5 h-5 text-blue-500 animate-spin"});case"pending":return M.jsx(J0,{className:"w-5 h-5 text-gray-400"});default:return M.jsx(iB,{className:"w-5 h-5 text-red-500"})}},S=E=>{switch(E){case"completed":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"active":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";case"pending":return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-700";default:return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}};return M.jsxs(Yi,{className:"p-6",children:[M.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"Processing Status - Behind the Scenes"}),M.jsx("div",{className:"space-y-4",children:y.map(E=>{const b=E.icon;return M.jsx("div",{className:`p-4 border rounded-lg transition-all duration-300 ${S(E.status)}`,children:M.jsxs("div",{className:"flex items-start space-x-3",children:[M.jsx("div",{className:"flex-shrink-0 mt-0.5",children:A(E.status)}),M.jsxs("div",{className:"flex-grow",children:[M.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[M.jsx(b,{className:"w-4 h-4 text-slate-600 dark:text-slate-400"}),M.jsxs("h4",{className:"font-medium text-slate-800 dark:text-slate-100",children:["Phase ",E.id,": ",E.name]}),M.jsx(cG,{stepId:`phase${E.id}`,timers:u,formatTime:c,isActive:E.status==="active",isCompleted:E.status==="completed"})]}),M.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:E.description}),M.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500 font-mono",children:E.details})]})]})},E.id)})}),M.jsxs("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[M.jsx("h4",{className:"font-medium text-slate-800 dark:text-slate-100 mb-2",children:"Current Activity"}),M.jsxs("div",{className:"flex items-center space-x-2",children:[M.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),M.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:[e&&"AI is formatting the final document...",t&&"Processing pages and analyzing content...",!t&&!e&&i<4&&"Ready to process",i===4&&"Processing complete!"]})]})]})]})}function fG({isOpen:i,onClose:t}){var L,P,U,k,F,B,q,Y,Q,Z,ut,St,gt,yt;const e=rG(),[n,o]=at.useState([]),[r,u]=at.useState([]),[c,f]=at.useState(null),[h,y]=at.useState("logs"),[A,S]=at.useState(!1),E=at.useRef(null);at.useEffect(()=>{i&&b()},[i]),at.useEffect(()=>{if(A){const G=setInterval(b,2e3);return()=>clearInterval(G)}},[A]),at.useEffect(()=>{i&&E.current&&(E.current.scrollTop=E.current.scrollHeight)},[n,i]);const b=async()=>{try{const[G,$,rt]=await Promise.all([e.getLogs({limit:50}),e.getErrors(20),e.getStatus()]);o((G==null?void 0:G.logs)||[]),u(($==null?void 0:$.errors)||[]),f(rt)}catch(G){console.error("Failed to refresh debug data:",G)}},x=async()=>{await e.clearLogs(),b()},D=async()=>{await e.clearErrors(),b()},N=async()=>{await e.clearAll(),b()};return i?M.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:M.jsxs(Yi,{className:"w-11/12 h-5/6 bg-white flex flex-col",children:[M.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[M.jsx("h2",{className:"text-xl font-bold",children:"Debug Panel"}),M.jsxs("div",{className:"flex gap-2",children:[M.jsx(Fn,{variant:A?"default":"outline",onClick:()=>S(!A),className:"text-sm",children:A?"Auto-refresh ON":"Auto-refresh OFF"}),M.jsx(Fn,{onClick:b,className:"text-sm",children:"Refresh"}),M.jsx(Fn,{onClick:N,variant:"outline",className:"text-sm bg-red-50 hover:bg-red-100 text-red-700 border-red-300",children:"🗑️ Limpar Tudo"}),M.jsx(Fn,{onClick:t,variant:"outline",className:"text-sm",children:"×"})]})]}),M.jsxs("div",{className:"flex border-b",children:[M.jsxs("button",{className:`px-4 py-2 ${h==="logs"?"bg-blue-100 border-b-2 border-blue-500":""}`,onClick:()=>y("logs"),children:["Logs (",n.length,")"]}),M.jsxs("button",{className:`px-4 py-2 ${h==="errors"?"bg-red-100 border-b-2 border-red-500":""}`,onClick:()=>y("errors"),children:["Errors (",r.length,")"]}),M.jsx("button",{className:`px-4 py-2 ${h==="status"?"bg-green-100 border-b-2 border-green-500":""}`,onClick:()=>y("status"),children:"Status"})]}),M.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[h==="logs"&&M.jsxs("div",{children:[M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsx("h3",{className:"font-semibold",children:"Application Logs"}),M.jsx(Fn,{onClick:x,variant:"outline",className:"text-sm",children:"Clear Logs"})]}),M.jsx("div",{className:"space-y-2 font-mono text-sm",children:n.map((G,$)=>M.jsxs("div",{className:`p-2 rounded border-l-4 ${G.level==="error"?"border-red-500 bg-red-50":G.level==="warn"?"border-yellow-500 bg-yellow-50":G.level==="debug"?"border-gray-500 bg-gray-50":"border-blue-500 bg-blue-50"}`,children:[M.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[M.jsxs("span",{children:["[",G.level.toUpperCase(),"] ",G.source]}),M.jsx("span",{children:new Date(G.timestamp).toLocaleTimeString()})]}),M.jsx("div",{className:"font-medium",children:G.message}),G.data&&M.jsx("pre",{className:"mt-1 text-xs bg-white p-2 rounded overflow-auto max-h-20",children:JSON.stringify(G.data,null,2)})]},$))})]}),h==="errors"&&M.jsxs("div",{children:[M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsx("h3",{className:"font-semibold",children:"Application Errors"}),M.jsx(Fn,{onClick:D,variant:"outline",className:"text-sm",children:"Clear Errors"})]}),M.jsx("div",{className:"space-y-2 font-mono text-sm",children:r.map((G,$)=>M.jsxs("div",{className:"p-2 rounded border-l-4 border-red-500 bg-red-50",children:[M.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[M.jsx("span",{children:"ERROR"}),M.jsx("span",{children:new Date(G.timestamp).toLocaleTimeString()})]}),M.jsx("div",{className:"font-medium text-red-800",children:G.error}),G.stack&&M.jsx("pre",{className:"mt-1 text-xs bg-white p-2 rounded overflow-auto max-h-32",children:G.stack}),G.context&&M.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-20",children:JSON.stringify(G.context,null,2)})]},$))})]}),h==="status"&&M.jsxs("div",{children:[M.jsx("h3",{className:"font-semibold mb-4",children:"Server Status"}),c&&M.jsxs("div",{className:"space-y-4",children:[M.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[M.jsxs(Yi,{className:"p-4",children:[M.jsx("h4",{className:"font-medium mb-2",children:"Server Info"}),M.jsxs("div",{className:"text-sm space-y-1",children:[M.jsxs("div",{children:["Uptime: ",((L=c.server)==null?void 0:L.uptime)||"N/A"]}),M.jsxs("div",{children:["Version: ",((P=c.server)==null?void 0:P.version)||"N/A"]}),M.jsxs("div",{children:["Platform: ",((U=c.server)==null?void 0:U.platform)||"N/A"]})]})]}),M.jsxs(Yi,{className:"p-4",children:[M.jsx("h4",{className:"font-medium mb-2",children:"Logs Summary"}),M.jsxs("div",{className:"text-sm space-y-1",children:[M.jsxs("div",{children:["Total: ",((k=c.logs)==null?void 0:k.total)||0]}),M.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[M.jsxs("div",{children:["Info: ",((B=(F=c.logs)==null?void 0:F.byLevel)==null?void 0:B.info)||0]}),M.jsxs("div",{children:["Warn: ",((Y=(q=c.logs)==null?void 0:q.byLevel)==null?void 0:Y.warn)||0]}),M.jsxs("div",{children:["Error: ",((Z=(Q=c.logs)==null?void 0:Q.byLevel)==null?void 0:Z.error)||0]}),M.jsxs("div",{children:["Debug: ",((St=(ut=c.logs)==null?void 0:ut.byLevel)==null?void 0:St.debug)||0]})]})]})]})]}),M.jsxs(Yi,{className:"p-4",children:[M.jsx("h4",{className:"font-medium mb-2",children:"Recent Errors"}),M.jsx("div",{className:"text-sm space-y-1 max-h-40 overflow-auto",children:((yt=(gt=c.errors)==null?void 0:gt.recent)==null?void 0:yt.map((G,$)=>M.jsxs("div",{className:"p-2 bg-red-50 rounded text-xs",children:[M.jsx("div",{className:"font-medium",children:G.error}),M.jsx("div",{className:"text-gray-600",children:new Date(G.timestamp).toLocaleString()})]},$)))||M.jsx("div",{className:"text-gray-500",children:"No recent errors"})})]})]})]})]})]})}):null}const hG=({isOpen:i,processInfo:t,onResume:e,onDismiss:n})=>{if(at.useEffect(()=>{if(i){const r=setTimeout(()=>{n()},3e4);return()=>clearTimeout(r)}},[i,n]),!i||!t)return null;const o=r=>{const c=Date.now()-r,f=Math.floor(c/6e4),h=Math.floor(f/60);return h>0?`há ${h}h${f%60}min`:f>0?`há ${f} minutos`:"há pouco tempo"};return M.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:M.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 border border-slate-200 dark:border-slate-700",children:[M.jsx("div",{className:"flex items-center justify-center mb-4",children:M.jsx("div",{className:"w-16 h-16 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center",children:M.jsx("svg",{className:"w-8 h-8 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),M.jsx("h3",{className:"text-xl font-bold text-center text-slate-900 dark:text-slate-100 mb-2",children:"Processo Interrompido Detectado"}),M.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/50 rounded-lg p-4 mb-6 space-y-2",children:[M.jsxs("div",{className:"flex justify-between",children:[M.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Arquivo:"}),M.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate max-w-48",children:t.fileName})]}),M.jsxs("div",{className:"flex justify-between",children:[M.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Progresso:"}),M.jsxs("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:[t.progress," páginas processadas"]})]}),M.jsxs("div",{className:"flex justify-between",children:[M.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Última fase:"}),M.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.lastStep})]}),M.jsxs("div",{className:"flex justify-between",children:[M.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Interrompido:"}),M.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:o(t.timestamp)})]})]}),M.jsxs("div",{className:"flex gap-3",children:[M.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors duration-200",children:"Ignorar"}),M.jsxs("button",{onClick:e,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[M.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8M7 7h10a2 2 0 012 2v8a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2z"})}),"Retomar Processo"]})]}),M.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center mt-3",children:"Este diálogo será fechado automaticamente em 30 segundos"})]})})},pG=()=>{const i=at.useRef(!1),[t,e]=at.useState({hasIncompleteProcess:!1,processInfo:null}),[n,o]=at.useState(!1),r=at.useCallback(()=>{var f,h,y,A,S,E;console.log("🔍 [AUTO-RESUME] Verificando processo incompleto no localStorage...");try{const b=window.localStorage.getItem("pdfProcessState");if(b){const x=JSON.parse(b);if(x.processData&&!x.processData.isCompleted&&x.processData.isProcessing){console.log("📋 [AUTO-RESUME] Processo incompleto encontrado:",{fileName:(f=x.fileInfo)==null?void 0:f.name,progress:(h=x.processData.progress)==null?void 0:h.processed,phase:(y=x.processData.progress)==null?void 0:y.phase});const D={fileName:((A=x.fileInfo)==null?void 0:A.name)||"Arquivo desconhecido",progress:((S=x.processData.progress)==null?void 0:S.processed)||0,lastStep:((E=x.processData.progress)==null?void 0:E.phase)||"Desconhecido",timestamp:x.timestamp||Date.now()};return e({hasIncompleteProcess:!0,processInfo:D}),setTimeout(()=>{console.log("💬 [AUTO-RESUME] Exibindo diálogo de retomada..."),o(!0),setTimeout(async()=>{try{console.log("🔄 [AUTO-RESUME] Iniciando continuação automática...");const N=new CustomEvent("autoResumeProcess",{detail:{processInfo:D}});window.dispatchEvent(N)}catch(N){console.error("Erro no auto-resume:",N)}},3e3)},1e3),!0}else console.log("✅ [AUTO-RESUME] Nenhum processo incompleto encontrado")}else console.log("📭 [AUTO-RESUME] localStorage vazio - nenhum estado salvo")}catch(b){console.error("❌ [AUTO-RESUME] Erro ao verificar processo incompleto:",b)}return e({hasIncompleteProcess:!1,processInfo:null}),!1},[]),u=at.useCallback(()=>{try{const f=window.localStorage.getItem("pdfProcessState");if(f){const h=JSON.parse(f);h.processData&&(h.processData.isCompleted=!0,h.processData.isProcessing=!1,window.localStorage.setItem("pdfProcessState",JSON.stringify(h)))}}catch(f){console.error("Erro ao marcar processo como finalizado:",f)}},[]),c=at.useCallback(()=>{console.log("🔄 [AUTO-RESUME] Fechando diálogo de retomada..."),console.log("🔄 [AUTO-RESUME] didMountRef.current:",i.current),e({hasIncompleteProcess:!1,processInfo:null}),o(!1),console.log("✅ [AUTO-RESUME] Diálogo fechado - estado limpo")},[]);return at.useEffect(()=>{if(!i.current){i.current=!0,console.log("🔄 [AUTO-RESUME] Primeira verificação de processo incompleto...");const f=setTimeout(()=>{r()},500);return()=>clearTimeout(f)}},[r]),{autoResumeState:t,showResumeDialog:n,setShowResumeDialog:o,checkForIncompleteProcess:r,markProcessAsCompleted:u,dismissIncompleteProcess:c}},gG=()=>{const[i,t]=at.useState([]),e=On.getInstance(),n=at.useCallback(async()=>{try{console.log("Tentando buscar logs do servidor debug...");const o=await e.getLogs({limit:10});if(console.log("Resposta do servidor:",o),o!=null&&o.logs){const r=o.logs.map(u=>`[${new Date(u.timestamp).toLocaleTimeString()}] ${u.level.toUpperCase()}: ${u.message}`);t(r)}else t(["ℹ️ Nenhum log encontrado no servidor"])}catch(o){console.error("Erro ao buscar logs:",o),t(["❌ Erro ao conectar com servidor de debug","🔧 Verifique se o servidor backend está rodando na porta 3001",`⚠️ Erro detalhado: ${o instanceof Error?o.message:String(o)}`])}},[e]);return at.useEffect(()=>{n();const o=setInterval(n,2e3);return()=>clearInterval(o)},[n]),{logs:i,refreshLogs:n}};function mG(){const[i,t]=at.useState("ocr"),[e,n]=at.useState("AIzaSyClTdMj-LJS0K_Uwcmyw1PbbytaTgru_cU"),[o,r]=at.useState(!1),[u,c]=at.useState(!1),f=at.useMemo(()=>new On,[]);at.useEffect(()=>{e&&Zx(e)},[e]);const[h,y]=at.useState(null),{results:A=[],processPdf:S,isProcessing:E,isReformatting:b,footnoteAnalysis:x,formattedText:D,progress:N,error:L,clear:P,resumeFromLocalStorage:U,continueProcessingFromState:k,processingMessage:F,reformattingTimer:B,currentStatus:q,hasSavedState:Y}=lG(),{autoResumeState:Q,showResumeDialog:Z,markProcessAsCompleted:ut,dismissIncompleteProcess:St}=pG(),{logs:gt}=gG();at.useEffect(()=>{On.getInstance().log("info","🚀 PDF OCR Pro iniciado",null,"App").catch(console.error)},[]);const[yt,G]=at.useState(0),[$,rt]=at.useState("summary"),[vt,V]=at.useState(!1),j=()=>{const[Ht,Hn]=at.useState(""),[xn,Xl]=at.useState(()=>localStorage.getItem("selectedModel")||"gemini-2.5-flash"),[Oe,ay]=at.useState("Hello world"),[sd,pp]=at.useState("{}"),[lr,gp]=at.useState(""),[od,mp]=at.useState(null),[yp,Xo]=at.useState(!1),_n=async()=>{mp(null),gp(""),Xo(!0),Zx(Ht);try{const xe=JSON.parse(sd||"{}"),wn=await id.generateContent({model:xn,contents:Oe,config:xe});gp(wn.text)}catch(xe){mp(xe.message||String(xe))}finally{Xo(!1)}};return M.jsxs(Yi,{className:"max-w-xl mx-auto p-6 space-y-4 overflow-y-auto max-h-[70vh]",children:[M.jsx("h2",{className:"text-2xl font-bold",children:"LLM API Tester"}),M.jsxs("div",{className:"flex flex-col",children:[M.jsx("label",{className:"mb-1 font-medium",children:"API Key"}),M.jsx("input",{className:"border rounded px-3 py-2",type:"password",placeholder:"Enter API Key",value:Ht,onChange:xe=>Hn(xe.target.value)})]}),M.jsxs("div",{className:"flex flex-col",children:[M.jsx("label",{className:"mb-1 font-medium",children:"Model"}),M.jsxs("select",{className:"border rounded px-3 py-2",value:xn,onChange:xe=>Xl(xe.target.value),children:[M.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash"}),M.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro"})]})]}),M.jsxs("div",{className:"flex flex-col",children:[M.jsx("label",{className:"mb-1 font-medium",children:"Contents"}),M.jsx("textarea",{className:"border rounded px-3 py-2 h-24",value:Oe,onChange:xe=>ay(xe.target.value)})]}),M.jsxs("div",{className:"flex flex-col",children:[M.jsx("label",{className:"mb-1 font-medium",children:"Config (JSON)"}),M.jsx("textarea",{className:"border rounded px-3 py-2 h-20 font-mono text-sm",value:sd,onChange:xe=>pp(xe.target.value)})]}),M.jsxs("div",{className:"flex space-x-2",children:[M.jsx(Fn,{onClick:_n,disabled:yp,className:"flex-1",children:yp?"Generating...":"Generate"}),M.jsx(Fn,{variant:"outline",onClick:()=>{localStorage.setItem("selectedModel",xn),alert("Model saved successfully!"),t("ocr")},className:"flex-1",children:"Save Model"})]}),od&&M.jsxs(Yi,{className:"bg-red-100 border-red-400 text-red-800 p-4",children:[M.jsx("strong",{children:"Error:"})," ",od]}),lr&&M.jsxs(Yi,{className:"bg-green-50 p-4",children:[M.jsx("h3",{className:"font-semibold mb-2",children:"Response"}),M.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:lr})]})]})},st=async()=>{var Ht,Hn;if(console.log("🔄 [AUTO-RESUME] handleResumeProcess iniciado"),Q.processInfo)try{if(await f.log("info",`🔄 Tentando retomar processo para: ${Q.processInfo.fileName}`,{progress:Q.processInfo.progress,lastStep:Q.processInfo.lastStep}),await U()){await f.log("info","✅ Estado restaurado do localStorage");const Xl=localStorage.getItem("pdfProcessState");if(Xl){const Oe=JSON.parse(Xl);Oe.fileInfo&&!Oe.processData.isCompleted&&(await f.log("info","🚀 Iniciando continuação automática do processamento..."),await k(Oe),await f.log("info","✅ Processamento continuado automaticamente!"),await f.log("info",`📊 Progresso salvo: ${((Ht=Oe.processData.progress)==null?void 0:Ht.processed)||0}/${((Hn=Oe.processData.progress)==null?void 0:Hn.total)||0} páginas`))}}else await f.log("error","❌ Não foi possível restaurar estado do localStorage")}catch(xn){console.error("Erro ao retomar processo:",xn),await f.log("error",`❌ Erro ao retomar processo: ${xn}`)}finally{console.log("🔄 [AUTO-RESUME] Fechando diálogo via dismissIncompleteProcess..."),St(),console.log("✅ [AUTO-RESUME] handleResumeProcess finalizado")}else console.log("⚠️ [AUTO-RESUME] Nenhuma informação de processo encontrada")},it=at.useCallback(()=>{console.log("❌ [AUTO-RESUME] handleDismissResume iniciado");try{On.getInstance().log("info","❌ Utilizador ignorou o processo de retomada",null,"DismissResume").catch(console.error)}catch(Ht){console.error("Erro ao registrar dismiss:",Ht)}finally{console.log("🔄 [AUTO-RESUME] Fechando diálogo via dismissIncompleteProcess..."),St(),console.log("✅ [AUTO-RESUME] handleDismissResume finalizado")}},[St]);at.useEffect(()=>{D&&!L&&ut()},[D,L,ut]),at.useEffect(()=>{D?G(4):b?G(3):E?(N.processed===N.total&&N.total>0,G(2)):G(h?1:0)},[E,b,D,h,N]),at.useEffect(()=>{V(h&&Y?Y(h):!1)},[h,Y]);const dt=at.useCallback(Ht=>{y(Ht),G(1),On.getInstance().log("info",`📄 Arquivo selecionado: ${Ht.name}`,{size:Ht.size,type:Ht.type,lastModified:Ht.lastModified},"FileSelection").catch(console.error)},[]),Nt=at.useCallback(()=>{h&&(On.getInstance().log("info",`🚀 Iniciando processamento de: ${h.name}`,{fileSize:h.size,apiKeyConfigured:!!e},"ProcessingStart").catch(console.error),S(h,!1))},[h,S,e]),Et=at.useCallback(()=>{y(null),P(),rt("summary")},[P]),kt=at.useCallback(()=>{h&&(On.getInstance().log("info",`🔄 Reprocessando do zero: ${h.name}`,{fileSize:h.size,apiKeyConfigured:!!e},"ReprocessStart").catch(console.error),S(h,!0))},[h,S,e]),Yt=at.useCallback(()=>{h&&(On.getInstance().log("info",`🔄 Continuando processo existente: ${h.name}`,{fileSize:h.size,apiKeyConfigured:!!e},"ContinueProcess").catch(console.error),S(h,!1))},[h,S,e]),_i=at.useCallback(()=>{if(!D)return;const Ht=new Blob([D],{type:"text/plain;charset=utf-8"}),Hn=URL.createObjectURL(Ht),xn=document.createElement("a");xn.href=Hn,xn.download=`${h==null?void 0:h.name.replace(/\.pdf$/i,"")}_final.txt`||"final_document.txt",document.body.appendChild(xn),xn.click(),document.body.removeChild(xn),URL.revokeObjectURL(Hn)},[D,h]),rr=["Upload","Confirm","Process","Analyze Notes","Finalize","Download"],wi=at.useMemo(()=>A.filter(Ht=>Ht.method==="AI Correction"||Ht.method==="AI OCR").map(Ht=>Ht.pageNumber),[A]),zs=()=>{if(i==="api")return M.jsx(j,{});switch(yt){case 0:return M.jsx(rB,{onFileSelect:dt});case 1:return M.jsxs("div",{className:"text-center w-full",children:[M.jsx(sw,{className:"mx-auto h-16 w-16 text-primary-500"}),M.jsx("h3",{className:"mt-2 text-lg font-medium text-slate-900 dark:text-slate-100",children:"PDF Selected"}),M.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:h==null?void 0:h.name}),M.jsxs("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:["(",((h==null?void 0:h.size)||0)/1024/1024>1?`${(((h==null?void 0:h.size)||0)/1024/1024).toFixed(2)} MB`:`${(((h==null?void 0:h.size)||0)/1024).toFixed(2)} KB`,")"]}),M.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[M.jsx(Fn,{onClick:Et,variant:"outline",children:"Change File"}),vt?M.jsxs(M.Fragment,{children:[M.jsxs(Fn,{onClick:Yt,disabled:!e,children:[M.jsx(jx,{className:"mr-2 h-4 w-4"}),"Continuar Processo"]}),M.jsxs(Fn,{onClick:kt,variant:"outline",className:"text-orange-600 border-orange-300 hover:bg-orange-50 dark:text-orange-400 dark:border-orange-600 dark:hover:bg-orange-900/20",disabled:!e,children:[M.jsx(aB,{className:"mr-2 h-4 w-4"}),"Reprocessar do Zero"]})]}):M.jsxs(Fn,{onClick:Nt,disabled:!e,children:[M.jsx(tB,{className:"mr-2 h-4 w-4"}),"Iniciar Processamento"]})]}),!e&&M.jsx("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:M.jsx("p",{className:"text-amber-800 dark:text-amber-200 text-sm",children:"⚠️ Please enter your API Key above to start processing the PDF."})})]});case 2:case 3:case 4:return M.jsxs("div",{className:"w-full space-y-6",children:[M.jsx(dG,{currentStep:yt,isProcessing:E,isReformatting:b,progress:N,footnoteAnalysis:x,pagesWithAICorrection:wi,debugLogs:gt}),M.jsx(uB,{results:A,isProcessing:E,isReformatting:b,progress:N,error:L,processingMessage:F,reformattingTimer:B,footnoteAnalysis:x,currentStatus:q})]});case 5:return M.jsxs("div",{className:"w-full h-full flex flex-col",children:[M.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700 mb-4",children:M.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[M.jsx("button",{onClick:()=>rt("summary"),className:`${$==="summary"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-200 dark:hover:border-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none`,children:"Processing Summary"}),M.jsx("button",{onClick:()=>rt("final"),className:`${$==="final"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-200 dark:hover:border-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none`,children:"Final Text"}),M.jsx("button",{onClick:()=>rt("debug"),className:`${$==="debug"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm`,children:"Debug Logs"})]})}),M.jsxs("div",{className:"flex-grow min-h-[55vh]",children:[$==="summary"&&M.jsx("div",{className:"w-full h-full flex flex-col gap-6 text-sm animate-fade-in",children:M.jsxs(Yi,{className:"p-4",children:[M.jsx("h4",{className:"font-semibold text-base mb-2 text-slate-800 dark:text-slate-100",children:"AI Correction Procedure"}),M.jsxs("p",{className:"text-slate-600 dark:text-slate-400",children:["The document was processed with an optimized strategy for speed and precision, using the ",M.jsx("strong",{className:"text-slate-900 dark:text-slate-200",children:"Gemini 2.5 Flash"})," model."]}),M.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1.5 text-slate-600 dark:text-slate-400",children:[M.jsxs("li",{children:[M.jsx("strong",{children:"Quick Extraction:"})," All text was initially extracted from the PDF's text layer for maximum speed."]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Intelligent Analysis:"})," AI analyzed the complete document to identify pages with likely extraction errors (e.g., broken tables, missing text)."]}),wi.length>0&&M.jsxs("li",{children:[M.jsx("strong",{children:"Targeted Correction:"})," Pages ",M.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:wi.join(", ")})," were reprocessed with AI to ensure maximum fidelity."]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Footnote Analysis:"}),x&&x.count>0?M.jsxs("span",{children:[" The system identified and marked ",M.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:x.count})," footnotes for formatting."]}):M.jsx("span",{children:" No footnotes were detected in the document."})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Final Formatting:"})," Text from all pages was consolidated, cleaned and reformatted by AI to generate the final document structure."]})]})]})}),$==="final"&&D&&M.jsx(uG,{text:D}),$==="debug"&&M.jsx("pre",{className:"whitespace-pre-wrap bg-gray-100 p-4 overflow-auto h-full",children:gt.join(`
`)})]})]});default:return null}};return M.jsxs(M.Fragment,{children:[M.jsxs("div",{className:"flex space-x-4 mb-4",children:[M.jsx("button",{onClick:()=>t("ocr"),className:"btn",children:"OCR App"}),M.jsx("button",{onClick:()=>t("api"),className:"btn",children:"LLM API"})]}),i==="ocr"?M.jsx("div",{className:"min-h-screen flex flex-col items-center p-4 sm:p-6 lg:p-8 font-sans",children:M.jsxs("div",{className:"w-full max-w-7xl mx-auto",children:[M.jsxs("header",{className:"text-center mb-6",children:[M.jsx("h1",{className:"text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-50",children:"PDF OCR Pro"}),M.jsx("p",{className:"mt-2 text-lg text-slate-600 dark:text-slate-400",children:"Extract and format documents from PDFs with precision."})]}),M.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[M.jsx("input",{className:"border rounded px-3 py-2 w-80",type:"password",placeholder:"Enter Google Gemini API Key",value:e,onChange:Ht=>n(Ht.target.value)}),!e&&M.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Please enter your Gemini API Key to process the PDF."})]}),M.jsxs("main",{className:"w-full",children:[M.jsx(cB,{steps:rr,currentStep:yt}),M.jsx("div",{className:"mt-8 bg-white dark:bg-slate-800/50 rounded-xl shadow-lg p-6 min-h-[400px] flex flex-col justify-center items-center ring-1 ring-slate-200 dark:ring-slate-700",children:zs()}),yt===5&&M.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[M.jsxs(Fn,{onClick:Et,variant:"outline",children:[M.jsx(jx,{className:"mr-2 h-4 w-4"}),"Process New PDF"]}),M.jsxs(Fn,{onClick:_i,children:[M.jsx(jO,{className:"mr-2 h-4 w-4"}),"Download Final .txt"]})]})]}),M.jsx("footer",{className:"text-center mt-12 text-sm text-slate-500 dark:text-slate-400",children:M.jsxs("p",{children:["© ",new Date().getFullYear()," PDF OCR Pro. Built with React & Gemini."]})})]})}):M.jsx(j,{}),M.jsx(fG,{isOpen:u,onClose:()=>c(!1)}),M.jsxs("div",{className:`fixed bottom-0 left-0 right-0 bg-gray-100 dark:bg-gray-800 border-t z-50 transition-all duration-300 ${o?"h-12":"h-64"}`,children:[M.jsxs("div",{className:"flex justify-between items-center p-3",children:[M.jsx("h3",{className:"font-semibold text-sm",children:"Debug Logs"}),M.jsx("div",{className:"flex gap-2",children:M.jsx("button",{onClick:()=>r(!o),className:"text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded",children:o?"▲ Expand":"▼ Minimize"})})]}),!o&&M.jsx("div",{className:"px-4 pb-6 overflow-auto",style:{height:"220px"},children:M.jsx("pre",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:gt.join(`
`)})})]}),M.jsx(hG,{isOpen:Z,processInfo:Q.processInfo,onResume:st,onDismiss:it})]})}const gR=document.getElementById("root");if(!gR)throw new Error("Could not find root element to mount to");const yG=$N.createRoot(gR);yG.render(M.jsx(FN.StrictMode,{children:M.jsx(mG,{})}));
