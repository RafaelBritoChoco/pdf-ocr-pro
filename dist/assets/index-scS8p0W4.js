var DN=Object.defineProperty;var Eb=i=>{throw TypeError(i)};var IN=(i,t,e)=>t in i?DN(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ot=(i,t,e)=>IN(i,typeof t!="symbol"?t+"":t,e),p0=(i,t,e)=>t.has(i)||Eb("Cannot "+e);var g=(i,t,e)=>(p0(i,t,"read from private field"),e?e.call(i):t.get(i)),w=(i,t,e)=>t.has(i)?Eb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),C=(i,t,e,n)=>(p0(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),M=(i,t,e)=>(p0(i,t,"access private method"),e);var xn=(i,t,e,n)=>({set _(o){C(i,t,o,e)},get _(){return g(i,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();function E_(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var g0={exports:{}},Zd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cb;function PN(){if(Cb)return Zd;Cb=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,o,r){var u=null;if(r!==void 0&&(u=""+r),o.key!==void 0&&(u=""+o.key),"key"in o){r={};for(var c in o)c!=="key"&&(r[c]=o[c])}else r=o;return o=r.ref,{$$typeof:i,type:n,key:u,ref:o!==void 0?o:null,props:r}}return Zd.Fragment=t,Zd.jsx=e,Zd.jsxs=e,Zd}var bb;function LN(){return bb||(bb=1,g0.exports=PN()),g0.exports}var R=LN(),m0={exports:{}},Pt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb;function kN(){if(xb)return Pt;xb=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),A=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=A&&V[A]||V["@@iterator"],typeof V=="function"?V:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function N(V,Z,st){this.props=V,this.context=Z,this.refs=x,this.updater=st||E}N.prototype.isReactComponent={},N.prototype.setState=function(V,Z){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Z,"setState")},N.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function D(){}D.prototype=N.prototype;function k(V,Z,st){this.props=V,this.context=Z,this.refs=x,this.updater=st||E}var L=k.prototype=new D;L.constructor=k,b(L,N.prototype),L.isPureReactComponent=!0;var U=Array.isArray,P={H:null,A:null,T:null,S:null,V:null},G=Object.prototype.hasOwnProperty;function F(V,Z,st,it,yt,ht){return st=ht.ref,{$$typeof:i,type:V,key:Z,ref:st!==void 0?st:null,props:ht}}function $(V,Z){return F(V.type,Z,void 0,void 0,void 0,V.props)}function X(V){return typeof V=="object"&&V!==null&&V.$$typeof===i}function et(V){var Z={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(st){return Z[st]})}var Q=/\/+/g;function ut(V,Z){return typeof V=="object"&&V!==null&&V.key!=null?et(""+V.key):Z.toString(36)}function Ct(){}function mt(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(Ct,Ct):(V.status="pending",V.then(function(Z){V.status==="pending"&&(V.status="fulfilled",V.value=Z)},function(Z){V.status==="pending"&&(V.status="rejected",V.reason=Z)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function At(V,Z,st,it,yt){var ht=typeof V;(ht==="undefined"||ht==="boolean")&&(V=null);var gt=!1;if(V===null)gt=!0;else switch(ht){case"bigint":case"string":case"number":gt=!0;break;case"object":switch(V.$$typeof){case i:case t:gt=!0;break;case y:return gt=V._init,At(gt(V._payload),Z,st,it,yt)}}if(gt)return yt=yt(V),gt=it===""?"."+ut(V,0):it,U(yt)?(st="",gt!=null&&(st=gt.replace(Q,"$&/")+"/"),At(yt,Z,st,"",function(Ue){return Ue})):yt!=null&&(X(yt)&&(yt=$(yt,st+(yt.key==null||V&&V.key===yt.key?"":(""+yt.key).replace(Q,"$&/")+"/")+gt)),Z.push(yt)),1;gt=0;var wt=it===""?".":it+":";if(U(V))for(var Vt=0;Vt<V.length;Vt++)it=V[Vt],ht=wt+ut(it,Vt),gt+=At(it,Z,st,ht,yt);else if(Vt=S(V),typeof Vt=="function")for(V=Vt.call(V),Vt=0;!(it=V.next()).done;)it=it.value,ht=wt+ut(it,Vt++),gt+=At(it,Z,st,ht,yt);else if(ht==="object"){if(typeof V.then=="function")return At(mt(V),Z,st,it,yt);throw Z=String(V),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return gt}function O(V,Z,st){if(V==null)return V;var it=[],yt=0;return At(V,it,"","",function(ht){return Z.call(st,ht,yt++)}),it}function J(V){if(V._status===-1){var Z=V._result;Z=Z(),Z.then(function(st){(V._status===0||V._status===-1)&&(V._status=1,V._result=st)},function(st){(V._status===0||V._status===-1)&&(V._status=2,V._result=st)}),V._status===-1&&(V._status=0,V._result=Z)}if(V._status===1)return V._result.default;throw V._result}var at=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function bt(){}return Pt.Children={map:O,forEach:function(V,Z,st){O(V,function(){Z.apply(this,arguments)},st)},count:function(V){var Z=0;return O(V,function(){Z++}),Z},toArray:function(V){return O(V,function(Z){return Z})||[]},only:function(V){if(!X(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Pt.Component=N,Pt.Fragment=e,Pt.Profiler=o,Pt.PureComponent=k,Pt.StrictMode=n,Pt.Suspense=f,Pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Pt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return P.H.useMemoCache(V)}},Pt.cache=function(V){return function(){return V.apply(null,arguments)}},Pt.cloneElement=function(V,Z,st){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var it=b({},V.props),yt=V.key,ht=void 0;if(Z!=null)for(gt in Z.ref!==void 0&&(ht=void 0),Z.key!==void 0&&(yt=""+Z.key),Z)!G.call(Z,gt)||gt==="key"||gt==="__self"||gt==="__source"||gt==="ref"&&Z.ref===void 0||(it[gt]=Z[gt]);var gt=arguments.length-2;if(gt===1)it.children=st;else if(1<gt){for(var wt=Array(gt),Vt=0;Vt<gt;Vt++)wt[Vt]=arguments[Vt+2];it.children=wt}return F(V.type,yt,void 0,void 0,ht,it)},Pt.createContext=function(V){return V={$$typeof:u,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:r,_context:V},V},Pt.createElement=function(V,Z,st){var it,yt={},ht=null;if(Z!=null)for(it in Z.key!==void 0&&(ht=""+Z.key),Z)G.call(Z,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(yt[it]=Z[it]);var gt=arguments.length-2;if(gt===1)yt.children=st;else if(1<gt){for(var wt=Array(gt),Vt=0;Vt<gt;Vt++)wt[Vt]=arguments[Vt+2];yt.children=wt}if(V&&V.defaultProps)for(it in gt=V.defaultProps,gt)yt[it]===void 0&&(yt[it]=gt[it]);return F(V,ht,void 0,void 0,null,yt)},Pt.createRef=function(){return{current:null}},Pt.forwardRef=function(V){return{$$typeof:c,render:V}},Pt.isValidElement=X,Pt.lazy=function(V){return{$$typeof:y,_payload:{_status:-1,_result:V},_init:J}},Pt.memo=function(V,Z){return{$$typeof:h,type:V,compare:Z===void 0?null:Z}},Pt.startTransition=function(V){var Z=P.T,st={};P.T=st;try{var it=V(),yt=P.S;yt!==null&&yt(st,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(bt,at)}catch(ht){at(ht)}finally{P.T=Z}},Pt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Pt.use=function(V){return P.H.use(V)},Pt.useActionState=function(V,Z,st){return P.H.useActionState(V,Z,st)},Pt.useCallback=function(V,Z){return P.H.useCallback(V,Z)},Pt.useContext=function(V){return P.H.useContext(V)},Pt.useDebugValue=function(){},Pt.useDeferredValue=function(V,Z){return P.H.useDeferredValue(V,Z)},Pt.useEffect=function(V,Z,st){var it=P.H;if(typeof st=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return it.useEffect(V,Z)},Pt.useId=function(){return P.H.useId()},Pt.useImperativeHandle=function(V,Z,st){return P.H.useImperativeHandle(V,Z,st)},Pt.useInsertionEffect=function(V,Z){return P.H.useInsertionEffect(V,Z)},Pt.useLayoutEffect=function(V,Z){return P.H.useLayoutEffect(V,Z)},Pt.useMemo=function(V,Z){return P.H.useMemo(V,Z)},Pt.useOptimistic=function(V,Z){return P.H.useOptimistic(V,Z)},Pt.useReducer=function(V,Z,st){return P.H.useReducer(V,Z,st)},Pt.useRef=function(V){return P.H.useRef(V)},Pt.useState=function(V){return P.H.useState(V)},Pt.useSyncExternalStore=function(V,Z,st){return P.H.useSyncExternalStore(V,Z,st)},Pt.useTransition=function(){return P.H.useTransition()},Pt.version="19.1.0",Pt}var _b;function uT(){return _b||(_b=1,m0.exports=kN()),m0.exports}var rt=uT();const UN=E_(rt);var y0={exports:{}},jd={},v0={exports:{}},A0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wb;function FN(){return wb||(wb=1,function(i){function t(O,J){var at=O.length;O.push(J);t:for(;0<at;){var bt=at-1>>>1,V=O[bt];if(0<o(V,J))O[bt]=J,O[at]=V,at=bt;else break t}}function e(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var J=O[0],at=O.pop();if(at!==J){O[0]=at;t:for(var bt=0,V=O.length,Z=V>>>1;bt<Z;){var st=2*(bt+1)-1,it=O[st],yt=st+1,ht=O[yt];if(0>o(it,at))yt<V&&0>o(ht,it)?(O[bt]=ht,O[yt]=at,bt=yt):(O[bt]=it,O[st]=at,bt=st);else if(yt<V&&0>o(ht,at))O[bt]=ht,O[yt]=at,bt=yt;else break t}}return J}function o(O,J){var at=O.sortIndex-J.sortIndex;return at!==0?at:O.id-J.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var u=Date,c=u.now();i.unstable_now=function(){return u.now()-c}}var f=[],h=[],y=1,A=null,S=3,E=!1,b=!1,x=!1,N=!1,D=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function U(O){for(var J=e(h);J!==null;){if(J.callback===null)n(h);else if(J.startTime<=O)n(h),J.sortIndex=J.expirationTime,t(f,J);else break;J=e(h)}}function P(O){if(x=!1,U(O),!b)if(e(f)!==null)b=!0,G||(G=!0,ut());else{var J=e(h);J!==null&&At(P,J.startTime-O)}}var G=!1,F=-1,$=5,X=-1;function et(){return N?!0:!(i.unstable_now()-X<$)}function Q(){if(N=!1,G){var O=i.unstable_now();X=O;var J=!0;try{t:{b=!1,x&&(x=!1,k(F),F=-1),E=!0;var at=S;try{e:{for(U(O),A=e(f);A!==null&&!(A.expirationTime>O&&et());){var bt=A.callback;if(typeof bt=="function"){A.callback=null,S=A.priorityLevel;var V=bt(A.expirationTime<=O);if(O=i.unstable_now(),typeof V=="function"){A.callback=V,U(O),J=!0;break e}A===e(f)&&n(f),U(O)}else n(f);A=e(f)}if(A!==null)J=!0;else{var Z=e(h);Z!==null&&At(P,Z.startTime-O),J=!1}}break t}finally{A=null,S=at,E=!1}J=void 0}}finally{J?ut():G=!1}}}var ut;if(typeof L=="function")ut=function(){L(Q)};else if(typeof MessageChannel<"u"){var Ct=new MessageChannel,mt=Ct.port2;Ct.port1.onmessage=Q,ut=function(){mt.postMessage(null)}}else ut=function(){D(Q,0)};function At(O,J){F=D(function(){O(i.unstable_now())},J)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(O){O.callback=null},i.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<O?Math.floor(1e3/O):5},i.unstable_getCurrentPriorityLevel=function(){return S},i.unstable_next=function(O){switch(S){case 1:case 2:case 3:var J=3;break;default:J=S}var at=S;S=J;try{return O()}finally{S=at}},i.unstable_requestPaint=function(){N=!0},i.unstable_runWithPriority=function(O,J){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var at=S;S=O;try{return J()}finally{S=at}},i.unstable_scheduleCallback=function(O,J,at){var bt=i.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?bt+at:bt):at=bt,O){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=at+V,O={id:y++,callback:J,priorityLevel:O,startTime:at,expirationTime:V,sortIndex:-1},at>bt?(O.sortIndex=at,t(h,O),e(f)===null&&O===e(h)&&(x?(k(F),F=-1):x=!0,At(P,at-bt))):(O.sortIndex=V,t(f,O),b||E||(b=!0,G||(G=!0,ut()))),O},i.unstable_shouldYield=et,i.unstable_wrapCallback=function(O){var J=S;return function(){var at=S;S=J;try{return O.apply(this,arguments)}finally{S=at}}}}(A0)),A0}var Mb;function ON(){return Mb||(Mb=1,v0.exports=FN()),v0.exports}var T0={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rb;function BN(){if(Rb)return mn;Rb=1;var i=uT();function t(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},o=Symbol.for("react.portal");function r(f,h,y){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:A==null?null:""+A,children:f,containerInfo:h,implementation:y}}var u=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,mn.createPortal=function(f,h){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return r(f,h,null,y)},mn.flushSync=function(f){var h=u.T,y=n.p;try{if(u.T=null,n.p=2,f)return f()}finally{u.T=h,n.p=y,n.d.f()}},mn.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(f,h))},mn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},mn.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var y=h.as,A=c(y,h.crossOrigin),S=typeof h.integrity=="string"?h.integrity:void 0,E=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;y==="style"?n.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:A,integrity:S,fetchPriority:E}):y==="script"&&n.d.X(f,{crossOrigin:A,integrity:S,fetchPriority:E,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},mn.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var y=c(h.as,h.crossOrigin);n.d.M(f,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(f)},mn.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var y=h.as,A=c(y,h.crossOrigin);n.d.L(f,y,{crossOrigin:A,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},mn.preloadModule=function(f,h){if(typeof f=="string")if(h){var y=c(h.as,h.crossOrigin);n.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(f)},mn.requestFormReset=function(f){n.d.r(f)},mn.unstable_batchedUpdates=function(f,h){return f(h)},mn.useFormState=function(f,h,y){return u.H.useFormState(f,h,y)},mn.useFormStatus=function(){return u.H.useHostTransitionStatus()},mn.version="19.1.0",mn}var Nb;function GN(){if(Nb)return T0.exports;Nb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),T0.exports=BN(),T0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Db;function VN(){if(Db)return jd;Db=1;var i=ON(),t=uT(),e=GN();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function r(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function u(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function c(s){if(r(s)!==s)throw Error(n(188))}function f(s){var a=s.alternate;if(!a){if(a=r(s),a===null)throw Error(n(188));return a!==s?null:s}for(var l=s,m=a;;){var v=l.return;if(v===null)break;var T=v.alternate;if(T===null){if(m=v.return,m!==null){l=m;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===l)return c(v),s;if(T===m)return c(v),a;T=T.sibling}throw Error(n(188))}if(l.return!==m.return)l=v,m=T;else{for(var _=!1,I=v.child;I;){if(I===l){_=!0,l=v,m=T;break}if(I===m){_=!0,m=v,l=T;break}I=I.sibling}if(!_){for(I=T.child;I;){if(I===l){_=!0,l=T,m=v;break}if(I===m){_=!0,m=T,l=v;break}I=I.sibling}if(!_)throw Error(n(189))}}if(l.alternate!==m)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?s:a}function h(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=h(s),a!==null)return a;s=s.sibling}return null}var y=Object.assign,A=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),L=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),et=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function ut(s){return s===null||typeof s!="object"?null:(s=Q&&s[Q]||s["@@iterator"],typeof s=="function"?s:null)}var Ct=Symbol.for("react.client.reference");function mt(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Ct?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case N:return"Profiler";case x:return"StrictMode";case P:return"Suspense";case G:return"SuspenseList";case X:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case L:return(s.displayName||"Context")+".Provider";case k:return(s._context.displayName||"Context")+".Consumer";case U:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return a=s.displayName||null,a!==null?a:mt(s.type)||"Memo";case $:a=s._payload,s=s._init;try{return mt(s(a))}catch{}}return null}var At=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,at={pending:!1,data:null,method:null,action:null},bt=[],V=-1;function Z(s){return{current:s}}function st(s){0>V||(s.current=bt[V],bt[V]=null,V--)}function it(s,a){V++,bt[V]=s.current,s.current=a}var yt=Z(null),ht=Z(null),gt=Z(null),wt=Z(null);function Vt(s,a){switch(it(gt,a),it(ht,s),it(yt,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?WC(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=WC(a),s=QC(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}st(yt),it(yt,s)}function Ue(){st(yt),st(ht),st(gt)}function ar(s){s.memoizedState!==null&&it(wt,s);var a=yt.current,l=QC(a,s.type);a!==l&&(it(ht,s),it(yt,l))}function $i(s){ht.current===s&&(st(yt),st(ht)),wt.current===s&&(st(wt),Xd._currentValue=at)}var Gs=Object.prototype.hasOwnProperty,Vs=i.unstable_scheduleCallback,$o=i.unstable_cancelCallback,dp=i.unstable_shouldYield,fp=i.unstable_requestPaint,Xn=i.unstable_now,hp=i.unstable_getCurrentPriorityLevel,pp=i.unstable_ImmediatePriority,Cn=i.unstable_UserBlockingPriority,$l=i.unstable_NormalPriority,f1=i.unstable_LowPriority,IT=i.unstable_IdlePriority,h1=i.log,p1=i.unstable_setDisableYieldValue,ed=null,Jn=null;function Yo(s){if(typeof h1=="function"&&p1(s),Jn&&typeof Jn.setStrictMode=="function")try{Jn.setStrictMode(ed,s)}catch{}}var Kn=Math.clz32?Math.clz32:y1,g1=Math.log,m1=Math.LN2;function y1(s){return s>>>=0,s===0?32:31-(g1(s)/m1|0)|0}var gp=256,mp=4194304;function rr(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function yp(s,a,l){var m=s.pendingLanes;if(m===0)return 0;var v=0,T=s.suspendedLanes,_=s.pingedLanes;s=s.warmLanes;var I=m&134217727;return I!==0?(m=I&~T,m!==0?v=rr(m):(_&=I,_!==0?v=rr(_):l||(l=I&~s,l!==0&&(v=rr(l))))):(I=m&~T,I!==0?v=rr(I):_!==0?v=rr(_):l||(l=m&~s,l!==0&&(v=rr(l)))),v===0?0:a!==0&&a!==v&&(a&T)===0&&(T=v&-v,l=a&-a,T>=l||T===32&&(l&4194048)!==0)?a:v}function nd(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function v1(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PT(){var s=gp;return gp<<=1,(gp&4194048)===0&&(gp=256),s}function LT(){var s=mp;return mp<<=1,(mp&62914560)===0&&(mp=4194304),s}function iy(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function id(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function A1(s,a,l,m,v,T){var _=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,B=s.expirationTimes,Y=s.hiddenUpdates;for(l=_&~l;0<l;){var j=31-Kn(l),nt=1<<j;I[j]=0,B[j]=-1;var K=Y[j];if(K!==null)for(Y[j]=null,j=0;j<K.length;j++){var W=K[j];W!==null&&(W.lane&=-536870913)}l&=~nt}m!==0&&kT(s,m,0),T!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=T&~(_&~a))}function kT(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var m=31-Kn(a);s.entangledLanes|=a,s.entanglements[m]=s.entanglements[m]|1073741824|l&4194090}function UT(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var m=31-Kn(l),v=1<<m;v&a|s[m]&a&&(s[m]|=a),l&=~v}}function sy(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function oy(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function FT(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:mb(s.type))}function T1(s,a){var l=J.p;try{return J.p=s,a()}finally{J.p=l}}var Xo=Math.random().toString(36).slice(2),pn="__reactFiber$"+Xo,Un="__reactProps$"+Xo,Yl="__reactContainer$"+Xo,ay="__reactEvents$"+Xo,S1="__reactListeners$"+Xo,E1="__reactHandles$"+Xo,OT="__reactResources$"+Xo,sd="__reactMarker$"+Xo;function ry(s){delete s[pn],delete s[Un],delete s[ay],delete s[S1],delete s[E1]}function Xl(s){var a=s[pn];if(a)return a;for(var l=s.parentNode;l;){if(a=l[Yl]||l[pn]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=eb(s);s!==null;){if(l=s[pn])return l;s=eb(s)}return a}s=l,l=s.parentNode}return null}function Jl(s){if(s=s[pn]||s[Yl]){var a=s.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return s}return null}function od(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function Kl(s){var a=s[OT];return a||(a=s[OT]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ze(s){s[sd]=!0}var BT=new Set,GT={};function lr(s,a){Wl(s,a),Wl(s+"Capture",a)}function Wl(s,a){for(GT[s]=a,s=0;s<a.length;s++)BT.add(a[s])}var C1=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),VT={},HT={};function b1(s){return Gs.call(HT,s)?!0:Gs.call(VT,s)?!1:C1.test(s)?HT[s]=!0:(VT[s]=!0,!1)}function vp(s,a,l){if(b1(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var m=a.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function Ap(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function Hs(s,a,l,m){if(m===null)s.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+m)}}var ly,qT;function Ql(s){if(ly===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);ly=a&&a[1]||"",qT=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ly+s+qT}var uy=!1;function cy(s,a){if(!s||uy)return"";uy=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(a){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(W){var K=W}Reflect.construct(s,[],nt)}else{try{nt.call()}catch(W){K=W}s.call(nt.prototype)}}else{try{throw Error()}catch(W){K=W}(nt=s())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(W){if(W&&K&&typeof W.stack=="string")return[W.stack,K.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),_=T[0],I=T[1];if(_&&I){var B=_.split(`
`),Y=I.split(`
`);for(v=m=0;m<B.length&&!B[m].includes("DetermineComponentFrameRoot");)m++;for(;v<Y.length&&!Y[v].includes("DetermineComponentFrameRoot");)v++;if(m===B.length||v===Y.length)for(m=B.length-1,v=Y.length-1;1<=m&&0<=v&&B[m]!==Y[v];)v--;for(;1<=m&&0<=v;m--,v--)if(B[m]!==Y[v]){if(m!==1||v!==1)do if(m--,v--,0>v||B[m]!==Y[v]){var j=`
`+B[m].replace(" at new "," at ");return s.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",s.displayName)),j}while(1<=m&&0<=v);break}}}finally{uy=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Ql(l):""}function x1(s){switch(s.tag){case 26:case 27:case 5:return Ql(s.type);case 16:return Ql("Lazy");case 13:return Ql("Suspense");case 19:return Ql("SuspenseList");case 0:case 15:return cy(s.type,!1);case 11:return cy(s.type.render,!1);case 1:return cy(s.type,!0);case 31:return Ql("Activity");default:return""}}function zT(s){try{var a="";do a+=x1(s),s=s.return;while(s);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Ci(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $T(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function _1(s){var a=$T(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),m=""+s[a];if(!s.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var v=l.get,T=l.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return v.call(this)},set:function(_){m=""+_,T.call(this,_)}}),Object.defineProperty(s,a,{enumerable:l.enumerable}),{getValue:function(){return m},setValue:function(_){m=""+_},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Tp(s){s._valueTracker||(s._valueTracker=_1(s))}function YT(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),m="";return s&&(m=$T(s)?s.checked?"true":"false":s.value),s=m,s!==l?(a.setValue(s),!0):!1}function Sp(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var w1=/[\n"\\]/g;function bi(s){return s.replace(w1,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function dy(s,a,l,m,v,T,_,I){s.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?s.type=_:s.removeAttribute("type"),a!=null?_==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Ci(a)):s.value!==""+Ci(a)&&(s.value=""+Ci(a)):_!=="submit"&&_!=="reset"||s.removeAttribute("value"),a!=null?fy(s,_,Ci(a)):l!=null?fy(s,_,Ci(l)):m!=null&&s.removeAttribute("value"),v==null&&T!=null&&(s.defaultChecked=!!T),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+Ci(I):s.removeAttribute("name")}function XT(s,a,l,m,v,T,_,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),a!=null||l!=null){if(!(T!=="submit"&&T!=="reset"||a!=null))return;l=l!=null?""+Ci(l):"",a=a!=null?""+Ci(a):l,I||a===s.value||(s.value=a),s.defaultValue=a}m=m??v,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=I?s.checked:!!m,s.defaultChecked=!!m,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.name=_)}function fy(s,a,l){a==="number"&&Sp(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Zl(s,a,l,m){if(s=s.options,a){a={};for(var v=0;v<l.length;v++)a["$"+l[v]]=!0;for(l=0;l<s.length;l++)v=a.hasOwnProperty("$"+s[l].value),s[l].selected!==v&&(s[l].selected=v),v&&m&&(s[l].defaultSelected=!0)}else{for(l=""+Ci(l),a=null,v=0;v<s.length;v++){if(s[v].value===l){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}a!==null||s[v].disabled||(a=s[v])}a!==null&&(a.selected=!0)}}function JT(s,a,l){if(a!=null&&(a=""+Ci(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+Ci(l):""}function KT(s,a,l,m){if(a==null){if(m!=null){if(l!=null)throw Error(n(92));if(At(m)){if(1<m.length)throw Error(n(93));m=m[0]}l=m}l==null&&(l=""),a=l}l=Ci(a),s.defaultValue=l,m=s.textContent,m===l&&m!==""&&m!==null&&(s.value=m)}function jl(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var M1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function WT(s,a,l){var m=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?m?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":m?s.setProperty(a,l):typeof l!="number"||l===0||M1.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function QT(s,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,l!=null){for(var m in l)!l.hasOwnProperty(m)||a!=null&&a.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var v in a)m=a[v],a.hasOwnProperty(v)&&l[v]!==m&&WT(s,v,m)}else for(var T in a)a.hasOwnProperty(T)&&WT(s,T,a[T])}function hy(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var R1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),N1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ep(s){return N1.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var py=null;function gy(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var tu=null,eu=null;function ZT(s){var a=Jl(s);if(a&&(s=a.stateNode)){var l=s[Un]||null;t:switch(s=a.stateNode,a.type){case"input":if(dy(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+bi(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var m=l[a];if(m!==s&&m.form===s.form){var v=m[Un]||null;if(!v)throw Error(n(90));dy(m,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<l.length;a++)m=l[a],m.form===s.form&&YT(m)}break t;case"textarea":JT(s,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&Zl(s,!!l.multiple,a,!1)}}}var my=!1;function jT(s,a,l){if(my)return s(a,l);my=!0;try{var m=s(a);return m}finally{if(my=!1,(tu!==null||eu!==null)&&(rg(),tu&&(a=tu,s=eu,eu=tu=null,ZT(a),s)))for(a=0;a<s.length;a++)ZT(s[a])}}function ad(s,a){var l=s.stateNode;if(l===null)return null;var m=l[Un]||null;if(m===null)return null;l=m[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break t;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var qs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yy=!1;if(qs)try{var rd={};Object.defineProperty(rd,"passive",{get:function(){yy=!0}}),window.addEventListener("test",rd,rd),window.removeEventListener("test",rd,rd)}catch{yy=!1}var Jo=null,vy=null,Cp=null;function tS(){if(Cp)return Cp;var s,a=vy,l=a.length,m,v="value"in Jo?Jo.value:Jo.textContent,T=v.length;for(s=0;s<l&&a[s]===v[s];s++);var _=l-s;for(m=1;m<=_&&a[l-m]===v[T-m];m++);return Cp=v.slice(s,1<m?1-m:void 0)}function bp(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function xp(){return!0}function eS(){return!1}function Fn(s){function a(l,m,v,T,_){this._reactName=l,this._targetInst=v,this.type=m,this.nativeEvent=T,this.target=_,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?xp:eS,this.isPropagationStopped=eS,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=xp)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=xp)},persist:function(){},isPersistent:xp}),a}var ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_p=Fn(ur),ld=y({},ur,{view:0,detail:0}),D1=Fn(ld),Ay,Ty,ud,wp=y({},ld,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ey,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ud&&(ud&&s.type==="mousemove"?(Ay=s.screenX-ud.screenX,Ty=s.screenY-ud.screenY):Ty=Ay=0,ud=s),Ay)},movementY:function(s){return"movementY"in s?s.movementY:Ty}}),nS=Fn(wp),I1=y({},wp,{dataTransfer:0}),P1=Fn(I1),L1=y({},ld,{relatedTarget:0}),Sy=Fn(L1),k1=y({},ur,{animationName:0,elapsedTime:0,pseudoElement:0}),U1=Fn(k1),F1=y({},ur,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),O1=Fn(F1),B1=y({},ur,{data:0}),iS=Fn(B1),G1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q1(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=H1[s])?!!a[s]:!1}function Ey(){return q1}var z1=y({},ld,{key:function(s){if(s.key){var a=G1[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=bp(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?V1[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ey,charCode:function(s){return s.type==="keypress"?bp(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?bp(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),$1=Fn(z1),Y1=y({},wp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sS=Fn(Y1),X1=y({},ld,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ey}),J1=Fn(X1),K1=y({},ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),W1=Fn(K1),Q1=y({},wp,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Z1=Fn(Q1),j1=y({},ur,{newState:0,oldState:0}),tR=Fn(j1),eR=[9,13,27,32],Cy=qs&&"CompositionEvent"in window,cd=null;qs&&"documentMode"in document&&(cd=document.documentMode);var nR=qs&&"TextEvent"in window&&!cd,oS=qs&&(!Cy||cd&&8<cd&&11>=cd),aS=" ",rS=!1;function lS(s,a){switch(s){case"keyup":return eR.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uS(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var nu=!1;function iR(s,a){switch(s){case"compositionend":return uS(a);case"keypress":return a.which!==32?null:(rS=!0,aS);case"textInput":return s=a.data,s===aS&&rS?null:s;default:return null}}function sR(s,a){if(nu)return s==="compositionend"||!Cy&&lS(s,a)?(s=tS(),Cp=vy=Jo=null,nu=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return oS&&a.locale!=="ko"?null:a.data;default:return null}}var oR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cS(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!oR[s.type]:a==="textarea"}function dS(s,a,l,m){tu?eu?eu.push(m):eu=[m]:tu=m,a=hg(a,"onChange"),0<a.length&&(l=new _p("onChange","change",null,l,m),s.push({event:l,listeners:a}))}var dd=null,fd=null;function aR(s){$C(s,0)}function Mp(s){var a=od(s);if(YT(a))return s}function fS(s,a){if(s==="change")return a}var hS=!1;if(qs){var by;if(qs){var xy="oninput"in document;if(!xy){var pS=document.createElement("div");pS.setAttribute("oninput","return;"),xy=typeof pS.oninput=="function"}by=xy}else by=!1;hS=by&&(!document.documentMode||9<document.documentMode)}function gS(){dd&&(dd.detachEvent("onpropertychange",mS),fd=dd=null)}function mS(s){if(s.propertyName==="value"&&Mp(fd)){var a=[];dS(a,fd,s,gy(s)),jT(aR,a)}}function rR(s,a,l){s==="focusin"?(gS(),dd=a,fd=l,dd.attachEvent("onpropertychange",mS)):s==="focusout"&&gS()}function lR(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Mp(fd)}function uR(s,a){if(s==="click")return Mp(a)}function cR(s,a){if(s==="input"||s==="change")return Mp(a)}function dR(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Wn=typeof Object.is=="function"?Object.is:dR;function hd(s,a){if(Wn(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),m=Object.keys(a);if(l.length!==m.length)return!1;for(m=0;m<l.length;m++){var v=l[m];if(!Gs.call(a,v)||!Wn(s[v],a[v]))return!1}return!0}function yS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function vS(s,a){var l=yS(s);s=0;for(var m;l;){if(l.nodeType===3){if(m=s+l.textContent.length,s<=a&&m>=a)return{node:l,offset:a-s};s=m}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=yS(l)}}function AS(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?AS(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function TS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Sp(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=Sp(s.document)}return a}function _y(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var fR=qs&&"documentMode"in document&&11>=document.documentMode,iu=null,wy=null,pd=null,My=!1;function SS(s,a,l){var m=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;My||iu==null||iu!==Sp(m)||(m=iu,"selectionStart"in m&&_y(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),pd&&hd(pd,m)||(pd=m,m=hg(wy,"onSelect"),0<m.length&&(a=new _p("onSelect","select",null,a,l),s.push({event:a,listeners:m}),a.target=iu)))}function cr(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var su={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionrun:cr("Transition","TransitionRun"),transitionstart:cr("Transition","TransitionStart"),transitioncancel:cr("Transition","TransitionCancel"),transitionend:cr("Transition","TransitionEnd")},Ry={},ES={};qs&&(ES=document.createElement("div").style,"AnimationEvent"in window||(delete su.animationend.animation,delete su.animationiteration.animation,delete su.animationstart.animation),"TransitionEvent"in window||delete su.transitionend.transition);function dr(s){if(Ry[s])return Ry[s];if(!su[s])return s;var a=su[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in ES)return Ry[s]=a[l];return s}var CS=dr("animationend"),bS=dr("animationiteration"),xS=dr("animationstart"),hR=dr("transitionrun"),pR=dr("transitionstart"),gR=dr("transitioncancel"),_S=dr("transitionend"),wS=new Map,Ny="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ny.push("scrollEnd");function Yi(s,a){wS.set(s,a),lr(a,[s])}var MS=new WeakMap;function xi(s,a){if(typeof s=="object"&&s!==null){var l=MS.get(s);return l!==void 0?l:(a={value:s,source:a,stack:zT(a)},MS.set(s,a),a)}return{value:s,source:a,stack:zT(a)}}var _i=[],ou=0,Dy=0;function Rp(){for(var s=ou,a=Dy=ou=0;a<s;){var l=_i[a];_i[a++]=null;var m=_i[a];_i[a++]=null;var v=_i[a];_i[a++]=null;var T=_i[a];if(_i[a++]=null,m!==null&&v!==null){var _=m.pending;_===null?v.next=v:(v.next=_.next,_.next=v),m.pending=v}T!==0&&RS(l,v,T)}}function Np(s,a,l,m){_i[ou++]=s,_i[ou++]=a,_i[ou++]=l,_i[ou++]=m,Dy|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function Iy(s,a,l,m){return Np(s,a,l,m),Dp(s)}function au(s,a){return Np(s,null,null,a),Dp(s)}function RS(s,a,l){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l);for(var v=!1,T=s.return;T!==null;)T.childLanes|=l,m=T.alternate,m!==null&&(m.childLanes|=l),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(v=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,v&&a!==null&&(v=31-Kn(l),s=T.hiddenUpdates,m=s[v],m===null?s[v]=[a]:m.push(a),a.lane=l|536870912),T):null}function Dp(s){if(50<Bd)throw Bd=0,Ov=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ru={};function mR(s,a,l,m){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(s,a,l,m){return new mR(s,a,l,m)}function Py(s){return s=s.prototype,!(!s||!s.isReactComponent)}function zs(s,a){var l=s.alternate;return l===null?(l=Qn(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function NS(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Ip(s,a,l,m,v,T){var _=0;if(m=s,typeof s=="function")Py(s)&&(_=1);else if(typeof s=="string")_=vN(s,l,yt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case X:return s=Qn(31,l,a,v),s.elementType=X,s.lanes=T,s;case b:return fr(l.children,v,T,a);case x:_=8,v|=24;break;case N:return s=Qn(12,l,a,v|2),s.elementType=N,s.lanes=T,s;case P:return s=Qn(13,l,a,v),s.elementType=P,s.lanes=T,s;case G:return s=Qn(19,l,a,v),s.elementType=G,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:case L:_=10;break t;case k:_=9;break t;case U:_=11;break t;case F:_=14;break t;case $:_=16,m=null;break t}_=29,l=Error(n(130,s===null?"null":typeof s,"")),m=null}return a=Qn(_,l,a,v),a.elementType=s,a.type=m,a.lanes=T,a}function fr(s,a,l,m){return s=Qn(7,s,m,a),s.lanes=l,s}function Ly(s,a,l){return s=Qn(6,s,null,a),s.lanes=l,s}function ky(s,a,l){return a=Qn(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var lu=[],uu=0,Pp=null,Lp=0,wi=[],Mi=0,hr=null,$s=1,Ys="";function pr(s,a){lu[uu++]=Lp,lu[uu++]=Pp,Pp=s,Lp=a}function DS(s,a,l){wi[Mi++]=$s,wi[Mi++]=Ys,wi[Mi++]=hr,hr=s;var m=$s;s=Ys;var v=32-Kn(m)-1;m&=~(1<<v),l+=1;var T=32-Kn(a)+v;if(30<T){var _=v-v%5;T=(m&(1<<_)-1).toString(32),m>>=_,v-=_,$s=1<<32-Kn(a)+v|l<<v|m,Ys=T+s}else $s=1<<T|l<<v|m,Ys=s}function Uy(s){s.return!==null&&(pr(s,1),DS(s,1,0))}function Fy(s){for(;s===Pp;)Pp=lu[--uu],lu[uu]=null,Lp=lu[--uu],lu[uu]=null;for(;s===hr;)hr=wi[--Mi],wi[Mi]=null,Ys=wi[--Mi],wi[Mi]=null,$s=wi[--Mi],wi[Mi]=null}var bn=null,Se=null,Xt=!1,gr=null,ds=!1,Oy=Error(n(519));function mr(s){var a=Error(n(418,""));throw yd(xi(a,s)),Oy}function IS(s){var a=s.stateNode,l=s.type,m=s.memoizedProps;switch(a[pn]=s,a[Un]=m,l){case"dialog":Bt("cancel",a),Bt("close",a);break;case"iframe":case"object":case"embed":Bt("load",a);break;case"video":case"audio":for(l=0;l<Vd.length;l++)Bt(Vd[l],a);break;case"source":Bt("error",a);break;case"img":case"image":case"link":Bt("error",a),Bt("load",a);break;case"details":Bt("toggle",a);break;case"input":Bt("invalid",a),XT(a,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Tp(a);break;case"select":Bt("invalid",a);break;case"textarea":Bt("invalid",a),KT(a,m.value,m.defaultValue,m.children),Tp(a)}l=m.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||m.suppressHydrationWarning===!0||KC(a.textContent,l)?(m.popover!=null&&(Bt("beforetoggle",a),Bt("toggle",a)),m.onScroll!=null&&Bt("scroll",a),m.onScrollEnd!=null&&Bt("scrollend",a),m.onClick!=null&&(a.onclick=pg),a=!0):a=!1,a||mr(s)}function PS(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 13:ds=!1;return;case 27:case 3:ds=!0;return;default:bn=bn.return}}function gd(s){if(s!==bn)return!1;if(!Xt)return PS(s),Xt=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||t0(s.type,s.memoizedProps)),l=!l),l&&Se&&mr(s),PS(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));t:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(a===0){Se=Ji(s.nextSibling);break t}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;s=s.nextSibling}Se=null}}else a===27?(a=Se,ca(s.type)?(s=s0,s0=null,Se=s):Se=a):Se=bn?Ji(s.stateNode.nextSibling):null;return!0}function md(){Se=bn=null,Xt=!1}function LS(){var s=gr;return s!==null&&(Gn===null?Gn=s:Gn.push.apply(Gn,s),gr=null),s}function yd(s){gr===null?gr=[s]:gr.push(s)}var By=Z(null),yr=null,Xs=null;function Ko(s,a,l){it(By,a._currentValue),a._currentValue=l}function Js(s){s._currentValue=By.current,st(By)}function Gy(s,a,l){for(;s!==null;){var m=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),s===l)break;s=s.return}}function Vy(s,a,l,m){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var T=v.dependencies;if(T!==null){var _=v.child;T=T.firstContext;t:for(;T!==null;){var I=T;T=v;for(var B=0;B<a.length;B++)if(I.context===a[B]){T.lanes|=l,I=T.alternate,I!==null&&(I.lanes|=l),Gy(T.return,l,s),m||(_=null);break t}T=I.next}}else if(v.tag===18){if(_=v.return,_===null)throw Error(n(341));_.lanes|=l,T=_.alternate,T!==null&&(T.lanes|=l),Gy(_,l,s),_=null}else _=v.child;if(_!==null)_.return=v;else for(_=v;_!==null;){if(_===s){_=null;break}if(v=_.sibling,v!==null){v.return=_.return,_=v;break}_=_.return}v=_}}function vd(s,a,l,m){s=null;for(var v=a,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var _=v.alternate;if(_===null)throw Error(n(387));if(_=_.memoizedProps,_!==null){var I=v.type;Wn(v.pendingProps.value,_.value)||(s!==null?s.push(I):s=[I])}}else if(v===wt.current){if(_=v.alternate,_===null)throw Error(n(387));_.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Xd):s=[Xd])}v=v.return}s!==null&&Vy(a,s,l,m),a.flags|=262144}function kp(s){for(s=s.firstContext;s!==null;){if(!Wn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function vr(s){yr=s,Xs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function gn(s){return kS(yr,s)}function Up(s,a){return yr===null&&vr(s),kS(s,a)}function kS(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Xs===null){if(s===null)throw Error(n(308));Xs=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Xs=Xs.next=a;return l}var yR=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,m){s.push(m)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},vR=i.unstable_scheduleCallback,AR=i.unstable_NormalPriority,Fe={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hy(){return{controller:new yR,data:new Map,refCount:0}}function Ad(s){s.refCount--,s.refCount===0&&vR(AR,function(){s.controller.abort()})}var Td=null,qy=0,cu=0,du=null;function TR(s,a){if(Td===null){var l=Td=[];qy=0,cu=$v(),du={status:"pending",value:void 0,then:function(m){l.push(m)}}}return qy++,a.then(US,US),a}function US(){if(--qy===0&&Td!==null){du!==null&&(du.status="fulfilled");var s=Td;Td=null,cu=0,du=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function SR(s,a){var l=[],m={status:"pending",value:null,reason:null,then:function(v){l.push(v)}};return s.then(function(){m.status="fulfilled",m.value=a;for(var v=0;v<l.length;v++)(0,l[v])(a)},function(v){for(m.status="rejected",m.reason=v,v=0;v<l.length;v++)(0,l[v])(void 0)}),m}var FS=O.S;O.S=function(s,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&TR(s,a),FS!==null&&FS(s,a)};var Ar=Z(null);function zy(){var s=Ar.current;return s!==null?s:le.pooledCache}function Fp(s,a){a===null?it(Ar,Ar.current):it(Ar,a.pool)}function OS(){var s=zy();return s===null?null:{parent:Fe._currentValue,pool:s}}var Sd=Error(n(460)),BS=Error(n(474)),Op=Error(n(542)),$y={then:function(){}};function GS(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Bp(){}function VS(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(Bp,Bp),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,qS(s),s;default:if(typeof a.status=="string")a.then(Bp,Bp);else{if(s=le,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(m){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=m}},function(m){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=m}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,qS(s),s}throw Ed=a,Sd}}var Ed=null;function HS(){if(Ed===null)throw Error(n(459));var s=Ed;return Ed=null,s}function qS(s){if(s===Sd||s===Op)throw Error(n(483))}var Wo=!1;function Yy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xy(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Qo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Zo(s,a,l){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Wt&2)!==0){var v=m.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),m.pending=a,a=Dp(s),RS(s,null,l),a}return Np(s,m,a,l),Dp(s)}function Cd(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var m=a.lanes;m&=s.pendingLanes,l|=m,a.lanes=l,UT(s,l)}}function Jy(s,a){var l=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,l===m)){var v=null,T=null;if(l=l.firstBaseUpdate,l!==null){do{var _={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};T===null?v=T=_:T=T.next=_,l=l.next}while(l!==null);T===null?v=T=a:T=T.next=a}else v=T=a;l={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var Ky=!1;function bd(){if(Ky){var s=du;if(s!==null)throw s}}function xd(s,a,l,m){Ky=!1;var v=s.updateQueue;Wo=!1;var T=v.firstBaseUpdate,_=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var B=I,Y=B.next;B.next=null,_===null?T=Y:_.next=Y,_=B;var j=s.alternate;j!==null&&(j=j.updateQueue,I=j.lastBaseUpdate,I!==_&&(I===null?j.firstBaseUpdate=Y:I.next=Y,j.lastBaseUpdate=B))}if(T!==null){var nt=v.baseState;_=0,j=Y=B=null,I=T;do{var K=I.lane&-536870913,W=K!==I.lane;if(W?(qt&K)===K:(m&K)===K){K!==0&&K===cu&&(Ky=!0),j!==null&&(j=j.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});t:{var Rt=s,xt=I;K=a;var ne=l;switch(xt.tag){case 1:if(Rt=xt.payload,typeof Rt=="function"){nt=Rt.call(ne,nt,K);break t}nt=Rt;break t;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=xt.payload,K=typeof Rt=="function"?Rt.call(ne,nt,K):Rt,K==null)break t;nt=y({},nt,K);break t;case 2:Wo=!0}}K=I.callback,K!==null&&(s.flags|=64,W&&(s.flags|=8192),W=v.callbacks,W===null?v.callbacks=[K]:W.push(K))}else W={lane:K,tag:I.tag,payload:I.payload,callback:I.callback,next:null},j===null?(Y=j=W,B=nt):j=j.next=W,_|=K;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;W=I,I=W.next,W.next=null,v.lastBaseUpdate=W,v.shared.pending=null}}while(!0);j===null&&(B=nt),v.baseState=B,v.firstBaseUpdate=Y,v.lastBaseUpdate=j,T===null&&(v.shared.lanes=0),aa|=_,s.lanes=_,s.memoizedState=nt}}function zS(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function $S(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)zS(l[s],a)}var fu=Z(null),Gp=Z(0);function YS(s,a){s=eo,it(Gp,s),it(fu,a),eo=s|a.baseLanes}function Wy(){it(Gp,eo),it(fu,fu.current)}function Qy(){eo=Gp.current,st(fu),st(Gp)}var jo=0,kt=null,te=null,Re=null,Vp=!1,hu=!1,Tr=!1,Hp=0,_d=0,pu=null,ER=0;function be(){throw Error(n(321))}function Zy(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!Wn(s[l],a[l]))return!1;return!0}function jy(s,a,l,m,v,T){return jo=T,kt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,O.H=s===null||s.memoizedState===null?RE:NE,Tr=!1,T=l(m,v),Tr=!1,hu&&(T=JS(a,l,m,v)),XS(s),T}function XS(s){O.H=Jp;var a=te!==null&&te.next!==null;if(jo=0,Re=te=kt=null,Vp=!1,_d=0,pu=null,a)throw Error(n(300));s===null||$e||(s=s.dependencies,s!==null&&kp(s)&&($e=!0))}function JS(s,a,l,m){kt=s;var v=0;do{if(hu&&(pu=null),_d=0,hu=!1,25<=v)throw Error(n(301));if(v+=1,Re=te=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}O.H=RR,T=a(l,m)}while(hu);return T}function CR(){var s=O.H,a=s.useState()[0];return a=typeof a.then=="function"?wd(a):a,s=s.useState()[0],(te!==null?te.memoizedState:null)!==s&&(kt.flags|=1024),a}function tv(){var s=Hp!==0;return Hp=0,s}function ev(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function nv(s){if(Vp){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Vp=!1}jo=0,Re=te=kt=null,hu=!1,_d=Hp=0,pu=null}function On(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Re===null?kt.memoizedState=Re=s:Re=Re.next=s,Re}function Ne(){if(te===null){var s=kt.alternate;s=s!==null?s.memoizedState:null}else s=te.next;var a=Re===null?kt.memoizedState:Re.next;if(a!==null)Re=a,te=s;else{if(s===null)throw kt.alternate===null?Error(n(467)):Error(n(310));te=s,s={memoizedState:te.memoizedState,baseState:te.baseState,baseQueue:te.baseQueue,queue:te.queue,next:null},Re===null?kt.memoizedState=Re=s:Re=Re.next=s}return Re}function iv(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wd(s){var a=_d;return _d+=1,pu===null&&(pu=[]),s=VS(pu,s,a),a=kt,(Re===null?a.memoizedState:Re.next)===null&&(a=a.alternate,O.H=a===null||a.memoizedState===null?RE:NE),s}function qp(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wd(s);if(s.$$typeof===L)return gn(s)}throw Error(n(438,String(s)))}function sv(s){var a=null,l=kt.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var m=kt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(a={data:m.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=iv(),kt.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),m=0;m<s;m++)l[m]=et;return a.index++,l}function Ks(s,a){return typeof a=="function"?a(s):a}function zp(s){var a=Ne();return ov(a,te,s)}function ov(s,a,l){var m=s.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var v=s.baseQueue,T=m.pending;if(T!==null){if(v!==null){var _=v.next;v.next=T.next,T.next=_}a.baseQueue=v=T,m.pending=null}if(T=s.baseState,v===null)s.memoizedState=T;else{a=v.next;var I=_=null,B=null,Y=a,j=!1;do{var nt=Y.lane&-536870913;if(nt!==Y.lane?(qt&nt)===nt:(jo&nt)===nt){var K=Y.revertLane;if(K===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),nt===cu&&(j=!0);else if((jo&K)===K){Y=Y.next,K===cu&&(j=!0);continue}else nt={lane:0,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},B===null?(I=B=nt,_=T):B=B.next=nt,kt.lanes|=K,aa|=K;nt=Y.action,Tr&&l(T,nt),T=Y.hasEagerState?Y.eagerState:l(T,nt)}else K={lane:nt,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},B===null?(I=B=K,_=T):B=B.next=K,kt.lanes|=nt,aa|=nt;Y=Y.next}while(Y!==null&&Y!==a);if(B===null?_=T:B.next=I,!Wn(T,s.memoizedState)&&($e=!0,j&&(l=du,l!==null)))throw l;s.memoizedState=T,s.baseState=_,s.baseQueue=B,m.lastRenderedState=T}return v===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function av(s){var a=Ne(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=s;var m=l.dispatch,v=l.pending,T=a.memoizedState;if(v!==null){l.pending=null;var _=v=v.next;do T=s(T,_.action),_=_.next;while(_!==v);Wn(T,a.memoizedState)||($e=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),l.lastRenderedState=T}return[T,m]}function KS(s,a,l){var m=kt,v=Ne(),T=Xt;if(T){if(l===void 0)throw Error(n(407));l=l()}else l=a();var _=!Wn((te||v).memoizedState,l);_&&(v.memoizedState=l,$e=!0),v=v.queue;var I=ZS.bind(null,m,v,s);if(Md(2048,8,I,[s]),v.getSnapshot!==a||_||Re!==null&&Re.memoizedState.tag&1){if(m.flags|=2048,gu(9,$p(),QS.bind(null,m,v,l,a),null),le===null)throw Error(n(349));T||(jo&124)!==0||WS(m,a,l)}return l}function WS(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=kt.updateQueue,a===null?(a=iv(),kt.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function QS(s,a,l,m){a.value=l,a.getSnapshot=m,jS(a)&&tE(s)}function ZS(s,a,l){return l(function(){jS(a)&&tE(s)})}function jS(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!Wn(s,l)}catch{return!0}}function tE(s){var a=au(s,2);a!==null&&ni(a,s,2)}function rv(s){var a=On();if(typeof s=="function"){var l=s;if(s=l(),Tr){Yo(!0);try{l()}finally{Yo(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:s},a}function eE(s,a,l,m){return s.baseState=l,ov(s,te,typeof m=="function"?m:Ks)}function bR(s,a,l,m,v){if(Xp(s))throw Error(n(485));if(s=a.action,s!==null){var T={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){T.listeners.push(_)}};O.T!==null?l(!0):T.isTransition=!1,m(T),l=a.pending,l===null?(T.next=a.pending=T,nE(a,T)):(T.next=l.next,a.pending=l.next=T)}}function nE(s,a){var l=a.action,m=a.payload,v=s.state;if(a.isTransition){var T=O.T,_={};O.T=_;try{var I=l(v,m),B=O.S;B!==null&&B(_,I),iE(s,a,I)}catch(Y){lv(s,a,Y)}finally{O.T=T}}else try{T=l(v,m),iE(s,a,T)}catch(Y){lv(s,a,Y)}}function iE(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(m){sE(s,a,m)},function(m){return lv(s,a,m)}):sE(s,a,l)}function sE(s,a,l){a.status="fulfilled",a.value=l,oE(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,nE(s,l)))}function lv(s,a,l){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do a.status="rejected",a.reason=l,oE(a),a=a.next;while(a!==m)}s.action=null}function oE(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function aE(s,a){return a}function rE(s,a){if(Xt){var l=le.formState;if(l!==null){t:{var m=kt;if(Xt){if(Se){e:{for(var v=Se,T=ds;v.nodeType!==8;){if(!T){v=null;break e}if(v=Ji(v.nextSibling),v===null){v=null;break e}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){Se=Ji(v.nextSibling),m=v.data==="F!";break t}}mr(m)}m=!1}m&&(a=l[0])}}return l=On(),l.memoizedState=l.baseState=a,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:aE,lastRenderedState:a},l.queue=m,l=_E.bind(null,kt,m),m.dispatch=l,m=rv(!1),T=hv.bind(null,kt,!1,m.queue),m=On(),v={state:a,dispatch:null,action:s,pending:null},m.queue=v,l=bR.bind(null,kt,v,T,l),v.dispatch=l,m.memoizedState=s,[a,l,!1]}function lE(s){var a=Ne();return uE(a,te,s)}function uE(s,a,l){if(a=ov(s,a,aE)[0],s=zp(Ks)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var m=wd(a)}catch(_){throw _===Sd?Op:_}else m=a;a=Ne();var v=a.queue,T=v.dispatch;return l!==a.memoizedState&&(kt.flags|=2048,gu(9,$p(),xR.bind(null,v,l),null)),[m,T,s]}function xR(s,a){s.action=a}function cE(s){var a=Ne(),l=te;if(l!==null)return uE(a,l,s);Ne(),a=a.memoizedState,l=Ne();var m=l.queue.dispatch;return l.memoizedState=s,[a,m,!1]}function gu(s,a,l,m){return s={tag:s,create:l,deps:m,inst:a,next:null},a=kt.updateQueue,a===null&&(a=iv(),kt.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(m=l.next,l.next=s,s.next=m,a.lastEffect=s),s}function $p(){return{destroy:void 0,resource:void 0}}function dE(){return Ne().memoizedState}function Yp(s,a,l,m){var v=On();m=m===void 0?null:m,kt.flags|=s,v.memoizedState=gu(1|a,$p(),l,m)}function Md(s,a,l,m){var v=Ne();m=m===void 0?null:m;var T=v.memoizedState.inst;te!==null&&m!==null&&Zy(m,te.memoizedState.deps)?v.memoizedState=gu(a,T,l,m):(kt.flags|=s,v.memoizedState=gu(1|a,T,l,m))}function fE(s,a){Yp(8390656,8,s,a)}function hE(s,a){Md(2048,8,s,a)}function pE(s,a){return Md(4,2,s,a)}function gE(s,a){return Md(4,4,s,a)}function mE(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function yE(s,a,l){l=l!=null?l.concat([s]):null,Md(4,4,mE.bind(null,a,s),l)}function uv(){}function vE(s,a){var l=Ne();a=a===void 0?null:a;var m=l.memoizedState;return a!==null&&Zy(a,m[1])?m[0]:(l.memoizedState=[s,a],s)}function AE(s,a){var l=Ne();a=a===void 0?null:a;var m=l.memoizedState;if(a!==null&&Zy(a,m[1]))return m[0];if(m=s(),Tr){Yo(!0);try{s()}finally{Yo(!1)}}return l.memoizedState=[m,a],m}function cv(s,a,l){return l===void 0||(jo&1073741824)!==0?s.memoizedState=a:(s.memoizedState=l,s=EC(),kt.lanes|=s,aa|=s,l)}function TE(s,a,l,m){return Wn(l,a)?l:fu.current!==null?(s=cv(s,l,m),Wn(s,a)||($e=!0),s):(jo&42)===0?($e=!0,s.memoizedState=l):(s=EC(),kt.lanes|=s,aa|=s,a)}function SE(s,a,l,m,v){var T=J.p;J.p=T!==0&&8>T?T:8;var _=O.T,I={};O.T=I,hv(s,!1,a,l);try{var B=v(),Y=O.S;if(Y!==null&&Y(I,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var j=SR(B,m);Rd(s,a,j,ei(s))}else Rd(s,a,m,ei(s))}catch(nt){Rd(s,a,{then:function(){},status:"rejected",reason:nt},ei())}finally{J.p=T,O.T=_}}function _R(){}function dv(s,a,l,m){if(s.tag!==5)throw Error(n(476));var v=EE(s).queue;SE(s,v,a,at,l===null?_R:function(){return CE(s),l(m)})}function EE(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:at,baseState:at,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:at},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function CE(s){var a=EE(s).next.queue;Rd(s,a,{},ei())}function fv(){return gn(Xd)}function bE(){return Ne().memoizedState}function xE(){return Ne().memoizedState}function wR(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=ei();s=Qo(l);var m=Zo(a,s,l);m!==null&&(ni(m,a,l),Cd(m,a,l)),a={cache:Hy()},s.payload=a;return}a=a.return}}function MR(s,a,l){var m=ei();l={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Xp(s)?wE(a,l):(l=Iy(s,a,l,m),l!==null&&(ni(l,s,m),ME(l,a,m)))}function _E(s,a,l){var m=ei();Rd(s,a,l,m)}function Rd(s,a,l,m){var v={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Xp(s))wE(a,v);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var _=a.lastRenderedState,I=T(_,l);if(v.hasEagerState=!0,v.eagerState=I,Wn(I,_))return Np(s,a,v,0),le===null&&Rp(),!1}catch{}finally{}if(l=Iy(s,a,v,m),l!==null)return ni(l,s,m),ME(l,a,m),!0}return!1}function hv(s,a,l,m){if(m={lane:2,revertLane:$v(),action:m,hasEagerState:!1,eagerState:null,next:null},Xp(s)){if(a)throw Error(n(479))}else a=Iy(s,l,m,2),a!==null&&ni(a,s,2)}function Xp(s){var a=s.alternate;return s===kt||a!==null&&a===kt}function wE(s,a){hu=Vp=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function ME(s,a,l){if((l&4194048)!==0){var m=a.lanes;m&=s.pendingLanes,l|=m,a.lanes=l,UT(s,l)}}var Jp={readContext:gn,use:qp,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useLayoutEffect:be,useInsertionEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useSyncExternalStore:be,useId:be,useHostTransitionStatus:be,useFormState:be,useActionState:be,useOptimistic:be,useMemoCache:be,useCacheRefresh:be},RE={readContext:gn,use:qp,useCallback:function(s,a){return On().memoizedState=[s,a===void 0?null:a],s},useContext:gn,useEffect:fE,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,Yp(4194308,4,mE.bind(null,a,s),l)},useLayoutEffect:function(s,a){return Yp(4194308,4,s,a)},useInsertionEffect:function(s,a){Yp(4,2,s,a)},useMemo:function(s,a){var l=On();a=a===void 0?null:a;var m=s();if(Tr){Yo(!0);try{s()}finally{Yo(!1)}}return l.memoizedState=[m,a],m},useReducer:function(s,a,l){var m=On();if(l!==void 0){var v=l(a);if(Tr){Yo(!0);try{l(a)}finally{Yo(!1)}}}else v=a;return m.memoizedState=m.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},m.queue=s,s=s.dispatch=MR.bind(null,kt,s),[m.memoizedState,s]},useRef:function(s){var a=On();return s={current:s},a.memoizedState=s},useState:function(s){s=rv(s);var a=s.queue,l=_E.bind(null,kt,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:uv,useDeferredValue:function(s,a){var l=On();return cv(l,s,a)},useTransition:function(){var s=rv(!1);return s=SE.bind(null,kt,s.queue,!0,!1),On().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var m=kt,v=On();if(Xt){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),le===null)throw Error(n(349));(qt&124)!==0||WS(m,a,l)}v.memoizedState=l;var T={value:l,getSnapshot:a};return v.queue=T,fE(ZS.bind(null,m,T,s),[s]),m.flags|=2048,gu(9,$p(),QS.bind(null,m,T,l,a),null),l},useId:function(){var s=On(),a=le.identifierPrefix;if(Xt){var l=Ys,m=$s;l=(m&~(1<<32-Kn(m)-1)).toString(32)+l,a=""+a+"R"+l,l=Hp++,0<l&&(a+="H"+l.toString(32)),a+=""}else l=ER++,a=""+a+"r"+l.toString(32)+"";return s.memoizedState=a},useHostTransitionStatus:fv,useFormState:rE,useActionState:rE,useOptimistic:function(s){var a=On();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=hv.bind(null,kt,!0,l),l.dispatch=a,[s,a]},useMemoCache:sv,useCacheRefresh:function(){return On().memoizedState=wR.bind(null,kt)}},NE={readContext:gn,use:qp,useCallback:vE,useContext:gn,useEffect:hE,useImperativeHandle:yE,useInsertionEffect:pE,useLayoutEffect:gE,useMemo:AE,useReducer:zp,useRef:dE,useState:function(){return zp(Ks)},useDebugValue:uv,useDeferredValue:function(s,a){var l=Ne();return TE(l,te.memoizedState,s,a)},useTransition:function(){var s=zp(Ks)[0],a=Ne().memoizedState;return[typeof s=="boolean"?s:wd(s),a]},useSyncExternalStore:KS,useId:bE,useHostTransitionStatus:fv,useFormState:lE,useActionState:lE,useOptimistic:function(s,a){var l=Ne();return eE(l,te,s,a)},useMemoCache:sv,useCacheRefresh:xE},RR={readContext:gn,use:qp,useCallback:vE,useContext:gn,useEffect:hE,useImperativeHandle:yE,useInsertionEffect:pE,useLayoutEffect:gE,useMemo:AE,useReducer:av,useRef:dE,useState:function(){return av(Ks)},useDebugValue:uv,useDeferredValue:function(s,a){var l=Ne();return te===null?cv(l,s,a):TE(l,te.memoizedState,s,a)},useTransition:function(){var s=av(Ks)[0],a=Ne().memoizedState;return[typeof s=="boolean"?s:wd(s),a]},useSyncExternalStore:KS,useId:bE,useHostTransitionStatus:fv,useFormState:cE,useActionState:cE,useOptimistic:function(s,a){var l=Ne();return te!==null?eE(l,te,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:sv,useCacheRefresh:xE},mu=null,Nd=0;function Kp(s){var a=Nd;return Nd+=1,mu===null&&(mu=[]),VS(mu,s,a)}function Dd(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Wp(s,a){throw a.$$typeof===A?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function DE(s){var a=s._init;return a(s._payload)}function IE(s){function a(q,H){if(s){var z=q.deletions;z===null?(q.deletions=[H],q.flags|=16):z.push(H)}}function l(q,H){if(!s)return null;for(;H!==null;)a(q,H),H=H.sibling;return null}function m(q){for(var H=new Map;q!==null;)q.key!==null?H.set(q.key,q):H.set(q.index,q),q=q.sibling;return H}function v(q,H){return q=zs(q,H),q.index=0,q.sibling=null,q}function T(q,H,z){return q.index=z,s?(z=q.alternate,z!==null?(z=z.index,z<H?(q.flags|=67108866,H):z):(q.flags|=67108866,H)):(q.flags|=1048576,H)}function _(q){return s&&q.alternate===null&&(q.flags|=67108866),q}function I(q,H,z,tt){return H===null||H.tag!==6?(H=Ly(z,q.mode,tt),H.return=q,H):(H=v(H,z),H.return=q,H)}function B(q,H,z,tt){var pt=z.type;return pt===b?j(q,H,z.props.children,tt,z.key):H!==null&&(H.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===$&&DE(pt)===H.type)?(H=v(H,z.props),Dd(H,z),H.return=q,H):(H=Ip(z.type,z.key,z.props,null,q.mode,tt),Dd(H,z),H.return=q,H)}function Y(q,H,z,tt){return H===null||H.tag!==4||H.stateNode.containerInfo!==z.containerInfo||H.stateNode.implementation!==z.implementation?(H=ky(z,q.mode,tt),H.return=q,H):(H=v(H,z.children||[]),H.return=q,H)}function j(q,H,z,tt,pt){return H===null||H.tag!==7?(H=fr(z,q.mode,tt,pt),H.return=q,H):(H=v(H,z),H.return=q,H)}function nt(q,H,z){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Ly(""+H,q.mode,z),H.return=q,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case S:return z=Ip(H.type,H.key,H.props,null,q.mode,z),Dd(z,H),z.return=q,z;case E:return H=ky(H,q.mode,z),H.return=q,H;case $:var tt=H._init;return H=tt(H._payload),nt(q,H,z)}if(At(H)||ut(H))return H=fr(H,q.mode,z,null),H.return=q,H;if(typeof H.then=="function")return nt(q,Kp(H),z);if(H.$$typeof===L)return nt(q,Up(q,H),z);Wp(q,H)}return null}function K(q,H,z,tt){var pt=H!==null?H.key:null;if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return pt!==null?null:I(q,H,""+z,tt);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case S:return z.key===pt?B(q,H,z,tt):null;case E:return z.key===pt?Y(q,H,z,tt):null;case $:return pt=z._init,z=pt(z._payload),K(q,H,z,tt)}if(At(z)||ut(z))return pt!==null?null:j(q,H,z,tt,null);if(typeof z.then=="function")return K(q,H,Kp(z),tt);if(z.$$typeof===L)return K(q,H,Up(q,z),tt);Wp(q,z)}return null}function W(q,H,z,tt,pt){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return q=q.get(z)||null,I(H,q,""+tt,pt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case S:return q=q.get(tt.key===null?z:tt.key)||null,B(H,q,tt,pt);case E:return q=q.get(tt.key===null?z:tt.key)||null,Y(H,q,tt,pt);case $:var Ut=tt._init;return tt=Ut(tt._payload),W(q,H,z,tt,pt)}if(At(tt)||ut(tt))return q=q.get(z)||null,j(H,q,tt,pt,null);if(typeof tt.then=="function")return W(q,H,z,Kp(tt),pt);if(tt.$$typeof===L)return W(q,H,z,Up(H,tt),pt);Wp(H,tt)}return null}function Rt(q,H,z,tt){for(var pt=null,Ut=null,St=H,Mt=H=0,Xe=null;St!==null&&Mt<z.length;Mt++){St.index>Mt?(Xe=St,St=null):Xe=St.sibling;var Yt=K(q,St,z[Mt],tt);if(Yt===null){St===null&&(St=Xe);break}s&&St&&Yt.alternate===null&&a(q,St),H=T(Yt,H,Mt),Ut===null?pt=Yt:Ut.sibling=Yt,Ut=Yt,St=Xe}if(Mt===z.length)return l(q,St),Xt&&pr(q,Mt),pt;if(St===null){for(;Mt<z.length;Mt++)St=nt(q,z[Mt],tt),St!==null&&(H=T(St,H,Mt),Ut===null?pt=St:Ut.sibling=St,Ut=St);return Xt&&pr(q,Mt),pt}for(St=m(St);Mt<z.length;Mt++)Xe=W(St,q,Mt,z[Mt],tt),Xe!==null&&(s&&Xe.alternate!==null&&St.delete(Xe.key===null?Mt:Xe.key),H=T(Xe,H,Mt),Ut===null?pt=Xe:Ut.sibling=Xe,Ut=Xe);return s&&St.forEach(function(ga){return a(q,ga)}),Xt&&pr(q,Mt),pt}function xt(q,H,z,tt){if(z==null)throw Error(n(151));for(var pt=null,Ut=null,St=H,Mt=H=0,Xe=null,Yt=z.next();St!==null&&!Yt.done;Mt++,Yt=z.next()){St.index>Mt?(Xe=St,St=null):Xe=St.sibling;var ga=K(q,St,Yt.value,tt);if(ga===null){St===null&&(St=Xe);break}s&&St&&ga.alternate===null&&a(q,St),H=T(ga,H,Mt),Ut===null?pt=ga:Ut.sibling=ga,Ut=ga,St=Xe}if(Yt.done)return l(q,St),Xt&&pr(q,Mt),pt;if(St===null){for(;!Yt.done;Mt++,Yt=z.next())Yt=nt(q,Yt.value,tt),Yt!==null&&(H=T(Yt,H,Mt),Ut===null?pt=Yt:Ut.sibling=Yt,Ut=Yt);return Xt&&pr(q,Mt),pt}for(St=m(St);!Yt.done;Mt++,Yt=z.next())Yt=W(St,q,Mt,Yt.value,tt),Yt!==null&&(s&&Yt.alternate!==null&&St.delete(Yt.key===null?Mt:Yt.key),H=T(Yt,H,Mt),Ut===null?pt=Yt:Ut.sibling=Yt,Ut=Yt);return s&&St.forEach(function(NN){return a(q,NN)}),Xt&&pr(q,Mt),pt}function ne(q,H,z,tt){if(typeof z=="object"&&z!==null&&z.type===b&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case S:t:{for(var pt=z.key;H!==null;){if(H.key===pt){if(pt=z.type,pt===b){if(H.tag===7){l(q,H.sibling),tt=v(H,z.props.children),tt.return=q,q=tt;break t}}else if(H.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===$&&DE(pt)===H.type){l(q,H.sibling),tt=v(H,z.props),Dd(tt,z),tt.return=q,q=tt;break t}l(q,H);break}else a(q,H);H=H.sibling}z.type===b?(tt=fr(z.props.children,q.mode,tt,z.key),tt.return=q,q=tt):(tt=Ip(z.type,z.key,z.props,null,q.mode,tt),Dd(tt,z),tt.return=q,q=tt)}return _(q);case E:t:{for(pt=z.key;H!==null;){if(H.key===pt)if(H.tag===4&&H.stateNode.containerInfo===z.containerInfo&&H.stateNode.implementation===z.implementation){l(q,H.sibling),tt=v(H,z.children||[]),tt.return=q,q=tt;break t}else{l(q,H);break}else a(q,H);H=H.sibling}tt=ky(z,q.mode,tt),tt.return=q,q=tt}return _(q);case $:return pt=z._init,z=pt(z._payload),ne(q,H,z,tt)}if(At(z))return Rt(q,H,z,tt);if(ut(z)){if(pt=ut(z),typeof pt!="function")throw Error(n(150));return z=pt.call(z),xt(q,H,z,tt)}if(typeof z.then=="function")return ne(q,H,Kp(z),tt);if(z.$$typeof===L)return ne(q,H,Up(q,z),tt);Wp(q,z)}return typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint"?(z=""+z,H!==null&&H.tag===6?(l(q,H.sibling),tt=v(H,z),tt.return=q,q=tt):(l(q,H),tt=Ly(z,q.mode,tt),tt.return=q,q=tt),_(q)):l(q,H)}return function(q,H,z,tt){try{Nd=0;var pt=ne(q,H,z,tt);return mu=null,pt}catch(St){if(St===Sd||St===Op)throw St;var Ut=Qn(29,St,null,q.mode);return Ut.lanes=tt,Ut.return=q,Ut}finally{}}}var yu=IE(!0),PE=IE(!1),Ri=Z(null),fs=null;function ta(s){var a=s.alternate;it(Oe,Oe.current&1),it(Ri,s),fs===null&&(a===null||fu.current!==null||a.memoizedState!==null)&&(fs=s)}function LE(s){if(s.tag===22){if(it(Oe,Oe.current),it(Ri,s),fs===null){var a=s.alternate;a!==null&&a.memoizedState!==null&&(fs=s)}}else ea()}function ea(){it(Oe,Oe.current),it(Ri,Ri.current)}function Ws(s){st(Ri),fs===s&&(fs=null),st(Oe)}var Oe=Z(0);function Qp(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||i0(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function pv(s,a,l,m){a=s.memoizedState,l=l(m,a),l=l==null?a:y({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var gv={enqueueSetState:function(s,a,l){s=s._reactInternals;var m=ei(),v=Qo(m);v.payload=a,l!=null&&(v.callback=l),a=Zo(s,v,m),a!==null&&(ni(a,s,m),Cd(a,s,m))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var m=ei(),v=Qo(m);v.tag=1,v.payload=a,l!=null&&(v.callback=l),a=Zo(s,v,m),a!==null&&(ni(a,s,m),Cd(a,s,m))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=ei(),m=Qo(l);m.tag=2,a!=null&&(m.callback=a),a=Zo(s,m,l),a!==null&&(ni(a,s,l),Cd(a,s,l))}};function kE(s,a,l,m,v,T,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,T,_):a.prototype&&a.prototype.isPureReactComponent?!hd(l,m)||!hd(v,T):!0}function UE(s,a,l,m){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,m),a.state!==s&&gv.enqueueReplaceState(a,a.state,null)}function Sr(s,a){var l=a;if("ref"in a){l={};for(var m in a)m!=="ref"&&(l[m]=a[m])}if(s=s.defaultProps){l===a&&(l=y({},l));for(var v in s)l[v]===void 0&&(l[v]=s[v])}return l}var Zp=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function FE(s){Zp(s)}function OE(s){console.error(s)}function BE(s){Zp(s)}function jp(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(m){setTimeout(function(){throw m})}}function GE(s,a,l){try{var m=s.onCaughtError;m(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function mv(s,a,l){return l=Qo(l),l.tag=3,l.payload={element:null},l.callback=function(){jp(s,a)},l}function VE(s){return s=Qo(s),s.tag=3,s}function HE(s,a,l,m){var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var T=m.value;s.payload=function(){return v(T)},s.callback=function(){GE(a,l,m)}}var _=l.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(s.callback=function(){GE(a,l,m),typeof v!="function"&&(ra===null?ra=new Set([this]):ra.add(this));var I=m.stack;this.componentDidCatch(m.value,{componentStack:I!==null?I:""})})}function NR(s,a,l,m,v){if(l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(a=l.alternate,a!==null&&vd(a,l,v,!0),l=Ri.current,l!==null){switch(l.tag){case 13:return fs===null?Gv():l.alternate===null&&Ee===0&&(Ee=3),l.flags&=-257,l.flags|=65536,l.lanes=v,m===$y?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([m]):a.add(m),Hv(s,m,v)),!1;case 22:return l.flags|=65536,m===$y?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([m])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([m]):l.add(m)),Hv(s,m,v)),!1}throw Error(n(435,l.tag))}return Hv(s,m,v),Gv(),!1}if(Xt)return a=Ri.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,m!==Oy&&(s=Error(n(422),{cause:m}),yd(xi(s,l)))):(m!==Oy&&(a=Error(n(423),{cause:m}),yd(xi(a,l))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,m=xi(m,l),v=mv(s.stateNode,m,v),Jy(s,v),Ee!==4&&(Ee=2)),!1;var T=Error(n(520),{cause:m});if(T=xi(T,l),Od===null?Od=[T]:Od.push(T),Ee!==4&&(Ee=2),a===null)return!0;m=xi(m,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=v&-v,l.lanes|=s,s=mv(l.stateNode,m,s),Jy(l,s),!1;case 1:if(a=l.type,T=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ra===null||!ra.has(T))))return l.flags|=65536,v&=-v,l.lanes|=v,v=VE(v),HE(v,s,l,m),Jy(l,v),!1}l=l.return}while(l!==null);return!1}var qE=Error(n(461)),$e=!1;function en(s,a,l,m){a.child=s===null?PE(a,null,l,m):yu(a,s.child,l,m)}function zE(s,a,l,m,v){l=l.render;var T=a.ref;if("ref"in m){var _={};for(var I in m)I!=="ref"&&(_[I]=m[I])}else _=m;return vr(a),m=jy(s,a,l,_,T,v),I=tv(),s!==null&&!$e?(ev(s,a,v),Qs(s,a,v)):(Xt&&I&&Uy(a),a.flags|=1,en(s,a,m,v),a.child)}function $E(s,a,l,m,v){if(s===null){var T=l.type;return typeof T=="function"&&!Py(T)&&T.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=T,YE(s,a,T,m,v)):(s=Ip(l.type,null,m,a,a.mode,v),s.ref=a.ref,s.return=a,a.child=s)}if(T=s.child,!bv(s,v)){var _=T.memoizedProps;if(l=l.compare,l=l!==null?l:hd,l(_,m)&&s.ref===a.ref)return Qs(s,a,v)}return a.flags|=1,s=zs(T,m),s.ref=a.ref,s.return=a,a.child=s}function YE(s,a,l,m,v){if(s!==null){var T=s.memoizedProps;if(hd(T,m)&&s.ref===a.ref)if($e=!1,a.pendingProps=m=T,bv(s,v))(s.flags&131072)!==0&&($e=!0);else return a.lanes=s.lanes,Qs(s,a,v)}return yv(s,a,l,m,v)}function XE(s,a,l){var m=a.pendingProps,v=m.children,T=s!==null?s.memoizedState:null;if(m.mode==="hidden"){if((a.flags&128)!==0){if(m=T!==null?T.baseLanes|l:l,s!==null){for(v=a.child=s.child,T=0;v!==null;)T=T|v.lanes|v.childLanes,v=v.sibling;a.childLanes=T&~m}else a.childLanes=0,a.child=null;return JE(s,a,m,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Fp(a,T!==null?T.cachePool:null),T!==null?YS(a,T):Wy(),LE(a);else return a.lanes=a.childLanes=536870912,JE(s,a,T!==null?T.baseLanes|l:l,l)}else T!==null?(Fp(a,T.cachePool),YS(a,T),ea(),a.memoizedState=null):(s!==null&&Fp(a,null),Wy(),ea());return en(s,a,v,l),a.child}function JE(s,a,l,m){var v=zy();return v=v===null?null:{parent:Fe._currentValue,pool:v},a.memoizedState={baseLanes:l,cachePool:v},s!==null&&Fp(a,null),Wy(),LE(a),s!==null&&vd(s,a,m,!0),null}function tg(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function yv(s,a,l,m,v){return vr(a),l=jy(s,a,l,m,void 0,v),m=tv(),s!==null&&!$e?(ev(s,a,v),Qs(s,a,v)):(Xt&&m&&Uy(a),a.flags|=1,en(s,a,l,v),a.child)}function KE(s,a,l,m,v,T){return vr(a),a.updateQueue=null,l=JS(a,m,l,v),XS(s),m=tv(),s!==null&&!$e?(ev(s,a,T),Qs(s,a,T)):(Xt&&m&&Uy(a),a.flags|=1,en(s,a,l,T),a.child)}function WE(s,a,l,m,v){if(vr(a),a.stateNode===null){var T=ru,_=l.contextType;typeof _=="object"&&_!==null&&(T=gn(_)),T=new l(m,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=gv,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=m,T.state=a.memoizedState,T.refs={},Yy(a),_=l.contextType,T.context=typeof _=="object"&&_!==null?gn(_):ru,T.state=a.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(pv(a,l,_,m),T.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(_=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),_!==T.state&&gv.enqueueReplaceState(T,T.state,null),xd(a,m,T,v),bd(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),m=!0}else if(s===null){T=a.stateNode;var I=a.memoizedProps,B=Sr(l,I);T.props=B;var Y=T.context,j=l.contextType;_=ru,typeof j=="object"&&j!==null&&(_=gn(j));var nt=l.getDerivedStateFromProps;j=typeof nt=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,j||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||Y!==_)&&UE(a,T,m,_),Wo=!1;var K=a.memoizedState;T.state=K,xd(a,m,T,v),bd(),Y=a.memoizedState,I||K!==Y||Wo?(typeof nt=="function"&&(pv(a,l,nt,m),Y=a.memoizedState),(B=Wo||kE(a,l,B,m,K,Y,_))?(j||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=Y),T.props=m,T.state=Y,T.context=_,m=B):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{T=a.stateNode,Xy(s,a),_=a.memoizedProps,j=Sr(l,_),T.props=j,nt=a.pendingProps,K=T.context,Y=l.contextType,B=ru,typeof Y=="object"&&Y!==null&&(B=gn(Y)),I=l.getDerivedStateFromProps,(Y=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(_!==nt||K!==B)&&UE(a,T,m,B),Wo=!1,K=a.memoizedState,T.state=K,xd(a,m,T,v),bd();var W=a.memoizedState;_!==nt||K!==W||Wo||s!==null&&s.dependencies!==null&&kp(s.dependencies)?(typeof I=="function"&&(pv(a,l,I,m),W=a.memoizedState),(j=Wo||kE(a,l,j,m,K,W,B)||s!==null&&s.dependencies!==null&&kp(s.dependencies))?(Y||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,W,B),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,W,B)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=W),T.props=m,T.state=W,T.context=B,m=j):(typeof T.componentDidUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),m=!1)}return T=m,tg(s,a),m=(a.flags&128)!==0,T||m?(T=a.stateNode,l=m&&typeof l.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,s!==null&&m?(a.child=yu(a,s.child,null,v),a.child=yu(a,null,l,v)):en(s,a,l,v),a.memoizedState=T.state,s=a.child):s=Qs(s,a,v),s}function QE(s,a,l,m){return md(),a.flags|=256,en(s,a,l,m),a.child}var vv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Av(s){return{baseLanes:s,cachePool:OS()}}function Tv(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=Ni),s}function ZE(s,a,l){var m=a.pendingProps,v=!1,T=(a.flags&128)!==0,_;if((_=T)||(_=s!==null&&s.memoizedState===null?!1:(Oe.current&2)!==0),_&&(v=!0,a.flags&=-129),_=(a.flags&32)!==0,a.flags&=-33,s===null){if(Xt){if(v?ta(a):ea(),Xt){var I=Se,B;if(B=I){t:{for(B=I,I=ds;B.nodeType!==8;){if(!I){I=null;break t}if(B=Ji(B.nextSibling),B===null){I=null;break t}}I=B}I!==null?(a.memoizedState={dehydrated:I,treeContext:hr!==null?{id:$s,overflow:Ys}:null,retryLane:536870912,hydrationErrors:null},B=Qn(18,null,null,0),B.stateNode=I,B.return=a,a.child=B,bn=a,Se=null,B=!0):B=!1}B||mr(a)}if(I=a.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return i0(I)?a.lanes=32:a.lanes=536870912,null;Ws(a)}return I=m.children,m=m.fallback,v?(ea(),v=a.mode,I=eg({mode:"hidden",children:I},v),m=fr(m,v,l,null),I.return=a,m.return=a,I.sibling=m,a.child=I,v=a.child,v.memoizedState=Av(l),v.childLanes=Tv(s,_,l),a.memoizedState=vv,m):(ta(a),Sv(a,I))}if(B=s.memoizedState,B!==null&&(I=B.dehydrated,I!==null)){if(T)a.flags&256?(ta(a),a.flags&=-257,a=Ev(s,a,l)):a.memoizedState!==null?(ea(),a.child=s.child,a.flags|=128,a=null):(ea(),v=m.fallback,I=a.mode,m=eg({mode:"visible",children:m.children},I),v=fr(v,I,l,null),v.flags|=2,m.return=a,v.return=a,m.sibling=v,a.child=m,yu(a,s.child,null,l),m=a.child,m.memoizedState=Av(l),m.childLanes=Tv(s,_,l),a.memoizedState=vv,a=v);else if(ta(a),i0(I)){if(_=I.nextSibling&&I.nextSibling.dataset,_)var Y=_.dgst;_=Y,m=Error(n(419)),m.stack="",m.digest=_,yd({value:m,source:null,stack:null}),a=Ev(s,a,l)}else if($e||vd(s,a,l,!1),_=(l&s.childLanes)!==0,$e||_){if(_=le,_!==null&&(m=l&-l,m=(m&42)!==0?1:sy(m),m=(m&(_.suspendedLanes|l))!==0?0:m,m!==0&&m!==B.retryLane))throw B.retryLane=m,au(s,m),ni(_,s,m),qE;I.data==="$?"||Gv(),a=Ev(s,a,l)}else I.data==="$?"?(a.flags|=192,a.child=s.child,a=null):(s=B.treeContext,Se=Ji(I.nextSibling),bn=a,Xt=!0,gr=null,ds=!1,s!==null&&(wi[Mi++]=$s,wi[Mi++]=Ys,wi[Mi++]=hr,$s=s.id,Ys=s.overflow,hr=a),a=Sv(a,m.children),a.flags|=4096);return a}return v?(ea(),v=m.fallback,I=a.mode,B=s.child,Y=B.sibling,m=zs(B,{mode:"hidden",children:m.children}),m.subtreeFlags=B.subtreeFlags&65011712,Y!==null?v=zs(Y,v):(v=fr(v,I,l,null),v.flags|=2),v.return=a,m.return=a,m.sibling=v,a.child=m,m=v,v=a.child,I=s.child.memoizedState,I===null?I=Av(l):(B=I.cachePool,B!==null?(Y=Fe._currentValue,B=B.parent!==Y?{parent:Y,pool:Y}:B):B=OS(),I={baseLanes:I.baseLanes|l,cachePool:B}),v.memoizedState=I,v.childLanes=Tv(s,_,l),a.memoizedState=vv,m):(ta(a),l=s.child,s=l.sibling,l=zs(l,{mode:"visible",children:m.children}),l.return=a,l.sibling=null,s!==null&&(_=a.deletions,_===null?(a.deletions=[s],a.flags|=16):_.push(s)),a.child=l,a.memoizedState=null,l)}function Sv(s,a){return a=eg({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function eg(s,a){return s=Qn(22,s,null,a),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Ev(s,a,l){return yu(a,s.child,null,l),s=Sv(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function jE(s,a,l){s.lanes|=a;var m=s.alternate;m!==null&&(m.lanes|=a),Gy(s.return,a,l)}function Cv(s,a,l,m,v){var T=s.memoizedState;T===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:l,tailMode:v}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=m,T.tail=l,T.tailMode=v)}function tC(s,a,l){var m=a.pendingProps,v=m.revealOrder,T=m.tail;if(en(s,a,m.children,l),m=Oe.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&jE(s,l,a);else if(s.tag===19)jE(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break t;for(;s.sibling===null;){if(s.return===null||s.return===a)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}switch(it(Oe,m),v){case"forwards":for(l=a.child,v=null;l!==null;)s=l.alternate,s!==null&&Qp(s)===null&&(v=l),l=l.sibling;l=v,l===null?(v=a.child,a.child=null):(v=l.sibling,l.sibling=null),Cv(a,!1,v,l,T);break;case"backwards":for(l=null,v=a.child,a.child=null;v!==null;){if(s=v.alternate,s!==null&&Qp(s)===null){a.child=v;break}s=v.sibling,v.sibling=l,l=v,v=s}Cv(a,!0,l,null,T);break;case"together":Cv(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Qs(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),aa|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(vd(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,l=zs(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=zs(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function bv(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&kp(s)))}function DR(s,a,l){switch(a.tag){case 3:Vt(a,a.stateNode.containerInfo),Ko(a,Fe,s.memoizedState.cache),md();break;case 27:case 5:ar(a);break;case 4:Vt(a,a.stateNode.containerInfo);break;case 10:Ko(a,a.type,a.memoizedProps.value);break;case 13:var m=a.memoizedState;if(m!==null)return m.dehydrated!==null?(ta(a),a.flags|=128,null):(l&a.child.childLanes)!==0?ZE(s,a,l):(ta(a),s=Qs(s,a,l),s!==null?s.sibling:null);ta(a);break;case 19:var v=(s.flags&128)!==0;if(m=(l&a.childLanes)!==0,m||(vd(s,a,l,!1),m=(l&a.childLanes)!==0),v){if(m)return tC(s,a,l);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),it(Oe,Oe.current),m)break;return null;case 22:case 23:return a.lanes=0,XE(s,a,l);case 24:Ko(a,Fe,s.memoizedState.cache)}return Qs(s,a,l)}function eC(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)$e=!0;else{if(!bv(s,l)&&(a.flags&128)===0)return $e=!1,DR(s,a,l);$e=(s.flags&131072)!==0}else $e=!1,Xt&&(a.flags&1048576)!==0&&DS(a,Lp,a.index);switch(a.lanes=0,a.tag){case 16:t:{s=a.pendingProps;var m=a.elementType,v=m._init;if(m=v(m._payload),a.type=m,typeof m=="function")Py(m)?(s=Sr(m,s),a.tag=1,a=WE(null,a,m,s,l)):(a.tag=0,a=yv(null,a,m,s,l));else{if(m!=null){if(v=m.$$typeof,v===U){a.tag=11,a=zE(null,a,m,s,l);break t}else if(v===F){a.tag=14,a=$E(null,a,m,s,l);break t}}throw a=mt(m)||m,Error(n(306,a,""))}}return a;case 0:return yv(s,a,a.type,a.pendingProps,l);case 1:return m=a.type,v=Sr(m,a.pendingProps),WE(s,a,m,v,l);case 3:t:{if(Vt(a,a.stateNode.containerInfo),s===null)throw Error(n(387));m=a.pendingProps;var T=a.memoizedState;v=T.element,Xy(s,a),xd(a,m,null,l);var _=a.memoizedState;if(m=_.cache,Ko(a,Fe,m),m!==T.cache&&Vy(a,[Fe],l,!0),bd(),m=_.element,T.isDehydrated)if(T={element:m,isDehydrated:!1,cache:_.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=QE(s,a,m,l);break t}else if(m!==v){v=xi(Error(n(424)),a),yd(v),a=QE(s,a,m,l);break t}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Se=Ji(s.firstChild),bn=a,Xt=!0,gr=null,ds=!0,l=PE(a,null,m,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(md(),m===v){a=Qs(s,a,l);break t}en(s,a,m,l)}a=a.child}return a;case 26:return tg(s,a),s===null?(l=ob(a.type,null,a.pendingProps,null))?a.memoizedState=l:Xt||(l=a.type,s=a.pendingProps,m=gg(gt.current).createElement(l),m[pn]=a,m[Un]=s,sn(m,l,s),ze(m),a.stateNode=m):a.memoizedState=ob(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return ar(a),s===null&&Xt&&(m=a.stateNode=nb(a.type,a.pendingProps,gt.current),bn=a,ds=!0,v=Se,ca(a.type)?(s0=v,Se=Ji(m.firstChild)):Se=v),en(s,a,a.pendingProps.children,l),tg(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Xt&&((v=m=Se)&&(m=oN(m,a.type,a.pendingProps,ds),m!==null?(a.stateNode=m,bn=a,Se=Ji(m.firstChild),ds=!1,v=!0):v=!1),v||mr(a)),ar(a),v=a.type,T=a.pendingProps,_=s!==null?s.memoizedProps:null,m=T.children,t0(v,T)?m=null:_!==null&&t0(v,_)&&(a.flags|=32),a.memoizedState!==null&&(v=jy(s,a,CR,null,null,l),Xd._currentValue=v),tg(s,a),en(s,a,m,l),a.child;case 6:return s===null&&Xt&&((s=l=Se)&&(l=aN(l,a.pendingProps,ds),l!==null?(a.stateNode=l,bn=a,Se=null,s=!0):s=!1),s||mr(a)),null;case 13:return ZE(s,a,l);case 4:return Vt(a,a.stateNode.containerInfo),m=a.pendingProps,s===null?a.child=yu(a,null,m,l):en(s,a,m,l),a.child;case 11:return zE(s,a,a.type,a.pendingProps,l);case 7:return en(s,a,a.pendingProps,l),a.child;case 8:return en(s,a,a.pendingProps.children,l),a.child;case 12:return en(s,a,a.pendingProps.children,l),a.child;case 10:return m=a.pendingProps,Ko(a,a.type,m.value),en(s,a,m.children,l),a.child;case 9:return v=a.type._context,m=a.pendingProps.children,vr(a),v=gn(v),m=m(v),a.flags|=1,en(s,a,m,l),a.child;case 14:return $E(s,a,a.type,a.pendingProps,l);case 15:return YE(s,a,a.type,a.pendingProps,l);case 19:return tC(s,a,l);case 31:return m=a.pendingProps,l=a.mode,m={mode:m.mode,children:m.children},s===null?(l=eg(m,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=zs(s.child,m),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return XE(s,a,l);case 24:return vr(a),m=gn(Fe),s===null?(v=zy(),v===null&&(v=le,T=Hy(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=l),v=T),a.memoizedState={parent:m,cache:v},Yy(a),Ko(a,Fe,v)):((s.lanes&l)!==0&&(Xy(s,a),xd(a,null,null,l),bd()),v=s.memoizedState,T=a.memoizedState,v.parent!==m?(v={parent:m,cache:m},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),Ko(a,Fe,m)):(m=T.cache,Ko(a,Fe,m),m!==v.cache&&Vy(a,[Fe],l,!0))),en(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Zs(s){s.flags|=4}function nC(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!cb(a)){if(a=Ri.current,a!==null&&((qt&4194048)===qt?fs!==null:(qt&62914560)!==qt&&(qt&536870912)===0||a!==fs))throw Ed=$y,BS;s.flags|=8192}}function ng(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?LT():536870912,s.lanes|=a,Su|=a)}function Id(s,a){if(!Xt)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function ve(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,m=0;if(a)for(var v=s.child;v!==null;)l|=v.lanes|v.childLanes,m|=v.subtreeFlags&65011712,m|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)l|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=l,a}function IR(s,a,l){var m=a.pendingProps;switch(Fy(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ve(a),null;case 1:return ve(a),null;case 3:return l=a.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),a.memoizedState.cache!==m&&(a.flags|=2048),Js(Fe),Ue(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(gd(a)?Zs(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,LS())),ve(a),null;case 26:return l=a.memoizedState,s===null?(Zs(a),l!==null?(ve(a),nC(a,l)):(ve(a),a.flags&=-16777217)):l?l!==s.memoizedState?(Zs(a),ve(a),nC(a,l)):(ve(a),a.flags&=-16777217):(s.memoizedProps!==m&&Zs(a),ve(a),a.flags&=-16777217),null;case 27:$i(a),l=gt.current;var v=a.type;if(s!==null&&a.stateNode!=null)s.memoizedProps!==m&&Zs(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return ve(a),null}s=yt.current,gd(a)?IS(a):(s=nb(v,m,l),a.stateNode=s,Zs(a))}return ve(a),null;case 5:if($i(a),l=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==m&&Zs(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return ve(a),null}if(s=yt.current,gd(a))IS(a);else{switch(v=gg(gt.current),s){case 1:s=v.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=v.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=v.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof m.is=="string"?v.createElement("select",{is:m.is}):v.createElement("select"),m.multiple?s.multiple=!0:m.size&&(s.size=m.size);break;default:s=typeof m.is=="string"?v.createElement(l,{is:m.is}):v.createElement(l)}}s[pn]=a,s[Un]=m;t:for(v=a.child;v!==null;){if(v.tag===5||v.tag===6)s.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===a)break t;for(;v.sibling===null;){if(v.return===null||v.return===a)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}a.stateNode=s;t:switch(sn(s,l,m),l){case"button":case"input":case"select":case"textarea":s=!!m.autoFocus;break t;case"img":s=!0;break t;default:s=!1}s&&Zs(a)}}return ve(a),a.flags&=-16777217,null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==m&&Zs(a);else{if(typeof m!="string"&&a.stateNode===null)throw Error(n(166));if(s=gt.current,gd(a)){if(s=a.stateNode,l=a.memoizedProps,m=null,v=bn,v!==null)switch(v.tag){case 27:case 5:m=v.memoizedProps}s[pn]=a,s=!!(s.nodeValue===l||m!==null&&m.suppressHydrationWarning===!0||KC(s.nodeValue,l)),s||mr(a)}else s=gg(s).createTextNode(m),s[pn]=a,a.stateNode=s}return ve(a),null;case 13:if(m=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=gd(a),m!==null&&m.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[pn]=a}else md(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ve(a),v=!1}else v=LS(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(Ws(a),a):(Ws(a),null)}if(Ws(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=m!==null,s=s!==null&&s.memoizedState!==null,l){m=a.child,v=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(v=m.alternate.memoizedState.cachePool.pool);var T=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==v&&(m.flags|=2048)}return l!==s&&l&&(a.child.flags|=8192),ng(a,a.updateQueue),ve(a),null;case 4:return Ue(),s===null&&Kv(a.stateNode.containerInfo),ve(a),null;case 10:return Js(a.type),ve(a),null;case 19:if(st(Oe),v=a.memoizedState,v===null)return ve(a),null;if(m=(a.flags&128)!==0,T=v.rendering,T===null)if(m)Id(v,!1);else{if(Ee!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(T=Qp(s),T!==null){for(a.flags|=128,Id(v,!1),s=T.updateQueue,a.updateQueue=s,ng(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)NS(l,s),l=l.sibling;return it(Oe,Oe.current&1|2),a.child}s=s.sibling}v.tail!==null&&Xn()>og&&(a.flags|=128,m=!0,Id(v,!1),a.lanes=4194304)}else{if(!m)if(s=Qp(T),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,ng(a,s),Id(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!Xt)return ve(a),null}else 2*Xn()-v.renderingStartTime>og&&l!==536870912&&(a.flags|=128,m=!0,Id(v,!1),a.lanes=4194304);v.isBackwards?(T.sibling=a.child,a.child=T):(s=v.last,s!==null?s.sibling=T:a.child=T,v.last=T)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Xn(),a.sibling=null,s=Oe.current,it(Oe,m?s&1|2:s&1),a):(ve(a),null);case 22:case 23:return Ws(a),Qy(),m=a.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(a.flags|=8192):m&&(a.flags|=8192),m?(l&536870912)!==0&&(a.flags&128)===0&&(ve(a),a.subtreeFlags&6&&(a.flags|=8192)):ve(a),l=a.updateQueue,l!==null&&ng(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),m=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),m!==l&&(a.flags|=2048),s!==null&&st(Ar),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Js(Fe),ve(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function PR(s,a){switch(Fy(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Js(Fe),Ue(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return $i(a),null;case 13:if(Ws(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));md()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return st(Oe),null;case 4:return Ue(),null;case 10:return Js(a.type),null;case 22:case 23:return Ws(a),Qy(),s!==null&&st(Ar),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Js(Fe),null;case 25:return null;default:return null}}function iC(s,a){switch(Fy(a),a.tag){case 3:Js(Fe),Ue();break;case 26:case 27:case 5:$i(a);break;case 4:Ue();break;case 13:Ws(a);break;case 19:st(Oe);break;case 10:Js(a.type);break;case 22:case 23:Ws(a),Qy(),s!==null&&st(Ar);break;case 24:Js(Fe)}}function Pd(s,a){try{var l=a.updateQueue,m=l!==null?l.lastEffect:null;if(m!==null){var v=m.next;l=v;do{if((l.tag&s)===s){m=void 0;var T=l.create,_=l.inst;m=T(),_.destroy=m}l=l.next}while(l!==v)}}catch(I){re(a,a.return,I)}}function na(s,a,l){try{var m=a.updateQueue,v=m!==null?m.lastEffect:null;if(v!==null){var T=v.next;m=T;do{if((m.tag&s)===s){var _=m.inst,I=_.destroy;if(I!==void 0){_.destroy=void 0,v=a;var B=l,Y=I;try{Y()}catch(j){re(v,B,j)}}}m=m.next}while(m!==T)}}catch(j){re(a,a.return,j)}}function sC(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{$S(a,l)}catch(m){re(s,s.return,m)}}}function oC(s,a,l){l.props=Sr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(m){re(s,a,m)}}function Ld(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof l=="function"?s.refCleanup=l(m):l.current=m}}catch(v){re(s,a,v)}}function hs(s,a){var l=s.ref,m=s.refCleanup;if(l!==null)if(typeof m=="function")try{m()}catch(v){re(s,a,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(v){re(s,a,v)}else l.current=null}function aC(s){var a=s.type,l=s.memoizedProps,m=s.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&m.focus();break t;case"img":l.src?m.src=l.src:l.srcSet&&(m.srcset=l.srcSet)}}catch(v){re(s,s.return,v)}}function xv(s,a,l){try{var m=s.stateNode;tN(m,s.type,l,a),m[Un]=a}catch(v){re(s,s.return,v)}}function rC(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ca(s.type)||s.tag===4}function _v(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||rC(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ca(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function wv(s,a,l){var m=s.tag;if(m===5||m===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=pg));else if(m!==4&&(m===27&&ca(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(wv(s,a,l),s=s.sibling;s!==null;)wv(s,a,l),s=s.sibling}function ig(s,a,l){var m=s.tag;if(m===5||m===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(m!==4&&(m===27&&ca(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(ig(s,a,l),s=s.sibling;s!==null;)ig(s,a,l),s=s.sibling}function lC(s){var a=s.stateNode,l=s.memoizedProps;try{for(var m=s.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);sn(a,m,l),a[pn]=s,a[Un]=l}catch(T){re(s,s.return,T)}}var js=!1,xe=!1,Mv=!1,uC=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function LR(s,a){if(s=s.containerInfo,Zv=Sg,s=TS(s),_y(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else t:{l=(l=s.ownerDocument)&&l.defaultView||window;var m=l.getSelection&&l.getSelection();if(m&&m.rangeCount!==0){l=m.anchorNode;var v=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{l.nodeType,T.nodeType}catch{l=null;break t}var _=0,I=-1,B=-1,Y=0,j=0,nt=s,K=null;e:for(;;){for(var W;nt!==l||v!==0&&nt.nodeType!==3||(I=_+v),nt!==T||m!==0&&nt.nodeType!==3||(B=_+m),nt.nodeType===3&&(_+=nt.nodeValue.length),(W=nt.firstChild)!==null;)K=nt,nt=W;for(;;){if(nt===s)break e;if(K===l&&++Y===v&&(I=_),K===T&&++j===m&&(B=_),(W=nt.nextSibling)!==null)break;nt=K,K=nt.parentNode}nt=W}l=I===-1||B===-1?null:{start:I,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(jv={focusedElem:s,selectionRange:l},Sg=!1,Ye=a;Ye!==null;)if(a=Ye,s=a.child,(a.subtreeFlags&1024)!==0&&s!==null)s.return=a,Ye=s;else for(;Ye!==null;){switch(a=Ye,T=a.alternate,s=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,l=a,v=T.memoizedProps,T=T.memoizedState,m=l.stateNode;try{var Rt=Sr(l.type,v,l.elementType===l.type);s=m.getSnapshotBeforeUpdate(Rt,T),m.__reactInternalSnapshotBeforeUpdate=s}catch(xt){re(l,l.return,xt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)n0(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":n0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Ye=s;break}Ye=a.return}}function cC(s,a,l){var m=l.flags;switch(l.tag){case 0:case 11:case 15:ia(s,l),m&4&&Pd(5,l);break;case 1:if(ia(s,l),m&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(_){re(l,l.return,_)}else{var v=Sr(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(v,a,s.__reactInternalSnapshotBeforeUpdate)}catch(_){re(l,l.return,_)}}m&64&&sC(l),m&512&&Ld(l,l.return);break;case 3:if(ia(s,l),m&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{$S(s,a)}catch(_){re(l,l.return,_)}}break;case 27:a===null&&m&4&&lC(l);case 26:case 5:ia(s,l),a===null&&m&4&&aC(l),m&512&&Ld(l,l.return);break;case 12:ia(s,l);break;case 13:ia(s,l),m&4&&hC(s,l),m&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=qR.bind(null,l),rN(s,l))));break;case 22:if(m=l.memoizedState!==null||js,!m){a=a!==null&&a.memoizedState!==null||xe,v=js;var T=xe;js=m,(xe=a)&&!T?sa(s,l,(l.subtreeFlags&8772)!==0):ia(s,l),js=v,xe=T}break;case 30:break;default:ia(s,l)}}function dC(s){var a=s.alternate;a!==null&&(s.alternate=null,dC(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&ry(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var he=null,Bn=!1;function to(s,a,l){for(l=l.child;l!==null;)fC(s,a,l),l=l.sibling}function fC(s,a,l){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(ed,l)}catch{}switch(l.tag){case 26:xe||hs(l,a),to(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:xe||hs(l,a);var m=he,v=Bn;ca(l.type)&&(he=l.stateNode,Bn=!1),to(s,a,l),qd(l.stateNode),he=m,Bn=v;break;case 5:xe||hs(l,a);case 6:if(m=he,v=Bn,he=null,to(s,a,l),he=m,Bn=v,he!==null)if(Bn)try{(he.nodeType===9?he.body:he.nodeName==="HTML"?he.ownerDocument.body:he).removeChild(l.stateNode)}catch(T){re(l,a,T)}else try{he.removeChild(l.stateNode)}catch(T){re(l,a,T)}break;case 18:he!==null&&(Bn?(s=he,tb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Qd(s)):tb(he,l.stateNode));break;case 4:m=he,v=Bn,he=l.stateNode.containerInfo,Bn=!0,to(s,a,l),he=m,Bn=v;break;case 0:case 11:case 14:case 15:xe||na(2,l,a),xe||na(4,l,a),to(s,a,l);break;case 1:xe||(hs(l,a),m=l.stateNode,typeof m.componentWillUnmount=="function"&&oC(l,a,m)),to(s,a,l);break;case 21:to(s,a,l);break;case 22:xe=(m=xe)||l.memoizedState!==null,to(s,a,l),xe=m;break;default:to(s,a,l)}}function hC(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Qd(s)}catch(l){re(a,a.return,l)}}function kR(s){switch(s.tag){case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new uC),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new uC),a;default:throw Error(n(435,s.tag))}}function Rv(s,a){var l=kR(s);a.forEach(function(m){var v=zR.bind(null,s,m);l.has(m)||(l.add(m),m.then(v,v))})}function Zn(s,a){var l=a.deletions;if(l!==null)for(var m=0;m<l.length;m++){var v=l[m],T=s,_=a,I=_;t:for(;I!==null;){switch(I.tag){case 27:if(ca(I.type)){he=I.stateNode,Bn=!1;break t}break;case 5:he=I.stateNode,Bn=!1;break t;case 3:case 4:he=I.stateNode.containerInfo,Bn=!0;break t}I=I.return}if(he===null)throw Error(n(160));fC(T,_,v),he=null,Bn=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)pC(a,s),a=a.sibling}var Xi=null;function pC(s,a){var l=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Zn(a,s),jn(s),m&4&&(na(3,s,s.return),Pd(3,s),na(5,s,s.return));break;case 1:Zn(a,s),jn(s),m&512&&(xe||l===null||hs(l,l.return)),m&64&&js&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?m:l.concat(m))));break;case 26:var v=Xi;if(Zn(a,s),jn(s),m&512&&(xe||l===null||hs(l,l.return)),m&4){var T=l!==null?l.memoizedState:null;if(m=s.memoizedState,l===null)if(m===null)if(s.stateNode===null){t:{m=s.type,l=s.memoizedProps,v=v.ownerDocument||v;e:switch(m){case"title":T=v.getElementsByTagName("title")[0],(!T||T[sd]||T[pn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(m),v.head.insertBefore(T,v.querySelector("head > title"))),sn(T,m,l),T[pn]=s,ze(T),m=T;break t;case"link":var _=lb("link","href",v).get(m+(l.href||""));if(_){for(var I=0;I<_.length;I++)if(T=_[I],T.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&T.getAttribute("rel")===(l.rel==null?null:l.rel)&&T.getAttribute("title")===(l.title==null?null:l.title)&&T.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){_.splice(I,1);break e}}T=v.createElement(m),sn(T,m,l),v.head.appendChild(T);break;case"meta":if(_=lb("meta","content",v).get(m+(l.content||""))){for(I=0;I<_.length;I++)if(T=_[I],T.getAttribute("content")===(l.content==null?null:""+l.content)&&T.getAttribute("name")===(l.name==null?null:l.name)&&T.getAttribute("property")===(l.property==null?null:l.property)&&T.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&T.getAttribute("charset")===(l.charSet==null?null:l.charSet)){_.splice(I,1);break e}}T=v.createElement(m),sn(T,m,l),v.head.appendChild(T);break;default:throw Error(n(468,m))}T[pn]=s,ze(T),m=T}s.stateNode=m}else ub(v,s.type,s.stateNode);else s.stateNode=rb(v,m,s.memoizedProps);else T!==m?(T===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):T.count--,m===null?ub(v,s.type,s.stateNode):rb(v,m,s.memoizedProps)):m===null&&s.stateNode!==null&&xv(s,s.memoizedProps,l.memoizedProps)}break;case 27:Zn(a,s),jn(s),m&512&&(xe||l===null||hs(l,l.return)),l!==null&&m&4&&xv(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Zn(a,s),jn(s),m&512&&(xe||l===null||hs(l,l.return)),s.flags&32){v=s.stateNode;try{jl(v,"")}catch(W){re(s,s.return,W)}}m&4&&s.stateNode!=null&&(v=s.memoizedProps,xv(s,v,l!==null?l.memoizedProps:v)),m&1024&&(Mv=!0);break;case 6:if(Zn(a,s),jn(s),m&4){if(s.stateNode===null)throw Error(n(162));m=s.memoizedProps,l=s.stateNode;try{l.nodeValue=m}catch(W){re(s,s.return,W)}}break;case 3:if(vg=null,v=Xi,Xi=mg(a.containerInfo),Zn(a,s),Xi=v,jn(s),m&4&&l!==null&&l.memoizedState.isDehydrated)try{Qd(a.containerInfo)}catch(W){re(s,s.return,W)}Mv&&(Mv=!1,gC(s));break;case 4:m=Xi,Xi=mg(s.stateNode.containerInfo),Zn(a,s),jn(s),Xi=m;break;case 12:Zn(a,s),jn(s);break;case 13:Zn(a,s),jn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(kv=Xn()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Rv(s,m)));break;case 22:v=s.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,Y=js,j=xe;if(js=Y||v,xe=j||B,Zn(a,s),xe=j,js=Y,jn(s),m&8192)t:for(a=s.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(l===null||B||js||xe||Er(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){B=l=a;try{if(T=B.stateNode,v)_=T.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{I=B.stateNode;var nt=B.memoizedProps.style,K=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;I.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(W){re(B,B.return,W)}}}else if(a.tag===6){if(l===null){B=a;try{B.stateNode.nodeValue=v?"":B.memoizedProps}catch(W){re(B,B.return,W)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break t;for(;a.sibling===null;){if(a.return===null||a.return===s)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}m&4&&(m=s.updateQueue,m!==null&&(l=m.retryQueue,l!==null&&(m.retryQueue=null,Rv(s,l))));break;case 19:Zn(a,s),jn(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Rv(s,m)));break;case 30:break;case 21:break;default:Zn(a,s),jn(s)}}function jn(s){var a=s.flags;if(a&2){try{for(var l,m=s.return;m!==null;){if(rC(m)){l=m;break}m=m.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var v=l.stateNode,T=_v(s);ig(s,T,v);break;case 5:var _=l.stateNode;l.flags&32&&(jl(_,""),l.flags&=-33);var I=_v(s);ig(s,I,_);break;case 3:case 4:var B=l.stateNode.containerInfo,Y=_v(s);wv(s,Y,B);break;default:throw Error(n(161))}}catch(j){re(s,s.return,j)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function gC(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;gC(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ia(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)cC(s,a.alternate,a),a=a.sibling}function Er(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:na(4,a,a.return),Er(a);break;case 1:hs(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&oC(a,a.return,l),Er(a);break;case 27:qd(a.stateNode);case 26:case 5:hs(a,a.return),Er(a);break;case 22:a.memoizedState===null&&Er(a);break;case 30:Er(a);break;default:Er(a)}s=s.sibling}}function sa(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var m=a.alternate,v=s,T=a,_=T.flags;switch(T.tag){case 0:case 11:case 15:sa(v,T,l),Pd(4,T);break;case 1:if(sa(v,T,l),m=T,v=m.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(Y){re(m,m.return,Y)}if(m=T,v=m.updateQueue,v!==null){var I=m.stateNode;try{var B=v.shared.hiddenCallbacks;if(B!==null)for(v.shared.hiddenCallbacks=null,v=0;v<B.length;v++)zS(B[v],I)}catch(Y){re(m,m.return,Y)}}l&&_&64&&sC(T),Ld(T,T.return);break;case 27:lC(T);case 26:case 5:sa(v,T,l),l&&m===null&&_&4&&aC(T),Ld(T,T.return);break;case 12:sa(v,T,l);break;case 13:sa(v,T,l),l&&_&4&&hC(v,T);break;case 22:T.memoizedState===null&&sa(v,T,l),Ld(T,T.return);break;case 30:break;default:sa(v,T,l)}a=a.sibling}}function Nv(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Ad(l))}function Dv(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ad(s))}function ps(s,a,l,m){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)mC(s,a,l,m),a=a.sibling}function mC(s,a,l,m){var v=a.flags;switch(a.tag){case 0:case 11:case 15:ps(s,a,l,m),v&2048&&Pd(9,a);break;case 1:ps(s,a,l,m);break;case 3:ps(s,a,l,m),v&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ad(s)));break;case 12:if(v&2048){ps(s,a,l,m),s=a.stateNode;try{var T=a.memoizedProps,_=T.id,I=T.onPostCommit;typeof I=="function"&&I(_,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){re(a,a.return,B)}}else ps(s,a,l,m);break;case 13:ps(s,a,l,m);break;case 23:break;case 22:T=a.stateNode,_=a.alternate,a.memoizedState!==null?T._visibility&2?ps(s,a,l,m):kd(s,a):T._visibility&2?ps(s,a,l,m):(T._visibility|=2,vu(s,a,l,m,(a.subtreeFlags&10256)!==0)),v&2048&&Nv(_,a);break;case 24:ps(s,a,l,m),v&2048&&Dv(a.alternate,a);break;default:ps(s,a,l,m)}}function vu(s,a,l,m,v){for(v=v&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var T=s,_=a,I=l,B=m,Y=_.flags;switch(_.tag){case 0:case 11:case 15:vu(T,_,I,B,v),Pd(8,_);break;case 23:break;case 22:var j=_.stateNode;_.memoizedState!==null?j._visibility&2?vu(T,_,I,B,v):kd(T,_):(j._visibility|=2,vu(T,_,I,B,v)),v&&Y&2048&&Nv(_.alternate,_);break;case 24:vu(T,_,I,B,v),v&&Y&2048&&Dv(_.alternate,_);break;default:vu(T,_,I,B,v)}a=a.sibling}}function kd(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,m=a,v=m.flags;switch(m.tag){case 22:kd(l,m),v&2048&&Nv(m.alternate,m);break;case 24:kd(l,m),v&2048&&Dv(m.alternate,m);break;default:kd(l,m)}a=a.sibling}}var Ud=8192;function Au(s){if(s.subtreeFlags&Ud)for(s=s.child;s!==null;)yC(s),s=s.sibling}function yC(s){switch(s.tag){case 26:Au(s),s.flags&Ud&&s.memoizedState!==null&&TN(Xi,s.memoizedState,s.memoizedProps);break;case 5:Au(s);break;case 3:case 4:var a=Xi;Xi=mg(s.stateNode.containerInfo),Au(s),Xi=a;break;case 22:s.memoizedState===null&&(a=s.alternate,a!==null&&a.memoizedState!==null?(a=Ud,Ud=16777216,Au(s),Ud=a):Au(s));break;default:Au(s)}}function vC(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Fd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var m=a[l];Ye=m,TC(m,s)}vC(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)AC(s),s=s.sibling}function AC(s){switch(s.tag){case 0:case 11:case 15:Fd(s),s.flags&2048&&na(9,s,s.return);break;case 3:Fd(s);break;case 12:Fd(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,sg(s)):Fd(s);break;default:Fd(s)}}function sg(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var m=a[l];Ye=m,TC(m,s)}vC(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:na(8,a,a.return),sg(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,sg(a));break;default:sg(a)}s=s.sibling}}function TC(s,a){for(;Ye!==null;){var l=Ye;switch(l.tag){case 0:case 11:case 15:na(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var m=l.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Ad(l.memoizedState.cache)}if(m=l.child,m!==null)m.return=l,Ye=m;else t:for(l=s;Ye!==null;){m=Ye;var v=m.sibling,T=m.return;if(dC(m),m===l){Ye=null;break t}if(v!==null){v.return=T,Ye=v;break t}Ye=T}}}var UR={getCacheForType:function(s){var a=gn(Fe),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l}},FR=typeof WeakMap=="function"?WeakMap:Map,Wt=0,le=null,Ot=null,qt=0,Qt=0,ti=null,oa=!1,Tu=!1,Iv=!1,eo=0,Ee=0,aa=0,Cr=0,Pv=0,Ni=0,Su=0,Od=null,Gn=null,Lv=!1,kv=0,og=1/0,ag=null,ra=null,nn=0,la=null,Eu=null,Cu=0,Uv=0,Fv=null,SC=null,Bd=0,Ov=null;function ei(){if((Wt&2)!==0&&qt!==0)return qt&-qt;if(O.T!==null){var s=cu;return s!==0?s:$v()}return FT()}function EC(){Ni===0&&(Ni=(qt&536870912)===0||Xt?PT():536870912);var s=Ri.current;return s!==null&&(s.flags|=32),Ni}function ni(s,a,l){(s===le&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)&&(bu(s,0),ua(s,qt,Ni,!1)),id(s,l),((Wt&2)===0||s!==le)&&(s===le&&((Wt&2)===0&&(Cr|=l),Ee===4&&ua(s,qt,Ni,!1)),gs(s))}function CC(s,a,l){if((Wt&6)!==0)throw Error(n(327));var m=!l&&(a&124)===0&&(a&s.expiredLanes)===0||nd(s,a),v=m?GR(s,a):Vv(s,a,!0),T=m;do{if(v===0){Tu&&!m&&ua(s,a,0,!1);break}else{if(l=s.current.alternate,T&&!OR(l)){v=Vv(s,a,!1),T=!1;continue}if(v===2){if(T=a,s.errorRecoveryDisabledLanes&T)var _=0;else _=s.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){a=_;t:{var I=s;v=Od;var B=I.current.memoizedState.isDehydrated;if(B&&(bu(I,_).flags|=256),_=Vv(I,_,!1),_!==2){if(Iv&&!B){I.errorRecoveryDisabledLanes|=T,Cr|=T,v=4;break t}T=Gn,Gn=v,T!==null&&(Gn===null?Gn=T:Gn.push.apply(Gn,T))}v=_}if(T=!1,v!==2)continue}}if(v===1){bu(s,0),ua(s,a,0,!0);break}t:{switch(m=s,T=v,T){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:ua(m,a,Ni,!oa);break t;case 2:Gn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(v=kv+300-Xn(),10<v)){if(ua(m,a,Ni,!oa),yp(m,0,!0)!==0)break t;m.timeoutHandle=ZC(bC.bind(null,m,l,Gn,ag,Lv,a,Ni,Cr,Su,oa,T,2,-0,0),v);break t}bC(m,l,Gn,ag,Lv,a,Ni,Cr,Su,oa,T,0,-0,0)}}break}while(!0);gs(s)}function bC(s,a,l,m,v,T,_,I,B,Y,j,nt,K,W){if(s.timeoutHandle=-1,nt=a.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(Yd={stylesheets:null,count:0,unsuspend:AN},yC(a),nt=SN(),nt!==null)){s.cancelPendingCommit=nt(DC.bind(null,s,a,T,l,m,v,_,I,B,j,1,K,W)),ua(s,T,_,!Y);return}DC(s,a,T,l,m,v,_,I,B)}function OR(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var m=0;m<l.length;m++){var v=l[m],T=v.getSnapshot;v=v.value;try{if(!Wn(T(),v))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ua(s,a,l,m){a&=~Pv,a&=~Cr,s.suspendedLanes|=a,s.pingedLanes&=~a,m&&(s.warmLanes|=a),m=s.expirationTimes;for(var v=a;0<v;){var T=31-Kn(v),_=1<<T;m[T]=-1,v&=~_}l!==0&&kT(s,l,a)}function rg(){return(Wt&6)===0?(Gd(0),!1):!0}function Bv(){if(Ot!==null){if(Qt===0)var s=Ot.return;else s=Ot,Xs=yr=null,nv(s),mu=null,Nd=0,s=Ot;for(;s!==null;)iC(s.alternate,s),s=s.return;Ot=null}}function bu(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,nN(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Bv(),le=s,Ot=l=zs(s.current,null),qt=a,Qt=0,ti=null,oa=!1,Tu=nd(s,a),Iv=!1,Su=Ni=Pv=Cr=aa=Ee=0,Gn=Od=null,Lv=!1,(a&8)!==0&&(a|=a&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=a;0<m;){var v=31-Kn(m),T=1<<v;a|=s[v],m&=~T}return eo=a,Rp(),l}function xC(s,a){kt=null,O.H=Jp,a===Sd||a===Op?(a=HS(),Qt=3):a===BS?(a=HS(),Qt=4):Qt=a===qE?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ti=a,Ot===null&&(Ee=1,jp(s,xi(a,s.current)))}function _C(){var s=O.H;return O.H=Jp,s===null?Jp:s}function wC(){var s=O.A;return O.A=UR,s}function Gv(){Ee=4,oa||(qt&4194048)!==qt&&Ri.current!==null||(Tu=!0),(aa&134217727)===0&&(Cr&134217727)===0||le===null||ua(le,qt,Ni,!1)}function Vv(s,a,l){var m=Wt;Wt|=2;var v=_C(),T=wC();(le!==s||qt!==a)&&(ag=null,bu(s,a)),a=!1;var _=Ee;t:do try{if(Qt!==0&&Ot!==null){var I=Ot,B=ti;switch(Qt){case 8:Bv(),_=6;break t;case 3:case 2:case 9:case 6:Ri.current===null&&(a=!0);var Y=Qt;if(Qt=0,ti=null,xu(s,I,B,Y),l&&Tu){_=0;break t}break;default:Y=Qt,Qt=0,ti=null,xu(s,I,B,Y)}}BR(),_=Ee;break}catch(j){xC(s,j)}while(!0);return a&&s.shellSuspendCounter++,Xs=yr=null,Wt=m,O.H=v,O.A=T,Ot===null&&(le=null,qt=0,Rp()),_}function BR(){for(;Ot!==null;)MC(Ot)}function GR(s,a){var l=Wt;Wt|=2;var m=_C(),v=wC();le!==s||qt!==a?(ag=null,og=Xn()+500,bu(s,a)):Tu=nd(s,a);t:do try{if(Qt!==0&&Ot!==null){a=Ot;var T=ti;e:switch(Qt){case 1:Qt=0,ti=null,xu(s,a,T,1);break;case 2:case 9:if(GS(T)){Qt=0,ti=null,RC(a);break}a=function(){Qt!==2&&Qt!==9||le!==s||(Qt=7),gs(s)},T.then(a,a);break t;case 3:Qt=7;break t;case 4:Qt=5;break t;case 7:GS(T)?(Qt=0,ti=null,RC(a)):(Qt=0,ti=null,xu(s,a,T,7));break;case 5:var _=null;switch(Ot.tag){case 26:_=Ot.memoizedState;case 5:case 27:var I=Ot;if(!_||cb(_)){Qt=0,ti=null;var B=I.sibling;if(B!==null)Ot=B;else{var Y=I.return;Y!==null?(Ot=Y,lg(Y)):Ot=null}break e}}Qt=0,ti=null,xu(s,a,T,5);break;case 6:Qt=0,ti=null,xu(s,a,T,6);break;case 8:Bv(),Ee=6;break t;default:throw Error(n(462))}}VR();break}catch(j){xC(s,j)}while(!0);return Xs=yr=null,O.H=m,O.A=v,Wt=l,Ot!==null?0:(le=null,qt=0,Rp(),Ee)}function VR(){for(;Ot!==null&&!dp();)MC(Ot)}function MC(s){var a=eC(s.alternate,s,eo);s.memoizedProps=s.pendingProps,a===null?lg(s):Ot=a}function RC(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=KE(l,a,a.pendingProps,a.type,void 0,qt);break;case 11:a=KE(l,a,a.pendingProps,a.type.render,a.ref,qt);break;case 5:nv(a);default:iC(l,a),a=Ot=NS(a,eo),a=eC(l,a,eo)}s.memoizedProps=s.pendingProps,a===null?lg(s):Ot=a}function xu(s,a,l,m){Xs=yr=null,nv(a),mu=null,Nd=0;var v=a.return;try{if(NR(s,v,a,l,qt)){Ee=1,jp(s,xi(l,s.current)),Ot=null;return}}catch(T){if(v!==null)throw Ot=v,T;Ee=1,jp(s,xi(l,s.current)),Ot=null;return}a.flags&32768?(Xt||m===1?s=!0:Tu||(qt&536870912)!==0?s=!1:(oa=s=!0,(m===2||m===9||m===3||m===6)&&(m=Ri.current,m!==null&&m.tag===13&&(m.flags|=16384))),NC(a,s)):lg(a)}function lg(s){var a=s;do{if((a.flags&32768)!==0){NC(a,oa);return}s=a.return;var l=IR(a.alternate,a,eo);if(l!==null){Ot=l;return}if(a=a.sibling,a!==null){Ot=a;return}Ot=a=s}while(a!==null);Ee===0&&(Ee=5)}function NC(s,a){do{var l=PR(s.alternate,s);if(l!==null){l.flags&=32767,Ot=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){Ot=s;return}Ot=s=l}while(s!==null);Ee=6,Ot=null}function DC(s,a,l,m,v,T,_,I,B){s.cancelPendingCommit=null;do ug();while(nn!==0);if((Wt&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(T=a.lanes|a.childLanes,T|=Dy,A1(s,l,T,_,I,B),s===le&&(Ot=le=null,qt=0),Eu=a,la=s,Cu=l,Uv=T,Fv=v,SC=m,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,$R($l,function(){return UC(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||m){m=O.T,O.T=null,v=J.p,J.p=2,_=Wt,Wt|=4;try{LR(s,a,l)}finally{Wt=_,J.p=v,O.T=m}}nn=1,IC(),PC(),LC()}}function IC(){if(nn===1){nn=0;var s=la,a=Eu,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var m=J.p;J.p=2;var v=Wt;Wt|=4;try{pC(a,s);var T=jv,_=TS(s.containerInfo),I=T.focusedElem,B=T.selectionRange;if(_!==I&&I&&I.ownerDocument&&AS(I.ownerDocument.documentElement,I)){if(B!==null&&_y(I)){var Y=B.start,j=B.end;if(j===void 0&&(j=Y),"selectionStart"in I)I.selectionStart=Y,I.selectionEnd=Math.min(j,I.value.length);else{var nt=I.ownerDocument||document,K=nt&&nt.defaultView||window;if(K.getSelection){var W=K.getSelection(),Rt=I.textContent.length,xt=Math.min(B.start,Rt),ne=B.end===void 0?xt:Math.min(B.end,Rt);!W.extend&&xt>ne&&(_=ne,ne=xt,xt=_);var q=vS(I,xt),H=vS(I,ne);if(q&&H&&(W.rangeCount!==1||W.anchorNode!==q.node||W.anchorOffset!==q.offset||W.focusNode!==H.node||W.focusOffset!==H.offset)){var z=nt.createRange();z.setStart(q.node,q.offset),W.removeAllRanges(),xt>ne?(W.addRange(z),W.extend(H.node,H.offset)):(z.setEnd(H.node,H.offset),W.addRange(z))}}}}for(nt=[],W=I;W=W.parentNode;)W.nodeType===1&&nt.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<nt.length;I++){var tt=nt[I];tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}Sg=!!Zv,jv=Zv=null}finally{Wt=v,J.p=m,O.T=l}}s.current=a,nn=2}}function PC(){if(nn===2){nn=0;var s=la,a=Eu,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var m=J.p;J.p=2;var v=Wt;Wt|=4;try{cC(s,a.alternate,a)}finally{Wt=v,J.p=m,O.T=l}}nn=3}}function LC(){if(nn===4||nn===3){nn=0,fp();var s=la,a=Eu,l=Cu,m=SC;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?nn=5:(nn=0,Eu=la=null,kC(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(ra=null),oy(l),a=a.stateNode,Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(ed,a,void 0,(a.current.flags&128)===128)}catch{}if(m!==null){a=O.T,v=J.p,J.p=2,O.T=null;try{for(var T=s.onRecoverableError,_=0;_<m.length;_++){var I=m[_];T(I.value,{componentStack:I.stack})}}finally{O.T=a,J.p=v}}(Cu&3)!==0&&ug(),gs(s),v=s.pendingLanes,(l&4194090)!==0&&(v&42)!==0?s===Ov?Bd++:(Bd=0,Ov=s):Bd=0,Gd(0)}}function kC(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ad(a)))}function ug(s){return IC(),PC(),LC(),UC()}function UC(){if(nn!==5)return!1;var s=la,a=Uv;Uv=0;var l=oy(Cu),m=O.T,v=J.p;try{J.p=32>l?32:l,O.T=null,l=Fv,Fv=null;var T=la,_=Cu;if(nn=0,Eu=la=null,Cu=0,(Wt&6)!==0)throw Error(n(331));var I=Wt;if(Wt|=4,AC(T.current),mC(T,T.current,_,l),Wt=I,Gd(0,!1),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(ed,T)}catch{}return!0}finally{J.p=v,O.T=m,kC(s,a)}}function FC(s,a,l){a=xi(l,a),a=mv(s.stateNode,a,2),s=Zo(s,a,2),s!==null&&(id(s,2),gs(s))}function re(s,a,l){if(s.tag===3)FC(s,s,l);else for(;a!==null;){if(a.tag===3){FC(a,s,l);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ra===null||!ra.has(m))){s=xi(l,s),l=VE(2),m=Zo(a,l,2),m!==null&&(HE(l,m,a,s),id(m,2),gs(m));break}}a=a.return}}function Hv(s,a,l){var m=s.pingCache;if(m===null){m=s.pingCache=new FR;var v=new Set;m.set(a,v)}else v=m.get(a),v===void 0&&(v=new Set,m.set(a,v));v.has(l)||(Iv=!0,v.add(l),s=HR.bind(null,s,a,l),a.then(s,s))}function HR(s,a,l){var m=s.pingCache;m!==null&&m.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,le===s&&(qt&l)===l&&(Ee===4||Ee===3&&(qt&62914560)===qt&&300>Xn()-kv?(Wt&2)===0&&bu(s,0):Pv|=l,Su===qt&&(Su=0)),gs(s)}function OC(s,a){a===0&&(a=LT()),s=au(s,a),s!==null&&(id(s,a),gs(s))}function qR(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),OC(s,l)}function zR(s,a){var l=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(l=v.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(a),OC(s,l)}function $R(s,a){return Vs(s,a)}var cg=null,_u=null,qv=!1,dg=!1,zv=!1,br=0;function gs(s){s!==_u&&s.next===null&&(_u===null?cg=_u=s:_u=_u.next=s),dg=!0,qv||(qv=!0,XR())}function Gd(s,a){if(!zv&&dg){zv=!0;do for(var l=!1,m=cg;m!==null;){if(s!==0){var v=m.pendingLanes;if(v===0)var T=0;else{var _=m.suspendedLanes,I=m.pingedLanes;T=(1<<31-Kn(42|s)+1)-1,T&=v&~(_&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(l=!0,HC(m,T))}else T=qt,T=yp(m,m===le?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(T&3)===0||nd(m,T)||(l=!0,HC(m,T));m=m.next}while(l);zv=!1}}function YR(){BC()}function BC(){dg=qv=!1;var s=0;br!==0&&(eN()&&(s=br),br=0);for(var a=Xn(),l=null,m=cg;m!==null;){var v=m.next,T=GC(m,a);T===0?(m.next=null,l===null?cg=v:l.next=v,v===null&&(_u=l)):(l=m,(s!==0||(T&3)!==0)&&(dg=!0)),m=v}Gd(s)}function GC(s,a){for(var l=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var _=31-Kn(T),I=1<<_,B=v[_];B===-1?((I&l)===0||(I&m)!==0)&&(v[_]=v1(I,a)):B<=a&&(s.expiredLanes|=I),T&=~I}if(a=le,l=qt,l=yp(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,l===0||s===a&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&$o(m),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||nd(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(m!==null&&$o(m),oy(l)){case 2:case 8:l=Cn;break;case 32:l=$l;break;case 268435456:l=IT;break;default:l=$l}return m=VC.bind(null,s),l=Vs(l,m),s.callbackPriority=a,s.callbackNode=l,a}return m!==null&&m!==null&&$o(m),s.callbackPriority=2,s.callbackNode=null,2}function VC(s,a){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(ug()&&s.callbackNode!==l)return null;var m=qt;return m=yp(s,s===le?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(CC(s,m,a),GC(s,Xn()),s.callbackNode!=null&&s.callbackNode===l?VC.bind(null,s):null)}function HC(s,a){if(ug())return null;CC(s,a,!0)}function XR(){iN(function(){(Wt&6)!==0?Vs(pp,YR):BC()})}function $v(){return br===0&&(br=PT()),br}function qC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ep(""+s)}function zC(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function JR(s,a,l,m,v){if(a==="submit"&&l&&l.stateNode===v){var T=qC((v[Un]||null).action),_=m.submitter;_&&(a=(a=_[Un]||null)?qC(a.formAction):_.getAttribute("formAction"),a!==null&&(T=a,_=null));var I=new _p("action","action",null,m,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(br!==0){var B=_?zC(v,_):new FormData(v);dv(l,{pending:!0,data:B,method:v.method,action:T},null,B)}}else typeof T=="function"&&(I.preventDefault(),B=_?zC(v,_):new FormData(v),dv(l,{pending:!0,data:B,method:v.method,action:T},T,B))},currentTarget:v}]})}}for(var Yv=0;Yv<Ny.length;Yv++){var Xv=Ny[Yv],KR=Xv.toLowerCase(),WR=Xv[0].toUpperCase()+Xv.slice(1);Yi(KR,"on"+WR)}Yi(CS,"onAnimationEnd"),Yi(bS,"onAnimationIteration"),Yi(xS,"onAnimationStart"),Yi("dblclick","onDoubleClick"),Yi("focusin","onFocus"),Yi("focusout","onBlur"),Yi(hR,"onTransitionRun"),Yi(pR,"onTransitionStart"),Yi(gR,"onTransitionCancel"),Yi(_S,"onTransitionEnd"),Wl("onMouseEnter",["mouseout","mouseover"]),Wl("onMouseLeave",["mouseout","mouseover"]),Wl("onPointerEnter",["pointerout","pointerover"]),Wl("onPointerLeave",["pointerout","pointerover"]),lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),lr("onBeforeInput",["compositionend","keypress","textInput","paste"]),lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vd));function $C(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var m=s[l],v=m.event;m=m.listeners;t:{var T=void 0;if(a)for(var _=m.length-1;0<=_;_--){var I=m[_],B=I.instance,Y=I.currentTarget;if(I=I.listener,B!==T&&v.isPropagationStopped())break t;T=I,v.currentTarget=Y;try{T(v)}catch(j){Zp(j)}v.currentTarget=null,T=B}else for(_=0;_<m.length;_++){if(I=m[_],B=I.instance,Y=I.currentTarget,I=I.listener,B!==T&&v.isPropagationStopped())break t;T=I,v.currentTarget=Y;try{T(v)}catch(j){Zp(j)}v.currentTarget=null,T=B}}}}function Bt(s,a){var l=a[ay];l===void 0&&(l=a[ay]=new Set);var m=s+"__bubble";l.has(m)||(YC(a,s,2,!1),l.add(m))}function Jv(s,a,l){var m=0;a&&(m|=4),YC(l,s,m,a)}var fg="_reactListening"+Math.random().toString(36).slice(2);function Kv(s){if(!s[fg]){s[fg]=!0,BT.forEach(function(l){l!=="selectionchange"&&(QR.has(l)||Jv(l,!1,s),Jv(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[fg]||(a[fg]=!0,Jv("selectionchange",!1,a))}}function YC(s,a,l,m){switch(mb(a)){case 2:var v=bN;break;case 8:v=xN;break;default:v=u0}l=v.bind(null,a,l,s),v=void 0,!yy||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(a,l,{capture:!0,passive:v}):s.addEventListener(a,l,!0):v!==void 0?s.addEventListener(a,l,{passive:v}):s.addEventListener(a,l,!1)}function Wv(s,a,l,m,v){var T=m;if((a&1)===0&&(a&2)===0&&m!==null)t:for(;;){if(m===null)return;var _=m.tag;if(_===3||_===4){var I=m.stateNode.containerInfo;if(I===v)break;if(_===4)for(_=m.return;_!==null;){var B=_.tag;if((B===3||B===4)&&_.stateNode.containerInfo===v)return;_=_.return}for(;I!==null;){if(_=Xl(I),_===null)return;if(B=_.tag,B===5||B===6||B===26||B===27){m=T=_;continue t}I=I.parentNode}}m=m.return}jT(function(){var Y=T,j=gy(l),nt=[];t:{var K=wS.get(s);if(K!==void 0){var W=_p,Rt=s;switch(s){case"keypress":if(bp(l)===0)break t;case"keydown":case"keyup":W=$1;break;case"focusin":Rt="focus",W=Sy;break;case"focusout":Rt="blur",W=Sy;break;case"beforeblur":case"afterblur":W=Sy;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=nS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=P1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=J1;break;case CS:case bS:case xS:W=U1;break;case _S:W=W1;break;case"scroll":case"scrollend":W=D1;break;case"wheel":W=Z1;break;case"copy":case"cut":case"paste":W=O1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=sS;break;case"toggle":case"beforetoggle":W=tR}var xt=(a&4)!==0,ne=!xt&&(s==="scroll"||s==="scrollend"),q=xt?K!==null?K+"Capture":null:K;xt=[];for(var H=Y,z;H!==null;){var tt=H;if(z=tt.stateNode,tt=tt.tag,tt!==5&&tt!==26&&tt!==27||z===null||q===null||(tt=ad(H,q),tt!=null&&xt.push(Hd(H,tt,z))),ne)break;H=H.return}0<xt.length&&(K=new W(K,Rt,null,l,j),nt.push({event:K,listeners:xt}))}}if((a&7)===0){t:{if(K=s==="mouseover"||s==="pointerover",W=s==="mouseout"||s==="pointerout",K&&l!==py&&(Rt=l.relatedTarget||l.fromElement)&&(Xl(Rt)||Rt[Yl]))break t;if((W||K)&&(K=j.window===j?j:(K=j.ownerDocument)?K.defaultView||K.parentWindow:window,W?(Rt=l.relatedTarget||l.toElement,W=Y,Rt=Rt?Xl(Rt):null,Rt!==null&&(ne=r(Rt),xt=Rt.tag,Rt!==ne||xt!==5&&xt!==27&&xt!==6)&&(Rt=null)):(W=null,Rt=Y),W!==Rt)){if(xt=nS,tt="onMouseLeave",q="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(xt=sS,tt="onPointerLeave",q="onPointerEnter",H="pointer"),ne=W==null?K:od(W),z=Rt==null?K:od(Rt),K=new xt(tt,H+"leave",W,l,j),K.target=ne,K.relatedTarget=z,tt=null,Xl(j)===Y&&(xt=new xt(q,H+"enter",Rt,l,j),xt.target=z,xt.relatedTarget=ne,tt=xt),ne=tt,W&&Rt)e:{for(xt=W,q=Rt,H=0,z=xt;z;z=wu(z))H++;for(z=0,tt=q;tt;tt=wu(tt))z++;for(;0<H-z;)xt=wu(xt),H--;for(;0<z-H;)q=wu(q),z--;for(;H--;){if(xt===q||q!==null&&xt===q.alternate)break e;xt=wu(xt),q=wu(q)}xt=null}else xt=null;W!==null&&XC(nt,K,W,xt,!1),Rt!==null&&ne!==null&&XC(nt,ne,Rt,xt,!0)}}t:{if(K=Y?od(Y):window,W=K.nodeName&&K.nodeName.toLowerCase(),W==="select"||W==="input"&&K.type==="file")var pt=fS;else if(cS(K))if(hS)pt=cR;else{pt=lR;var Ut=rR}else W=K.nodeName,!W||W.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?Y&&hy(Y.elementType)&&(pt=fS):pt=uR;if(pt&&(pt=pt(s,Y))){dS(nt,pt,l,j);break t}Ut&&Ut(s,K,Y),s==="focusout"&&Y&&K.type==="number"&&Y.memoizedProps.value!=null&&fy(K,"number",K.value)}switch(Ut=Y?od(Y):window,s){case"focusin":(cS(Ut)||Ut.contentEditable==="true")&&(iu=Ut,wy=Y,pd=null);break;case"focusout":pd=wy=iu=null;break;case"mousedown":My=!0;break;case"contextmenu":case"mouseup":case"dragend":My=!1,SS(nt,l,j);break;case"selectionchange":if(fR)break;case"keydown":case"keyup":SS(nt,l,j)}var St;if(Cy)t:{switch(s){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else nu?lS(s,l)&&(Mt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Mt="onCompositionStart");Mt&&(oS&&l.locale!=="ko"&&(nu||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&nu&&(St=tS()):(Jo=j,vy="value"in Jo?Jo.value:Jo.textContent,nu=!0)),Ut=hg(Y,Mt),0<Ut.length&&(Mt=new iS(Mt,s,null,l,j),nt.push({event:Mt,listeners:Ut}),St?Mt.data=St:(St=uS(l),St!==null&&(Mt.data=St)))),(St=nR?iR(s,l):sR(s,l))&&(Mt=hg(Y,"onBeforeInput"),0<Mt.length&&(Ut=new iS("onBeforeInput","beforeinput",null,l,j),nt.push({event:Ut,listeners:Mt}),Ut.data=St)),JR(nt,s,Y,l,j)}$C(nt,a)})}function Hd(s,a,l){return{instance:s,listener:a,currentTarget:l}}function hg(s,a){for(var l=a+"Capture",m=[];s!==null;){var v=s,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=ad(s,l),v!=null&&m.unshift(Hd(s,v,T)),v=ad(s,a),v!=null&&m.push(Hd(s,v,T))),s.tag===3)return m;s=s.return}return[]}function wu(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function XC(s,a,l,m,v){for(var T=a._reactName,_=[];l!==null&&l!==m;){var I=l,B=I.alternate,Y=I.stateNode;if(I=I.tag,B!==null&&B===m)break;I!==5&&I!==26&&I!==27||Y===null||(B=Y,v?(Y=ad(l,T),Y!=null&&_.unshift(Hd(l,Y,B))):v||(Y=ad(l,T),Y!=null&&_.push(Hd(l,Y,B)))),l=l.return}_.length!==0&&s.push({event:a,listeners:_})}var ZR=/\r\n?/g,jR=/\u0000|\uFFFD/g;function JC(s){return(typeof s=="string"?s:""+s).replace(ZR,`
`).replace(jR,"")}function KC(s,a){return a=JC(a),JC(s)===a}function pg(){}function ee(s,a,l,m,v,T){switch(l){case"children":typeof m=="string"?a==="body"||a==="textarea"&&m===""||jl(s,m):(typeof m=="number"||typeof m=="bigint")&&a!=="body"&&jl(s,""+m);break;case"className":Ap(s,"class",m);break;case"tabIndex":Ap(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Ap(s,l,m);break;case"style":QT(s,m,T);break;case"data":if(a!=="object"){Ap(s,"data",m);break}case"src":case"href":if(m===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(l);break}m=Ep(""+m),s.setAttribute(l,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(l==="formAction"?(a!=="input"&&ee(s,a,"name",v.name,v,null),ee(s,a,"formEncType",v.formEncType,v,null),ee(s,a,"formMethod",v.formMethod,v,null),ee(s,a,"formTarget",v.formTarget,v,null)):(ee(s,a,"encType",v.encType,v,null),ee(s,a,"method",v.method,v,null),ee(s,a,"target",v.target,v,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(l);break}m=Ep(""+m),s.setAttribute(l,m);break;case"onClick":m!=null&&(s.onclick=pg);break;case"onScroll":m!=null&&Bt("scroll",s);break;case"onScrollEnd":m!=null&&Bt("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(l=m.__html,l!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}l=Ep(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,""+m):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":m===!0?s.setAttribute(l,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(l,m):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(l,m):s.removeAttribute(l);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(l):s.setAttribute(l,m);break;case"popover":Bt("beforetoggle",s),Bt("toggle",s),vp(s,"popover",m);break;case"xlinkActuate":Hs(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Hs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Hs(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Hs(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Hs(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Hs(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Hs(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Hs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Hs(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":vp(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=R1.get(l)||l,vp(s,l,m))}}function Qv(s,a,l,m,v,T){switch(l){case"style":QT(s,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(l=m.__html,l!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"children":typeof m=="string"?jl(s,m):(typeof m=="number"||typeof m=="bigint")&&jl(s,""+m);break;case"onScroll":m!=null&&Bt("scroll",s);break;case"onScrollEnd":m!=null&&Bt("scrollend",s);break;case"onClick":m!=null&&(s.onclick=pg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!GT.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(v=l.endsWith("Capture"),a=l.slice(2,v?l.length-7:void 0),T=s[Un]||null,T=T!=null?T[l]:null,typeof T=="function"&&s.removeEventListener(a,T,v),typeof m=="function")){typeof T!="function"&&T!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,m,v);break t}l in s?s[l]=m:m===!0?s.setAttribute(l,""):vp(s,l,m)}}}function sn(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",s),Bt("load",s);var m=!1,v=!1,T;for(T in l)if(l.hasOwnProperty(T)){var _=l[T];if(_!=null)switch(T){case"src":m=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ee(s,a,T,_,l,null)}}v&&ee(s,a,"srcSet",l.srcSet,l,null),m&&ee(s,a,"src",l.src,l,null);return;case"input":Bt("invalid",s);var I=T=_=v=null,B=null,Y=null;for(m in l)if(l.hasOwnProperty(m)){var j=l[m];if(j!=null)switch(m){case"name":v=j;break;case"type":_=j;break;case"checked":B=j;break;case"defaultChecked":Y=j;break;case"value":T=j;break;case"defaultValue":I=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(137,a));break;default:ee(s,a,m,j,l,null)}}XT(s,T,I,B,Y,_,v,!1),Tp(s);return;case"select":Bt("invalid",s),m=_=T=null;for(v in l)if(l.hasOwnProperty(v)&&(I=l[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":_=I;break;case"multiple":m=I;default:ee(s,a,v,I,l,null)}a=T,l=_,s.multiple=!!m,a!=null?Zl(s,!!m,a,!1):l!=null&&Zl(s,!!m,l,!0);return;case"textarea":Bt("invalid",s),T=v=m=null;for(_ in l)if(l.hasOwnProperty(_)&&(I=l[_],I!=null))switch(_){case"value":m=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:ee(s,a,_,I,l,null)}KT(s,m,v,T),Tp(s);return;case"option":for(B in l)if(l.hasOwnProperty(B)&&(m=l[B],m!=null))switch(B){case"selected":s.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ee(s,a,B,m,l,null)}return;case"dialog":Bt("beforetoggle",s),Bt("toggle",s),Bt("cancel",s),Bt("close",s);break;case"iframe":case"object":Bt("load",s);break;case"video":case"audio":for(m=0;m<Vd.length;m++)Bt(Vd[m],s);break;case"image":Bt("error",s),Bt("load",s);break;case"details":Bt("toggle",s);break;case"embed":case"source":case"link":Bt("error",s),Bt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in l)if(l.hasOwnProperty(Y)&&(m=l[Y],m!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ee(s,a,Y,m,l,null)}return;default:if(hy(a)){for(j in l)l.hasOwnProperty(j)&&(m=l[j],m!==void 0&&Qv(s,a,j,m,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(m=l[I],m!=null&&ee(s,a,I,m,l,null))}function tN(s,a,l,m){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,_=null,I=null,B=null,Y=null,j=null;for(W in l){var nt=l[W];if(l.hasOwnProperty(W)&&nt!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":B=nt;default:m.hasOwnProperty(W)||ee(s,a,W,null,m,nt)}}for(var K in m){var W=m[K];if(nt=l[K],m.hasOwnProperty(K)&&(W!=null||nt!=null))switch(K){case"type":T=W;break;case"name":v=W;break;case"checked":Y=W;break;case"defaultChecked":j=W;break;case"value":_=W;break;case"defaultValue":I=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:W!==nt&&ee(s,a,K,W,m,nt)}}dy(s,_,I,B,Y,j,T,v);return;case"select":W=_=I=K=null;for(T in l)if(B=l[T],l.hasOwnProperty(T)&&B!=null)switch(T){case"value":break;case"multiple":W=B;default:m.hasOwnProperty(T)||ee(s,a,T,null,m,B)}for(v in m)if(T=m[v],B=l[v],m.hasOwnProperty(v)&&(T!=null||B!=null))switch(v){case"value":K=T;break;case"defaultValue":I=T;break;case"multiple":_=T;default:T!==B&&ee(s,a,v,T,m,B)}a=I,l=_,m=W,K!=null?Zl(s,!!l,K,!1):!!m!=!!l&&(a!=null?Zl(s,!!l,a,!0):Zl(s,!!l,l?[]:"",!1));return;case"textarea":W=K=null;for(I in l)if(v=l[I],l.hasOwnProperty(I)&&v!=null&&!m.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ee(s,a,I,null,m,v)}for(_ in m)if(v=m[_],T=l[_],m.hasOwnProperty(_)&&(v!=null||T!=null))switch(_){case"value":K=v;break;case"defaultValue":W=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==T&&ee(s,a,_,v,m,T)}JT(s,K,W);return;case"option":for(var Rt in l)if(K=l[Rt],l.hasOwnProperty(Rt)&&K!=null&&!m.hasOwnProperty(Rt))switch(Rt){case"selected":s.selected=!1;break;default:ee(s,a,Rt,null,m,K)}for(B in m)if(K=m[B],W=l[B],m.hasOwnProperty(B)&&K!==W&&(K!=null||W!=null))switch(B){case"selected":s.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:ee(s,a,B,K,m,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in l)K=l[xt],l.hasOwnProperty(xt)&&K!=null&&!m.hasOwnProperty(xt)&&ee(s,a,xt,null,m,K);for(Y in m)if(K=m[Y],W=l[Y],m.hasOwnProperty(Y)&&K!==W&&(K!=null||W!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(137,a));break;default:ee(s,a,Y,K,m,W)}return;default:if(hy(a)){for(var ne in l)K=l[ne],l.hasOwnProperty(ne)&&K!==void 0&&!m.hasOwnProperty(ne)&&Qv(s,a,ne,void 0,m,K);for(j in m)K=m[j],W=l[j],!m.hasOwnProperty(j)||K===W||K===void 0&&W===void 0||Qv(s,a,j,K,m,W);return}}for(var q in l)K=l[q],l.hasOwnProperty(q)&&K!=null&&!m.hasOwnProperty(q)&&ee(s,a,q,null,m,K);for(nt in m)K=m[nt],W=l[nt],!m.hasOwnProperty(nt)||K===W||K==null&&W==null||ee(s,a,nt,K,m,W)}var Zv=null,jv=null;function gg(s){return s.nodeType===9?s:s.ownerDocument}function WC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QC(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function t0(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var e0=null;function eN(){var s=window.event;return s&&s.type==="popstate"?s===e0?!1:(e0=s,!0):(e0=null,!1)}var ZC=typeof setTimeout=="function"?setTimeout:void 0,nN=typeof clearTimeout=="function"?clearTimeout:void 0,jC=typeof Promise=="function"?Promise:void 0,iN=typeof queueMicrotask=="function"?queueMicrotask:typeof jC<"u"?function(s){return jC.resolve(null).then(s).catch(sN)}:ZC;function sN(s){setTimeout(function(){throw s})}function ca(s){return s==="head"}function tb(s,a){var l=a,m=0,v=0;do{var T=l.nextSibling;if(s.removeChild(l),T&&T.nodeType===8)if(l=T.data,l==="/$"){if(0<m&&8>m){l=m;var _=s.ownerDocument;if(l&1&&qd(_.documentElement),l&2&&qd(_.body),l&4)for(l=_.head,qd(l),_=l.firstChild;_;){var I=_.nextSibling,B=_.nodeName;_[sd]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&_.rel.toLowerCase()==="stylesheet"||l.removeChild(_),_=I}}if(v===0){s.removeChild(T),Qd(a);return}v--}else l==="$"||l==="$?"||l==="$!"?v++:m=l.charCodeAt(0)-48;else m=0;l=T}while(l);Qd(a)}function n0(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":n0(l),ry(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function oN(s,a,l,m){for(;s.nodeType===1;){var v=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[sd])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=Ji(s.nextSibling),s===null)break}return null}function aN(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ji(s.nextSibling),s===null))return null;return s}function i0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function rN(s,a){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")a();else{var m=function(){a(),l.removeEventListener("DOMContentLoaded",m)};l.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function Ji(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return s}var s0=null;function eb(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return s;a--}else l==="/$"&&a++}s=s.previousSibling}return null}function nb(s,a,l){switch(a=gg(l),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function qd(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);ry(s)}var Di=new Map,ib=new Set;function mg(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var no=J.d;J.d={f:lN,r:uN,D:cN,C:dN,L:fN,m:hN,X:gN,S:pN,M:mN};function lN(){var s=no.f(),a=rg();return s||a}function uN(s){var a=Jl(s);a!==null&&a.tag===5&&a.type==="form"?CE(a):no.r(s)}var Mu=typeof document>"u"?null:document;function sb(s,a,l){var m=Mu;if(m&&typeof a=="string"&&a){var v=bi(a);v='link[rel="'+s+'"][href="'+v+'"]',typeof l=="string"&&(v+='[crossorigin="'+l+'"]'),ib.has(v)||(ib.add(v),s={rel:s,crossOrigin:l,href:a},m.querySelector(v)===null&&(a=m.createElement("link"),sn(a,"link",s),ze(a),m.head.appendChild(a)))}}function cN(s){no.D(s),sb("dns-prefetch",s,null)}function dN(s,a){no.C(s,a),sb("preconnect",s,a)}function fN(s,a,l){no.L(s,a,l);var m=Mu;if(m&&s&&a){var v='link[rel="preload"][as="'+bi(a)+'"]';a==="image"&&l&&l.imageSrcSet?(v+='[imagesrcset="'+bi(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(v+='[imagesizes="'+bi(l.imageSizes)+'"]')):v+='[href="'+bi(s)+'"]';var T=v;switch(a){case"style":T=Ru(s);break;case"script":T=Nu(s)}Di.has(T)||(s=y({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),Di.set(T,s),m.querySelector(v)!==null||a==="style"&&m.querySelector(zd(T))||a==="script"&&m.querySelector($d(T))||(a=m.createElement("link"),sn(a,"link",s),ze(a),m.head.appendChild(a)))}}function hN(s,a){no.m(s,a);var l=Mu;if(l&&s){var m=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+bi(m)+'"][href="'+bi(s)+'"]',T=v;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Nu(s)}if(!Di.has(T)&&(s=y({rel:"modulepreload",href:s},a),Di.set(T,s),l.querySelector(v)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector($d(T)))return}m=l.createElement("link"),sn(m,"link",s),ze(m),l.head.appendChild(m)}}}function pN(s,a,l){no.S(s,a,l);var m=Mu;if(m&&s){var v=Kl(m).hoistableStyles,T=Ru(s);a=a||"default";var _=v.get(T);if(!_){var I={loading:0,preload:null};if(_=m.querySelector(zd(T)))I.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":a},l),(l=Di.get(T))&&o0(s,l);var B=_=m.createElement("link");ze(B),sn(B,"link",s),B._p=new Promise(function(Y,j){B.onload=Y,B.onerror=j}),B.addEventListener("load",function(){I.loading|=1}),B.addEventListener("error",function(){I.loading|=2}),I.loading|=4,yg(_,a,m)}_={type:"stylesheet",instance:_,count:1,state:I},v.set(T,_)}}}function gN(s,a){no.X(s,a);var l=Mu;if(l&&s){var m=Kl(l).hoistableScripts,v=Nu(s),T=m.get(v);T||(T=l.querySelector($d(v)),T||(s=y({src:s,async:!0},a),(a=Di.get(v))&&a0(s,a),T=l.createElement("script"),ze(T),sn(T,"link",s),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(v,T))}}function mN(s,a){no.M(s,a);var l=Mu;if(l&&s){var m=Kl(l).hoistableScripts,v=Nu(s),T=m.get(v);T||(T=l.querySelector($d(v)),T||(s=y({src:s,async:!0,type:"module"},a),(a=Di.get(v))&&a0(s,a),T=l.createElement("script"),ze(T),sn(T,"link",s),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(v,T))}}function ob(s,a,l,m){var v=(v=gt.current)?mg(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Ru(l.href),l=Kl(v).hoistableStyles,m=l.get(a),m||(m={type:"style",instance:null,count:0,state:null},l.set(a,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Ru(l.href);var T=Kl(v).hoistableStyles,_=T.get(s);if(_||(v=v.ownerDocument||v,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,_),(T=v.querySelector(zd(s)))&&!T._p&&(_.instance=T,_.state.loading=5),Di.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Di.set(s,l),T||yN(v,s,l,_.state))),a&&m===null)throw Error(n(528,""));return _}if(a&&m!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Nu(l),l=Kl(v).hoistableScripts,m=l.get(a),m||(m={type:"script",instance:null,count:0,state:null},l.set(a,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Ru(s){return'href="'+bi(s)+'"'}function zd(s){return'link[rel="stylesheet"]['+s+"]"}function ab(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function yN(s,a,l,m){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?m.loading=1:(a=s.createElement("link"),m.preload=a,a.addEventListener("load",function(){return m.loading|=1}),a.addEventListener("error",function(){return m.loading|=2}),sn(a,"link",l),ze(a),s.head.appendChild(a))}function Nu(s){return'[src="'+bi(s)+'"]'}function $d(s){return"script[async]"+s}function rb(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var m=s.querySelector('style[data-href~="'+bi(l.href)+'"]');if(m)return a.instance=m,ze(m),m;var v=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),ze(m),sn(m,"style",v),yg(m,l.precedence,s),a.instance=m;case"stylesheet":v=Ru(l.href);var T=s.querySelector(zd(v));if(T)return a.state.loading|=4,a.instance=T,ze(T),T;m=ab(l),(v=Di.get(v))&&o0(m,v),T=(s.ownerDocument||s).createElement("link"),ze(T);var _=T;return _._p=new Promise(function(I,B){_.onload=I,_.onerror=B}),sn(T,"link",m),a.state.loading|=4,yg(T,l.precedence,s),a.instance=T;case"script":return T=Nu(l.src),(v=s.querySelector($d(T)))?(a.instance=v,ze(v),v):(m=l,(v=Di.get(T))&&(m=y({},l),a0(m,v)),s=s.ownerDocument||s,v=s.createElement("script"),ze(v),sn(v,"link",m),s.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(m=a.instance,a.state.loading|=4,yg(m,l.precedence,s));return a.instance}function yg(s,a,l){for(var m=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=m.length?m[m.length-1]:null,T=v,_=0;_<m.length;_++){var I=m[_];if(I.dataset.precedence===a)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(s,T.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function o0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function a0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var vg=null;function lb(s,a,l){if(vg===null){var m=new Map,v=vg=new Map;v.set(l,m)}else v=vg,m=v.get(l),m||(m=new Map,v.set(l,m));if(m.has(s))return m;for(m.set(s,null),l=l.getElementsByTagName(s),v=0;v<l.length;v++){var T=l[v];if(!(T[sd]||T[pn]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var _=T.getAttribute(a)||"";_=s+_;var I=m.get(_);I?I.push(T):m.set(_,[T])}}return m}function ub(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function vN(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function cb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Yd=null;function AN(){}function TN(s,a,l){if(Yd===null)throw Error(n(475));var m=Yd;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var v=Ru(l.href),T=s.querySelector(zd(v));if(T){s=T._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(m.count++,m=Ag.bind(m),s.then(m,m)),a.state.loading|=4,a.instance=T,ze(T);return}T=s.ownerDocument||s,l=ab(l),(v=Di.get(v))&&o0(l,v),T=T.createElement("link"),ze(T);var _=T;_._p=new Promise(function(I,B){_.onload=I,_.onerror=B}),sn(T,"link",l),a.instance=T}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(a,s),(s=a.state.preload)&&(a.state.loading&3)===0&&(m.count++,a=Ag.bind(m),s.addEventListener("load",a),s.addEventListener("error",a))}}function SN(){if(Yd===null)throw Error(n(475));var s=Yd;return s.stylesheets&&s.count===0&&r0(s,s.stylesheets),0<s.count?function(a){var l=setTimeout(function(){if(s.stylesheets&&r0(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Ag(){if(this.count--,this.count===0){if(this.stylesheets)r0(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Tg=null;function r0(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Tg=new Map,a.forEach(EN,s),Tg=null,Ag.call(s))}function EN(s,a){if(!(a.state.loading&4)){var l=Tg.get(s);if(l)var m=l.get(null);else{l=new Map,Tg.set(s,l);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var _=v[T];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(l.set(_.dataset.precedence,_),m=_)}m&&l.set(null,m)}v=a.instance,_=v.getAttribute("data-precedence"),T=l.get(_)||m,T===m&&l.set(null,v),l.set(_,v),this.count++,m=Ag.bind(this),v.addEventListener("load",m),v.addEventListener("error",m),T?T.parentNode.insertBefore(v,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),a.state.loading|=4}}var Xd={$$typeof:L,Provider:null,Consumer:null,_currentValue:at,_currentValue2:at,_threadCount:0};function CN(s,a,l,m,v,T,_,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=iy(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=iy(0),this.hiddenUpdates=iy(null),this.identifierPrefix=m,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function db(s,a,l,m,v,T,_,I,B,Y,j,nt){return s=new CN(s,a,l,_,I,B,Y,nt),a=1,T===!0&&(a|=24),T=Qn(3,null,null,a),s.current=T,T.stateNode=s,a=Hy(),a.refCount++,s.pooledCache=a,a.refCount++,T.memoizedState={element:m,isDehydrated:l,cache:a},Yy(T),s}function fb(s){return s?(s=ru,s):ru}function hb(s,a,l,m,v,T){v=fb(v),m.context===null?m.context=v:m.pendingContext=v,m=Qo(a),m.payload={element:l},T=T===void 0?null:T,T!==null&&(m.callback=T),l=Zo(s,m,a),l!==null&&(ni(l,s,a),Cd(l,s,a))}function pb(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function l0(s,a){pb(s,a),(s=s.alternate)&&pb(s,a)}function gb(s){if(s.tag===13){var a=au(s,67108864);a!==null&&ni(a,s,67108864),l0(s,67108864)}}var Sg=!0;function bN(s,a,l,m){var v=O.T;O.T=null;var T=J.p;try{J.p=2,u0(s,a,l,m)}finally{J.p=T,O.T=v}}function xN(s,a,l,m){var v=O.T;O.T=null;var T=J.p;try{J.p=8,u0(s,a,l,m)}finally{J.p=T,O.T=v}}function u0(s,a,l,m){if(Sg){var v=c0(m);if(v===null)Wv(s,a,m,Eg,l),yb(s,m);else if(wN(v,s,a,l,m))m.stopPropagation();else if(yb(s,m),a&4&&-1<_N.indexOf(s)){for(;v!==null;){var T=Jl(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var _=rr(T.pendingLanes);if(_!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;_;){var B=1<<31-Kn(_);I.entanglements[1]|=B,_&=~B}gs(T),(Wt&6)===0&&(og=Xn()+500,Gd(0))}}break;case 13:I=au(T,2),I!==null&&ni(I,T,2),rg(),l0(T,2)}if(T=c0(m),T===null&&Wv(s,a,m,Eg,l),T===v)break;v=T}v!==null&&m.stopPropagation()}else Wv(s,a,m,null,l)}}function c0(s){return s=gy(s),d0(s)}var Eg=null;function d0(s){if(Eg=null,s=Xl(s),s!==null){var a=r(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=u(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Eg=s,null}function mb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hp()){case pp:return 2;case Cn:return 8;case $l:case f1:return 32;case IT:return 268435456;default:return 32}default:return 32}}var f0=!1,da=null,fa=null,ha=null,Jd=new Map,Kd=new Map,pa=[],_N="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yb(s,a){switch(s){case"focusin":case"focusout":da=null;break;case"dragenter":case"dragleave":fa=null;break;case"mouseover":case"mouseout":ha=null;break;case"pointerover":case"pointerout":Jd.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kd.delete(a.pointerId)}}function Wd(s,a,l,m,v,T){return s===null||s.nativeEvent!==T?(s={blockedOn:a,domEventName:l,eventSystemFlags:m,nativeEvent:T,targetContainers:[v]},a!==null&&(a=Jl(a),a!==null&&gb(a)),s):(s.eventSystemFlags|=m,a=s.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),s)}function wN(s,a,l,m,v){switch(a){case"focusin":return da=Wd(da,s,a,l,m,v),!0;case"dragenter":return fa=Wd(fa,s,a,l,m,v),!0;case"mouseover":return ha=Wd(ha,s,a,l,m,v),!0;case"pointerover":var T=v.pointerId;return Jd.set(T,Wd(Jd.get(T)||null,s,a,l,m,v)),!0;case"gotpointercapture":return T=v.pointerId,Kd.set(T,Wd(Kd.get(T)||null,s,a,l,m,v)),!0}return!1}function vb(s){var a=Xl(s.target);if(a!==null){var l=r(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){s.blockedOn=a,T1(s.priority,function(){if(l.tag===13){var m=ei();m=sy(m);var v=au(l,m);v!==null&&ni(v,l,m),l0(l,m)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Cg(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=c0(s.nativeEvent);if(l===null){l=s.nativeEvent;var m=new l.constructor(l.type,l);py=m,l.target.dispatchEvent(m),py=null}else return a=Jl(l),a!==null&&gb(a),s.blockedOn=l,!1;a.shift()}return!0}function Ab(s,a,l){Cg(s)&&l.delete(a)}function MN(){f0=!1,da!==null&&Cg(da)&&(da=null),fa!==null&&Cg(fa)&&(fa=null),ha!==null&&Cg(ha)&&(ha=null),Jd.forEach(Ab),Kd.forEach(Ab)}function bg(s,a){s.blockedOn===a&&(s.blockedOn=null,f0||(f0=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,MN)))}var xg=null;function Tb(s){xg!==s&&(xg=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){xg===s&&(xg=null);for(var a=0;a<s.length;a+=3){var l=s[a],m=s[a+1],v=s[a+2];if(typeof m!="function"){if(d0(m||l)===null)continue;break}var T=Jl(l);T!==null&&(s.splice(a,3),a-=3,dv(T,{pending:!0,data:v,method:l.method,action:m},m,v))}}))}function Qd(s){function a(B){return bg(B,s)}da!==null&&bg(da,s),fa!==null&&bg(fa,s),ha!==null&&bg(ha,s),Jd.forEach(a),Kd.forEach(a);for(var l=0;l<pa.length;l++){var m=pa[l];m.blockedOn===s&&(m.blockedOn=null)}for(;0<pa.length&&(l=pa[0],l.blockedOn===null);)vb(l),l.blockedOn===null&&pa.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(m=0;m<l.length;m+=3){var v=l[m],T=l[m+1],_=v[Un]||null;if(typeof T=="function")_||Tb(l);else if(_){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,_=T[Un]||null)I=_.formAction;else if(d0(v)!==null)continue}else I=_.action;typeof I=="function"?l[m+1]=I:(l.splice(m,3),m-=3),Tb(l)}}}function h0(s){this._internalRoot=s}_g.prototype.render=h0.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,m=ei();hb(l,m,s,a,null,null)},_g.prototype.unmount=h0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;hb(s.current,2,null,s,null,null),rg(),a[Yl]=null}};function _g(s){this._internalRoot=s}_g.prototype.unstable_scheduleHydration=function(s){if(s){var a=FT();s={blockedOn:null,target:s,priority:a};for(var l=0;l<pa.length&&a!==0&&a<pa[l].priority;l++);pa.splice(l,0,s),l===0&&vb(s)}};var Sb=t.version;if(Sb!=="19.1.0")throw Error(n(527,Sb,"19.1.0"));J.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=f(a),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var RN={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wg.isDisabled&&wg.supportsFiber)try{ed=wg.inject(RN),Jn=wg}catch{}}return jd.createRoot=function(s,a){if(!o(s))throw Error(n(299));var l=!1,m="",v=FE,T=OE,_=BE,I=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(I=a.unstable_transitionCallbacks)),a=db(s,1,!1,null,null,l,m,v,T,_,I,null),s[Yl]=a.current,Kv(s),new h0(a)},jd.hydrateRoot=function(s,a,l){if(!o(s))throw Error(n(299));var m=!1,v="",T=FE,_=OE,I=BE,B=null,Y=null;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(T=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(B=l.unstable_transitionCallbacks),l.formState!==void 0&&(Y=l.formState)),a=db(s,1,!0,a,l??null,m,v,T,_,I,B,Y),a.context=fb(null),l=a.current,m=ei(),m=sy(m),v=Qo(m),v.callback=null,Zo(l,v,m),l=m,a.current.lanes=l,id(a,l),gs(a),s[Yl]=a.current,Kv(s),new _g(a)},jd.version="19.1.0",jd}var Ib;function HN(){if(Ib)return y0.exports;Ib=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),y0.exports=VN(),y0.exports}var qN=HN();const zN=E_(qN);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let $N,YN;function XN(){return{geminiUrl:$N,vertexUrl:YN}}function JN(i,t,e){var n,o,r;if(!(!((n=i.httpOptions)===null||n===void 0)&&n.baseUrl)){const u=XN();return i.vertexai?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(r=u.geminiUrl)!==null&&r!==void 0?r:e}return i.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hl{}function Tt(i,t){const e=/\{([^}]+)\}/g;return i.replace(e,(n,o)=>{if(Object.prototype.hasOwnProperty.call(t,o)){const r=t[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function p(i,t,e){for(let r=0;r<t.length-1;r++){const u=t[r];if(u.endsWith("[]")){const c=u.slice(0,-2);if(!(c in i))if(Array.isArray(e))i[c]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(i[c])){const f=i[c];if(Array.isArray(e))for(let h=0;h<f.length;h++){const y=f[h];p(y,t.slice(r+1),e[h])}else for(const h of f)p(h,t.slice(r+1),e)}return}else if(u.endsWith("[0]")){const c=u.slice(0,-3);c in i||(i[c]=[{}]);const f=i[c];p(f[0],t.slice(r+1),e);return}(!i[u]||typeof i[u]!="object")&&(i[u]={}),i=i[u]}const n=t[t.length-1],o=i[n];if(o!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===o)return;if(typeof o=="object"&&typeof e=="object"&&o!==null&&e!==null)Object.assign(o,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=e}function d(i,t){try{if(t.length===1&&t[0]==="_self")return i;for(let e=0;e<t.length;e++){if(typeof i!="object"||i===null)return;const n=t[e];if(n.endsWith("[]")){const o=n.slice(0,-2);if(o in i){const r=i[o];return Array.isArray(r)?r.map(u=>d(u,t.slice(e+1))):void 0}else return}else i=i[n]}return i}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Pb;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Pb||(Pb={}));var Lb;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(Lb||(Lb={}));var Fs;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(Fs||(Fs={}));var kb;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(kb||(kb={}));var Ub;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(Ub||(Ub={}));var Fb;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(Fb||(Fb={}));var Ob;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Ob||(Ob={}));var Bb;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(Bb||(Bb={}));var Gb;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Gb||(Gb={}));var Vb;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vb||(Vb={}));var Hb;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Hb||(Hb={}));var qb;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(qb||(qb={}));var zb;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(zb||(zb={}));var $b;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})($b||($b={}));var Yb;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY"})(Yb||(Yb={}));var Xb;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Xb||(Xb={}));var ym;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(ym||(ym={}));var Jb;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Jb||(Jb={}));var D0;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(D0||(D0={}));var Kb;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Kb||(Kb={}));var Wb;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Wb||(Wb={}));var Qb;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(Qb||(Qb={}));var Zb;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Zb||(Zb={}));var jb;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(jb||(jb={}));var tx;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(tx||(tx={}));var ex;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(ex||(ex={}));var nx;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(nx||(nx={}));var ix;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ix||(ix={}));var sx;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(sx||(sx={}));var ox;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(ox||(ox={}));var ax;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ax||(ax={}));var rx;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(rx||(rx={}));var lx;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(lx||(lx={}));var ux;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(ux||(ux={}));var cx;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(cx||(cx={}));var dx;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(dx||(dx={}));var fx;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(fx||(fx={}));var hx;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(hx||(hx={}));var px;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(px||(px={}));var gx;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(gx||(gx={}));var mx;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(mx||(mx={}));var Ou;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Ou||(Ou={}));class I0{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class tf{get text(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",y=!1;const A=[];for(const S of(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[E,b]of Object.entries(S))E!=="text"&&E!=="thought"&&(b!==null||b!==void 0)&&A.push(E);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;y=!0,h+=S.text}}return A.length>0&&console.warn(`there are non-text parts ${A} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?h:void 0}get data(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const y=[];for(const A of(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[S,E]of Object.entries(A))S!=="inlineData"&&(E!==null||E!==void 0)&&y.push(S);A.inlineData&&typeof A.inlineData.data=="string"&&(h+=atob(A.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,e,n,o,r,u,c,f;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,e,n,o,r,u,c,f,h;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(A=>A.executableCode).map(A=>A.executableCode).filter(A=>A!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,e,n,o,r,u,c,f,h;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(f=(c=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(A=>A.codeExecutionResult).map(A=>A.codeExecutionResult).filter(A=>A!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.output}}class yx{}class vx{}class KN{}class WN{}class Ax{}class Tx{}class Sx{}class QN{}class Ex{}class Cx{}class bx{}class ZN{}class jN{}class tD{}class xx{}class eD{get text(){var t,e,n;let o="",r=!1;const u=[];for(const c of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[f,h]of Object.entries(c))f!=="text"&&f!=="thought"&&h!==null&&u.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;r=!0,o+=c.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var t,e,n;let o="";const r=[];for(const u of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[c,f]of Object.entries(u))c!=="inlineData"&&f!==null&&r.push(c);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class nD{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jt(i,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function C_(i,t){const e=jt(i,t);return e?e.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:e.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${e}`:e:""}function b_(i){return Array.isArray(i)?i.map(t=>vm(t)):[vm(i)]}function vm(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function x_(i){const t=vm(i);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function __(i){const t=vm(i);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function _x(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function w_(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(t=>_x(t)):[_x(i)]}function P0(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function wx(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function Mx(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function En(i){if(i==null)throw new Error("ContentUnion is required");return P0(i)?i:{role:"user",parts:w_(i)}}function M_(i,t){if(!t)return[];if(i.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=En(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const e=En(t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>En(e)):[En(t)]}function qi(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(wx(i)||Mx(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[En(i)]}const t=[],e=[],n=P0(i[0]);for(const o of i){const r=P0(o);if(r!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)t.push(o);else{if(wx(o)||Mx(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");e.push(o)}}return n||t.push({role:"user",parts:w_(e)}),t}function iD(i,t){i.includes("null")&&(t.nullable=!0);const e=i.filter(n=>n!=="null");if(e.length===1)t.type=Object.values(Fs).includes(e[0].toUpperCase())?e[0].toUpperCase():Fs.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of e)t.anyOf.push({type:Object.values(Fs).includes(n.toUpperCase())?n.toUpperCase():Fs.TYPE_UNSPECIFIED})}}function Hu(i){const t={},e=["items"],n=["anyOf"],o=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=i.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(t.nullable=!0,i=r[1]):r[1].type==="null"&&(t.nullable=!0,i=r[0])),i.type instanceof Array&&iD(i.type,t);for(const[u,c]of Object.entries(i))if(c!=null)if(u=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;t.type=Object.values(Fs).includes(c.toUpperCase())?c.toUpperCase():Fs.TYPE_UNSPECIFIED}else if(e.includes(u))t[u]=Hu(c);else if(n.includes(u)){const f=[];for(const h of c){if(h.type=="null"){t.nullable=!0;continue}f.push(Hu(h))}t[u]=f}else if(o.includes(u)){const f={};for(const[h,y]of Object.entries(c))f[h]=Hu(y);t[u]=f}else{if(u==="additionalProperties")continue;t[u]=c}return t}function cT(i){return Hu(i)}function dT(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function fT(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function Wc(i){if(i.functionDeclarations)for(const t of i.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Hu(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Hu(t.response));return i}function Qc(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const t=[];for(const e of i)t.push(e);return t}function sD(i,t,e,n=1){const o=!t.startsWith(`${e}/`)&&t.split("/").length===n;return i.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${i.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:o?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}/${t}`:t:o?`${e}/${t}`:t}function qo(i,t){if(typeof t!="string")throw new Error("name must be a string");return sD(i,t,"cachedContents")}function R_(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function zo(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}function oD(i){return i!=null&&typeof i=="object"&&"name"in i}function aD(i){return i!=null&&typeof i=="object"&&"video"in i}function rD(i){return i!=null&&typeof i=="object"&&"uri"in i}function N_(i){var t;let e;if(oD(i)&&(e=i.name),!(rD(i)&&(e=i.uri,e===void 0))&&!(aD(i)&&(e=(t=i.video)===null||t===void 0?void 0:t.uri,e===void 0))){if(typeof i=="string"&&(e=i),e===void 0)throw new Error("Could not extract file name from the provided input.");if(e.startsWith("https://")){const o=e.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${e}`);e=o[0]}else e.startsWith("files/")&&(e=e.split("files/")[1]);return e}}function D_(i,t){let e;return i.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function I_(i){for(const t of["models","tunedModels","publisherModels"])if(lD(i,t))return i[t];return[]}function lD(i,t){return i!==null&&typeof i=="object"&&t in i}function uD(i,t={}){const e=i,n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function cD(i,t={}){const e=[],n=new Set;for(const o of i){const r=o.name;if(n.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);n.add(r);const u=uD(o,t);u.functionDeclarations&&e.push(...u.functionDeclarations)}return{functionDeclarations:e}}function P_(i,t){if(typeof t!="string"&&!Array.isArray(t)){if(i&&i.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function dD(i){const t=i;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Zc(i,t){const e=t;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(e))return e.split("/").pop();throw new Error(`Invalid batch job name: ${e}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(e))return e.split("/").pop();if(/^\d+$/.test(e))return e;throw new Error(`Invalid batch job name: ${e}.`)}function L_(i){const t=i;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fD(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function hD(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function pD(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function gD(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],fD(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],hD(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],pD(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function k_(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>gD(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function mD(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const N=d(i,["minimum"]);N!=null&&p(t,["minimum"],N);const D=d(i,["nullable"]);D!=null&&p(t,["nullable"],D);const k=d(i,["pattern"]);k!=null&&p(t,["pattern"],k);const L=d(i,["properties"]);L!=null&&p(t,["properties"],L);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const P=d(i,["required"]);P!=null&&p(t,["required"],P);const G=d(i,["title"]);G!=null&&p(t,["title"],G);const F=d(i,["type"]);return F!=null&&p(t,["type"],F),t}function yD(i){const t={};if(d(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const e=d(i,["category"]);e!=null&&p(t,["category"],e);const n=d(i,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function vD(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function AD(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function TD(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],AD(e)),t}function SD(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function ED(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],SD(e)),t}function CD(){return{}}function bD(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>vD(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],TD(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],ED(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],CD());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function xD(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function _D(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function wD(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],_D(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function MD(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],xD(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],wD(n)),t}function RD(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function U_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],RD(e)),t}function ND(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],U_(n)),t}function DD(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>ND(o))),p(t,["speakerVoiceConfigs"],n)}return t}function ID(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],U_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],DD(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function PD(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function LD(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],k_(En(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const N=d(t,["responseMimeType"]);N!=null&&p(n,["responseMimeType"],N);const D=d(t,["responseSchema"]);D!=null&&p(n,["responseSchema"],mD(cT(D)));const k=d(t,["responseJsonSchema"]);if(k!=null&&p(n,["responseJsonSchema"],k),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=d(t,["safetySettings"]);if(e!==void 0&&L!=null){let Q=L;Array.isArray(Q)&&(Q=Q.map(ut=>yD(ut))),p(e,["safetySettings"],Q)}const U=d(t,["tools"]);if(e!==void 0&&U!=null){let Q=Qc(U);Array.isArray(Q)&&(Q=Q.map(ut=>bD(Wc(ut)))),p(e,["tools"],Q)}const P=d(t,["toolConfig"]);if(e!==void 0&&P!=null&&p(e,["toolConfig"],MD(P)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=d(t,["cachedContent"]);e!==void 0&&G!=null&&p(e,["cachedContent"],qo(i,G));const F=d(t,["responseModalities"]);F!=null&&p(n,["responseModalities"],F);const $=d(t,["mediaResolution"]);$!=null&&p(n,["mediaResolution"],$);const X=d(t,["speechConfig"]);if(X!=null&&p(n,["speechConfig"],ID(dT(X))),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const et=d(t,["thinkingConfig"]);return et!=null&&p(n,["thinkingConfig"],PD(et)),n}function kD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["request","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>k_(c))),p(e,["request","contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["request","generationConfig"],LD(i,r,e)),e}function UD(i,t){const e={};if(d(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=d(t,["fileName"]);n!=null&&p(e,["fileName"],n);const o=d(t,["inlinedRequests"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(u=>kD(i,u))),p(e,["requests","requests"],r)}return e}function FD(i,t){const e={},n=d(i,["displayName"]);if(t!==void 0&&n!=null&&p(t,["batch","displayName"],n),d(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return e}function OD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["src"]);o!=null&&p(e,["batch","inputConfig"],UD(i,P_(i,o)));const r=d(t,["config"]);return r!=null&&p(e,["config"],FD(r,e)),e}function BD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function GD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function VD(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);if(t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),d(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return e}function HD(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],VD(e,t)),t}function qD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function zD(i){const t={},e=d(i,["format"]);e!=null&&p(t,["instancesFormat"],e);const n=d(i,["gcsUri"]);n!=null&&p(t,["gcsSource","uris"],n);const o=d(i,["bigqueryUri"]);if(o!=null&&p(t,["bigquerySource","inputUri"],o),d(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function $D(i){const t={},e=d(i,["format"]);e!=null&&p(t,["predictionsFormat"],e);const n=d(i,["gcsUri"]);n!=null&&p(t,["gcsDestination","outputUriPrefix"],n);const o=d(i,["bigqueryUri"]);if(o!=null&&p(t,["bigqueryDestination","outputUri"],o),d(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function YD(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["dest"]);return t!==void 0&&o!=null&&p(t,["outputConfig"],$D(dD(o))),e}function XD(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],jt(i,n));const o=d(t,["src"]);o!=null&&p(e,["inputConfig"],zD(P_(i,o)));const r=d(t,["config"]);return r!=null&&p(e,["config"],YD(r,e)),e}function JD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function KD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function WD(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function QD(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],WD(e,t)),t}function ZD(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],Zc(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function F_(){return{}}function jD(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function tI(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function eI(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function nI(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],jD(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],tI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],eI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function iI(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>nI(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function sI(i){const t={},e=d(i,["citationSources"]);return e!=null&&p(t,["citations"],e),t}function oI(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function aI(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>oI(o))),p(t,["urlMetadata"],n)}return t}function rI(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],iI(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],sI(n));const o=d(i,["tokenCount"]);o!=null&&p(t,["tokenCount"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],aI(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function lI(i){const t={},e=d(i,["candidates"]);if(e!=null){let u=e;Array.isArray(u)&&(u=u.map(c=>rI(c))),p(t,["candidates"],u)}const n=d(i,["modelVersion"]);n!=null&&p(t,["modelVersion"],n);const o=d(i,["promptFeedback"]);o!=null&&p(t,["promptFeedback"],o);const r=d(i,["usageMetadata"]);return r!=null&&p(t,["usageMetadata"],r),t}function uI(i){const t={},e=d(i,["response"]);return e!=null&&p(t,["response"],lI(e)),d(i,["error"])!=null&&p(t,["error"],F_()),t}function cI(i){const t={},e=d(i,["responsesFile"]);e!=null&&p(t,["fileName"],e);const n=d(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>uI(r))),p(t,["inlinedResponses"],o)}return t}function L0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata","displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["metadata","state"]);o!=null&&p(t,["state"],L_(o));const r=d(i,["metadata","createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["metadata","endTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["metadata","updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["metadata","model"]);f!=null&&p(t,["model"],f);const h=d(i,["metadata","output"]);return h!=null&&p(t,["dest"],cI(h)),t}function dI(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["operations"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>L0(r))),p(t,["batchJobs"],o)}return t}function fI(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["done"]);return n!=null&&p(t,["done"],n),d(i,["error"])!=null&&p(t,["error"],F_()),t}function O_(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["code"]);n!=null&&p(t,["code"],n);const o=d(i,["message"]);return o!=null&&p(t,["message"],o),t}function hI(i){const t={},e=d(i,["instancesFormat"]);e!=null&&p(t,["format"],e);const n=d(i,["gcsSource","uris"]);n!=null&&p(t,["gcsUri"],n);const o=d(i,["bigquerySource","inputUri"]);return o!=null&&p(t,["bigqueryUri"],o),t}function pI(i){const t={},e=d(i,["predictionsFormat"]);e!=null&&p(t,["format"],e);const n=d(i,["gcsDestination","outputUriPrefix"]);n!=null&&p(t,["gcsUri"],n);const o=d(i,["bigqueryDestination","outputUri"]);return o!=null&&p(t,["bigqueryUri"],o),t}function k0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["state"]);o!=null&&p(t,["state"],L_(o));const r=d(i,["error"]);r!=null&&p(t,["error"],O_(r));const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["startTime"]);c!=null&&p(t,["startTime"],c);const f=d(i,["endTime"]);f!=null&&p(t,["endTime"],f);const h=d(i,["updateTime"]);h!=null&&p(t,["updateTime"],h);const y=d(i,["model"]);y!=null&&p(t,["model"],y);const A=d(i,["inputConfig"]);A!=null&&p(t,["src"],hI(A));const S=d(i,["outputConfig"]);return S!=null&&p(t,["dest"],pI(S)),t}function gI(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["batchPredictionJobs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>k0(r))),p(t,["batchJobs"],o)}return t}function mI(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["done"]);n!=null&&p(t,["done"],n);const o=d(i,["error"]);return o!=null&&p(t,["error"],O_(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ol;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ol||(Ol={}));class ip{constructor(t,e,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,o)}init(t,e,n){var o,r;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let u={config:{}};n?typeof n=="object"?u=Object.assign({},n):u=n:u={config:{}},u.config&&(u.config.pageToken=e.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(r=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yI extends Hl{constructor(t){super(),this.apiClient=t,this.create=async e=>{if(this.apiClient.isVertexAI()){const o=Date.now().toString();if(Array.isArray(e.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(e.config=e.config||{},e.config.displayName===void 0&&(e.config.displayName="genaiBatchJob_${timestampStr}"),e.config.dest===void 0&&typeof e.src=="string")if(e.src.startsWith("gs://")&&e.src.endsWith(".jsonl"))e.config.dest=`${e.src.slice(0,-6)}/dest`;else if(e.src.startsWith("bq://"))e.config.dest=`${e.src}_dest_${o}`;else throw new Error("Unsupported source:"+e.src)}return await this.createInternal(e)},this.list=async(e={})=>new ip(Ol.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(e),e)}async createInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=XD(this.apiClient,t);return c=Tt("batchPredictionJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>k0(y))}else{const h=OD(this.apiClient,t);return c=Tt("{model}:batchGenerateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>L0(y))}}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=JD(this.apiClient,t);return c=Tt("batchPredictionJobs/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>k0(y))}else{const h=BD(this.apiClient,t);return c=Tt("batches/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>L0(y))}}async cancel(t){var e,n,o,r;let u="",c={};if(this.apiClient.isVertexAI()){const f=KD(this.apiClient,t);u=Tt("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const f=GD(this.apiClient,t);u=Tt("batches/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=QD(t);return c=Tt("batchPredictionJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=gI(y),S=new xx;return Object.assign(S,A),S})}else{const h=HD(t);return c=Tt("batches",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=dI(y),S=new xx;return Object.assign(S,A),S})}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=ZD(this.apiClient,t);return c=Tt("batchPredictionJobs/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>mI(y))}else{const h=qD(this.apiClient,t);return c=Tt("batches/{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>fI(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vI(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function AI(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function TI(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function SI(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],vI(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],AI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],TI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Rx(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>SI(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function EI(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function CI(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function bI(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],CI(e)),t}function xI(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function _I(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],xI(e)),t}function wI(){return{}}function MI(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>EI(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],bI(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],_I(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],wI());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function RI(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function NI(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function DI(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],NI(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function II(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],RI(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],DI(n)),t}function PI(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);t!==void 0&&o!=null&&p(t,["expireTime"],o);const r=d(i,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const u=d(i,["contents"]);if(t!==void 0&&u!=null){let y=qi(u);Array.isArray(y)&&(y=y.map(A=>Rx(A))),p(t,["contents"],y)}const c=d(i,["systemInstruction"]);t!==void 0&&c!=null&&p(t,["systemInstruction"],Rx(En(c)));const f=d(i,["tools"]);if(t!==void 0&&f!=null){let y=f;Array.isArray(y)&&(y=y.map(A=>MI(A))),p(t,["tools"],y)}const h=d(i,["toolConfig"]);if(t!==void 0&&h!=null&&p(t,["toolConfig"],II(h)),d(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return e}function LI(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],C_(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],PI(o,e)),e}function kI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function UI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function FI(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);return t!==void 0&&o!=null&&p(t,["expireTime"],o),e}function OI(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],FI(o,e)),e}function BI(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function GI(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],BI(e,t)),t}function VI(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function HI(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function qI(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function zI(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],VI(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],HI(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],qI(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Nx(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>zI(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function $I(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function YI(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function XI(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],YI(e)),t}function JI(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function KI(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],JI(e)),t}function WI(){return{}}function QI(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function ZI(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],QI(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function jI(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],ZI(e)),t}function tP(){return{}}function eP(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>$I(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],XI(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],KI(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],WI());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],jI(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],tP());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function nP(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function iP(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function sP(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],iP(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function oP(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],nP(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],sP(n)),t}function aP(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);t!==void 0&&o!=null&&p(t,["expireTime"],o);const r=d(i,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const u=d(i,["contents"]);if(t!==void 0&&u!=null){let A=qi(u);Array.isArray(A)&&(A=A.map(S=>Nx(S))),p(t,["contents"],A)}const c=d(i,["systemInstruction"]);t!==void 0&&c!=null&&p(t,["systemInstruction"],Nx(En(c)));const f=d(i,["tools"]);if(t!==void 0&&f!=null){let A=f;Array.isArray(A)&&(A=A.map(S=>eP(S))),p(t,["tools"],A)}const h=d(i,["toolConfig"]);t!==void 0&&h!=null&&p(t,["toolConfig"],oP(h));const y=d(i,["kmsKeyName"]);return t!==void 0&&y!=null&&p(t,["encryption_spec","kmsKeyName"],y),e}function rP(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["model"],C_(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],aP(o,e)),e}function lP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function uP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function cP(i,t){const e={},n=d(i,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const o=d(i,["expireTime"]);return t!==void 0&&o!=null&&p(t,["expireTime"],o),e}function dP(i,t){const e={},n=d(t,["name"]);n!=null&&p(e,["_url","name"],qo(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],cP(o,e)),e}function fP(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function hP(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],fP(e,t)),t}function Fg(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["model"]);o!=null&&p(t,["model"],o);const r=d(i,["createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["updateTime"]);u!=null&&p(t,["updateTime"],u);const c=d(i,["expireTime"]);c!=null&&p(t,["expireTime"],c);const f=d(i,["usageMetadata"]);return f!=null&&p(t,["usageMetadata"],f),t}function pP(){return{}}function gP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["cachedContents"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Fg(r))),p(t,["cachedContents"],o)}return t}function Og(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["model"]);o!=null&&p(t,["model"],o);const r=d(i,["createTime"]);r!=null&&p(t,["createTime"],r);const u=d(i,["updateTime"]);u!=null&&p(t,["updateTime"],u);const c=d(i,["expireTime"]);c!=null&&p(t,["expireTime"],c);const f=d(i,["usageMetadata"]);return f!=null&&p(t,["usageMetadata"],f),t}function mP(){return{}}function yP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["cachedContents"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Og(r))),p(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vP extends Hl{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new ip(Ol.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=rP(this.apiClient,t);return c=Tt("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Og(y))}else{const h=LI(this.apiClient,t);return c=Tt("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Fg(y))}}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=lP(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Og(y))}else{const h=kI(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Fg(y))}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=uP(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(()=>{const y=mP(),A=new Cx;return Object.assign(A,y),A})}else{const h=UI(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(()=>{const y=pP(),A=new Cx;return Object.assign(A,y),A})}}async update(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=dP(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Og(y))}else{const h=OI(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Fg(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=hP(t);return c=Tt("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=yP(y),S=new bx;return Object.assign(S,A),S})}else{const h=GI(t);return c=Tt("cachedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=gP(y),S=new bx;return Object.assign(S,A),S})}}}function Dx(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function fe(i){return this instanceof fe?(this.v=i,this):new fe(i)}function qu(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(E){return function(b){return Promise.resolve(b).then(E,A)}}function c(E,b){n[E]&&(o[E]=function(x){return new Promise(function(N,D){r.push([E,x,N,D])>1||f(E,x)})},b&&(o[E]=b(o[E])))}function f(E,b){try{h(n[E](b))}catch(x){S(r[0][3],x)}}function h(E){E.value instanceof fe?Promise.resolve(E.value.v).then(y,A):S(r[0][2],E)}function y(E){f("next",E)}function A(E){f("throw",E)}function S(E,b){E(b),r.shift(),r.length&&f(r[0][0],r[0][1])}}function xf(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Dx=="function"?Dx(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=i[r]&&function(u){return new Promise(function(c,f){u=i[r](u),o(c,f,u.done,u.value)})}}function o(r,u,c,f){Promise.resolve(f).then(function(h){r({value:h,done:c})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AP(i){var t;if(i.candidates==null||i.candidates.length===0)return!1;const e=(t=i.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:B_(e)}function B_(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const t of i.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function TP(i){if(i.length!==0){for(const t of i)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Ix(i){if(i===void 0||i.length===0)return[];const t=[],e=i.length;let n=0;for(;n<e;)if(i[n].role==="user")t.push(i[n]),n++;else{const o=[];let r=!0;for(;n<e&&i[n].role==="model";)o.push(i[n]),r&&!B_(i[n])&&(r=!1),n++;r?t.push(...o):t.pop()}return t}class SP{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new EP(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class EP{constructor(t,e,n,o={},r=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),TP(r)}async sendMessage(t){var e;await this.sendPromise;const n=En(t.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var r,u,c;const f=await o,h=(u=(r=f.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content,y=f.automaticFunctionCallingHistory,A=this.getHistory(!0).length;let S=[];y!=null&&(S=(c=y.slice(A))!==null&&c!==void 0?c:[]);const E=h?[h]:[];this.recordHistory(n,E,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(t){var e;await this.sendPromise;const n=En(t.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,n)}getHistory(t=!1){const e=t?Ix(this.history):this.history;return structuredClone(e)}processStreamResponse(t,e){var n,o;return qu(this,arguments,function*(){var u,c,f,h;const y=[];try{for(var A=!0,S=xf(t),E;E=yield fe(S.next()),u=E.done,!u;A=!0){h=E.value,A=!1;const b=h;if(AP(b)){const x=(o=(n=b.candidates)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.content;x!==void 0&&y.push(x)}yield yield fe(b)}}catch(b){c={error:b}}finally{try{!A&&!u&&(f=S.return)&&(yield fe(f.call(S)))}finally{if(c)throw c.error}}this.recordHistory(e,y)})}recordHistory(t,e,n){let o=[];e.length>0&&e.every(r=>r.role!==void 0)?o=e:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Ix(n)):this.history.push(t),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xm extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Xm.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CP(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);return t!==void 0&&o!=null&&p(t,["_query","pageToken"],o),e}function bP(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],CP(e,t)),t}function xP(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["message"]);n!=null&&p(t,["message"],n);const o=d(i,["code"]);return o!=null&&p(t,["code"],o),t}function _P(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["mimeType"]);o!=null&&p(t,["mimeType"],o);const r=d(i,["sizeBytes"]);r!=null&&p(t,["sizeBytes"],r);const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["expirationTime"]);c!=null&&p(t,["expirationTime"],c);const f=d(i,["updateTime"]);f!=null&&p(t,["updateTime"],f);const h=d(i,["sha256Hash"]);h!=null&&p(t,["sha256Hash"],h);const y=d(i,["uri"]);y!=null&&p(t,["uri"],y);const A=d(i,["downloadUri"]);A!=null&&p(t,["downloadUri"],A);const S=d(i,["state"]);S!=null&&p(t,["state"],S);const E=d(i,["source"]);E!=null&&p(t,["source"],E);const b=d(i,["videoMetadata"]);b!=null&&p(t,["videoMetadata"],b);const x=d(i,["error"]);return x!=null&&p(t,["error"],xP(x)),t}function wP(i){const t={},e=d(i,["file"]);e!=null&&p(t,["file"],_P(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function MP(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","file"],N_(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function RP(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","file"],N_(e));const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function NP(i){const t={},e=d(i,["details"]);e!=null&&p(t,["details"],e);const n=d(i,["message"]);n!=null&&p(t,["message"],n);const o=d(i,["code"]);return o!=null&&p(t,["code"],o),t}function U0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["mimeType"]);o!=null&&p(t,["mimeType"],o);const r=d(i,["sizeBytes"]);r!=null&&p(t,["sizeBytes"],r);const u=d(i,["createTime"]);u!=null&&p(t,["createTime"],u);const c=d(i,["expirationTime"]);c!=null&&p(t,["expirationTime"],c);const f=d(i,["updateTime"]);f!=null&&p(t,["updateTime"],f);const h=d(i,["sha256Hash"]);h!=null&&p(t,["sha256Hash"],h);const y=d(i,["uri"]);y!=null&&p(t,["uri"],y);const A=d(i,["downloadUri"]);A!=null&&p(t,["downloadUri"],A);const S=d(i,["state"]);S!=null&&p(t,["state"],S);const E=d(i,["source"]);E!=null&&p(t,["source"],E);const b=d(i,["videoMetadata"]);b!=null&&p(t,["videoMetadata"],b);const x=d(i,["error"]);return x!=null&&p(t,["error"],NP(x)),t}function DP(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["files"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>U0(r))),p(t,["files"],o)}return t}function IP(){return{}}function PP(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LP extends Hl{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new ip(Ol.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>U0(e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=bP(t);return r=Tt("files",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=DP(f),y=new ZN;return Object.assign(y,h),y})}}async createInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wP(t);return r=Tt("upload/v1beta/files",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(()=>{const f=IP(),h=new jN;return Object.assign(h,f),h})}}async get(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=MP(t);return r=Tt("files/{file}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>U0(f))}}async delete(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=RP(t);return r=Tt("files/{file}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(()=>{const f=PP(),h=new tD;return Object.assign(h,f),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kP(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function UP(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function G_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],kP(e)),t}function FP(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],UP(e)),t}function OP(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],G_(n)),t}function BP(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>OP(o))),p(t,["speakerVoiceConfigs"],n)}return t}function GP(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],G_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],BP(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function VP(i){const t={},e=d(i,["voiceConfig"]);if(e!=null&&p(t,["voiceConfig"],FP(e)),d(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function HP(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function qP(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function zP(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function $P(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function YP(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function XP(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function JP(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],HP(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],zP(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],YP(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function KP(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],qP(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],$P(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],XP(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function WP(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>JP(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function QP(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>KP(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function ZP(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function jP(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function t2(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function e2(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function n2(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],t2(e)),t}function i2(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],e2(e)),t}function s2(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function o2(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function a2(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],s2(e)),t}function r2(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],o2(e)),t}function l2(){return{}}function u2(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function c2(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],u2(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function d2(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],c2(e)),t}function f2(){return{}}function h2(){return{}}function p2(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>ZP(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],n2(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],a2(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],f2());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function g2(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>jP(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],i2(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r2(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],l2());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],d2(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],h2());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function m2(i){const t={},e=d(i,["handle"]);if(e!=null&&p(t,["handle"],e),d(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function y2(i){const t={},e=d(i,["handle"]);e!=null&&p(t,["handle"],e);const n=d(i,["transparent"]);return n!=null&&p(t,["transparent"],n),t}function Px(){return{}}function Lx(){return{}}function v2(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function A2(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function T2(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],v2(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function S2(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],A2(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function E2(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function C2(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function b2(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],E2(n)),t}function x2(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],C2(n)),t}function _2(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function w2(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function M2(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],GP(fT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],WP(En(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let P=Qc(b);Array.isArray(P)&&(P=P.map(G=>p2(Wc(G)))),p(t,["setup","tools"],P)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],m2(x));const N=d(i,["inputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","inputAudioTranscription"],Px());const D=d(i,["outputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","outputAudioTranscription"],Px());const k=d(i,["realtimeInputConfig"]);t!==void 0&&k!=null&&p(t,["setup","realtimeInputConfig"],T2(k));const L=d(i,["contextWindowCompression"]);t!==void 0&&L!=null&&p(t,["setup","contextWindowCompression"],b2(L));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],_2(U)),e}function R2(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],VP(fT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],QP(En(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let P=Qc(b);Array.isArray(P)&&(P=P.map(G=>g2(Wc(G)))),p(t,["setup","tools"],P)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],y2(x));const N=d(i,["inputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","inputAudioTranscription"],Lx());const D=d(i,["outputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","outputAudioTranscription"],Lx());const k=d(i,["realtimeInputConfig"]);t!==void 0&&k!=null&&p(t,["setup","realtimeInputConfig"],S2(k));const L=d(i,["contextWindowCompression"]);t!==void 0&&L!=null&&p(t,["setup","contextWindowCompression"],x2(L));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],w2(U)),e}function N2(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],M2(o,e)),e}function D2(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],R2(o,e)),e}function I2(){return{}}function P2(){return{}}function L2(){return{}}function k2(){return{}}function U2(i){const t={},e=d(i,["media"]);e!=null&&p(t,["mediaChunks"],b_(e));const n=d(i,["audio"]);n!=null&&p(t,["audio"],__(n));const o=d(i,["audioStreamEnd"]);o!=null&&p(t,["audioStreamEnd"],o);const r=d(i,["video"]);r!=null&&p(t,["video"],x_(r));const u=d(i,["text"]);return u!=null&&p(t,["text"],u),d(i,["activityStart"])!=null&&p(t,["activityStart"],I2()),d(i,["activityEnd"])!=null&&p(t,["activityEnd"],L2()),t}function F2(i){const t={},e=d(i,["media"]);e!=null&&p(t,["mediaChunks"],b_(e));const n=d(i,["audio"]);n!=null&&p(t,["audio"],__(n));const o=d(i,["audioStreamEnd"]);o!=null&&p(t,["audioStreamEnd"],o);const r=d(i,["video"]);r!=null&&p(t,["video"],x_(r));const u=d(i,["text"]);return u!=null&&p(t,["text"],u),d(i,["activityStart"])!=null&&p(t,["activityStart"],P2()),d(i,["activityEnd"])!=null&&p(t,["activityEnd"],k2()),t}function V_(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["weight"]);return n!=null&&p(t,["weight"],n),t}function O2(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>V_(o))),p(t,["weightedPrompts"],n)}return t}function H_(i){const t={},e=d(i,["temperature"]);e!=null&&p(t,["temperature"],e);const n=d(i,["topK"]);n!=null&&p(t,["topK"],n);const o=d(i,["seed"]);o!=null&&p(t,["seed"],o);const r=d(i,["guidance"]);r!=null&&p(t,["guidance"],r);const u=d(i,["bpm"]);u!=null&&p(t,["bpm"],u);const c=d(i,["density"]);c!=null&&p(t,["density"],c);const f=d(i,["brightness"]);f!=null&&p(t,["brightness"],f);const h=d(i,["scale"]);h!=null&&p(t,["scale"],h);const y=d(i,["muteBass"]);y!=null&&p(t,["muteBass"],y);const A=d(i,["muteDrums"]);A!=null&&p(t,["muteDrums"],A);const S=d(i,["onlyBassAndDrums"]);return S!=null&&p(t,["onlyBassAndDrums"],S),t}function B2(i){const t={},e=d(i,["musicGenerationConfig"]);return e!=null&&p(t,["musicGenerationConfig"],H_(e)),t}function q_(i){const t={},e=d(i,["model"]);return e!=null&&p(t,["model"],e),t}function z_(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>V_(o))),p(t,["weightedPrompts"],n)}return t}function F0(i){const t={},e=d(i,["setup"]);e!=null&&p(t,["setup"],q_(e));const n=d(i,["clientContent"]);n!=null&&p(t,["clientContent"],z_(n));const o=d(i,["musicGenerationConfig"]);o!=null&&p(t,["musicGenerationConfig"],H_(o));const r=d(i,["playbackControl"]);return r!=null&&p(t,["playbackControl"],r),t}function G2(){return{}}function V2(i){const t={},e=d(i,["sessionId"]);return e!=null&&p(t,["sessionId"],e),t}function H2(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function q2(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function z2(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function $2(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function Y2(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function X2(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function J2(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],H2(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],z2(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],Y2(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function K2(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],q2(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],$2(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],X2(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function W2(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>J2(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function Q2(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>K2(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function kx(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["finished"]);return n!=null&&p(t,["finished"],n),t}function Ux(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["finished"]);return n!=null&&p(t,["finished"],n),t}function Z2(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function j2(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>Z2(o))),p(t,["urlMetadata"],n)}return t}function tL(i){const t={},e=d(i,["modelTurn"]);e!=null&&p(t,["modelTurn"],W2(e));const n=d(i,["turnComplete"]);n!=null&&p(t,["turnComplete"],n);const o=d(i,["interrupted"]);o!=null&&p(t,["interrupted"],o);const r=d(i,["groundingMetadata"]);r!=null&&p(t,["groundingMetadata"],r);const u=d(i,["generationComplete"]);u!=null&&p(t,["generationComplete"],u);const c=d(i,["inputTranscription"]);c!=null&&p(t,["inputTranscription"],kx(c));const f=d(i,["outputTranscription"]);f!=null&&p(t,["outputTranscription"],kx(f));const h=d(i,["urlContextMetadata"]);return h!=null&&p(t,["urlContextMetadata"],j2(h)),t}function eL(i){const t={},e=d(i,["modelTurn"]);e!=null&&p(t,["modelTurn"],Q2(e));const n=d(i,["turnComplete"]);n!=null&&p(t,["turnComplete"],n);const o=d(i,["interrupted"]);o!=null&&p(t,["interrupted"],o);const r=d(i,["groundingMetadata"]);r!=null&&p(t,["groundingMetadata"],r);const u=d(i,["generationComplete"]);u!=null&&p(t,["generationComplete"],u);const c=d(i,["inputTranscription"]);c!=null&&p(t,["inputTranscription"],Ux(c));const f=d(i,["outputTranscription"]);return f!=null&&p(t,["outputTranscription"],Ux(f)),t}function nL(i){const t={},e=d(i,["id"]);e!=null&&p(t,["id"],e);const n=d(i,["args"]);n!=null&&p(t,["args"],n);const o=d(i,["name"]);return o!=null&&p(t,["name"],o),t}function iL(i){const t={},e=d(i,["args"]);e!=null&&p(t,["args"],e);const n=d(i,["name"]);return n!=null&&p(t,["name"],n),t}function sL(i){const t={},e=d(i,["functionCalls"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>nL(o))),p(t,["functionCalls"],n)}return t}function oL(i){const t={},e=d(i,["functionCalls"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>iL(o))),p(t,["functionCalls"],n)}return t}function aL(i){const t={},e=d(i,["ids"]);return e!=null&&p(t,["ids"],e),t}function rL(i){const t={},e=d(i,["ids"]);return e!=null&&p(t,["ids"],e),t}function Mg(i){const t={},e=d(i,["modality"]);e!=null&&p(t,["modality"],e);const n=d(i,["tokenCount"]);return n!=null&&p(t,["tokenCount"],n),t}function Rg(i){const t={},e=d(i,["modality"]);e!=null&&p(t,["modality"],e);const n=d(i,["tokenCount"]);return n!=null&&p(t,["tokenCount"],n),t}function lL(i){const t={},e=d(i,["promptTokenCount"]);e!=null&&p(t,["promptTokenCount"],e);const n=d(i,["cachedContentTokenCount"]);n!=null&&p(t,["cachedContentTokenCount"],n);const o=d(i,["responseTokenCount"]);o!=null&&p(t,["responseTokenCount"],o);const r=d(i,["toolUsePromptTokenCount"]);r!=null&&p(t,["toolUsePromptTokenCount"],r);const u=d(i,["thoughtsTokenCount"]);u!=null&&p(t,["thoughtsTokenCount"],u);const c=d(i,["totalTokenCount"]);c!=null&&p(t,["totalTokenCount"],c);const f=d(i,["promptTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(E=>Mg(E))),p(t,["promptTokensDetails"],S)}const h=d(i,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(E=>Mg(E))),p(t,["cacheTokensDetails"],S)}const y=d(i,["responseTokensDetails"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(E=>Mg(E))),p(t,["responseTokensDetails"],S)}const A=d(i,["toolUsePromptTokensDetails"]);if(A!=null){let S=A;Array.isArray(S)&&(S=S.map(E=>Mg(E))),p(t,["toolUsePromptTokensDetails"],S)}return t}function uL(i){const t={},e=d(i,["promptTokenCount"]);e!=null&&p(t,["promptTokenCount"],e);const n=d(i,["cachedContentTokenCount"]);n!=null&&p(t,["cachedContentTokenCount"],n);const o=d(i,["candidatesTokenCount"]);o!=null&&p(t,["responseTokenCount"],o);const r=d(i,["toolUsePromptTokenCount"]);r!=null&&p(t,["toolUsePromptTokenCount"],r);const u=d(i,["thoughtsTokenCount"]);u!=null&&p(t,["thoughtsTokenCount"],u);const c=d(i,["totalTokenCount"]);c!=null&&p(t,["totalTokenCount"],c);const f=d(i,["promptTokensDetails"]);if(f!=null){let E=f;Array.isArray(E)&&(E=E.map(b=>Rg(b))),p(t,["promptTokensDetails"],E)}const h=d(i,["cacheTokensDetails"]);if(h!=null){let E=h;Array.isArray(E)&&(E=E.map(b=>Rg(b))),p(t,["cacheTokensDetails"],E)}const y=d(i,["candidatesTokensDetails"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(b=>Rg(b))),p(t,["responseTokensDetails"],E)}const A=d(i,["toolUsePromptTokensDetails"]);if(A!=null){let E=A;Array.isArray(E)&&(E=E.map(b=>Rg(b))),p(t,["toolUsePromptTokensDetails"],E)}const S=d(i,["trafficType"]);return S!=null&&p(t,["trafficType"],S),t}function cL(i){const t={},e=d(i,["timeLeft"]);return e!=null&&p(t,["timeLeft"],e),t}function dL(i){const t={},e=d(i,["timeLeft"]);return e!=null&&p(t,["timeLeft"],e),t}function fL(i){const t={},e=d(i,["newHandle"]);e!=null&&p(t,["newHandle"],e);const n=d(i,["resumable"]);n!=null&&p(t,["resumable"],n);const o=d(i,["lastConsumedClientMessageIndex"]);return o!=null&&p(t,["lastConsumedClientMessageIndex"],o),t}function hL(i){const t={},e=d(i,["newHandle"]);e!=null&&p(t,["newHandle"],e);const n=d(i,["resumable"]);n!=null&&p(t,["resumable"],n);const o=d(i,["lastConsumedClientMessageIndex"]);return o!=null&&p(t,["lastConsumedClientMessageIndex"],o),t}function pL(i){const t={};d(i,["setupComplete"])!=null&&p(t,["setupComplete"],G2());const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],tL(n));const o=d(i,["toolCall"]);o!=null&&p(t,["toolCall"],sL(o));const r=d(i,["toolCallCancellation"]);r!=null&&p(t,["toolCallCancellation"],aL(r));const u=d(i,["usageMetadata"]);u!=null&&p(t,["usageMetadata"],lL(u));const c=d(i,["goAway"]);c!=null&&p(t,["goAway"],cL(c));const f=d(i,["sessionResumptionUpdate"]);return f!=null&&p(t,["sessionResumptionUpdate"],fL(f)),t}function gL(i){const t={},e=d(i,["setupComplete"]);e!=null&&p(t,["setupComplete"],V2(e));const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],eL(n));const o=d(i,["toolCall"]);o!=null&&p(t,["toolCall"],oL(o));const r=d(i,["toolCallCancellation"]);r!=null&&p(t,["toolCallCancellation"],rL(r));const u=d(i,["usageMetadata"]);u!=null&&p(t,["usageMetadata"],uL(u));const c=d(i,["goAway"]);c!=null&&p(t,["goAway"],dL(c));const f=d(i,["sessionResumptionUpdate"]);return f!=null&&p(t,["sessionResumptionUpdate"],hL(f)),t}function mL(){return{}}function yL(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["weight"]);return n!=null&&p(t,["weight"],n),t}function vL(i){const t={},e=d(i,["weightedPrompts"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>yL(o))),p(t,["weightedPrompts"],n)}return t}function AL(i){const t={},e=d(i,["temperature"]);e!=null&&p(t,["temperature"],e);const n=d(i,["topK"]);n!=null&&p(t,["topK"],n);const o=d(i,["seed"]);o!=null&&p(t,["seed"],o);const r=d(i,["guidance"]);r!=null&&p(t,["guidance"],r);const u=d(i,["bpm"]);u!=null&&p(t,["bpm"],u);const c=d(i,["density"]);c!=null&&p(t,["density"],c);const f=d(i,["brightness"]);f!=null&&p(t,["brightness"],f);const h=d(i,["scale"]);h!=null&&p(t,["scale"],h);const y=d(i,["muteBass"]);y!=null&&p(t,["muteBass"],y);const A=d(i,["muteDrums"]);A!=null&&p(t,["muteDrums"],A);const S=d(i,["onlyBassAndDrums"]);return S!=null&&p(t,["onlyBassAndDrums"],S),t}function TL(i){const t={},e=d(i,["clientContent"]);e!=null&&p(t,["clientContent"],vL(e));const n=d(i,["musicGenerationConfig"]);return n!=null&&p(t,["musicGenerationConfig"],AL(n)),t}function SL(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);n!=null&&p(t,["mimeType"],n);const o=d(i,["sourceMetadata"]);return o!=null&&p(t,["sourceMetadata"],TL(o)),t}function EL(i){const t={},e=d(i,["audioChunks"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>SL(o))),p(t,["audioChunks"],n)}return t}function CL(i){const t={},e=d(i,["text"]);e!=null&&p(t,["text"],e);const n=d(i,["filteredReason"]);return n!=null&&p(t,["filteredReason"],n),t}function bL(i){const t={};d(i,["setupComplete"])!=null&&p(t,["setupComplete"],mL());const n=d(i,["serverContent"]);n!=null&&p(t,["serverContent"],EL(n));const o=d(i,["filteredPrompt"]);return o!=null&&p(t,["filteredPrompt"],CL(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xL(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function _L(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function wL(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function ML(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],xL(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],_L(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],wL(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function Jm(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>ML(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function RL(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const N=d(i,["minimum"]);N!=null&&p(t,["minimum"],N);const D=d(i,["nullable"]);D!=null&&p(t,["nullable"],D);const k=d(i,["pattern"]);k!=null&&p(t,["pattern"],k);const L=d(i,["properties"]);L!=null&&p(t,["properties"],L);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const P=d(i,["required"]);P!=null&&p(t,["required"],P);const G=d(i,["title"]);G!=null&&p(t,["title"],G);const F=d(i,["type"]);return F!=null&&p(t,["type"],F),t}function NL(i){const t={};if(d(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const e=d(i,["category"]);e!=null&&p(t,["category"],e);const n=d(i,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function DL(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function IL(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function PL(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],IL(e)),t}function LL(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function kL(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],LL(e)),t}function UL(){return{}}function FL(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>DL(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],PL(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],kL(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],UL());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function OL(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function BL(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function GL(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],BL(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function VL(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],OL(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],GL(n)),t}function HL(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function $_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],HL(e)),t}function qL(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],$_(n)),t}function zL(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>qL(o))),p(t,["speakerVoiceConfigs"],n)}return t}function $L(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],$_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],zL(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function YL(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function XL(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],Jm(En(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const N=d(t,["responseMimeType"]);N!=null&&p(n,["responseMimeType"],N);const D=d(t,["responseSchema"]);D!=null&&p(n,["responseSchema"],RL(cT(D)));const k=d(t,["responseJsonSchema"]);if(k!=null&&p(n,["responseJsonSchema"],k),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=d(t,["safetySettings"]);if(e!==void 0&&L!=null){let Q=L;Array.isArray(Q)&&(Q=Q.map(ut=>NL(ut))),p(e,["safetySettings"],Q)}const U=d(t,["tools"]);if(e!==void 0&&U!=null){let Q=Qc(U);Array.isArray(Q)&&(Q=Q.map(ut=>FL(Wc(ut)))),p(e,["tools"],Q)}const P=d(t,["toolConfig"]);if(e!==void 0&&P!=null&&p(e,["toolConfig"],VL(P)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=d(t,["cachedContent"]);e!==void 0&&G!=null&&p(e,["cachedContent"],qo(i,G));const F=d(t,["responseModalities"]);F!=null&&p(n,["responseModalities"],F);const $=d(t,["mediaResolution"]);$!=null&&p(n,["mediaResolution"],$);const X=d(t,["speechConfig"]);if(X!=null&&p(n,["speechConfig"],$L(dT(X))),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const et=d(t,["thinkingConfig"]);return et!=null&&p(n,["thinkingConfig"],YL(et)),n}function Fx(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>Jm(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["generationConfig"],XL(i,r,e)),e}function JL(i,t){const e={},n=d(i,["taskType"]);t!==void 0&&n!=null&&p(t,["requests[]","taskType"],n);const o=d(i,["title"]);t!==void 0&&o!=null&&p(t,["requests[]","title"],o);const r=d(i,["outputDimensionality"]);if(t!==void 0&&r!=null&&p(t,["requests[]","outputDimensionality"],r),d(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return e}function KL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);o!=null&&p(e,["requests[]","content"],M_(i,o));const r=d(t,["config"]);r!=null&&p(e,["config"],JL(r,e));const u=d(t,["model"]);return u!==void 0&&p(e,["requests[]","model"],jt(i,u)),e}function WL(i,t){const e={};if(d(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=d(i,["numberOfImages"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const o=d(i,["aspectRatio"]);t!==void 0&&o!=null&&p(t,["parameters","aspectRatio"],o);const r=d(i,["guidanceScale"]);if(t!==void 0&&r!=null&&p(t,["parameters","guidanceScale"],r),d(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=d(i,["safetyFilterLevel"]);t!==void 0&&u!=null&&p(t,["parameters","safetySetting"],u);const c=d(i,["personGeneration"]);t!==void 0&&c!=null&&p(t,["parameters","personGeneration"],c);const f=d(i,["includeSafetyAttributes"]);t!==void 0&&f!=null&&p(t,["parameters","includeSafetyAttributes"],f);const h=d(i,["includeRaiReason"]);t!==void 0&&h!=null&&p(t,["parameters","includeRaiReason"],h);const y=d(i,["language"]);t!==void 0&&y!=null&&p(t,["parameters","language"],y);const A=d(i,["outputMimeType"]);t!==void 0&&A!=null&&p(t,["parameters","outputOptions","mimeType"],A);const S=d(i,["outputCompressionQuality"]);if(t!==void 0&&S!=null&&p(t,["parameters","outputOptions","compressionQuality"],S),d(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return e}function QL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["config"]);return r!=null&&p(e,["config"],WL(r,e)),e}function ZL(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function jL(i,t,e){const n={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const r=d(t,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const u=d(t,["filter"]);e!==void 0&&u!=null&&p(e,["_query","filter"],u);const c=d(t,["queryBase"]);return e!==void 0&&c!=null&&p(e,["_url","models_url"],D_(i,c)),n}function tk(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],jL(i,n,e)),e}function ek(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);t!==void 0&&o!=null&&p(t,["description"],o);const r=d(i,["defaultCheckpointId"]);return t!==void 0&&r!=null&&p(t,["defaultCheckpointId"],r),e}function nk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],ek(o,e)),e}function ik(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function sk(i){const t={};if(d(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function ok(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>Jm(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],sk(r)),e}function ak(i){const t={};if(d(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const e=d(i,["imageBytes"]);e!=null&&p(t,["bytesBase64Encoded"],zo(e));const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function rk(i,t){const e={},n=d(i,["numberOfVideos"]);if(t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n),d(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=d(i,["durationSeconds"]);if(t!==void 0&&o!=null&&p(t,["parameters","durationSeconds"],o),d(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=d(i,["aspectRatio"]);if(t!==void 0&&r!=null&&p(t,["parameters","aspectRatio"],r),d(i,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=d(i,["personGeneration"]);if(t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u),d(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=d(i,["negativePrompt"]);t!==void 0&&c!=null&&p(t,["parameters","negativePrompt"],c);const f=d(i,["enhancePrompt"]);if(t!==void 0&&f!=null&&p(t,["parameters","enhancePrompt"],f),d(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(d(i,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(d(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return e}function lk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["image"]);if(r!=null&&p(e,["instances[0]","image"],ak(r)),d(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const u=d(t,["config"]);return u!=null&&p(e,["config"],rk(u,e)),e}function uk(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function ck(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function dk(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function fk(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],uk(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],ck(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],dk(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function jc(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>fk(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function hk(i){const t={},e=d(i,["anyOf"]);e!=null&&p(t,["anyOf"],e);const n=d(i,["default"]);n!=null&&p(t,["default"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["enum"]);r!=null&&p(t,["enum"],r);const u=d(i,["example"]);u!=null&&p(t,["example"],u);const c=d(i,["format"]);c!=null&&p(t,["format"],c);const f=d(i,["items"]);f!=null&&p(t,["items"],f);const h=d(i,["maxItems"]);h!=null&&p(t,["maxItems"],h);const y=d(i,["maxLength"]);y!=null&&p(t,["maxLength"],y);const A=d(i,["maxProperties"]);A!=null&&p(t,["maxProperties"],A);const S=d(i,["maximum"]);S!=null&&p(t,["maximum"],S);const E=d(i,["minItems"]);E!=null&&p(t,["minItems"],E);const b=d(i,["minLength"]);b!=null&&p(t,["minLength"],b);const x=d(i,["minProperties"]);x!=null&&p(t,["minProperties"],x);const N=d(i,["minimum"]);N!=null&&p(t,["minimum"],N);const D=d(i,["nullable"]);D!=null&&p(t,["nullable"],D);const k=d(i,["pattern"]);k!=null&&p(t,["pattern"],k);const L=d(i,["properties"]);L!=null&&p(t,["properties"],L);const U=d(i,["propertyOrdering"]);U!=null&&p(t,["propertyOrdering"],U);const P=d(i,["required"]);P!=null&&p(t,["required"],P);const G=d(i,["title"]);G!=null&&p(t,["title"],G);const F=d(i,["type"]);return F!=null&&p(t,["type"],F),t}function pk(i){const t={},e=d(i,["featureSelectionPreference"]);return e!=null&&p(t,["featureSelectionPreference"],e),t}function gk(i){const t={},e=d(i,["method"]);e!=null&&p(t,["method"],e);const n=d(i,["category"]);n!=null&&p(t,["category"],n);const o=d(i,["threshold"]);return o!=null&&p(t,["threshold"],o),t}function mk(i){const t={};if(d(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const e=d(i,["description"]);e!=null&&p(t,["description"],e);const n=d(i,["name"]);n!=null&&p(t,["name"],n);const o=d(i,["parameters"]);o!=null&&p(t,["parameters"],o);const r=d(i,["parametersJsonSchema"]);r!=null&&p(t,["parametersJsonSchema"],r);const u=d(i,["response"]);u!=null&&p(t,["response"],u);const c=d(i,["responseJsonSchema"]);return c!=null&&p(t,["responseJsonSchema"],c),t}function yk(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function vk(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],yk(e)),t}function Ak(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function Tk(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],Ak(e)),t}function Sk(){return{}}function Ek(i){const t={},e=d(i,["apiKeyString"]);return e!=null&&p(t,["apiKeyString"],e),t}function Ck(i){const t={},e=d(i,["apiKeyConfig"]);e!=null&&p(t,["apiKeyConfig"],Ek(e));const n=d(i,["authType"]);n!=null&&p(t,["authType"],n);const o=d(i,["googleServiceAccountConfig"]);o!=null&&p(t,["googleServiceAccountConfig"],o);const r=d(i,["httpBasicAuthConfig"]);r!=null&&p(t,["httpBasicAuthConfig"],r);const u=d(i,["oauthConfig"]);u!=null&&p(t,["oauthConfig"],u);const c=d(i,["oidcConfig"]);return c!=null&&p(t,["oidcConfig"],c),t}function bk(i){const t={},e=d(i,["authConfig"]);return e!=null&&p(t,["authConfig"],Ck(e)),t}function xk(){return{}}function Y_(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let A=e;Array.isArray(A)&&(A=A.map(S=>mk(S))),p(t,["functionDeclarations"],A)}const n=d(i,["retrieval"]);n!=null&&p(t,["retrieval"],n);const o=d(i,["googleSearch"]);o!=null&&p(t,["googleSearch"],vk(o));const r=d(i,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],Tk(r)),d(i,["enterpriseWebSearch"])!=null&&p(t,["enterpriseWebSearch"],Sk());const c=d(i,["googleMaps"]);c!=null&&p(t,["googleMaps"],bk(c)),d(i,["urlContext"])!=null&&p(t,["urlContext"],xk());const h=d(i,["codeExecution"]);h!=null&&p(t,["codeExecution"],h);const y=d(i,["computerUse"]);return y!=null&&p(t,["computerUse"],y),t}function _k(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["allowedFunctionNames"]);return n!=null&&p(t,["allowedFunctionNames"],n),t}function wk(i){const t={},e=d(i,["latitude"]);e!=null&&p(t,["latitude"],e);const n=d(i,["longitude"]);return n!=null&&p(t,["longitude"],n),t}function Mk(i){const t={},e=d(i,["latLng"]);e!=null&&p(t,["latLng"],wk(e));const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function Rk(i){const t={},e=d(i,["functionCallingConfig"]);e!=null&&p(t,["functionCallingConfig"],_k(e));const n=d(i,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],Mk(n)),t}function Nk(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function Dk(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],Nk(e)),t}function Ik(i){const t={},e=d(i,["voiceConfig"]);if(e!=null&&p(t,["voiceConfig"],Dk(e)),d(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=d(i,["languageCode"]);return n!=null&&p(t,["languageCode"],n),t}function Pk(i){const t={},e=d(i,["includeThoughts"]);e!=null&&p(t,["includeThoughts"],e);const n=d(i,["thinkingBudget"]);return n!=null&&p(t,["thinkingBudget"],n),t}function Lk(i,t,e){const n={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],jc(En(o)));const r=d(t,["temperature"]);r!=null&&p(n,["temperature"],r);const u=d(t,["topP"]);u!=null&&p(n,["topP"],u);const c=d(t,["topK"]);c!=null&&p(n,["topK"],c);const f=d(t,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const h=d(t,["maxOutputTokens"]);h!=null&&p(n,["maxOutputTokens"],h);const y=d(t,["stopSequences"]);y!=null&&p(n,["stopSequences"],y);const A=d(t,["responseLogprobs"]);A!=null&&p(n,["responseLogprobs"],A);const S=d(t,["logprobs"]);S!=null&&p(n,["logprobs"],S);const E=d(t,["presencePenalty"]);E!=null&&p(n,["presencePenalty"],E);const b=d(t,["frequencyPenalty"]);b!=null&&p(n,["frequencyPenalty"],b);const x=d(t,["seed"]);x!=null&&p(n,["seed"],x);const N=d(t,["responseMimeType"]);N!=null&&p(n,["responseMimeType"],N);const D=d(t,["responseSchema"]);D!=null&&p(n,["responseSchema"],hk(cT(D)));const k=d(t,["responseJsonSchema"]);k!=null&&p(n,["responseJsonSchema"],k);const L=d(t,["routingConfig"]);L!=null&&p(n,["routingConfig"],L);const U=d(t,["modelSelectionConfig"]);U!=null&&p(n,["modelConfig"],pk(U));const P=d(t,["safetySettings"]);if(e!==void 0&&P!=null){let At=P;Array.isArray(At)&&(At=At.map(O=>gk(O))),p(e,["safetySettings"],At)}const G=d(t,["tools"]);if(e!==void 0&&G!=null){let At=Qc(G);Array.isArray(At)&&(At=At.map(O=>Y_(Wc(O)))),p(e,["tools"],At)}const F=d(t,["toolConfig"]);e!==void 0&&F!=null&&p(e,["toolConfig"],Rk(F));const $=d(t,["labels"]);e!==void 0&&$!=null&&p(e,["labels"],$);const X=d(t,["cachedContent"]);e!==void 0&&X!=null&&p(e,["cachedContent"],qo(i,X));const et=d(t,["responseModalities"]);et!=null&&p(n,["responseModalities"],et);const Q=d(t,["mediaResolution"]);Q!=null&&p(n,["mediaResolution"],Q);const ut=d(t,["speechConfig"]);ut!=null&&p(n,["speechConfig"],Ik(dT(ut)));const Ct=d(t,["audioTimestamp"]);Ct!=null&&p(n,["audioTimestamp"],Ct);const mt=d(t,["thinkingConfig"]);return mt!=null&&p(n,["thinkingConfig"],Pk(mt)),n}function Ox(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>jc(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["generationConfig"],Lk(i,r,e)),e}function kk(i,t){const e={},n=d(i,["taskType"]);t!==void 0&&n!=null&&p(t,["instances[]","task_type"],n);const o=d(i,["title"]);t!==void 0&&o!=null&&p(t,["instances[]","title"],o);const r=d(i,["outputDimensionality"]);t!==void 0&&r!=null&&p(t,["parameters","outputDimensionality"],r);const u=d(i,["mimeType"]);t!==void 0&&u!=null&&p(t,["instances[]","mimeType"],u);const c=d(i,["autoTruncate"]);return t!==void 0&&c!=null&&p(t,["parameters","autoTruncate"],c),e}function Uk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);o!=null&&p(e,["instances[]","content"],M_(i,o));const r=d(t,["config"]);return r!=null&&p(e,["config"],kk(r,e)),e}function Fk(i,t){const e={},n=d(i,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const o=d(i,["negativePrompt"]);t!==void 0&&o!=null&&p(t,["parameters","negativePrompt"],o);const r=d(i,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const u=d(i,["aspectRatio"]);t!==void 0&&u!=null&&p(t,["parameters","aspectRatio"],u);const c=d(i,["guidanceScale"]);t!==void 0&&c!=null&&p(t,["parameters","guidanceScale"],c);const f=d(i,["seed"]);t!==void 0&&f!=null&&p(t,["parameters","seed"],f);const h=d(i,["safetyFilterLevel"]);t!==void 0&&h!=null&&p(t,["parameters","safetySetting"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["includeSafetyAttributes"]);t!==void 0&&A!=null&&p(t,["parameters","includeSafetyAttributes"],A);const S=d(i,["includeRaiReason"]);t!==void 0&&S!=null&&p(t,["parameters","includeRaiReason"],S);const E=d(i,["language"]);t!==void 0&&E!=null&&p(t,["parameters","language"],E);const b=d(i,["outputMimeType"]);t!==void 0&&b!=null&&p(t,["parameters","outputOptions","mimeType"],b);const x=d(i,["outputCompressionQuality"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","compressionQuality"],x);const N=d(i,["addWatermark"]);t!==void 0&&N!=null&&p(t,["parameters","addWatermark"],N);const D=d(i,["enhancePrompt"]);return t!==void 0&&D!=null&&p(t,["parameters","enhancePrompt"],D),e}function Ok(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["config"]);return r!=null&&p(e,["config"],Fk(r,e)),e}function Km(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["imageBytes"]);n!=null&&p(t,["bytesBase64Encoded"],zo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function Bk(i){const t={},e=d(i,["maskMode"]);e!=null&&p(t,["maskMode"],e);const n=d(i,["segmentationClasses"]);n!=null&&p(t,["maskClasses"],n);const o=d(i,["maskDilation"]);return o!=null&&p(t,["dilation"],o),t}function Gk(i){const t={},e=d(i,["controlType"]);e!=null&&p(t,["controlType"],e);const n=d(i,["enableControlImageComputation"]);return n!=null&&p(t,["computeControl"],n),t}function Vk(i){const t={},e=d(i,["styleDescription"]);return e!=null&&p(t,["styleDescription"],e),t}function Hk(i){const t={},e=d(i,["subjectType"]);e!=null&&p(t,["subjectType"],e);const n=d(i,["subjectDescription"]);return n!=null&&p(t,["subjectDescription"],n),t}function qk(i){const t={},e=d(i,["referenceImage"]);e!=null&&p(t,["referenceImage"],Km(e));const n=d(i,["referenceId"]);n!=null&&p(t,["referenceId"],n);const o=d(i,["referenceType"]);o!=null&&p(t,["referenceType"],o);const r=d(i,["maskImageConfig"]);r!=null&&p(t,["maskImageConfig"],Bk(r));const u=d(i,["controlImageConfig"]);u!=null&&p(t,["controlImageConfig"],Gk(u));const c=d(i,["styleImageConfig"]);c!=null&&p(t,["styleImageConfig"],Vk(c));const f=d(i,["subjectImageConfig"]);return f!=null&&p(t,["subjectImageConfig"],Hk(f)),t}function zk(i,t){const e={},n=d(i,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const o=d(i,["negativePrompt"]);t!==void 0&&o!=null&&p(t,["parameters","negativePrompt"],o);const r=d(i,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const u=d(i,["aspectRatio"]);t!==void 0&&u!=null&&p(t,["parameters","aspectRatio"],u);const c=d(i,["guidanceScale"]);t!==void 0&&c!=null&&p(t,["parameters","guidanceScale"],c);const f=d(i,["seed"]);t!==void 0&&f!=null&&p(t,["parameters","seed"],f);const h=d(i,["safetyFilterLevel"]);t!==void 0&&h!=null&&p(t,["parameters","safetySetting"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["includeSafetyAttributes"]);t!==void 0&&A!=null&&p(t,["parameters","includeSafetyAttributes"],A);const S=d(i,["includeRaiReason"]);t!==void 0&&S!=null&&p(t,["parameters","includeRaiReason"],S);const E=d(i,["language"]);t!==void 0&&E!=null&&p(t,["parameters","language"],E);const b=d(i,["outputMimeType"]);t!==void 0&&b!=null&&p(t,["parameters","outputOptions","mimeType"],b);const x=d(i,["outputCompressionQuality"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","compressionQuality"],x);const N=d(i,["editMode"]);t!==void 0&&N!=null&&p(t,["parameters","editMode"],N);const D=d(i,["baseSteps"]);return t!==void 0&&D!=null&&p(t,["parameters","editConfig","baseSteps"],D),e}function $k(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["referenceImages"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>qk(f))),p(e,["instances[0]","referenceImages"],c)}const u=d(t,["config"]);return u!=null&&p(e,["config"],zk(u,e)),e}function Yk(i,t){const e={},n=d(i,["includeRaiReason"]);t!==void 0&&n!=null&&p(t,["parameters","includeRaiReason"],n);const o=d(i,["outputMimeType"]);t!==void 0&&o!=null&&p(t,["parameters","outputOptions","mimeType"],o);const r=d(i,["outputCompressionQuality"]);t!==void 0&&r!=null&&p(t,["parameters","outputOptions","compressionQuality"],r);const u=d(i,["enhanceInputImage"]);t!==void 0&&u!=null&&p(t,["parameters","upscaleConfig","enhanceInputImage"],u);const c=d(i,["imagePreservationFactor"]);t!==void 0&&c!=null&&p(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const f=d(i,["numberOfImages"]);t!==void 0&&f!=null&&p(t,["parameters","sampleCount"],f);const h=d(i,["mode"]);return t!==void 0&&h!=null&&p(t,["parameters","mode"],h),e}function Xk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["image"]);o!=null&&p(e,["instances[0]","image"],Km(o));const r=d(t,["upscaleFactor"]);r!=null&&p(e,["parameters","upscaleConfig","upscaleFactor"],r);const u=d(t,["config"]);return u!=null&&p(e,["config"],Yk(u,e)),e}function Jk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function Kk(i,t,e){const n={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const r=d(t,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const u=d(t,["filter"]);e!==void 0&&u!=null&&p(e,["_query","filter"],u);const c=d(t,["queryBase"]);return e!==void 0&&c!=null&&p(e,["_url","models_url"],D_(i,c)),n}function Wk(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],Kk(i,n,e)),e}function Qk(i,t){const e={},n=d(i,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);t!==void 0&&o!=null&&p(t,["description"],o);const r=d(i,["defaultCheckpointId"]);return t!==void 0&&r!=null&&p(t,["defaultCheckpointId"],r),e}function Zk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],Qk(o,e)),e}function jk(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","name"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],o),e}function tU(i,t){const e={},n=d(i,["systemInstruction"]);t!==void 0&&n!=null&&p(t,["systemInstruction"],jc(En(n)));const o=d(i,["tools"]);if(t!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>Y_(c))),p(t,["tools"],u)}const r=d(i,["generationConfig"]);return t!==void 0&&r!=null&&p(t,["generationConfig"],r),e}function eU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>jc(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],tU(r,e)),e}function nU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["contents"]);if(o!=null){let u=qi(o);Array.isArray(u)&&(u=u.map(c=>jc(c))),p(e,["contents"],u)}const r=d(t,["config"]);return r!=null&&p(e,["config"],r),e}function iU(i){const t={},e=d(i,["uri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["videoBytes"]);n!=null&&p(t,["bytesBase64Encoded"],zo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function sU(i,t){const e={},n=d(i,["numberOfVideos"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const o=d(i,["outputGcsUri"]);t!==void 0&&o!=null&&p(t,["parameters","storageUri"],o);const r=d(i,["fps"]);t!==void 0&&r!=null&&p(t,["parameters","fps"],r);const u=d(i,["durationSeconds"]);t!==void 0&&u!=null&&p(t,["parameters","durationSeconds"],u);const c=d(i,["seed"]);t!==void 0&&c!=null&&p(t,["parameters","seed"],c);const f=d(i,["aspectRatio"]);t!==void 0&&f!=null&&p(t,["parameters","aspectRatio"],f);const h=d(i,["resolution"]);t!==void 0&&h!=null&&p(t,["parameters","resolution"],h);const y=d(i,["personGeneration"]);t!==void 0&&y!=null&&p(t,["parameters","personGeneration"],y);const A=d(i,["pubsubTopic"]);t!==void 0&&A!=null&&p(t,["parameters","pubsubTopic"],A);const S=d(i,["negativePrompt"]);t!==void 0&&S!=null&&p(t,["parameters","negativePrompt"],S);const E=d(i,["enhancePrompt"]);t!==void 0&&E!=null&&p(t,["parameters","enhancePrompt"],E);const b=d(i,["generateAudio"]);t!==void 0&&b!=null&&p(t,["parameters","generateAudio"],b);const x=d(i,["lastFrame"]);t!==void 0&&x!=null&&p(t,["instances[0]","lastFrame"],Km(x));const N=d(i,["compressionQuality"]);return t!==void 0&&N!=null&&p(t,["parameters","compressionQuality"],N),e}function oU(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["_url","model"],jt(i,n));const o=d(t,["prompt"]);o!=null&&p(e,["instances[0]","prompt"],o);const r=d(t,["image"]);r!=null&&p(e,["instances[0]","image"],Km(r));const u=d(t,["video"]);u!=null&&p(e,["instances[0]","video"],iU(u));const c=d(t,["config"]);return c!=null&&p(e,["config"],sU(c,e)),e}function aU(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function rU(i){const t={},e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function lU(i){const t={},e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function uU(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],aU(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],rU(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],lU(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function cU(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>uU(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function dU(i){const t={},e=d(i,["citationSources"]);return e!=null&&p(t,["citations"],e),t}function fU(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function hU(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>fU(o))),p(t,["urlMetadata"],n)}return t}function pU(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],cU(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],dU(n));const o=d(i,["tokenCount"]);o!=null&&p(t,["tokenCount"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],hU(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function Bx(i){const t={},e=d(i,["candidates"]);if(e!=null){let u=e;Array.isArray(u)&&(u=u.map(c=>pU(c))),p(t,["candidates"],u)}const n=d(i,["modelVersion"]);n!=null&&p(t,["modelVersion"],n);const o=d(i,["promptFeedback"]);o!=null&&p(t,["promptFeedback"],o);const r=d(i,["usageMetadata"]);return r!=null&&p(t,["usageMetadata"],r),t}function gU(i){const t={},e=d(i,["values"]);return e!=null&&p(t,["values"],e),t}function mU(){return{}}function yU(i){const t={},e=d(i,["embeddings"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>gU(r))),p(t,["embeddings"],o)}return d(i,["metadata"])!=null&&p(t,["metadata"],mU()),t}function vU(i){const t={},e=d(i,["bytesBase64Encoded"]);e!=null&&p(t,["imageBytes"],zo(e));const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function X_(i){const t={},e=d(i,["safetyAttributes","categories"]);e!=null&&p(t,["categories"],e);const n=d(i,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const o=d(i,["contentType"]);return o!=null&&p(t,["contentType"],o),t}function AU(i){const t={},e=d(i,["_self"]);e!=null&&p(t,["image"],vU(e));const n=d(i,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const o=d(i,["_self"]);return o!=null&&p(t,["safetyAttributes"],X_(o)),t}function TU(i){const t={},e=d(i,["predictions"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>AU(r))),p(t,["generatedImages"],o)}const n=d(i,["positivePromptSafetyAttributes"]);return n!=null&&p(t,["positivePromptSafetyAttributes"],X_(n)),t}function SU(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["updateTime"]);return o!=null&&p(t,["updateTime"],o),t}function O0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["version"]);r!=null&&p(t,["version"],r);const u=d(i,["_self"]);u!=null&&p(t,["tunedModelInfo"],SU(u));const c=d(i,["inputTokenLimit"]);c!=null&&p(t,["inputTokenLimit"],c);const f=d(i,["outputTokenLimit"]);f!=null&&p(t,["outputTokenLimit"],f);const h=d(i,["supportedGenerationMethods"]);return h!=null&&p(t,["supportedActions"],h),t}function EU(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["_self"]);if(n!=null){let o=I_(n);Array.isArray(o)&&(o=o.map(r=>O0(r))),p(t,["models"],o)}return t}function CU(){return{}}function bU(i){const t={},e=d(i,["totalTokens"]);e!=null&&p(t,["totalTokens"],e);const n=d(i,["cachedContentTokenCount"]);return n!=null&&p(t,["cachedContentTokenCount"],n),t}function xU(i){const t={},e=d(i,["video","uri"]);e!=null&&p(t,["uri"],e);const n=d(i,["video","encodedVideo"]);n!=null&&p(t,["videoBytes"],zo(n));const o=d(i,["encoding"]);return o!=null&&p(t,["mimeType"],o),t}function _U(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],xU(e)),t}function wU(i){const t={},e=d(i,["generatedSamples"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>_U(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function MU(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response","generateVideoResponse"]);return u!=null&&p(t,["response"],wU(u)),t}function RU(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function NU(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["data"]);n!=null&&p(t,["data"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function DU(i){const t={},e=d(i,["displayName"]);e!=null&&p(t,["displayName"],e);const n=d(i,["fileUri"]);n!=null&&p(t,["fileUri"],n);const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function IU(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],RU(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],NU(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],DU(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function PU(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>IU(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function LU(i){const t={},e=d(i,["citations"]);return e!=null&&p(t,["citations"],e),t}function kU(i){const t={},e=d(i,["retrievedUrl"]);e!=null&&p(t,["retrievedUrl"],e);const n=d(i,["urlRetrievalStatus"]);return n!=null&&p(t,["urlRetrievalStatus"],n),t}function UU(i){const t={},e=d(i,["urlMetadata"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>kU(o))),p(t,["urlMetadata"],n)}return t}function FU(i){const t={},e=d(i,["content"]);e!=null&&p(t,["content"],PU(e));const n=d(i,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],LU(n));const o=d(i,["finishMessage"]);o!=null&&p(t,["finishMessage"],o);const r=d(i,["finishReason"]);r!=null&&p(t,["finishReason"],r);const u=d(i,["urlContextMetadata"]);u!=null&&p(t,["urlContextMetadata"],UU(u));const c=d(i,["avgLogprobs"]);c!=null&&p(t,["avgLogprobs"],c);const f=d(i,["groundingMetadata"]);f!=null&&p(t,["groundingMetadata"],f);const h=d(i,["index"]);h!=null&&p(t,["index"],h);const y=d(i,["logprobsResult"]);y!=null&&p(t,["logprobsResult"],y);const A=d(i,["safetyRatings"]);return A!=null&&p(t,["safetyRatings"],A),t}function Gx(i){const t={},e=d(i,["candidates"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>FU(h))),p(t,["candidates"],f)}const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["responseId"]);o!=null&&p(t,["responseId"],o);const r=d(i,["modelVersion"]);r!=null&&p(t,["modelVersion"],r);const u=d(i,["promptFeedback"]);u!=null&&p(t,["promptFeedback"],u);const c=d(i,["usageMetadata"]);return c!=null&&p(t,["usageMetadata"],c),t}function OU(i){const t={},e=d(i,["truncated"]);e!=null&&p(t,["truncated"],e);const n=d(i,["token_count"]);return n!=null&&p(t,["tokenCount"],n),t}function BU(i){const t={},e=d(i,["values"]);e!=null&&p(t,["values"],e);const n=d(i,["statistics"]);return n!=null&&p(t,["statistics"],OU(n)),t}function GU(i){const t={},e=d(i,["billableCharacterCount"]);return e!=null&&p(t,["billableCharacterCount"],e),t}function VU(i){const t={},e=d(i,["predictions[]","embeddings"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>BU(r))),p(t,["embeddings"],o)}const n=d(i,["metadata"]);return n!=null&&p(t,["metadata"],GU(n)),t}function HU(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["gcsUri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["imageBytes"],zo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function J_(i){const t={},e=d(i,["safetyAttributes","categories"]);e!=null&&p(t,["categories"],e);const n=d(i,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const o=d(i,["contentType"]);return o!=null&&p(t,["contentType"],o),t}function hT(i){const t={},e=d(i,["_self"]);e!=null&&p(t,["image"],HU(e));const n=d(i,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const o=d(i,["_self"]);o!=null&&p(t,["safetyAttributes"],J_(o));const r=d(i,["prompt"]);return r!=null&&p(t,["enhancedPrompt"],r),t}function qU(i){const t={},e=d(i,["predictions"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>hT(r))),p(t,["generatedImages"],o)}const n=d(i,["positivePromptSafetyAttributes"]);return n!=null&&p(t,["positivePromptSafetyAttributes"],J_(n)),t}function zU(i){const t={},e=d(i,["predictions"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>hT(o))),p(t,["generatedImages"],n)}return t}function $U(i){const t={},e=d(i,["predictions"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>hT(o))),p(t,["generatedImages"],n)}return t}function YU(i){const t={},e=d(i,["endpoint"]);e!=null&&p(t,["name"],e);const n=d(i,["deployedModelId"]);return n!=null&&p(t,["deployedModelId"],n),t}function XU(i){const t={},e=d(i,["labels","google-vertex-llm-tuning-base-model-id"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["createTime"]);n!=null&&p(t,["createTime"],n);const o=d(i,["updateTime"]);return o!=null&&p(t,["updateTime"],o),t}function JU(i){const t={},e=d(i,["checkpointId"]);e!=null&&p(t,["checkpointId"],e);const n=d(i,["epoch"]);n!=null&&p(t,["epoch"],n);const o=d(i,["step"]);return o!=null&&p(t,["step"],o),t}function B0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["displayName"]);n!=null&&p(t,["displayName"],n);const o=d(i,["description"]);o!=null&&p(t,["description"],o);const r=d(i,["versionId"]);r!=null&&p(t,["version"],r);const u=d(i,["deployedModels"]);if(u!=null){let A=u;Array.isArray(A)&&(A=A.map(S=>YU(S))),p(t,["endpoints"],A)}const c=d(i,["labels"]);c!=null&&p(t,["labels"],c);const f=d(i,["_self"]);f!=null&&p(t,["tunedModelInfo"],XU(f));const h=d(i,["defaultCheckpointId"]);h!=null&&p(t,["defaultCheckpointId"],h);const y=d(i,["checkpoints"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(S=>JU(S))),p(t,["checkpoints"],A)}return t}function KU(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["_self"]);if(n!=null){let o=I_(n);Array.isArray(o)&&(o=o.map(r=>B0(r))),p(t,["models"],o)}return t}function WU(){return{}}function QU(i){const t={},e=d(i,["totalTokens"]);return e!=null&&p(t,["totalTokens"],e),t}function ZU(i){const t={},e=d(i,["tokensInfo"]);return e!=null&&p(t,["tokensInfo"],e),t}function jU(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["uri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],zo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function tF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],jU(e)),t}function eF(i){const t={},e=d(i,["videos"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>tF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function nF(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response"]);return u!=null&&p(t,["response"],eF(u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iF="Content-Type",sF="X-Server-Timeout",oF="User-Agent",G0="x-goog-api-client",aF="1.9.0",rF=`google-genai-sdk/${aF}`,lF="v1beta1",uF="v1beta",Vx=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class cF{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:lF,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:uF,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const o=[this.getRequestUrlInternal(e)];return n&&o.push(this.getBaseResourcePath()),t!==""&&o.push(t),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[u,c]of Object.entries(t.queryParams))o.searchParams.append(u,String(c));let r={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=t.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,e,t.abortSignal),this.unaryApiCall(o,r,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[o,r]of Object.entries(e))typeof r=="object"?n[o]=Object.assign(Object.assign({},n[o]),r):r!==void 0&&(n[o]=r);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=t.body,r=await this.includeExtraHttpOptionsToRequestInit(r,e,t.abortSignal),this.streamApiCall(o,r,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const o=new AbortController,r=o.signal;if(e.timeout&&(e==null?void 0:e.timeout)>0){const u=setTimeout(()=>o.abort(),e.timeout);u&&typeof u.unref=="function"&&u.unref()}n&&n.addEventListener("abort",()=>{o.abort()}),t.signal=r}return e&&e.extraBody!==null&&dF(t,e.extraBody),t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await Hx(o),new I0(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await Hx(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(t){var e;return qu(this,arguments,function*(){const o=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:c,value:f}=yield fe(o.read());if(c){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=r.decode(f,{stream:!0});try{const A=JSON.parse(h);if("error"in A){const S=JSON.parse(JSON.stringify(A.error)),E=S.status,b=S.code,x=`got status: ${E}. ${JSON.stringify(A)}`;if(b>=400&&b<600)throw new Xm({message:x,status:b})}}catch(A){if(A.name==="ApiError")throw A}u+=h;let y=u.match(Vx);for(;y;){const A=y[1];try{const S=new Response(A,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield fe(new I0(S)),u=u.slice(y[0].length),y=u.match(Vx)}catch(S){throw new Error(`exception parsing stream chunk ${A}. ${S}`)}}}}finally{o.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=rF+" "+this.clientOptions.userAgentExtra;return t[oF]=e,t[G0]=e,t[iF]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,o]of Object.entries(t.headers))e.append(n,o);t.timeout&&t.timeout>0&&e.append(sF,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const o={};e!=null&&(o.mimeType=e.mimeType,o.name=e.name,o.displayName=e.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,u=await r.stat(t);o.sizeBytes=String(u.size);const c=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:u.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=c;const f=await this.fetchUploadUrl(o,e);return r.upload(t,f,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let o={};e!=null&&e.httpOptions?o=e.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const r={file:t},u=await this.request({path:Tt("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(n=u==null?void 0:u.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Hx(i){var t;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const e=i.status;let n;!((t=i.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const o=JSON.stringify(n);throw e>=400&&e<600?new Xm({message:o,status:e}):new Error(o)}}function dF(i,t){if(!t||Object.keys(t).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let e={};if(typeof i.body=="string"&&i.body.length>0)try{const r=JSON.parse(i.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))e=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(r,u){const c=Object.assign({},r);for(const f in u)if(Object.prototype.hasOwnProperty.call(u,f)){const h=u[f],y=c[f];h&&typeof h=="object"&&!Array.isArray(h)&&y&&typeof y=="object"&&!Array.isArray(y)?c[f]=n(y,h):(y&&h&&typeof y!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof y}, New type: ${typeof h}. Overwriting.`),c[f]=h)}return c}const o=n(e,t);i.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fF="mcp_used/unknown";function K_(i){for(const t of i)if(pT(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function W_(i){var t;const e=(t=i[G0])!==null&&t!==void 0?t:"";i[G0]=(e+` ${fF}`).trimStart()}function hF(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>pT(o)))!==null&&n!==void 0?n:!1}function pF(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>!pT(o)))!==null&&n!==void 0?n:!1}function pT(i){return i!==null&&typeof i=="object"&&i instanceof gT}function gF(i,t=100){return qu(this,arguments,function*(){let n,o=0;for(;o<t;){const r=yield fe(i.listTools({cursor:n}));for(const u of r.tools)yield yield fe(u),o++;if(!r.nextCursor)break;n=r.nextCursor}})}class gT{constructor(t=[],e){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=e}static create(t,e){return new gT(t,e)}async initialize(){var t,e,n,o;if(this.mcpTools.length>0)return;const r={},u=[];for(const y of this.mcpClients)try{for(var c=!0,f=(e=void 0,xf(gF(y))),h;h=await f.next(),t=h.done,!t;c=!0){o=h.value,c=!1;const A=o;u.push(A);const S=A.name;if(r[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);r[S]=y}}catch(A){e={error:A}}finally{try{!c&&!t&&(n=f.return)&&await n.call(f)}finally{if(e)throw e.error}}this.mcpTools=u,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),cD(this.mcpTools,this.config)}async callTool(t){await this.initialize();const e=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[n.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const u=await o.callTool({name:n.name,arguments:n.args},void 0,r);e.push({functionResponse:{name:n.name,response:u.isError?{error:u}:u}})}return e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function mF(i,t,e){const n=new nD;let o;e.data instanceof Blob?o=JSON.parse(await e.data.text()):o=JSON.parse(e.data);const r=bL(o);Object.assign(n,r),t(n)}class yF{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),u=TF(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${c}`;let h=()=>{};const y=new Promise(L=>{h=L}),A=t.callbacks,S=function(){h({})},E=this.apiClient,b={onopen:S,onmessage:L=>{mF(E,A.onmessage,L)},onerror:(e=A==null?void 0:A.onerror)!==null&&e!==void 0?e:function(L){},onclose:(n=A==null?void 0:A.onclose)!==null&&n!==void 0?n:function(L){}},x=this.webSocketFactory.create(f,AF(u),b);x.connect(),await y;const N=jt(this.apiClient,t.model),D=q_({model:N}),k=F0({setup:D});return x.send(JSON.stringify(k)),new vF(x,this.apiClient)}}class vF{constructor(t,e){this.conn=t,this.apiClient=e}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const e=O2(t),n=z_(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const e=B2(t),n=F0(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const e=F0({playbackControl:t});this.conn.send(JSON.stringify(e))}play(){this.sendPlaybackControl(Ou.PLAY)}pause(){this.sendPlaybackControl(Ou.PAUSE)}stop(){this.sendPlaybackControl(Ou.STOP)}resetContext(){this.sendPlaybackControl(Ou.RESET_CONTEXT)}close(){this.conn.close()}}function AF(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function TF(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function EF(i,t,e){const n=new eD;let o;e.data instanceof Blob?o=await e.data.text():e.data instanceof ArrayBuffer?o=new TextDecoder().decode(e.data):o=e.data;const r=JSON.parse(o);if(i.isVertexAI()){const u=gL(r);Object.assign(n,u)}else{const u=pL(r);Object.assign(n,u)}t(n)}class CF{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n,this.music=new yF(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var e,n,o,r,u,c;const f=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let y;const A=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&K_(t.config.tools)&&W_(A);const S=wF(A);if(this.apiClient.isVertexAI())y=`${f}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S);else{const X=this.apiClient.getApiKey();let et="BidiGenerateContent",Q="key";X!=null&&X.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),et="BidiGenerateContentConstrained",Q="access_token"),y=`${f}/ws/google.ai.generativelanguage.${h}.GenerativeService.${et}?${Q}=${X}`}let E=()=>{};const b=new Promise(X=>{E=X}),x=t.callbacks,N=function(){var X;(X=x==null?void 0:x.onopen)===null||X===void 0||X.call(x),E({})},D=this.apiClient,k={onopen:N,onmessage:X=>{EF(D,x.onmessage,X)},onerror:(e=x==null?void 0:x.onerror)!==null&&e!==void 0?e:function(X){},onclose:(n=x==null?void 0:x.onclose)!==null&&n!==void 0?n:function(X){}},L=this.webSocketFactory.create(y,_F(S),k);L.connect(),await b;let U=jt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const X=this.apiClient.getProject(),et=this.apiClient.getLocation();U=`projects/${X}/locations/${et}/`+U}let P={};this.apiClient.isVertexAI()&&((o=t.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[ym.AUDIO]}:t.config.responseModalities=[ym.AUDIO]),!((r=t.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const G=(c=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&c!==void 0?c:[],F=[];for(const X of G)if(this.isCallableTool(X)){const et=X;F.push(await et.tool())}else F.push(X);F.length>0&&(t.config.tools=F);const $={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?P=D2(this.apiClient,$):P=N2(this.apiClient,$),delete P.config,L.send(JSON.stringify(P)),new xF(L,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const bF={turnComplete:!0};class xF{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=qi(e.turns),t.isVertexAI()?n=n.map(o=>jc(o)):n=n.map(o=>Jm(o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const r of n){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!t.isVertexAI()&&!("id"in r))throw new Error(SF)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},bF),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:F2(t)}:e={realtimeInput:U2(t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function _F(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function wF(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qx=10;function zx(i){var t,e,n;if(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let o=!1;for(const u of(e=i==null?void 0:i.tools)!==null&&e!==void 0?e:[])if(Bg(u)){o=!0;break}if(!o)return!0;const r=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Bg(i){return"callTool"in i&&typeof i.callTool=="function"}function $x(i){var t;return!(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MF extends Hl{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>{var n,o,r,u,c;const f=await this.processParamsForMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!hF(e)||zx(e.config))return await this.generateContentInternal(f);if(pF(e))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,y;const A=qi(f.contents),S=(r=(o=(n=f.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:qx;let E=0;for(;E<S&&(h=await this.generateContentInternal(f),!(!h.functionCalls||h.functionCalls.length===0));){const b=h.candidates[0].content,x=[];for(const N of(c=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&c!==void 0?c:[])if(Bg(N)){const k=await N.callTool(h.functionCalls);x.push(...k)}E++,y={role:"user",parts:x},f.contents=qi(f.contents),f.contents.push(b),f.contents.push(y),$x(f.config)&&(A.push(b),A.push(y))}return $x(f.config)&&(h.automaticFunctionCallingHistory=A),h},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),zx(e.config)){const n=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var o;let r;const u=[];if(n!=null&&n.generatedImages)for(const f of n.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((o=f==null?void 0:f.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=f==null?void 0:f.safetyAttributes:u.push(f);let c;return r?c={generatedImages:u,positivePromptSafetyAttributes:r}:c={generatedImages:u},c}),this.list=async e=>{var n;const u={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((n=u.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new ip(Ol.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(u),u)},this.editImage=async e=>{const n={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(n.referenceImages=e.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async e=>{let n={numberOfImages:1,mode:"upscale"};e.config&&(n=Object.assign(Object.assign({},n),e.config));const o={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:n};return await this.upscaleImageInternal(o)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsForMcpUsage(t){var e,n,o;const r=(e=t.config)===null||e===void 0?void 0:e.tools;if(!r)return t;const u=await Promise.all(r.map(async f=>Bg(f)?await f.tool():f)),c={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:u})};if(c.config.tools=u,t.config&&t.config.tools&&K_(t.config.tools)){const f=(o=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&o!==void 0?o:{};let h=Object.assign({},f);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),W_(h),c.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return c}async initAfcToolsMap(t){var e,n,o;const r=new Map;for(const u of(n=(e=t.config)===null||e===void 0?void 0:e.tools)!==null&&n!==void 0?n:[])if(Bg(u)){const c=u,f=await c.tool();for(const h of(o=f.functionDeclarations)!==null&&o!==void 0?o:[]){if(!h.name)throw new Error("Function declaration name is required.");if(r.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);r.set(h.name,c)}}return r}async processAfcStream(t){var e,n,o;const r=(o=(n=(e=t.config)===null||e===void 0?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&o!==void 0?o:qx;let u=!1,c=0;const f=await this.initAfcToolsMap(t);return function(h,y,A){var S,E;return qu(this,arguments,function*(){for(var b,x,N,D;c<r;){u&&(c++,u=!1);const P=yield fe(h.processParamsForMcpUsage(A)),G=yield fe(h.generateContentStreamInternal(P)),F=[],$=[];try{for(var k=!0,L=(x=void 0,xf(G)),U;U=yield fe(L.next()),b=U.done,!b;k=!0){D=U.value,k=!1;const X=D;if(yield yield fe(X),X.candidates&&(!((S=X.candidates[0])===null||S===void 0)&&S.content)){$.push(X.candidates[0].content);for(const et of(E=X.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(c<r&&et.functionCall){if(!et.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(et.functionCall.name)){const Q=yield fe(y.get(et.functionCall.name).callTool([et.functionCall]));F.push(...Q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${et.functionCall.name}`)}}}}catch(X){x={error:X}}finally{try{!k&&!b&&(N=L.return)&&(yield fe(N.call(L)))}finally{if(x)throw x.error}}if(F.length>0){u=!0;const X=new tf;X.candidates=[{content:{role:"user",parts:F}}],yield yield fe(X);const et=[];et.push(...$),et.push({role:"user",parts:F});const Q=qi(A.contents).concat(et);A.contents=Q}else break}})}(this,f,t)}async generateContentInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Ox(this.apiClient,t);return c=Tt("{model}:generateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=Gx(y),S=new tf;return Object.assign(S,A),S})}else{const h=Fx(this.apiClient,t);return c=Tt("{model}:generateContent",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=Bx(y),S=new tf;return Object.assign(S,A),S})}}async generateContentStreamInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Ox(this.apiClient,t);return c=Tt("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),u.then(function(A){return qu(this,arguments,function*(){var S,E,b,x;try{for(var N=!0,D=xf(A),k;k=yield fe(D.next()),S=k.done,!S;N=!0){x=k.value,N=!1;const U=Gx(yield fe(x.json())),P=new tf;Object.assign(P,U),yield yield fe(P)}}catch(L){E={error:L}}finally{try{!N&&!S&&(b=D.return)&&(yield fe(b.call(D)))}finally{if(E)throw E.error}}})})}else{const h=Fx(this.apiClient,t);return c=Tt("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),u.then(function(A){return qu(this,arguments,function*(){var S,E,b,x;try{for(var N=!0,D=xf(A),k;k=yield fe(D.next()),S=k.done,!S;N=!0){x=k.value,N=!1;const U=Bx(yield fe(x.json())),P=new tf;Object.assign(P,U),yield yield fe(P)}}catch(L){E={error:L}}finally{try{!N&&!S&&(b=D.return)&&(yield fe(b.call(D)))}finally{if(E)throw E.error}}})})}}async embedContent(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Uk(this.apiClient,t);return c=Tt("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=VU(y),S=new yx;return Object.assign(S,A),S})}else{const h=KL(this.apiClient,t);return c=Tt("{model}:batchEmbedContents",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=yU(y),S=new yx;return Object.assign(S,A),S})}}async generateImagesInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Ok(this.apiClient,t);return c=Tt("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=qU(y),S=new vx;return Object.assign(S,A),S})}else{const h=QL(this.apiClient,t);return c=Tt("{model}:predict",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=TU(y),S=new vx;return Object.assign(S,A),S})}}async editImageInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=$k(this.apiClient,t);return r=Tt("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=zU(f),y=new KN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=Xk(this.apiClient,t);return r=Tt("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=$U(f),y=new WN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Jk(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>B0(y))}else{const h=ZL(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>O0(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Wk(this.apiClient,t);return c=Tt("{models_url}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=KU(y),S=new Ax;return Object.assign(S,A),S})}else{const h=tk(this.apiClient,t);return c=Tt("{models_url}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=EU(y),S=new Ax;return Object.assign(S,A),S})}}async update(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=Zk(this.apiClient,t);return c=Tt("{model}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>B0(y))}else{const h=nk(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>O0(y))}}async delete(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=jk(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(()=>{const y=WU(),A=new Tx;return Object.assign(A,y),A})}else{const h=ik(this.apiClient,t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(()=>{const y=CU(),A=new Tx;return Object.assign(A,y),A})}}async countTokens(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=eU(this.apiClient,t);return c=Tt("{model}:countTokens",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=QU(y),S=new Sx;return Object.assign(S,A),S})}else{const h=ok(this.apiClient,t);return c=Tt("{model}:countTokens",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=bU(y),S=new Sx;return Object.assign(S,A),S})}}async computeTokens(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=nU(this.apiClient,t);return r=Tt("{model}:computeTokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>{const h=ZU(f),y=new QN;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=oU(this.apiClient,t);return c=Tt("{model}:predictLongRunning",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>nF(y))}else{const h=lk(this.apiClient,t);return c=Tt("{model}:predictLongRunning",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>MU(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["_url","operationName"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function NF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["_url","operationName"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function DF(i){const t={},e=d(i,["operationName"]);e!=null&&p(t,["operationName"],e);const n=d(i,["resourceName"]);n!=null&&p(t,["_url","resourceName"],n);const o=d(i,["config"]);return o!=null&&p(t,["config"],o),t}function IF(i){const t={},e=d(i,["video","uri"]);e!=null&&p(t,["uri"],e);const n=d(i,["video","encodedVideo"]);n!=null&&p(t,["videoBytes"],zo(n));const o=d(i,["encoding"]);return o!=null&&p(t,["mimeType"],o),t}function PF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],IF(e)),t}function LF(i){const t={},e=d(i,["generatedSamples"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>PF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function kF(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response","generateVideoResponse"]);return u!=null&&p(t,["response"],LF(u)),t}function UF(i){const t={},e=d(i,["gcsUri"]);e!=null&&p(t,["uri"],e);const n=d(i,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],zo(n));const o=d(i,["mimeType"]);return o!=null&&p(t,["mimeType"],o),t}function FF(i){const t={},e=d(i,["_self"]);return e!=null&&p(t,["video"],UF(e)),t}function OF(i){const t={},e=d(i,["videos"]);if(e!=null){let r=e;Array.isArray(r)&&(r=r.map(u=>FF(u))),p(t,["generatedVideos"],r)}const n=d(i,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const o=d(i,["raiMediaFilteredReasons"]);return o!=null&&p(t,["raiMediaFilteredReasons"],o),t}function Yx(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);r!=null&&p(t,["error"],r);const u=d(i,["response"]);return u!=null&&p(t,["response"],OF(u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BF extends Hl{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=e.name.split("/operations/")[0];let r;return n&&"httpOptions"in n&&(r=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:o,config:{httpOptions:r}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=NF(t);return c=Tt("{operationName}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>Yx(y))}else{const h=RF(t);return c=Tt("{operationName}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>kF(y))}}async fetchPredictVideosOperationInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=DF(t);return r=Tt("{resourceName}:fetchPredictOperation",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>Yx(f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GF(i){const t={},e=d(i,["voiceName"]);return e!=null&&p(t,["voiceName"],e),t}function Q_(i){const t={},e=d(i,["prebuiltVoiceConfig"]);return e!=null&&p(t,["prebuiltVoiceConfig"],GF(e)),t}function VF(i){const t={},e=d(i,["speaker"]);e!=null&&p(t,["speaker"],e);const n=d(i,["voiceConfig"]);return n!=null&&p(t,["voiceConfig"],Q_(n)),t}function HF(i){const t={},e=d(i,["speakerVoiceConfigs"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>VF(o))),p(t,["speakerVoiceConfigs"],n)}return t}function qF(i){const t={},e=d(i,["voiceConfig"]);e!=null&&p(t,["voiceConfig"],Q_(e));const n=d(i,["multiSpeakerVoiceConfig"]);n!=null&&p(t,["multiSpeakerVoiceConfig"],HF(n));const o=d(i,["languageCode"]);return o!=null&&p(t,["languageCode"],o),t}function zF(i){const t={},e=d(i,["fps"]);e!=null&&p(t,["fps"],e);const n=d(i,["endOffset"]);n!=null&&p(t,["endOffset"],n);const o=d(i,["startOffset"]);return o!=null&&p(t,["startOffset"],o),t}function $F(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["data"]);e!=null&&p(t,["data"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function YF(i){const t={};if(d(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const e=d(i,["fileUri"]);e!=null&&p(t,["fileUri"],e);const n=d(i,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function XF(i){const t={},e=d(i,["videoMetadata"]);e!=null&&p(t,["videoMetadata"],zF(e));const n=d(i,["thought"]);n!=null&&p(t,["thought"],n);const o=d(i,["inlineData"]);o!=null&&p(t,["inlineData"],$F(o));const r=d(i,["fileData"]);r!=null&&p(t,["fileData"],YF(r));const u=d(i,["thoughtSignature"]);u!=null&&p(t,["thoughtSignature"],u);const c=d(i,["codeExecutionResult"]);c!=null&&p(t,["codeExecutionResult"],c);const f=d(i,["executableCode"]);f!=null&&p(t,["executableCode"],f);const h=d(i,["functionCall"]);h!=null&&p(t,["functionCall"],h);const y=d(i,["functionResponse"]);y!=null&&p(t,["functionResponse"],y);const A=d(i,["text"]);return A!=null&&p(t,["text"],A),t}function JF(i){const t={},e=d(i,["parts"]);if(e!=null){let o=e;Array.isArray(o)&&(o=o.map(r=>XF(r))),p(t,["parts"],o)}const n=d(i,["role"]);return n!=null&&p(t,["role"],n),t}function KF(i){const t={},e=d(i,["behavior"]);e!=null&&p(t,["behavior"],e);const n=d(i,["description"]);n!=null&&p(t,["description"],n);const o=d(i,["name"]);o!=null&&p(t,["name"],o);const r=d(i,["parameters"]);r!=null&&p(t,["parameters"],r);const u=d(i,["parametersJsonSchema"]);u!=null&&p(t,["parametersJsonSchema"],u);const c=d(i,["response"]);c!=null&&p(t,["response"],c);const f=d(i,["responseJsonSchema"]);return f!=null&&p(t,["responseJsonSchema"],f),t}function WF(i){const t={},e=d(i,["startTime"]);e!=null&&p(t,["startTime"],e);const n=d(i,["endTime"]);return n!=null&&p(t,["endTime"],n),t}function QF(i){const t={},e=d(i,["timeRangeFilter"]);return e!=null&&p(t,["timeRangeFilter"],WF(e)),t}function ZF(i){const t={},e=d(i,["mode"]);e!=null&&p(t,["mode"],e);const n=d(i,["dynamicThreshold"]);return n!=null&&p(t,["dynamicThreshold"],n),t}function jF(i){const t={},e=d(i,["dynamicRetrievalConfig"]);return e!=null&&p(t,["dynamicRetrievalConfig"],ZF(e)),t}function tO(){return{}}function eO(i){const t={},e=d(i,["functionDeclarations"]);if(e!=null){let f=e;Array.isArray(f)&&(f=f.map(h=>KF(h))),p(t,["functionDeclarations"],f)}if(d(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(i,["googleSearch"]);n!=null&&p(t,["googleSearch"],QF(n));const o=d(i,["googleSearchRetrieval"]);if(o!=null&&p(t,["googleSearchRetrieval"],jF(o)),d(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(i,["urlContext"])!=null&&p(t,["urlContext"],tO());const u=d(i,["codeExecution"]);u!=null&&p(t,["codeExecution"],u);const c=d(i,["computerUse"]);return c!=null&&p(t,["computerUse"],c),t}function nO(i){const t={},e=d(i,["handle"]);if(e!=null&&p(t,["handle"],e),d(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Xx(){return{}}function iO(i){const t={},e=d(i,["disabled"]);e!=null&&p(t,["disabled"],e);const n=d(i,["startOfSpeechSensitivity"]);n!=null&&p(t,["startOfSpeechSensitivity"],n);const o=d(i,["endOfSpeechSensitivity"]);o!=null&&p(t,["endOfSpeechSensitivity"],o);const r=d(i,["prefixPaddingMs"]);r!=null&&p(t,["prefixPaddingMs"],r);const u=d(i,["silenceDurationMs"]);return u!=null&&p(t,["silenceDurationMs"],u),t}function sO(i){const t={},e=d(i,["automaticActivityDetection"]);e!=null&&p(t,["automaticActivityDetection"],iO(e));const n=d(i,["activityHandling"]);n!=null&&p(t,["activityHandling"],n);const o=d(i,["turnCoverage"]);return o!=null&&p(t,["turnCoverage"],o),t}function oO(i){const t={},e=d(i,["targetTokens"]);return e!=null&&p(t,["targetTokens"],e),t}function aO(i){const t={},e=d(i,["triggerTokens"]);e!=null&&p(t,["triggerTokens"],e);const n=d(i,["slidingWindow"]);return n!=null&&p(t,["slidingWindow"],oO(n)),t}function rO(i){const t={},e=d(i,["proactiveAudio"]);return e!=null&&p(t,["proactiveAudio"],e),t}function lO(i,t){const e={},n=d(i,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const o=d(i,["responseModalities"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","responseModalities"],o);const r=d(i,["temperature"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig","temperature"],r);const u=d(i,["topP"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","topP"],u);const c=d(i,["topK"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","topK"],c);const f=d(i,["maxOutputTokens"]);t!==void 0&&f!=null&&p(t,["setup","generationConfig","maxOutputTokens"],f);const h=d(i,["mediaResolution"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","mediaResolution"],h);const y=d(i,["seed"]);t!==void 0&&y!=null&&p(t,["setup","generationConfig","seed"],y);const A=d(i,["speechConfig"]);t!==void 0&&A!=null&&p(t,["setup","generationConfig","speechConfig"],qF(fT(A)));const S=d(i,["enableAffectiveDialog"]);t!==void 0&&S!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],S);const E=d(i,["systemInstruction"]);t!==void 0&&E!=null&&p(t,["setup","systemInstruction"],JF(En(E)));const b=d(i,["tools"]);if(t!==void 0&&b!=null){let P=Qc(b);Array.isArray(P)&&(P=P.map(G=>eO(Wc(G)))),p(t,["setup","tools"],P)}const x=d(i,["sessionResumption"]);t!==void 0&&x!=null&&p(t,["setup","sessionResumption"],nO(x));const N=d(i,["inputAudioTranscription"]);t!==void 0&&N!=null&&p(t,["setup","inputAudioTranscription"],Xx());const D=d(i,["outputAudioTranscription"]);t!==void 0&&D!=null&&p(t,["setup","outputAudioTranscription"],Xx());const k=d(i,["realtimeInputConfig"]);t!==void 0&&k!=null&&p(t,["setup","realtimeInputConfig"],sO(k));const L=d(i,["contextWindowCompression"]);t!==void 0&&L!=null&&p(t,["setup","contextWindowCompression"],aO(L));const U=d(i,["proactivity"]);return t!==void 0&&U!=null&&p(t,["setup","proactivity"],rO(U)),e}function uO(i,t){const e={},n=d(t,["model"]);n!=null&&p(e,["setup","model"],jt(i,n));const o=d(t,["config"]);return o!=null&&p(e,["config"],lO(o,e)),e}function cO(i,t,e){const n={},o=d(t,["expireTime"]);e!==void 0&&o!=null&&p(e,["expireTime"],o);const r=d(t,["newSessionExpireTime"]);e!==void 0&&r!=null&&p(e,["newSessionExpireTime"],r);const u=d(t,["uses"]);e!==void 0&&u!=null&&p(e,["uses"],u);const c=d(t,["liveConnectConstraints"]);e!==void 0&&c!=null&&p(e,["bidiGenerateContentSetup"],uO(i,c));const f=d(t,["lockAdditionalFields"]);return e!==void 0&&f!=null&&p(e,["fieldMask"],f),n}function dO(i,t){const e={},n=d(t,["config"]);return n!=null&&p(e,["config"],cO(i,n,e)),e}function fO(i){const t={},e=d(i,["name"]);return e!=null&&p(t,["name"],e),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hO(i){const t=[];for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const n=i[e];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const o=Object.keys(n).map(r=>`${e}.${r}`);t.push(...o)}else t.push(e)}return t.join(",")}function pO(i,t){let e=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const r=n.setup;typeof r=="object"&&r!==null?(i.bidiGenerateContentSetup=r,e=r):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const o=i.fieldMask;if(e){const r=hO(e);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)r?i.fieldMask=r:delete i.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];o.length>0&&(c=o.map(h=>u.includes(h)?`generationConfig.${h}`:h));const f=[];r&&f.push(r),c.length>0&&f.push(...c),f.length>0?i.fieldMask=f.join(","):delete i.fieldMask}else delete i.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?i.fieldMask=o.join(","):delete i.fieldMask;return i}class gO extends Hl{constructor(t){super(),this.apiClient=t}async create(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=dO(this.apiClient,t);r=Tt("auth_tokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query;const f=pO(c,t.config);return o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),o.then(h=>fO(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","name"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function yO(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function vO(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],yO(e,t)),t}function AO(i){const t={},e=d(i,["textInput"]);e!=null&&p(t,["textInput"],e);const n=d(i,["output"]);return n!=null&&p(t,["output"],n),t}function TO(i){const t={};if(d(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const e=d(i,["examples"]);if(e!=null){let n=e;Array.isArray(n)&&(n=n.map(o=>AO(o))),p(t,["examples","examples"],n)}return t}function SO(i,t){const e={};if(d(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const n=d(i,["tunedModelDisplayName"]);if(t!==void 0&&n!=null&&p(t,["displayName"],n),d(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=d(i,["epochCount"]);t!==void 0&&o!=null&&p(t,["tuningTask","hyperparameters","epochCount"],o);const r=d(i,["learningRateMultiplier"]);if(r!=null&&p(e,["tuningTask","hyperparameters","learningRateMultiplier"],r),d(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=d(i,["batchSize"]);t!==void 0&&u!=null&&p(t,["tuningTask","hyperparameters","batchSize"],u);const c=d(i,["learningRate"]);return t!==void 0&&c!=null&&p(t,["tuningTask","hyperparameters","learningRate"],c),e}function EO(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["trainingDataset"]);n!=null&&p(t,["tuningTask","trainingData"],TO(n));const o=d(i,["config"]);return o!=null&&p(t,["config"],SO(o,t)),t}function CO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["_url","name"],e);const n=d(i,["config"]);return n!=null&&p(t,["config"],n),t}function bO(i,t){const e={},n=d(i,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const o=d(i,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const r=d(i,["filter"]);return t!==void 0&&r!=null&&p(t,["_query","filter"],r),e}function xO(i){const t={},e=d(i,["config"]);return e!=null&&p(t,["config"],bO(e,t)),t}function _O(i,t){const e={},n=d(i,["gcsUri"]);t!==void 0&&n!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],n);const o=d(i,["vertexDatasetResource"]);if(t!==void 0&&o!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],o),d(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return e}function wO(i,t){const e={},n=d(i,["gcsUri"]);n!=null&&p(e,["validationDatasetUri"],n);const o=d(i,["vertexDatasetResource"]);return t!==void 0&&o!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],o),e}function MO(i,t){const e={},n=d(i,["validationDataset"]);t!==void 0&&n!=null&&p(t,["supervisedTuningSpec"],wO(n,e));const o=d(i,["tunedModelDisplayName"]);t!==void 0&&o!=null&&p(t,["tunedModelDisplayName"],o);const r=d(i,["description"]);t!==void 0&&r!=null&&p(t,["description"],r);const u=d(i,["epochCount"]);t!==void 0&&u!=null&&p(t,["supervisedTuningSpec","hyperParameters","epochCount"],u);const c=d(i,["learningRateMultiplier"]);t!==void 0&&c!=null&&p(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const f=d(i,["exportLastCheckpointOnly"]);t!==void 0&&f!=null&&p(t,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const h=d(i,["adapterSize"]);if(t!==void 0&&h!=null&&p(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),d(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return e}function RO(i){const t={},e=d(i,["baseModel"]);e!=null&&p(t,["baseModel"],e);const n=d(i,["trainingDataset"]);n!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],_O(n,t));const o=d(i,["config"]);return o!=null&&p(t,["config"],MO(o,t)),t}function NO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["model"],e);const n=d(i,["name"]);return n!=null&&p(t,["endpoint"],n),t}function Z_(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["state"]);n!=null&&p(t,["state"],R_(n));const o=d(i,["createTime"]);o!=null&&p(t,["createTime"],o);const r=d(i,["tuningTask","startTime"]);r!=null&&p(t,["startTime"],r);const u=d(i,["tuningTask","completeTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["description"]);f!=null&&p(t,["description"],f);const h=d(i,["baseModel"]);h!=null&&p(t,["baseModel"],h);const y=d(i,["_self"]);y!=null&&p(t,["tunedModel"],NO(y));const A=d(i,["distillationSpec"]);A!=null&&p(t,["distillationSpec"],A);const S=d(i,["experiment"]);S!=null&&p(t,["experiment"],S);const E=d(i,["labels"]);E!=null&&p(t,["labels"],E);const b=d(i,["pipelineJob"]);b!=null&&p(t,["pipelineJob"],b);const x=d(i,["satisfiesPzi"]);x!=null&&p(t,["satisfiesPzi"],x);const N=d(i,["satisfiesPzs"]);N!=null&&p(t,["satisfiesPzs"],N);const D=d(i,["serviceAccount"]);D!=null&&p(t,["serviceAccount"],D);const k=d(i,["tunedModelDisplayName"]);return k!=null&&p(t,["tunedModelDisplayName"],k),t}function DO(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["tunedModels"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>Z_(r))),p(t,["tuningJobs"],o)}return t}function IO(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["metadata"]);n!=null&&p(t,["metadata"],n);const o=d(i,["done"]);o!=null&&p(t,["done"],o);const r=d(i,["error"]);return r!=null&&p(t,["error"],r),t}function PO(i){const t={},e=d(i,["checkpointId"]);e!=null&&p(t,["checkpointId"],e);const n=d(i,["epoch"]);n!=null&&p(t,["epoch"],n);const o=d(i,["step"]);o!=null&&p(t,["step"],o);const r=d(i,["endpoint"]);return r!=null&&p(t,["endpoint"],r),t}function LO(i){const t={},e=d(i,["model"]);e!=null&&p(t,["model"],e);const n=d(i,["endpoint"]);n!=null&&p(t,["endpoint"],n);const o=d(i,["checkpoints"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(u=>PO(u))),p(t,["checkpoints"],r)}return t}function V0(i){const t={},e=d(i,["name"]);e!=null&&p(t,["name"],e);const n=d(i,["state"]);n!=null&&p(t,["state"],R_(n));const o=d(i,["createTime"]);o!=null&&p(t,["createTime"],o);const r=d(i,["startTime"]);r!=null&&p(t,["startTime"],r);const u=d(i,["endTime"]);u!=null&&p(t,["endTime"],u);const c=d(i,["updateTime"]);c!=null&&p(t,["updateTime"],c);const f=d(i,["error"]);f!=null&&p(t,["error"],f);const h=d(i,["description"]);h!=null&&p(t,["description"],h);const y=d(i,["baseModel"]);y!=null&&p(t,["baseModel"],y);const A=d(i,["tunedModel"]);A!=null&&p(t,["tunedModel"],LO(A));const S=d(i,["supervisedTuningSpec"]);S!=null&&p(t,["supervisedTuningSpec"],S);const E=d(i,["tuningDataStats"]);E!=null&&p(t,["tuningDataStats"],E);const b=d(i,["encryptionSpec"]);b!=null&&p(t,["encryptionSpec"],b);const x=d(i,["partnerModelTuningSpec"]);x!=null&&p(t,["partnerModelTuningSpec"],x);const N=d(i,["distillationSpec"]);N!=null&&p(t,["distillationSpec"],N);const D=d(i,["experiment"]);D!=null&&p(t,["experiment"],D);const k=d(i,["labels"]);k!=null&&p(t,["labels"],k);const L=d(i,["pipelineJob"]);L!=null&&p(t,["pipelineJob"],L);const U=d(i,["satisfiesPzi"]);U!=null&&p(t,["satisfiesPzi"],U);const P=d(i,["satisfiesPzs"]);P!=null&&p(t,["satisfiesPzs"],P);const G=d(i,["serviceAccount"]);G!=null&&p(t,["serviceAccount"],G);const F=d(i,["tunedModelDisplayName"]);return F!=null&&p(t,["tunedModelDisplayName"],F),t}function kO(i){const t={},e=d(i,["nextPageToken"]);e!=null&&p(t,["nextPageToken"],e);const n=d(i,["tuningJobs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>V0(r))),p(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UO extends Hl{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new ip(Ol.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let o="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?o=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(o=n.name.split("/operations/")[0]),{name:o,state:D0.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=CO(t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>V0(y))}else{const h=mO(t);return c=Tt("{name}",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>Z_(y))}}async listInternal(t){var e,n,o,r;let u,c="",f={};if(this.apiClient.isVertexAI()){const h=xO(t);return c=Tt("tuningJobs",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(y=>y.json()),u.then(y=>{const A=kO(y),S=new Ex;return Object.assign(S,A),S})}else{const h=vO(t);return c=Tt("tunedModels",h._url),f=h._query,delete h.config,delete h._url,delete h._query,u=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),u.then(y=>{const A=DO(y),S=new Ex;return Object.assign(S,A),S})}}async tuneInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI()){const c=RO(t);return r=Tt("tuningJobs",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>V0(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let o,r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=EO(t);return r=Tt("tunedModels",c._url),u=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>IO(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FO{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const OO=1024*1024*8,BO=3,GO=1e3,VO=2,S0="x-goog-upload-status";async function HO(i,t,e){var n,o,r;let u=0,c=0,f=new I0(new Response),h="upload";for(u=i.size;c<u;){const A=Math.min(OO,u-c),S=i.slice(c,c+A);c+A>=u&&(h+=", finalize");let E=0,b=GO;for(;E<BO&&(f=await e.request({path:"",body:S,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(c),"Content-Length":String(A)}}}),!(!((n=f==null?void 0:f.headers)===null||n===void 0)&&n[S0]));)E++,await zO(b),b=b*VO;if(c+=A,((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[S0])!=="active")break;if(u<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const y=await(f==null?void 0:f.json());if(((r=f==null?void 0:f.headers)===null||r===void 0?void 0:r[S0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return y.file}async function qO(i){return{size:i.size,type:i.type}}function zO(i){return new Promise(t=>setTimeout(t,i))}class $O{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await HO(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await qO(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YO{create(t,e,n){return new XO(t,e,n)}}class XO{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jx="x-goog-api-key";class JO{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(Jx)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Jx,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KO="gl-node/";class WO{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=JN(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const o=new JO(this.apiKey);this.apiClient=new cF({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:KO+"web",uploader:new $O,downloader:new FO}),this.models=new MF(this.apiClient),this.live=new CF(this.apiClient,o,new YO),this.batches=new yI(this.apiClient),this.chats=new SP(this.models,this.apiClient),this.caches=new vP(this.apiClient),this.files=new LP(this.apiClient),this.operations=new BF(this.apiClient),this.authTokens=new gO(this.apiClient),this.tunings=new UO(this.apiClient)}}const j_="AIzaSyAQ2G3iTq-ncvefA-a6T8dfo_VYR1IudzU";console.log(" [DEBUG] LLM Client - API Key source:",{fromGeminiEnv:!0,fromApiEnv:!0,usingDefault:!1,keyLength:j_.length});let H0=j_;function Kx(i){H0=i}const td={generateContent:async i=>{var t;console.log(" [DEBUG] llmService.generateContent chamado com:",{model:i.model,contentsType:typeof i.contents,contentsLength:typeof i.contents=="string"?i.contents.length:"N/A",hasConfig:!!i.config,currentApiKeyLength:H0.length});try{const n=await new WO({apiKey:H0}).models.generateContent(i);return console.log(" [DEBUG] llmService response recebido:",{textLength:((t=n.text)==null?void 0:t.length)||0,hasText:!!n.text}),{text:n.text||""}}catch(e){throw console.error(" [DEBUG] llmService error:",e),e}}},QO=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),R.jsx("path",{d:"M12 12v9"}),R.jsx("path",{d:"m16 16-4-4-4 4"})]}),tw=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),R.jsx("polyline",{points:"14 2 14 8 20 8"}),R.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),R.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),R.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]}),ZO=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),R.jsx("polyline",{points:"7 10 12 15 17 10"}),R.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),jO=i=>R.jsx("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:R.jsx("path",{d:"m12 3-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9zM21 12l-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9zM3 12l-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9z"})}),q0=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),R.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),tB=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M3 12a9 9 0 0 1 9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),R.jsx("path",{d:"M21 3v5h-5"}),R.jsx("path",{d:"M21 12a9 9 0 0 1-9 9c-2.52 0-4.93-1-6.74-2.74L3 16"}),R.jsx("path",{d:"M3 21v-5h5"})]}),eB=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M12 8V4H8"}),R.jsx("rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}),R.jsx("path",{d:"M2 14h2"}),R.jsx("path",{d:"M20 14h2"}),R.jsx("path",{d:"M15 13v2"}),R.jsx("path",{d:"M9 13v2"})]}),nB=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"m8 11 2 2 4-4"}),R.jsx("circle",{cx:"11",cy:"11",r:"8"}),R.jsx("path",{d:"m21 21-4.3-4.3"})]}),z0=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("circle",{cx:"12",cy:"12",r:"10"}),R.jsx("polyline",{points:"12 6 12 12 16 14"})]}),iB=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("circle",{cx:"12",cy:"12",r:"10"}),R.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),R.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),sB=i=>R.jsx("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:R.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),oB=i=>R.jsxs("svg",{...i,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[R.jsx("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}),R.jsx("path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"}),R.jsx("path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"}),R.jsx("path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375"}),R.jsx("path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5"}),R.jsx("path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396"}),R.jsx("path",{d:"M19.938 10.5a4 4 0 0 1 .585.396"}),R.jsx("path",{d:"M6 18a4 4 0 0 1-1.967-.516"}),R.jsx("path",{d:"M19.967 17.484A4 4 0 0 1 18 18"})]}),aB=({onFileSelect:i})=>{const[t,e]=rt.useState(!1),n=rt.useCallback(f=>{f.preventDefault(),f.stopPropagation(),e(!0)},[]),o=rt.useCallback(f=>{f.preventDefault(),f.stopPropagation(),e(!1)},[]),r=rt.useCallback(f=>{f.preventDefault(),f.stopPropagation()},[]),u=rt.useCallback(f=>{if(f.preventDefault(),f.stopPropagation(),e(!1),f.dataTransfer.files&&f.dataTransfer.files.length>0){const h=f.dataTransfer.files[0];h.type==="application/pdf"?i(h):alert("Por favor, envie apenas arquivos PDF."),f.dataTransfer.clearData()}},[i]),c=f=>{f.target.files&&f.target.files.length>0&&i(f.target.files[0])};return R.jsxs("div",{onDragEnter:n,onDragLeave:o,onDragOver:r,onDrop:u,className:`w-full max-w-2xl mx-auto text-center p-8 border-2 border-dashed rounded-lg transition-colors
        ${t?"border-primary-500 bg-primary-50 dark:bg-primary-950/50":"border-slate-300 dark:border-slate-600 hover:border-primary-400"}`,children:[R.jsx("input",{id:"file-upload",type:"file",className:"sr-only",accept:"application/pdf",onChange:c}),R.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[R.jsx(QO,{className:"mx-auto h-12 w-12 text-slate-400"}),R.jsx("p",{className:"mt-4 text-lg font-semibold text-slate-700 dark:text-slate-200",children:"Arraste e solte o arquivo PDF aqui"}),R.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"ou"}),R.jsx("div",{className:"mt-2 inline-block px-4 py-2 text-sm font-medium text-primary-600 dark:text-primary-400 rounded-md bg-primary-500/10 hover:bg-primary-500/20",children:"Escolha um arquivo do seu computador"})]})]})};var ce=(i=>(i.PENDING="Pending",i.PROCESSING="Processing OCR",i.CORRECTING="AI Correction",i.COMPLETED="Completed",i.ERROR="Error",i))(ce||{});const Vi=({className:i,children:t,...e})=>R.jsx("div",{className:`bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm ${i||""}`,...e,children:t}),rB=i=>{switch(i){case ce.COMPLETED:return"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200";case ce.PROCESSING:return"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 animate-pulse";case ce.CORRECTING:return"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200 animate-pulse";case ce.ERROR:return"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200";default:return"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}},lB=({results:i,isProcessing:t,isReformatting:e,progress:n,error:o})=>{const[r,u]=rt.useState(1),c=i.find(y=>y.pageNumber===r),f=()=>e?"Phase 4: Formatting final document...":t?n.phase:"Processing completed",h=()=>{if(e)return 95;if(n.total===0)return 0;const y=n.processed/n.total*80;return i.filter(S=>S.status===ce.CORRECTING||S.status===ce.PROCESSING).length===0&&n.processed===n.total?85:y};return i.length===0&&t?R.jsxs("div",{className:"w-full text-center",children:[R.jsx("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-primary-500 mx-auto"}),R.jsx("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:"Analisando o PDF..."}),R.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Isso pode levar alguns instantes."})]}):R.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6",children:[R.jsxs("aside",{className:"w-full lg:w-1/4 xl:w-1/5",children:[R.jsx("h3",{className:"text-lg font-semibold mb-3 px-2 dark:text-slate-100",children:"Pginas"}),R.jsx("div",{className:"space-y-1 max-h-[60vh] overflow-y-auto pr-2",children:i.map(y=>R.jsxs("button",{onClick:()=>u(y.pageNumber),className:`w-full text-left p-2 rounded-md transition-colors flex justify-between items-center ${r===y.pageNumber?"bg-primary-100 dark:bg-primary-900/60 text-primary-800 dark:text-primary-100":"hover:bg-slate-100 dark:hover:bg-slate-700/50 dark:text-slate-300"}`,children:[R.jsxs("span",{className:"font-medium text-sm truncate pr-2",children:["Pgina ",y.pageNumber]}),R.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[y.changes&&y.status===ce.COMPLETED&&R.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full",title:"AI made modifications to this page"}),y.method&&R.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${y.method==="AI OCR"?"bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200":y.method==="AI Correction"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200":"bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-200"}`,children:y.method}),R.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold w-[125px] text-center ${rB(y.status)}`,children:y.status})]})]},y.pageNumber))}),t&&R.jsxs("div",{className:"mt-4 px-2",children:[R.jsx("p",{className:"text-sm font-medium dark:text-slate-200",children:f()}),n.phaseProgress&&R.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1",children:n.phaseProgress}),R.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2.5 mt-2",children:R.jsx("div",{className:"bg-primary-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${h()}%`}})}),R.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mt-1",children:[R.jsxs("span",{children:[n.processed,"/",n.total," pginas"]}),R.jsxs("span",{children:[Math.round(h()),"%"]})]})]})]}),R.jsxs("main",{className:"w-full lg:w-3/4 xl:w-4/5",children:[c?R.jsxs("div",{className:"space-y-4 h-[70vh] overflow-auto",children:[R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-[45vh]",children:[R.jsxs(Vi,{className:"flex flex-col overflow-hidden",children:[R.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:R.jsxs("h4",{className:"font-semibold dark:text-slate-100",children:["Original (Pgina ",c.pageNumber,")"]})}),R.jsx("div",{className:"p-4 flex-grow overflow-auto bg-slate-50 dark:bg-slate-800/50",children:c.imageUrl?R.jsx("img",{src:c.imageUrl,alt:`Pgina ${c.pageNumber} do PDF`,className:"w-full h-auto object-contain"}):R.jsx("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Carregando imagem..."})})]}),R.jsxs(Vi,{className:"flex flex-col overflow-hidden",children:[R.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:[R.jsx("h4",{className:"font-semibold dark:text-slate-100",children:"Extracted Text"}),c.method&&R.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["(",c.method,")"]})]}),R.jsxs("div",{className:"p-4 flex-grow overflow-auto",children:[(c.status===ce.PROCESSING||c.status===ce.CORRECTING)&&R.jsxs("div",{className:"flex items-center justify-center h-full flex-col",children:[R.jsx("div",{className:"w-8 h-8 border-2 border-dashed rounded-full animate-spin border-primary-500"}),R.jsxs("p",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400",children:[c.status,"..."]})]}),c.status===ce.ERROR&&R.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:R.jsx("p",{children:"Failed to process this page."})}),(c.status===ce.COMPLETED||c.status===ce.PENDING)&&R.jsx("pre",{className:"whitespace-pre-wrap text-sm font-sans dark:text-slate-300",children:c.text||"No text extracted."})]})]})]}),c.changes&&c.status===ce.COMPLETED&&R.jsxs(Vi,{className:"flex flex-col max-h-[20vh]",children:[R.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:[R.jsxs("h4",{className:"font-semibold dark:text-slate-100 flex items-center gap-2",children:[R.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Modificaes Feitas pela IA"]}),R.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Summary of corrections and improvements applied to text"})]}),R.jsx("div",{className:"p-4 overflow-auto",children:R.jsx("pre",{className:"whitespace-pre-wrap text-sm font-sans text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:c.changes})})]})]}):R.jsx("div",{className:"flex items-center justify-center h-[70vh]",children:R.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Selecione uma pgina para ver os resultados."})}),o&&R.jsx("div",{className:"mt-4 text-center text-red-500 bg-red-100 dark:bg-red-900/50 p-3 rounded-md",children:o})]})]})},uB=({steps:i,currentStep:t})=>R.jsx("nav",{"aria-label":"Progress",children:R.jsx("ol",{role:"list",className:"flex items-center justify-center",children:i.map((e,n)=>R.jsxs("li",{className:`relative ${n!==i.length-1?"pr-8 sm:pr-20":""}`,children:[n<t?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:R.jsx("div",{className:"h-0.5 w-full bg-primary-500"})}),R.jsxs("a",{href:"#",className:"relative flex h-8 w-8 items-center justify-center bg-primary-500 rounded-full hover:bg-primary-600",children:[R.jsx(q0,{className:"h-5 w-5 text-white","aria-hidden":"true"}),R.jsx("span",{className:"sr-only",children:e})]})]}):n===t?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:R.jsx("div",{className:"h-0.5 w-full bg-slate-200 dark:bg-slate-700"})}),R.jsxs("a",{href:"#",className:"relative flex h-8 w-8 items-center justify-center bg-white dark:bg-slate-800 border-2 border-primary-500 rounded-full","aria-current":"step",children:[R.jsx("span",{className:"h-2.5 w-2.5 bg-primary-500 rounded-full","aria-hidden":"true"}),R.jsx("span",{className:"sr-only",children:e})]})]}):R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:R.jsx("div",{className:"h-0.5 w-full bg-slate-200 dark:bg-slate-700"})}),R.jsx("div",{className:"relative flex h-8 w-8 items-center justify-center bg-white dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-full",children:R.jsx("span",{className:"sr-only",children:e})})]}),R.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 w-max text-center",children:R.jsx("span",{className:`text-xs font-medium ${n<=t?"text-primary-600 dark:text-primary-400":"text-slate-500 dark:text-slate-400"}`,children:e})})]},e))})}),Dn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),$0=[.001,0,0,.001,0,0],E0=1.35,vi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ya={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ew="pdfjs_internal_editor_",Nt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Ht={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},cB={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},yn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Gg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ie={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Du={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Wm={ERRORS:0,WARNINGS:1,INFOS:5},Am={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ng={moveTo:0,lineTo:1,curveTo:2,closePath:3},dB={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Qm=Wm.WARNINGS;function fB(i){Number.isInteger(i)&&(Qm=i)}function hB(){return Qm}function Zm(i){Qm>=Wm.INFOS&&console.log(`Info: ${i}`)}function Dt(i){Qm>=Wm.WARNINGS&&console.log(`Warning: ${i}`)}function oe(i){throw new Error(i)}function Le(i,t){i||oe(t)}function pB(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function nw(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"){if(e.addDefaultProtocol&&i.startsWith("www.")){const o=i.match(/\./g);(o==null?void 0:o.length)>=2&&(i=`http://${i}`)}if(e.tryConvertEncoding)try{i=AB(i)}catch{}}const n=t?URL.parse(i,t):URL.parse(i);return pB(n)?n:null}function iw(i,t,e=!1){const n=URL.parse(i);return n?(n.hash=t,n.href):e&&nw(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Gt(i,t,e,n=!1){return Object.defineProperty(i,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const ql=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class Wx extends ql{constructor(t,e){super(t,"PasswordException"),this.code=e}}class C0 extends ql{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Y0 extends ql{constructor(t){super(t,"InvalidPDFException")}}class Tm extends ql{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class gB extends ql{constructor(t){super(t,"FormatError")}}class er extends ql{constructor(t){super(t,"AbortException")}}function sw(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&oe("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const n=[];for(let o=0;o<t;o+=e){const r=Math.min(o+e,t),u=i.subarray(o,r);n.push(String.fromCharCode.apply(null,u))}return n.join("")}function sp(i){typeof i!="string"&&oe("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=i.charCodeAt(n)&255;return e}function mB(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function yB(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function vB(){try{return new Function(""),!0}catch{return!1}}class hn{static get isLittleEndian(){return Gt(this,"isLittleEndian",yB())}static get isEvalSupported(){return Gt(this,"isEvalSupported",vB())}static get isOffscreenCanvasSupported(){return Gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Gt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Gt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return Gt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const b0=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Go,Vg,X0;class Et{static makeHexColor(t,e,n){return`#${b0[t]}${b0[e]}${b0[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,n=0){const o=t[n],r=t[n+1];t[n]=o*e[0]+r*e[2]+e[4],t[n+1]=o*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const o=e[0],r=e[1],u=e[2],c=e[3],f=e[4],h=e[5];for(let y=0;y<6;y+=2){const A=t[n+y],S=t[n+y+1];t[n+y]=A*o+S*u+f,t[n+y+1]=A*r+S*c+h}}static applyInverseTransform(t,e){const n=t[0],o=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-o*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-n*e[1]+o*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,n){const o=e[0],r=e[1],u=e[2],c=e[3],f=e[4],h=e[5],y=t[0],A=t[1],S=t[2],E=t[3];let b=o*y+f,x=b,N=o*S+f,D=N,k=c*A+h,L=k,U=c*E+h,P=U;if(r!==0||u!==0){const G=r*y,F=r*S,$=u*A,X=u*E;b+=$,D+=$,N+=X,x+=X,k+=G,P+=G,U+=F,L+=F}n[0]=Math.min(n[0],b,N,x,D),n[1]=Math.min(n[1],k,U,L,P),n[2]=Math.max(n[2],b,N,x,D),n[3]=Math.max(n[3],k,U,L,P)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],o=t[1],r=t[2],u=t[3],c=n**2+o**2,f=n*r+o*u,h=r**2+u**2,y=(c+h)/2,A=Math.sqrt(y**2-(c*h-f**2));e[0]=Math.sqrt(y+A||1),e[1]=Math.sqrt(y-A||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),o=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>o)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),u=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>u?null:[n,r,o,u]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,o,r){r[0]=Math.min(r[0],t,n),r[1]=Math.min(r[1],e,o),r[2]=Math.max(r[2],t,n),r[3]=Math.max(r[3],e,o)}static bezierBoundingBox(t,e,n,o,r,u,c,f,h){h[0]=Math.min(h[0],t,c),h[1]=Math.min(h[1],e,f),h[2]=Math.max(h[2],t,c),h[3]=Math.max(h[3],e,f),M(this,Go,X0).call(this,t,n,r,c,e,o,u,f,3*(-t+3*(n-r)+c),6*(t-2*n+r),3*(n-t),h),M(this,Go,X0).call(this,t,n,r,c,e,o,u,f,3*(-e+3*(o-u)+f),6*(e-2*o+u),3*(o-e),h)}}Go=new WeakSet,Vg=function(t,e,n,o,r,u,c,f,h,y){if(h<=0||h>=1)return;const A=1-h,S=h*h,E=S*h,b=A*(A*(A*t+3*h*e)+3*S*n)+E*o,x=A*(A*(A*r+3*h*u)+3*S*c)+E*f;y[0]=Math.min(y[0],b),y[1]=Math.min(y[1],x),y[2]=Math.max(y[2],b),y[3]=Math.max(y[3],x)},X0=function(t,e,n,o,r,u,c,f,h,y,A,S){if(Math.abs(h)<1e-12){Math.abs(y)>=1e-12&&M(this,Go,Vg).call(this,t,e,n,o,r,u,c,f,-A/y,S);return}const E=y**2-4*A*h;if(E<0)return;const b=Math.sqrt(E),x=2*h;M(this,Go,Vg).call(this,t,e,n,o,r,u,c,f,(-y+b)/x,S),M(this,Go,Vg).call(this,t,e,n,o,r,u,c,f,(-y-b)/x,S)},w(Et,Go);function AB(i){return decodeURIComponent(escape(i))}let x0=null,Qx=null;function TB(i){return x0||(x0=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Qx=new Map([["","t"]])),i.replaceAll(x0,(t,e,n)=>e?e.normalize("NFKC"):Qx.get(n))}function ow(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),sw(i)}const mT="pdfjs_internal_id_";function SB(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,o,...r]=e;if(!i(n)&&!Number.isInteger(n)||!t(o))return!1;const u=r.length;let c=!0;switch(o.name){case"XYZ":if(u<2||u>3)return!1;break;case"Fit":case"FitB":return u===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(u>1)return!1;break;case"FitR":if(u!==4)return!1;c=!1;break;default:return!1}for(const f of r)if(!(typeof f=="number"||c&&f===null))return!1;return!0}function In(i,t,e){return Math.min(Math.max(i,t),e)}function aw(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(sw(i))}function EB(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):sp(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});const io="http://www.w3.org/2000/svg",Mr=class Mr{};ot(Mr,"CSS",96),ot(Mr,"PDF",72),ot(Mr,"PDF_TO_CSS_UNITS",Mr.CSS/Mr.PDF);let nr=Mr;async function op(i,t="text"){if(af(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType=t,o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){if(o.status===200||o.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(o.response);return}e(o.responseText);return}n(new Error(o.statusText))}},o.send(null)})}class ap{constructor({viewBox:t,userUnit:e,scale:n,rotation:o,offsetX:r=0,offsetY:u=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=o,this.offsetX=r,this.offsetY=u,n*=e;const f=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let y,A,S,E;switch(o%=360,o<0&&(o+=360),o){case 180:y=-1,A=0,S=0,E=1;break;case 90:y=0,A=1,S=1,E=0;break;case 270:y=0,A=-1,S=-1,E=0;break;case 0:y=1,A=0,S=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(S=-S,E=-E);let b,x,N,D;y===0?(b=Math.abs(h-t[1])*n+r,x=Math.abs(f-t[0])*n+u,N=(t[3]-t[1])*n,D=(t[2]-t[0])*n):(b=Math.abs(f-t[0])*n+r,x=Math.abs(h-t[1])*n+u,N=(t[2]-t[0])*n,D=(t[3]-t[1])*n),this.transform=[y*n,A*n,S*n,E*n,b-y*n*f-S*n*h,x-A*n*f-E*n*h],this.width=N,this.height=D}get rawDims(){const t=this.viewBox;return Gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:o=this.offsetY,dontFlip:r=!1}={}){return new ap({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:o,dontFlip:r})}convertToViewportPoint(t,e){const n=[t,e];return Et.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];Et.applyTransform(e,this.transform);const n=[t[2],t[3]];return Et.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return Et.applyInverseTransform(n,this.transform),n}}class yT extends ql{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function jm(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function vT(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function CB(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function bB(i,t="document.pdf"){if(typeof i!="string")return t;if(jm(i))return Dt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return t;const o=c=>{try{let f=decodeURIComponent(c);return f.includes("/")?(f=f.split("/").at(-1),f.test(/^\.pdf$/i)?f:c):f}catch{return c}},r=/\.pdf$/i,u=n.pathname.split("/").at(-1);if(r.test(u))return o(u);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const h of c)if(r.test(h))return o(h);const f=Array.from(n.searchParams.keys()).reverse();for(const h of f)if(r.test(h))return o(h)}if(n.hash){const f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(f)return o(f[0])}return t}class Zx{constructor(){ot(this,"started",Object.create(null));ot(this,"times",[])}time(t){t in this.started&&Dt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Dt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:o,end:r}of this.times)t.push(`${n.padEnd(e)} ${r-o}ms
`);return t.join("")}}function af(i,t){const e=t?URL.parse(i,t):URL.parse(i);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function us(i){i.preventDefault()}function Pe(i){i.preventDefault(),i.stopPropagation()}function xB(i){console.log("Deprecated API usage: "+i)}var Rf;class AT{static toDateObject(t){if(!t||typeof t!="string")return null;g(this,Rf)||C(this,Rf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=g(this,Rf).exec(t);if(!e)return null;const n=parseInt(e[1],10);let o=parseInt(e[2],10);o=o>=1&&o<=12?o-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let u=parseInt(e[4],10);u=u>=0&&u<=23?u:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let f=parseInt(e[6],10);f=f>=0&&f<=59?f:0;const h=e[7]||"Z";let y=parseInt(e[8],10);y=y>=0&&y<=23?y:0;let A=parseInt(e[9],10)||0;return A=A>=0&&A<=59?A:0,h==="-"?(u+=y,c+=A):h==="+"&&(u-=y,c-=A),new Date(Date.UTC(n,o,r,u,c,f))}}Rf=new WeakMap,w(AT,Rf);function _B(i,{scale:t=1,rotation:e=0}){const{width:n,height:o}=i.attributes.style,r=[0,0,parseInt(n),parseInt(o)];return new ap({viewBox:r,userUnit:1,scale:t,rotation:e})}function TT(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Dt(`Not a valid color format: "${i}"`),[0,0,0])}function wB(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;i.set(e,TT(n))}t.remove()}function Te(i){const{a:t,b:e,c:n,d:o,e:r,f:u}=i.getTransform();return[t,e,n,o,r,u]}function ms(i){const{a:t,b:e,c:n,d:o,e:r,f:u}=i.getTransform().invertSelf();return[t,e,n,o,r,u]}function Bl(i,t,e=!1,n=!0){if(t instanceof ap){const{pageWidth:o,pageHeight:r}=t.rawDims,{style:u}=i,c=hn.isCSSRoundSupported,f=`var(--total-scale-factor) * ${o}px`,h=`var(--total-scale-factor) * ${r}px`,y=c?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,A=c?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!e||t.rotation%180===0?(u.width=y,u.height=A):(u.width=A,u.height=y)}n&&i.setAttribute("data-main-rotation",t.rotation)}class Os{constructor(){const{pixelRatio:t}=Os;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,o,r=-1){let u=1/0,c=1/0,f=1/0;n=Os.capPixels(n,r),n>0&&(u=Math.sqrt(n/(t*e))),o!==-1&&(c=o/t,f=o/e);const h=Math.min(u,c,f);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const J0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var va,Nr,Pi,Aa,Nf,$u,Df,Mm,rw,Pn,lw,uw,rf,Hg;const ao=class ao{constructor(t){w(this,Pn);w(this,va,null);w(this,Nr,null);w(this,Pi);w(this,Aa,null);w(this,Nf,null);w(this,$u,null);C(this,Pi,t),g(ao,Df)||C(ao,Df,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=C(this,va,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=g(this,Pi)._uiManager._signal;t.addEventListener("contextmenu",us,{signal:e}),t.addEventListener("pointerdown",M(ao,Mm,rw),{signal:e});const n=C(this,Aa,document.createElement("div"));n.className="buttons",t.append(n);const o=g(this,Pi).toolbarPosition;if(o){const{style:r}=t,u=g(this,Pi)._uiManager.direction==="ltr"?1-o[0]:o[0];r.insetInlineEnd=`${100*u}%`,r.top=`calc(${100*o[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return g(this,va)}hide(){var t;g(this,va).classList.add("hidden"),(t=g(this,Nr))==null||t.hideDropdown()}show(){var t;g(this,va).classList.remove("hidden"),(t=g(this,Nf))==null||t.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=g(this,Pi),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",g(ao,Df)[t]),M(this,Pn,rf).call(this,n),n.addEventListener("click",o=>{e.delete()},{signal:e._signal}),g(this,Aa).append(n)}async addAltText(t){const e=await t.render();M(this,Pn,rf).call(this,e),g(this,Aa).append(e,g(this,Pn,Hg)),C(this,Nf,t)}addColorPicker(t){C(this,Nr,t);const e=t.renderButton();M(this,Pn,rf).call(this,e),g(this,Aa).append(e,g(this,Pn,Hg))}async addEditSignatureButton(t){const e=C(this,$u,await t.renderEditButton(g(this,Pi)));M(this,Pn,rf).call(this,e),g(this,Aa).append(e,g(this,Pn,Hg))}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(t){g(this,$u)&&(g(this,$u).title=t)}remove(){var t;g(this,va).remove(),(t=g(this,Nr))==null||t.destroy(),C(this,Nr,null)}};va=new WeakMap,Nr=new WeakMap,Pi=new WeakMap,Aa=new WeakMap,Nf=new WeakMap,$u=new WeakMap,Df=new WeakMap,Mm=new WeakSet,rw=function(t){t.stopPropagation()},Pn=new WeakSet,lw=function(t){g(this,Pi)._focusEventsAllowed=!1,Pe(t)},uw=function(t){g(this,Pi)._focusEventsAllowed=!0,Pe(t)},rf=function(t){const e=g(this,Pi)._uiManager._signal;t.addEventListener("focusin",M(this,Pn,lw).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",M(this,Pn,uw).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",us,{signal:e})},Hg=function(){const t=document.createElement("div");return t.className="divider",t},w(ao,Mm),w(ao,Df,null);let K0=ao;var If,Dr,Ir,ir,cw,dw,fw;class MB{constructor(t){w(this,ir);w(this,If,null);w(this,Dr,null);w(this,Ir);C(this,Ir,t)}show(t,e,n){const[o,r]=M(this,ir,dw).call(this,e,n),{style:u}=g(this,Dr)||C(this,Dr,M(this,ir,cw).call(this));t.append(g(this,Dr)),u.insetInlineEnd=`${100*o}%`,u.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,Dr).remove()}}If=new WeakMap,Dr=new WeakMap,Ir=new WeakMap,ir=new WeakSet,cw=function(){const t=C(this,Dr,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",us,{signal:g(this,Ir)._signal});const e=C(this,If,document.createElement("div"));return e.className="buttons",t.append(e),M(this,ir,fw).call(this),t},dw=function(t,e){let n=0,o=0;for(const r of t){const u=r.y+r.height;if(u<n)continue;const c=r.x+(e?r.width:0);if(u>n){o=c,n=u;continue}e?c>o&&(o=c):c<o&&(o=c)}return[e?1-o:o,n]},fw=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=g(this,Ir)._signal;t.addEventListener("contextmenu",us,{signal:n}),t.addEventListener("click",()=>{g(this,Ir).highlightSelection("floating_button")},{signal:n}),g(this,If).append(t)};function hw(i,t,e){for(const n of e)t.addEventListener(n,i[n].bind(i))}var Rm;class RB{constructor(){w(this,Rm,0)}get id(){return`${ew}${xn(this,Rm)._++}`}}Rm=new WeakMap;var Yu,Pf,An,Xu,qg;const wT=class wT{constructor(){w(this,Xu);w(this,Yu,ow());w(this,Pf,0);w(this,An,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),o=new Image;o.src=t;const r=o.decode().then(()=>(n.drawImage(o,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Gt(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:n,size:o,type:r}=t;return M(this,Xu,qg).call(this,`${e}_${n}_${o}_${r}`,t)}async getFromUrl(t){return M(this,Xu,qg).call(this,t,t)}async getFromBlob(t,e){const n=await e;return M(this,Xu,qg).call(this,t,n)}async getFromId(t){g(this,An)||C(this,An,new Map);const e=g(this,An).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){g(this,An)||C(this,An,new Map);let n=g(this,An).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const o=new OffscreenCanvas(e.width,e.height);return o.getContext("2d").drawImage(e,0,0),n={bitmap:o.transferToImageBitmap(),id:`image_${g(this,Yu)}_${xn(this,Pf)._++}`,refCounter:1,isSvg:!1},g(this,An).set(t,n),g(this,An).set(n.id,n),n}getSvgUrl(t){const e=g(this,An).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var o;g(this,An)||C(this,An,new Map);const e=g(this,An).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=r.convertToBlob()}(o=n.close)==null||o.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${g(this,Yu)}_`)}};Yu=new WeakMap,Pf=new WeakMap,An=new WeakMap,Xu=new WeakSet,qg=async function(t,e){g(this,An)||C(this,An,new Map);let n=g(this,An).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${g(this,Yu)}_${xn(this,Pf)._++}`,refCounter:0,isSvg:!1});let o;if(typeof e=="string"?(n.url=e,o=await op(e,"blob")):e instanceof File?o=n.file=e:e instanceof Blob&&(o=e),o.type==="image/svg+xml"){const r=wT._isSVGFittingCanvas,u=new FileReader,c=new Image,f=new Promise((h,y)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},u.onload=async()=>{const A=n.svgUrl=u.result;c.src=await r?`${A}#svgView(preserveAspectRatio(none))`:A},c.onerror=u.onerror=y});u.readAsDataURL(o),await f}else n.bitmap=await createImageBitmap(o);n.refCounter=1}catch(o){Dt(o),n=null}return g(this,An).set(t,n),n&&g(this,An).set(n.id,n),n};let W0=wT;var _e,Ta,Lf,Ae;class NB{constructor(t=128){w(this,_e,[]);w(this,Ta,!1);w(this,Lf);w(this,Ae,-1);C(this,Lf,t)}add({cmd:t,undo:e,post:n,mustExec:o,type:r=NaN,overwriteIfSameType:u=!1,keepUndo:c=!1}){if(o&&t(),g(this,Ta))return;const f={cmd:t,undo:e,post:n,type:r};if(g(this,Ae)===-1){g(this,_e).length>0&&(g(this,_e).length=0),C(this,Ae,0),g(this,_e).push(f);return}if(u&&g(this,_e)[g(this,Ae)].type===r){c&&(f.undo=g(this,_e)[g(this,Ae)].undo),g(this,_e)[g(this,Ae)]=f;return}const h=g(this,Ae)+1;h===g(this,Lf)?g(this,_e).splice(0,1):(C(this,Ae,h),h<g(this,_e).length&&g(this,_e).splice(h)),g(this,_e).push(f)}undo(){if(g(this,Ae)===-1)return;C(this,Ta,!0);const{undo:t,post:e}=g(this,_e)[g(this,Ae)];t(),e==null||e(),C(this,Ta,!1),C(this,Ae,g(this,Ae)-1)}redo(){if(g(this,Ae)<g(this,_e).length-1){C(this,Ae,g(this,Ae)+1),C(this,Ta,!0);const{cmd:t,post:e}=g(this,_e)[g(this,Ae)];t(),e==null||e(),C(this,Ta,!1)}}hasSomethingToUndo(){return g(this,Ae)!==-1}hasSomethingToRedo(){return g(this,Ae)<g(this,_e).length-1}cleanType(t){if(g(this,Ae)!==-1){for(let e=g(this,Ae);e>=0;e--)if(g(this,_e)[e].type!==t){g(this,_e).splice(e+1,g(this,Ae)-e),C(this,Ae,e);return}g(this,_e).length=0,C(this,Ae,-1)}}destroy(){C(this,_e,null)}}_e=new WeakMap,Ta=new WeakMap,Lf=new WeakMap,Ae=new WeakMap;var Nm,pw;class rp{constructor(t){w(this,Nm);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=hn.platform;for(const[n,o,r={}]of t)for(const u of n){const c=u.startsWith("mac+");e&&c?(this.callbacks.set(u.slice(4),{callback:o,options:r}),this.allKeys.add(u.split("+").at(-1))):!e&&!c&&(this.callbacks.set(u,{callback:o,options:r}),this.allKeys.add(u.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(M(this,Nm,pw).call(this,e));if(!n)return;const{callback:o,options:{bubbles:r=!1,args:u=[],checker:c=null}}=n;c&&!c(t,e)||(o.bind(t,...u,e)(),r||Pe(e))}}Nm=new WeakSet,pw=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Dm=class Dm{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return wB(t),Gt(this,"_colors",t)}convert(t){const e=TT(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,o]of this._colors)if(o.every((r,u)=>r===e[u]))return Dm._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Et.makeHexColor(...e):t}};ot(Dm,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Q0=Dm;var Ju,si,Ve,an,Ku,lo,Wu,Li,Sa,Ea,Qu,Pr,As,Wi,Lr,kf,Uf,Zu,Ff,Ts,Ca,ju,ba,Ss,Im,xa,Of,_a,kr,Ur,wa,Bf,Je,Zt,uo,Ma,Fr,Gf,Vf,Ra,Es,co,Hf,qf,ki,lt,zg,Z0,gw,mw,$g,yw,vw,Aw,j0,Tw,tA,eA,Sw,_n,so,Ew,Cw,nA,bw,lf,iA;const Gu=class Gu{constructor(t,e,n,o,r,u,c,f,h,y,A,S,E,b,x){w(this,lt);w(this,Ju,new AbortController);w(this,si,null);w(this,Ve,new Map);w(this,an,new Map);w(this,Ku,null);w(this,lo,null);w(this,Wu,null);w(this,Li,new NB);w(this,Sa,null);w(this,Ea,null);w(this,Qu,0);w(this,Pr,new Set);w(this,As,null);w(this,Wi,null);w(this,Lr,new Set);ot(this,"_editorUndoBar",null);w(this,kf,!1);w(this,Uf,!1);w(this,Zu,!1);w(this,Ff,null);w(this,Ts,null);w(this,Ca,null);w(this,ju,null);w(this,ba,!1);w(this,Ss,null);w(this,Im,new RB);w(this,xa,!1);w(this,Of,!1);w(this,_a,null);w(this,kr,null);w(this,Ur,null);w(this,wa,null);w(this,Bf,null);w(this,Je,Nt.NONE);w(this,Zt,new Set);w(this,uo,null);w(this,Ma,null);w(this,Fr,null);w(this,Gf,null);w(this,Vf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});w(this,Ra,[0,0]);w(this,Es,null);w(this,co,null);w(this,Hf,null);w(this,qf,null);w(this,ki,null);const N=this._signal=g(this,Ju).signal;C(this,co,t),C(this,Hf,e),C(this,qf,n),C(this,Ku,o),C(this,Ma,r),this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:N}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:N}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:N}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:N}),u._on("setpreference",this.onSetPreference.bind(this),{signal:N}),u._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:N}),M(this,lt,yw).call(this),M(this,lt,Sw).call(this),M(this,lt,j0).call(this),C(this,lo,c.annotationStorage),C(this,Ff,c.filterFactory),C(this,Fr,f),C(this,ju,h||null),C(this,kf,y),C(this,Uf,A),C(this,Zu,S),C(this,Bf,E||null),this.viewParameters={realScale:nr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const t=Gu.prototype,e=u=>g(u,co).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&u.hasSomethingToControl(),n=(u,{target:c})=>{if(c instanceof HTMLInputElement){const{type:f}=c;return f!=="text"&&f!=="number"}return!0},o=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new rp([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(u,{target:c})=>!(c instanceof HTMLButtonElement)&&g(u,co).contains(c)&&!u.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(u,{target:c})=>!(c instanceof HTMLButtonElement)&&g(u,co).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,n,o,r,u,c,f;(t=g(this,ki))==null||t.resolve(),C(this,ki,null),(e=g(this,Ju))==null||e.abort(),C(this,Ju,null),this._signal=null;for(const h of g(this,an).values())h.destroy();g(this,an).clear(),g(this,Ve).clear(),g(this,Lr).clear(),(n=g(this,wa))==null||n.clear(),C(this,si,null),g(this,Zt).clear(),g(this,Li).destroy(),(o=g(this,Ku))==null||o.destroy(),(r=g(this,Ma))==null||r.destroy(),(u=g(this,Ss))==null||u.hide(),C(this,Ss,null),(c=g(this,Ur))==null||c.destroy(),C(this,Ur,null),g(this,Ts)&&(clearTimeout(g(this,Ts)),C(this,Ts,null)),g(this,Es)&&(clearTimeout(g(this,Es)),C(this,Es,null)),(f=this._editorUndoBar)==null||f.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return g(this,Bf)}get useNewAltTextFlow(){return g(this,Uf)}get useNewAltTextWhenAddingImage(){return g(this,Zu)}get hcmFilter(){return Gt(this,"hcmFilter",g(this,Fr)?g(this,Ff).addHCMFilter(g(this,Fr).foreground,g(this,Fr).background):"none")}get direction(){return Gt(this,"direction",getComputedStyle(g(this,co)).direction)}get highlightColors(){return Gt(this,"highlightColors",g(this,ju)?new Map(g(this,ju).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColorNames(){return Gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),C(this,Ea,t)}setMainHighlightColorPicker(t){C(this,Ur,t)}editAltText(t,e=!1){var n;(n=g(this,Ku))==null||n.editAltText(this,t,e)}getSignature(t){var e;(e=g(this,Ma))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return g(this,Ma)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":C(this,Zu,e);break}}onPageChanging({pageNumber:t}){C(this,Qu,t-1)}focusMainContainer(){g(this,co).focus()}findParent(t,e){for(const n of g(this,an).values()){const{x:o,y:r,width:u,height:c}=n.div.getBoundingClientRect();if(t>=o&&t<=o+u&&e>=r&&e<=r+c)return n}return null}disableUserSelect(t=!1){g(this,Hf).classList.toggle("noUserSelect",t)}addShouldRescale(t){g(this,Lr).add(t)}removeShouldRescale(t){g(this,Lr).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*nr.PDF_TO_CSS_UNITS;for(const n of g(this,Lr))n.onScaleChanging();(e=g(this,Ea))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:o,focusNode:r,focusOffset:u}=e,c=e.toString(),h=M(this,lt,zg).call(this,e).closest(".textLayer"),y=this.getSelectionBoxes(h);if(!y)return;e.empty();const A=M(this,lt,Z0).call(this,h),S=g(this,Je)===Nt.NONE,E=()=>{A==null||A.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:n,anchorOffset:o,focusNode:r,focusOffset:u,text:c}),S&&this.showAllEditors("highlight",!0,!0)};if(S){this.switchToMode(Nt.HIGHLIGHT,E);return}E()}addToAnnotationStorage(t){!t.isEmpty()&&g(this,lo)&&!g(this,lo).has(t.id)&&g(this,lo).setValue(t.id,t)}a11yAlert(t,e=null){const n=g(this,qf);n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,g(this,ba)&&(C(this,ba,!1),M(this,lt,$g).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of g(this,Zt))if(e.div.contains(t)){C(this,kr,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!g(this,kr))return;const[t,e]=g(this,kr);C(this,kr,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){M(this,lt,j0).call(this),M(this,lt,tA).call(this)}removeEditListeners(){M(this,lt,Tw).call(this),M(this,lt,eA).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of g(this,Wi))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of g(this,Wi))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=g(this,si))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const o of g(this,Zt)){const r=o.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const u of g(this,Wi))if(u.isHandlingMimeForPasting(r.type)){u.paste(r,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(r){Dt(`paste: "${r.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const o=this.currentLayer;try{const r=[];for(const f of n){const h=await o.deserialize(f);if(!h)return;r.push(h)}const u=()=>{for(const f of r)M(this,lt,nA).call(this,f);M(this,lt,iA).call(this,r)},c=()=>{for(const f of r)f.remove()};this.addCommands({cmd:u,undo:c,mustExec:!0})}catch(r){Dt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,Je)!==Nt.NONE&&!this.isEditorHandlingKeyboard&&Gu._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,ba)&&(C(this,ba,!1),M(this,lt,$g).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(M(this,lt,vw).call(this),M(this,lt,tA).call(this),M(this,lt,_n).call(this,{isEditing:g(this,Je)!==Nt.NONE,isEmpty:M(this,lt,lf).call(this),hasSomethingToUndo:g(this,Li).hasSomethingToUndo(),hasSomethingToRedo:g(this,Li).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,lt,Aw).call(this),M(this,lt,eA).call(this),M(this,lt,_n).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!g(this,Wi)){C(this,Wi,t);for(const e of g(this,Wi))M(this,lt,so).call(this,e.defaultPropertiesToUpdate)}}getId(){return g(this,Im).id}get currentLayer(){return g(this,an).get(g(this,Qu))}getLayer(t){return g(this,an).get(t)}get currentPageIndex(){return g(this,Qu)}addLayer(t){g(this,an).set(t.pageIndex,t),g(this,xa)?t.enable():t.disable()}removeLayer(t){g(this,an).delete(t.pageIndex)}async updateMode(t,e=null,n=!1,o=!1){var r,u,c;if(g(this,Je)!==t&&!(g(this,ki)&&(await g(this,ki).promise,!g(this,ki)))){if(C(this,ki,Promise.withResolvers()),(r=g(this,Ea))==null||r.commitOrRemove(),C(this,Je,t),t===Nt.NONE){this.setEditingState(!1),M(this,lt,Cw).call(this),(u=this._editorUndoBar)==null||u.hide(),g(this,ki).resolve();return}t===Nt.SIGNATURE&&await((c=g(this,Ma))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await M(this,lt,Ew).call(this),this.unselectAll();for(const f of g(this,an).values())f.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),g(this,ki).resolve();return}for(const f of g(this,Ve).values())f.annotationElementId===e||f.id===e?(this.setSelected(f),o&&f.enterInEditMode()):f.unselect();g(this,ki).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==g(this,Je)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){var n;if(g(this,Wi)){switch(t){case Ht.CREATE:this.currentLayer.addNewEditor(e);return;case Ht.HIGHLIGHT_DEFAULT_COLOR:(n=g(this,Ur))==null||n.updateColor(e);break;case Ht.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,Gf)||C(this,Gf,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const o of g(this,Zt))o.updateParams(t,e);for(const o of g(this,Wi))o.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var r;for(const u of g(this,Ve).values())u.editorType===t&&u.show(e);(((r=g(this,Gf))==null?void 0:r.get(Ht.HIGHLIGHT_SHOW_ALL))??!0)!==e&&M(this,lt,so).call(this,[[Ht.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(g(this,Of)!==t){C(this,Of,t);for(const e of g(this,an).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of g(this,Ve).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return g(this,Ve).get(t)}addEditor(t){g(this,Ve).set(t.id,t)}removeEditor(t){var e,n;t.div.contains(document.activeElement)&&(g(this,Ts)&&clearTimeout(g(this,Ts)),C(this,Ts,setTimeout(()=>{this.focusMainContainer(),C(this,Ts,null)},0))),g(this,Ve).delete(t.id),t.annotationElementId&&((e=g(this,wa))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!g(this,Pr).has(t.annotationElementId))&&((n=g(this,lo))==null||n.remove(t.id))}addDeletedAnnotationElement(t){g(this,Pr).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return g(this,Pr).has(t)}removeDeletedAnnotationElement(t){g(this,Pr).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){g(this,si)!==t&&(C(this,si,t),t&&M(this,lt,so).call(this,t.propertiesToUpdate))}updateUI(t){g(this,lt,bw)===t&&M(this,lt,so).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){M(this,lt,so).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(g(this,Zt).has(t)){g(this,Zt).delete(t),t.unselect(),M(this,lt,_n).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,Zt).add(t),t.select(),M(this,lt,so).call(this,t.propertiesToUpdate),M(this,lt,_n).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.id}),(e=g(this,Ea))==null||e.commitOrRemove();for(const n of g(this,Zt))n!==t&&n.unselect();g(this,Zt).clear(),g(this,Zt).add(t),t.select(),M(this,lt,so).call(this,t.propertiesToUpdate),M(this,lt,_n).call(this,{hasSelectedEditor:!0})}isSelected(t){return g(this,Zt).has(t)}get firstSelectedEditor(){return g(this,Zt).values().next().value}unselect(t){t.unselect(),g(this,Zt).delete(t),M(this,lt,_n).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,Zt).size!==0}get isEnterHandled(){return g(this,Zt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;g(this,Li).undo(),M(this,lt,_n).call(this,{hasSomethingToUndo:g(this,Li).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,lt,lf).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){g(this,Li).redo(),M(this,lt,_n).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,Li).hasSomethingToRedo(),isEmpty:M(this,lt,lf).call(this)})}addCommands(t){g(this,Li).add(t),M(this,lt,_n).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,lt,lf).call(this)})}cleanUndoStack(t){g(this,Li).cleanType(t)}delete(){var r;this.commitOrRemove();const t=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...g(this,Zt)],n=()=>{var u;(u=this._editorUndoBar)==null||u.show(o,e.length===1?e[0].editorType:e.length);for(const c of e)c.remove()},o=()=>{for(const u of e)M(this,lt,nA).call(this,u)};this.addCommands({cmd:n,undo:o,mustExec:!0})}commitOrRemove(){var t;(t=g(this,si))==null||t.commitOrRemove()}hasSomethingToControl(){return g(this,si)||this.hasSelection}selectAll(){for(const t of g(this,Zt))t.commit();M(this,lt,iA).call(this,g(this,Ve).values())}unselectAll(){var t;if(!(g(this,si)&&(g(this,si).commitOrRemove(),g(this,Je)!==Nt.NONE))&&!((t=g(this,Ea))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of g(this,Zt))e.unselect();g(this,Zt).clear(),M(this,lt,_n).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;g(this,Ra)[0]+=t,g(this,Ra)[1]+=e;const[o,r]=g(this,Ra),u=[...g(this,Zt)],c=1e3;g(this,Es)&&clearTimeout(g(this,Es)),C(this,Es,setTimeout(()=>{C(this,Es,null),g(this,Ra)[0]=g(this,Ra)[1]=0,this.addCommands({cmd:()=>{for(const f of u)g(this,Ve).has(f.id)&&(f.translateInPage(o,r),f.translationDone())},undo:()=>{for(const f of u)g(this,Ve).has(f.id)&&(f.translateInPage(-o,-r),f.translationDone())},mustExec:!1})},c));for(const f of u)f.translateInPage(t,e),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,As,new Map);for(const t of g(this,Zt))g(this,As).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,As))return!1;this.disableUserSelect(!1);const t=g(this,As);C(this,As,null);let e=!1;for(const[{x:o,y:r,pageIndex:u},c]of t)c.newX=o,c.newY=r,c.newPageIndex=u,e||(e=o!==c.savedX||r!==c.savedY||u!==c.savedPageIndex);if(!e)return!1;const n=(o,r,u,c)=>{if(g(this,Ve).has(o.id)){const f=g(this,an).get(c);f?o._setParentAndPosition(f,r,u):(o.pageIndex=c,o.x=r,o.y=u)}};return this.addCommands({cmd:()=>{for(const[o,{newX:r,newY:u,newPageIndex:c}]of t)n(o,r,u,c)},undo:()=>{for(const[o,{savedX:r,savedY:u,savedPageIndex:c}]of t)n(o,r,u,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(g(this,As))for(const n of g(this,As).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||g(this,Zt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return g(this,si)===t}getActive(){return g(this,si)}getMode(){return g(this,Je)}get imageManager(){return Gt(this,"imageManager",new W0)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let h=0,y=e.rangeCount;h<y;h++)if(!t.contains(e.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:o,width:r,height:u}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(h,y,A,S)=>({x:(y-o)/u,y:1-(h+A-n)/r,width:S/u,height:A/r});break;case"180":c=(h,y,A,S)=>({x:1-(h+A-n)/r,y:1-(y+S-o)/u,width:A/r,height:S/u});break;case"270":c=(h,y,A,S)=>({x:1-(y+S-o)/u,y:(h-n)/r,width:S/u,height:A/r});break;default:c=(h,y,A,S)=>({x:(h-n)/r,y:(y-o)/u,width:A/r,height:S/u});break}const f=[];for(let h=0,y=e.rangeCount;h<y;h++){const A=e.getRangeAt(h);if(!A.collapsed)for(const{x:S,y:E,width:b,height:x}of A.getClientRects())b===0||x===0||f.push(c(S,E,b,x))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:t,id:e}){(g(this,Wu)||C(this,Wu,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=g(this,Wu))==null||e.delete(t)}renderAnnotationElement(t){var o;const e=(o=g(this,Wu))==null?void 0:o.get(t.data.id);if(!e)return;const n=g(this,lo).getRawValue(e);n&&(g(this,Je)===Nt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){var r;const o=(r=g(this,wa))==null?void 0:r.get(t);o&&(o.setCanvas(e,n),g(this,wa).delete(t))}addMissingCanvas(t,e){(g(this,wa)||C(this,wa,new Map)).set(t,e)}};Ju=new WeakMap,si=new WeakMap,Ve=new WeakMap,an=new WeakMap,Ku=new WeakMap,lo=new WeakMap,Wu=new WeakMap,Li=new WeakMap,Sa=new WeakMap,Ea=new WeakMap,Qu=new WeakMap,Pr=new WeakMap,As=new WeakMap,Wi=new WeakMap,Lr=new WeakMap,kf=new WeakMap,Uf=new WeakMap,Zu=new WeakMap,Ff=new WeakMap,Ts=new WeakMap,Ca=new WeakMap,ju=new WeakMap,ba=new WeakMap,Ss=new WeakMap,Im=new WeakMap,xa=new WeakMap,Of=new WeakMap,_a=new WeakMap,kr=new WeakMap,Ur=new WeakMap,wa=new WeakMap,Bf=new WeakMap,Je=new WeakMap,Zt=new WeakMap,uo=new WeakMap,Ma=new WeakMap,Fr=new WeakMap,Gf=new WeakMap,Vf=new WeakMap,Ra=new WeakMap,Es=new WeakMap,co=new WeakMap,Hf=new WeakMap,qf=new WeakMap,ki=new WeakMap,lt=new WeakSet,zg=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Z0=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of g(this,an).values())if(n.hasTextLayer(t))return n;return null},gw=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=M(this,lt,zg).call(this,t).closest(".textLayer"),o=this.getSelectionBoxes(n);o&&(g(this,Ss)||C(this,Ss,new MB(this)),g(this,Ss).show(n,o,this.direction==="ltr"))},mw=function(){var r,u,c;const t=document.getSelection();if(!t||t.isCollapsed){g(this,uo)&&((r=g(this,Ss))==null||r.hide(),C(this,uo,null),M(this,lt,_n).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===g(this,uo))return;const o=M(this,lt,zg).call(this,t).closest(".textLayer");if(!o){g(this,uo)&&((u=g(this,Ss))==null||u.hide(),C(this,uo,null),M(this,lt,_n).call(this,{hasSelectedText:!1}));return}if((c=g(this,Ss))==null||c.hide(),C(this,uo,e),M(this,lt,_n).call(this,{hasSelectedText:!0}),!(g(this,Je)!==Nt.HIGHLIGHT&&g(this,Je)!==Nt.NONE)&&(g(this,Je)===Nt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,ba,this.isShiftKeyDown),!this.isShiftKeyDown)){const f=g(this,Je)===Nt.HIGHLIGHT?M(this,lt,Z0).call(this,o):null;f==null||f.toggleDrawing();const h=new AbortController,y=this.combinedSignal(h),A=S=>{S.type==="pointerup"&&S.button!==0||(h.abort(),f==null||f.toggleDrawing(!0),S.type==="pointerup"&&M(this,lt,$g).call(this,"main_toolbar"))};window.addEventListener("pointerup",A,{signal:y}),window.addEventListener("blur",A,{signal:y})}},$g=function(t=""){g(this,Je)===Nt.HIGHLIGHT?this.highlightSelection(t):g(this,kf)&&M(this,lt,gw).call(this)},yw=function(){document.addEventListener("selectionchange",M(this,lt,mw).bind(this),{signal:this._signal})},vw=function(){if(g(this,Ca))return;C(this,Ca,new AbortController);const t=this.combinedSignal(g(this,Ca));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Aw=function(){var t;(t=g(this,Ca))==null||t.abort(),C(this,Ca,null)},j0=function(){if(g(this,_a))return;C(this,_a,new AbortController);const t=this.combinedSignal(g(this,_a));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},Tw=function(){var t;(t=g(this,_a))==null||t.abort(),C(this,_a,null)},tA=function(){if(g(this,Sa))return;C(this,Sa,new AbortController);const t=this.combinedSignal(g(this,Sa));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},eA=function(){var t;(t=g(this,Sa))==null||t.abort(),C(this,Sa,null)},Sw=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},_n=function(t){Object.entries(t).some(([n,o])=>g(this,Vf)[n]!==o)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,Vf),t)}),g(this,Je)===Nt.HIGHLIGHT&&t.hasSelectedEditor===!1&&M(this,lt,so).call(this,[[Ht.HIGHLIGHT_FREE,!0]]))},so=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Ew=async function(){if(!g(this,xa)){C(this,xa,!0);const t=[];for(const e of g(this,an).values())t.push(e.enable());await Promise.all(t);for(const e of g(this,Ve).values())e.enable()}},Cw=function(){if(this.unselectAll(),g(this,xa)){C(this,xa,!1);for(const t of g(this,an).values())t.disable();for(const t of g(this,Ve).values())t.disable()}},nA=function(t){const e=g(this,an).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},bw=function(){let t=null;for(t of g(this,Zt));return t},lf=function(){if(g(this,Ve).size===0)return!0;if(g(this,Ve).size===1)for(const t of g(this,Ve).values())return t.isEmpty();return!1},iA=function(t){for(const e of g(this,Zt))e.unselect();g(this,Zt).clear();for(const e of t)e.isEmpty()||(g(this,Zt).add(e),e.select());M(this,lt,_n).call(this,{hasSelectedEditor:this.hasSelection})},ot(Gu,"TRANSLATE_SMALL",1),ot(Gu,"TRANSLATE_BIG",10);let Gl=Gu;var Ke,Cs,Qi,tc,bs,oi,ec,xs,qn,fo,Or,_s,Na,ls,uf,Yg;const wn=class wn{constructor(t){w(this,ls);w(this,Ke,null);w(this,Cs,!1);w(this,Qi,null);w(this,tc,null);w(this,bs,null);w(this,oi,null);w(this,ec,!1);w(this,xs,null);w(this,qn,null);w(this,fo,null);w(this,Or,null);w(this,_s,!1);C(this,qn,t),C(this,_s,t._uiManager.useNewAltTextFlow),g(wn,Na)||C(wn,Na,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){wn._l10n??(wn._l10n=t)}async render(){const t=C(this,Qi,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=C(this,tc,document.createElement("span"));t.append(e),g(this,_s)?(t.classList.add("new"),t.setAttribute("data-l10n-id",g(wn,Na).missing),e.setAttribute("data-l10n-id",g(wn,Na)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=g(this,qn)._uiManager._signal;t.addEventListener("contextmenu",us,{signal:n}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:n});const o=r=>{r.preventDefault(),g(this,qn)._uiManager.editAltText(g(this,qn)),g(this,_s)&&g(this,qn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,ls,uf)}})};return t.addEventListener("click",o,{capture:!0,signal:n}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(C(this,ec,!0),o(r))},{signal:n}),await M(this,ls,Yg).call(this),t}finish(){g(this,Qi)&&(g(this,Qi).focus({focusVisible:g(this,ec)}),C(this,ec,!1))}isEmpty(){return g(this,_s)?g(this,Ke)===null:!g(this,Ke)&&!g(this,Cs)}hasData(){return g(this,_s)?g(this,Ke)!==null||!!g(this,fo):this.isEmpty()}get guessedText(){return g(this,fo)}async setGuessedText(t){g(this,Ke)===null&&(C(this,fo,t),C(this,Or,await wn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),M(this,ls,Yg).call(this))}toggleAltTextBadge(t=!1){var e;if(!g(this,_s)||g(this,Ke)){(e=g(this,xs))==null||e.remove(),C(this,xs,null);return}if(!g(this,xs)){const n=C(this,xs,document.createElement("div"));n.className="noAltTextBadge",g(this,qn).div.append(n)}g(this,xs).classList.toggle("hidden",!t)}serialize(t){let e=g(this,Ke);return!t&&g(this,fo)===e&&(e=g(this,Or)),{altText:e,decorative:g(this,Cs),guessedText:g(this,fo),textWithDisclaimer:g(this,Or)}}get data(){return{altText:g(this,Ke),decorative:g(this,Cs)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:o,cancel:r=!1}){n&&(C(this,fo,n),C(this,Or,o)),!(g(this,Ke)===t&&g(this,Cs)===e)&&(r||(C(this,Ke,t),C(this,Cs,e)),M(this,ls,Yg).call(this))}toggle(t=!1){g(this,Qi)&&(!t&&g(this,oi)&&(clearTimeout(g(this,oi)),C(this,oi,null)),g(this,Qi).disabled=!t)}shown(){g(this,qn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,ls,uf)}})}destroy(){var t,e;(t=g(this,Qi))==null||t.remove(),C(this,Qi,null),C(this,tc,null),C(this,bs,null),(e=g(this,xs))==null||e.remove(),C(this,xs,null)}};Ke=new WeakMap,Cs=new WeakMap,Qi=new WeakMap,tc=new WeakMap,bs=new WeakMap,oi=new WeakMap,ec=new WeakMap,xs=new WeakMap,qn=new WeakMap,fo=new WeakMap,Or=new WeakMap,_s=new WeakMap,Na=new WeakMap,ls=new WeakSet,uf=function(){return g(this,Ke)&&"added"||g(this,Ke)===null&&this.guessedText&&"review"||"missing"},Yg=async function(){var o,r,u;const t=g(this,Qi);if(!t)return;if(g(this,_s)){if(t.classList.toggle("done",!!g(this,Ke)),t.setAttribute("data-l10n-id",g(wn,Na)[g(this,ls,uf)]),(o=g(this,tc))==null||o.setAttribute("data-l10n-id",g(wn,Na)[`${g(this,ls,uf)}-label`]),!g(this,Ke)){(r=g(this,bs))==null||r.remove();return}}else{if(!g(this,Ke)&&!g(this,Cs)){t.classList.remove("done"),(u=g(this,bs))==null||u.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=g(this,bs);if(!e){C(this,bs,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${g(this,qn).id}`;const c=100,f=g(this,qn)._uiManager._signal;f.addEventListener("abort",()=>{clearTimeout(g(this,oi)),C(this,oi,null)},{once:!0}),t.addEventListener("mouseenter",()=>{C(this,oi,setTimeout(()=>{C(this,oi,null),g(this,bs).classList.add("show"),g(this,qn)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:f}),t.addEventListener("mouseleave",()=>{var h;g(this,oi)&&(clearTimeout(g(this,oi)),C(this,oi,null)),(h=g(this,bs))==null||h.classList.remove("show")},{signal:f})}g(this,Cs)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=g(this,Ke)),e.parentNode||t.append(e);const n=g(this,qn).getElementForAltText();n==null||n.setAttribute("aria-describedby",e.id)},w(wn,Na,null),ot(wn,"_l10n",null);let Sm=wn;var nc,Br,zf,$f,Yf,Xf,Jf,ho,Gr,po,Vr,go,sr,xw,_w,ww;const MT=class MT{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:o=null,onPinching:r=null,onPinchEnd:u=null,signal:c}){w(this,sr);w(this,nc);w(this,Br,!1);w(this,zf,null);w(this,$f);w(this,Yf);w(this,Xf);w(this,Jf);w(this,ho,null);w(this,Gr);w(this,po,null);w(this,Vr);w(this,go,null);C(this,nc,t),C(this,zf,n),C(this,$f,e),C(this,Yf,o),C(this,Xf,r),C(this,Jf,u),C(this,Vr,new AbortController),C(this,Gr,AbortSignal.any([c,g(this,Vr).signal])),t.addEventListener("touchstart",M(this,sr,xw).bind(this),{passive:!1,signal:g(this,Gr)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Os.pixelRatio}destroy(){var t,e;(t=g(this,Vr))==null||t.abort(),C(this,Vr,null),(e=g(this,ho))==null||e.abort(),C(this,ho,null)}};nc=new WeakMap,Br=new WeakMap,zf=new WeakMap,$f=new WeakMap,Yf=new WeakMap,Xf=new WeakMap,Jf=new WeakMap,ho=new WeakMap,Gr=new WeakMap,po=new WeakMap,Vr=new WeakMap,go=new WeakMap,sr=new WeakSet,xw=function(t){var o,r,u;if((o=g(this,$f))!=null&&o.call(this))return;if(t.touches.length===1){if(g(this,ho))return;const c=C(this,ho,new AbortController),f=AbortSignal.any([g(this,Gr),c.signal]),h=g(this,nc),y={capture:!0,signal:f,passive:!1},A=S=>{var E;S.pointerType==="touch"&&((E=g(this,ho))==null||E.abort(),C(this,ho,null))};h.addEventListener("pointerdown",S=>{S.pointerType==="touch"&&(Pe(S),A(S))},y),h.addEventListener("pointerup",A,y),h.addEventListener("pointercancel",A,y);return}if(!g(this,go)){C(this,go,new AbortController);const c=AbortSignal.any([g(this,Gr),g(this,go).signal]),f=g(this,nc),h={signal:c,capture:!1,passive:!1};f.addEventListener("touchmove",M(this,sr,_w).bind(this),h);const y=M(this,sr,ww).bind(this);f.addEventListener("touchend",y,h),f.addEventListener("touchcancel",y,h),h.capture=!0,f.addEventListener("pointerdown",Pe,h),f.addEventListener("pointermove",Pe,h),f.addEventListener("pointercancel",Pe,h),f.addEventListener("pointerup",Pe,h),(r=g(this,Yf))==null||r.call(this)}if(Pe(t),t.touches.length!==2||(u=g(this,zf))!=null&&u.call(this)){C(this,po,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),C(this,po,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},_w=function(t){var U;if(!g(this,po)||t.touches.length!==2)return;Pe(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:o,screenY:r}=e,{screenX:u,screenY:c}=n,f=g(this,po),{touch0X:h,touch0Y:y,touch1X:A,touch1Y:S}=f,E=A-h,b=S-y,x=u-o,N=c-r,D=Math.hypot(x,N)||1,k=Math.hypot(E,b)||1;if(!g(this,Br)&&Math.abs(k-D)<=MT.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=o,f.touch0Y=r,f.touch1X=u,f.touch1Y=c,!g(this,Br)){C(this,Br,!0);return}const L=[(o+u)/2,(r+c)/2];(U=g(this,Xf))==null||U.call(this,L,k,D)},ww=function(t){var e;t.touches.length>=2||(g(this,go)&&(g(this,go).abort(),C(this,go,null),(e=g(this,Jf))==null||e.call(this)),g(this,po)&&(Pe(t),C(this,po,null),C(this,Br,!1)))};let Em=MT;var Hr,Zi,ge,ic,Da,Kf,qr,rn,zr,mo,Ia,Wf,$r,ai,Qf,Yr,yo,ws,sc,oc,Ui,Xr,Zf,Pm,_t,sA,jf,oA,Xg,Mw,Rw,aA,Jg,rA,Nw,Dw,Iw,lA,Pw,uA,Lw,kw,Uw,cA,cf;const Lt=class Lt{constructor(t){w(this,_t);w(this,Hr,null);w(this,Zi,null);w(this,ge,null);w(this,ic,!1);w(this,Da,null);w(this,Kf,"");w(this,qr,!1);w(this,rn,null);w(this,zr,null);w(this,mo,null);w(this,Ia,null);w(this,Wf,"");w(this,$r,!1);w(this,ai,null);w(this,Qf,!1);w(this,Yr,!1);w(this,yo,!1);w(this,ws,null);w(this,sc,0);w(this,oc,0);w(this,Ui,null);w(this,Xr,null);ot(this,"isSelected",!1);ot(this,"_isCopy",!1);ot(this,"_editToolbar",null);ot(this,"_initialOptions",Object.create(null));ot(this,"_initialData",null);ot(this,"_isVisible",!0);ot(this,"_uiManager",null);ot(this,"_focusEventsAllowed",!0);w(this,Zf,!1);w(this,Pm,Lt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:o,pageX:r,pageY:u}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,o],this.pageTranslation=[r,u];const[c,f]=this.parentDimensions;this.x=t.x/c,this.y=t.y/f,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Lt.prototype._resizeWithKeyboard,e=Gl.TRANSLATE_SMALL,n=Gl.TRANSLATE_BIG;return Gt(this,"_resizerKeyboardManager",new rp([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Lt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new DB({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Lt._l10n??(Lt._l10n=t),Lt._l10nResizer||(Lt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Lt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Lt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){oe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,Zf)}set _isDraggable(t){var e;C(this,Zf,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,Pm)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):M(this,_t,cf).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(g(this,$r)?C(this,$r,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,o){const[r,u]=this.parentDimensions;[n,o]=this.screenToPageTranslation(n,o),this.x=(t+n)/r,this.y=(e+o)/u,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,o]=this.parentDimensions;this.setAt(t*n,e*o,this.width*n,this.height*o),this._onTranslated()}translate(t,e){M(this,_t,sA).call(this,this.parentDimensions,t,e)}translateInPage(t,e){g(this,ai)||C(this,ai,[this.x,this.y,this.width,this.height]),M(this,_t,sA).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){g(this,ai)||C(this,ai,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[o,r]}=this;if(this.x+=t/o,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:A,y:S}=this.div.getBoundingClientRect();this.parent.findNewParent(this,A,S)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:u,y:c}=this;const[f,h]=this.getBaseTranslation();u+=f,c+=h;const{style:y}=n;y.left=`${(100*u).toFixed(2)}%`,y.top=`${(100*c).toFixed(2)}%`,this._onTranslating(u,c),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!g(this,ai)&&(g(this,ai)[0]!==this.x||g(this,ai)[1]!==this.y)}get _hasBeenResized(){return!!g(this,ai)&&(g(this,ai)[2]!==this.width||g(this,ai)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Lt,o=n/t,r=n/e;switch(this.rotation){case 90:return[-o,r];case 180:return[o,r];case 270:return[o,-r];default:return[-o,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,o]}=this;let{x:r,y:u,width:c,height:f}=this;if(c*=n,f*=o,r*=n,u*=o,this._mustFixPosition)switch(t){case 0:r=In(r,0,n-c),u=In(u,0,o-f);break;case 90:r=In(r,0,n-f),u=In(u,c,o);break;case 180:r=In(r,c,n),u=In(u,f,o);break;case 270:r=In(r,f,n),u=In(u,0,o-c);break}this.x=r/=n,this.y=u/=o;const[h,y]=this.getBaseTranslation();r+=h,u+=y,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*u).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return M(n=Lt,jf,oA).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return M(n=Lt,jf,oA).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,o]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/n).toFixed(2)}%`,g(this,qr)||(r.height=`${(100*e/o).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,o=n.endsWith("%"),r=!g(this,qr)&&e.endsWith("%");if(o&&r)return;const[u,c]=this.parentDimensions;o||(t.width=`${(100*parseFloat(n)/u).toFixed(2)}%`),!g(this,qr)&&!r&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=g(this,ge))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||g(this,Yr))return this._editToolbar;this._editToolbar=new K0(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=g(this,ge))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return g(this,ge)||(Sm.initialize(Lt._l10n),C(this,ge,new Sm(this)),g(this,Hr)&&(g(this,ge).data=g(this,Hr),C(this,Hr,null))),g(this,ge)}get altTextData(){var t;return(t=g(this,ge))==null?void 0:t.data}set altTextData(t){g(this,ge)&&(g(this,ge).data=t)}get guessedAltText(){var t;return(t=g(this,ge))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=g(this,ge))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=g(this,ge))==null?void 0:e.serialize(t)}hasAltText(){return!!g(this,ge)&&!g(this,ge).isEmpty()}hasAltTextData(){var t;return((t=g(this,ge))==null?void 0:t.hasData())??!1}render(){var u;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=g(this,ic)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),M(this,_t,uA).call(this);const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[o,r]=this.getInitialTranslation();return this.translate(o,r),hw(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,Xr)||C(this,Xr,new Em({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,_t,Nw).bind(this),onPinching:M(this,_t,Dw).bind(this),onPinchEnd:M(this,_t,Iw).bind(this),signal:this._uiManager._signal}))),(u=this._uiManager._editorUndoBar)==null||u.hide(),t}pointerdown(t){const{isMac:e}=hn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(C(this,$r,!0),this._isDraggable){M(this,_t,Pw).call(this,t);return}M(this,_t,lA).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,ws)&&clearTimeout(g(this,ws)),C(this,ws,setTimeout(()=>{var t;C(this,ws,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const o=this.parentScale,[r,u]=this.pageDimensions,[c,f]=this.pageTranslation,h=t/o,y=e/o,A=this.x*r,S=this.y*u,E=this.width*r,b=this.height*u;switch(n){case 0:return[A+h+c,u-S-y-b+f,A+h+E+c,u-S-y+f];case 90:return[A+y+c,u-S+h+f,A+y+b+c,u-S+h+E+f];case 180:return[A-h-E+c,u-S+y+f,A-h+c,u-S+y+b+f];case 270:return[A-y-b+c,u-S-h-E+f,A-y+c,u-S-h+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,o,r,u]=t,c=r-n,f=u-o;switch(this.rotation){case 0:return[n,e-u,c,f];case 90:return[n,e-o,f,c];case 180:return[r,e-o,c,f];case 270:return[r,e-u,f,c];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),C(this,Yr,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),C(this,Yr,!1),!0):!1}isInEditMode(){return g(this,Yr)}shouldGetKeyboardEvents(){return g(this,yo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:o}=this.getClientDimensions(),{innerHeight:r,innerWidth:u}=window;return e<u&&o>0&&t<r&&n>0}rebuild(){M(this,_t,uA).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){oe("An editor must be serializable")}static async deserialize(t,e,n){const o=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});o.rotation=t.rotation,C(o,Hr,t.accessibilityData),o._isCopy=t.isCopy||!1;const[r,u]=o.pageDimensions,[c,f,h,y]=o.getRectInCurrentCoords(t.rect,u);return o.x=c/r,o.y=f/u,o.width=h/r,o.height=y/u,o}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=g(this,Ia))==null||t.abort(),C(this,Ia,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),g(this,ws)&&(clearTimeout(g(this,ws)),C(this,ws,null)),M(this,_t,cf).call(this),this.removeEditToolbar(),g(this,Ui)){for(const n of g(this,Ui).values())clearTimeout(n);C(this,Ui,null)}this.parent=null,(e=g(this,Xr))==null||e.destroy(),C(this,Xr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,_t,Mw).call(this),g(this,rn).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),C(this,mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=g(this,rn).children;if(!g(this,Zi)){C(this,Zi,Array.from(e));const u=M(this,_t,Lw).bind(this),c=M(this,_t,kw).bind(this),f=this._uiManager._signal;for(const h of g(this,Zi)){const y=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",u,{signal:f}),h.addEventListener("blur",c,{signal:f}),h.addEventListener("focus",M(this,_t,Uw).bind(this,y),{signal:f}),h.setAttribute("data-l10n-id",Lt._l10nResizer[y])}}const n=g(this,Zi)[0];let o=0;for(const u of e){if(u===n)break;o++}const r=(360-this.rotation+this.parentRotation)%360/90*(g(this,Zi).length/4);if(r!==o){if(r<o)for(let c=0;c<o-r;c++)g(this,rn).append(g(this,rn).firstChild);else if(r>o)for(let c=0;c<r-o;c++)g(this,rn).firstChild.before(g(this,rn).lastChild);let u=0;for(const c of e){const h=g(this,Zi)[u++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Lt._l10nResizer[h])}}M(this,_t,cA).call(this,0),C(this,yo,!0),g(this,rn).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){g(this,yo)&&M(this,_t,rA).call(this,g(this,Wf),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,_t,cf).call(this),this.div.focus()}select(){var t,e,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var o,r;(o=this.div)!=null&&o.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(e=this._editToolbar)==null||e.show(),(n=g(this,ge))==null||n.toggleAltTextBadge(!1)}}unselect(){var t,e,n,o,r;this.isSelected&&(this.isSelected=!1,(t=g(this,rn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(o=this._editToolbar)==null||o.hide(),(r=g(this,ge))==null||r.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return g(this,Qf)}set isEditing(t){C(this,Qf,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){C(this,qr,!0);const n=t/e,{style:o}=this.div;o.aspectRatio=n,o.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){g(this,Ui)||C(this,Ui,new Map);const{action:n}=t;let o=g(this,Ui).get(n);o&&clearTimeout(o),o=setTimeout(()=>{this._reportTelemetry(t),g(this,Ui).delete(n),g(this,Ui).size===0&&C(this,Ui,null)},Lt._telemetryTimeout),g(this,Ui).set(n,o);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),C(this,ic,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,ic,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Hr=new WeakMap,Zi=new WeakMap,ge=new WeakMap,ic=new WeakMap,Da=new WeakMap,Kf=new WeakMap,qr=new WeakMap,rn=new WeakMap,zr=new WeakMap,mo=new WeakMap,Ia=new WeakMap,Wf=new WeakMap,$r=new WeakMap,ai=new WeakMap,Qf=new WeakMap,Yr=new WeakMap,yo=new WeakMap,ws=new WeakMap,sc=new WeakMap,oc=new WeakMap,Ui=new WeakMap,Xr=new WeakMap,Zf=new WeakMap,Pm=new WeakMap,_t=new WeakSet,sA=function([t,e],n,o){[n,o]=this.screenToPageTranslation(n,o),this.x+=n/t,this.y+=o/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},jf=new WeakSet,oA=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Xg=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},Mw=function(){if(g(this,rn))return;C(this,rn,document.createElement("div")),g(this,rn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const o=document.createElement("div");g(this,rn).append(o),o.classList.add("resizer",n),o.setAttribute("data-resizer-name",n),o.addEventListener("pointerdown",M(this,_t,Rw).bind(this,n),{signal:e}),o.addEventListener("contextmenu",us,{signal:e}),o.tabIndex=-1}this.div.prepend(g(this,rn))},Rw=function(t,e){var y;e.preventDefault();const{isMac:n}=hn.platform;if(e.button!==0||e.ctrlKey&&n)return;(y=g(this,ge))==null||y.toggle(!1);const o=this._isDraggable;this._isDraggable=!1,C(this,zr,[e.screenX,e.screenY]);const r=new AbortController,u=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,_t,rA).bind(this,t),{passive:!0,capture:!0,signal:u}),window.addEventListener("touchmove",Pe,{passive:!1,signal:u}),window.addEventListener("contextmenu",us,{signal:u}),C(this,mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const h=()=>{var A;r.abort(),this.parent.togglePointerEvents(!0),(A=g(this,ge))==null||A.toggle(!0),this._isDraggable=o,this.parent.div.style.cursor=c,this.div.style.cursor=f,M(this,_t,Jg).call(this)};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})},aA=function(t,e,n,o){this.width=n,this.height=o,this.x=t,this.y=e;const[r,u]=this.parentDimensions;this.setDims(r*n,u*o),this.fixAndSetPosition(),this._onResized()},Jg=function(){if(!g(this,mo))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:o}=g(this,mo);C(this,mo,null);const r=this.x,u=this.y,c=this.width,f=this.height;r===t&&u===e&&c===n&&f===o||this.addCommands({cmd:M(this,_t,aA).bind(this,r,u,c,f),undo:M(this,_t,aA).bind(this,t,e,n,o),mustExec:!0})},rA=function(t,e){const[n,o]=this.parentDimensions,r=this.x,u=this.y,c=this.width,f=this.height,h=Lt.MIN_SIZE/n,y=Lt.MIN_SIZE/o,A=M(this,_t,Xg).call(this,this.rotation),S=(O,J)=>[A[0]*O+A[2]*J,A[1]*O+A[3]*J],E=M(this,_t,Xg).call(this,360-this.rotation),b=(O,J)=>[E[0]*O+E[2]*J,E[1]*O+E[3]*J];let x,N,D=!1,k=!1;switch(t){case"topLeft":D=!0,x=(O,J)=>[0,0],N=(O,J)=>[O,J];break;case"topMiddle":x=(O,J)=>[O/2,0],N=(O,J)=>[O/2,J];break;case"topRight":D=!0,x=(O,J)=>[O,0],N=(O,J)=>[0,J];break;case"middleRight":k=!0,x=(O,J)=>[O,J/2],N=(O,J)=>[0,J/2];break;case"bottomRight":D=!0,x=(O,J)=>[O,J],N=(O,J)=>[0,0];break;case"bottomMiddle":x=(O,J)=>[O/2,J],N=(O,J)=>[O/2,0];break;case"bottomLeft":D=!0,x=(O,J)=>[0,J],N=(O,J)=>[O,0];break;case"middleLeft":k=!0,x=(O,J)=>[0,J/2],N=(O,J)=>[O,J/2];break}const L=x(c,f),U=N(c,f);let P=S(...U);const G=Lt._round(r+P[0]),F=Lt._round(u+P[1]);let $=1,X=1,et,Q;if(e.fromKeyboard)({deltaX:et,deltaY:Q}=e);else{const{screenX:O,screenY:J}=e,[at,bt]=g(this,zr);[et,Q]=this.screenToPageTranslation(O-at,J-bt),g(this,zr)[0]=O,g(this,zr)[1]=J}if([et,Q]=b(et/n,Q/o),D){const O=Math.hypot(c,f);$=X=Math.max(Math.min(Math.hypot(U[0]-L[0]-et,U[1]-L[1]-Q)/O,1/c,1/f),h/c,y/f)}else k?$=In(Math.abs(U[0]-L[0]-et),h,1)/c:X=In(Math.abs(U[1]-L[1]-Q),y,1)/f;const ut=Lt._round(c*$),Ct=Lt._round(f*X);P=S(...N(ut,Ct));const mt=G-P[0],At=F-P[1];g(this,ai)||C(this,ai,[this.x,this.y,this.width,this.height]),this.width=ut,this.height=Ct,this.x=mt,this.y=At,this.setDims(n*ut,o*Ct),this.fixAndSetPosition(),this._onResizing()},Nw=function(){var t;C(this,mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=g(this,ge))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Dw=function(t,e,n){let r=.7*(n/e)+1-.7;if(r===1)return;const u=M(this,_t,Xg).call(this,this.rotation),c=(G,F)=>[u[0]*G+u[2]*F,u[1]*G+u[3]*F],[f,h]=this.parentDimensions,y=this.x,A=this.y,S=this.width,E=this.height,b=Lt.MIN_SIZE/f,x=Lt.MIN_SIZE/h;r=Math.max(Math.min(r,1/S,1/E),b/S,x/E);const N=Lt._round(S*r),D=Lt._round(E*r);if(N===S&&D===E)return;g(this,ai)||C(this,ai,[y,A,S,E]);const k=c(S/2,E/2),L=Lt._round(y+k[0]),U=Lt._round(A+k[1]),P=c(N/2,D/2);this.x=L-P[0],this.y=U-P[1],this.width=N,this.height=D,this.setDims(f*N,h*D),this.fixAndSetPosition(),this._onResizing()},Iw=function(){var t;(t=g(this,ge))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),M(this,_t,Jg).call(this)},lA=function(t){const{isMac:e}=hn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Pw=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const o=new AbortController,r=this._uiManager.combinedSignal(o),u={capture:!0,passive:!1,signal:r},c=h=>{o.abort(),C(this,Da,null),C(this,$r,!1),this._uiManager.endDragSession()||M(this,_t,lA).call(this,h),n&&this._onStopDragging()};e&&(C(this,sc,t.clientX),C(this,oc,t.clientY),C(this,Da,t.pointerId),C(this,Kf,t.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:y,clientY:A,pointerId:S}=h;if(S!==g(this,Da)){Pe(h);return}const[E,b]=this.screenToPageTranslation(y-g(this,sc),A-g(this,oc));C(this,sc,y),C(this,oc,A),this._uiManager.dragSelectedEditors(E,b)},u),window.addEventListener("touchmove",Pe,u),window.addEventListener("pointerdown",h=>{h.pointerType===g(this,Kf)&&(g(this,Xr)||h.isPrimary)&&c(h),Pe(h)},u));const f=h=>{if(!g(this,Da)||g(this,Da)===h.pointerId){c(h);return}Pe(h)};window.addEventListener("pointerup",f,{signal:r}),window.addEventListener("blur",f,{signal:r})},uA=function(){if(g(this,Ia)||!this.div)return;C(this,Ia,new AbortController);const t=this._uiManager.combinedSignal(g(this,Ia));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Lw=function(t){Lt._resizerKeyboardManager.exec(this,t)},kw=function(t){var e;g(this,yo)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==g(this,rn)&&M(this,_t,cf).call(this)},Uw=function(t){C(this,Wf,g(this,yo)?t:"")},cA=function(t){if(g(this,Zi))for(const e of g(this,Zi))e.tabIndex=t},cf=function(){C(this,yo,!1),M(this,_t,cA).call(this,-1),M(this,_t,Jg).call(this)},w(Lt,jf),ot(Lt,"_l10n",null),ot(Lt,"_l10nResizer",null),ot(Lt,"_borderLineWidth",-1),ot(Lt,"_colorManager",new Q0),ot(Lt,"_zIndex",1),ot(Lt,"_telemetryTimeout",1e3);let de=Lt;class DB extends de{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const jx=3285377520,Ii=4294901760,ys=65535;class Fw{constructor(t){this.h1=t?t&4294967295:jx,this.h2=t?t&4294967295:jx}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let x=0,N=t.length;x<N;x++){const D=t.charCodeAt(x);D<=255?e[n++]=D:(e[n++]=D>>>8,e[n++]=D&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const o=n>>2,r=n-o*4,u=new Uint32Array(e.buffer,0,o);let c=0,f=0,h=this.h1,y=this.h2;const A=3432918353,S=461845907,E=A&ys,b=S&ys;for(let x=0;x<o;x++)x&1?(c=u[x],c=c*A&Ii|c*E&ys,c=c<<15|c>>>17,c=c*S&Ii|c*b&ys,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(f=u[x],f=f*A&Ii|f*E&ys,f=f<<15|f>>>17,f=f*S&Ii|f*b&ys,y^=f,y=y<<13|y>>>19,y=y*5+3864292196);switch(c=0,r){case 3:c^=e[o*4+2]<<16;case 2:c^=e[o*4+1]<<8;case 1:c^=e[o*4],c=c*A&Ii|c*E&ys,c=c<<15|c>>>17,c=c*S&Ii|c*b&ys,o&1?h^=c:y^=c}this.h1=h,this.h2=y}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ii|t*36045&ys,e=e*4283543511&Ii|((e<<16|t>>>16)*2950163797&Ii)>>>16,t^=e>>>1,t=t*444984403&Ii|t*60499&ys,e=e*3301882366&Ii|((e<<16|t>>>16)*3120437893&Ii)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const dA=Object.freeze({map:null,hash:"",transfer:void 0});var Jr,Kr,ln,Lm,Ow;class ST{constructor(){w(this,Lm);w(this,Jr,!1);w(this,Kr,null);w(this,ln,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=g(this,ln).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return g(this,ln).get(t)}remove(t){if(g(this,ln).delete(t),g(this,ln).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of g(this,ln).values())if(e instanceof de)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=g(this,ln).get(t);let o=!1;if(n!==void 0)for(const[r,u]of Object.entries(e))n[r]!==u&&(o=!0,n[r]=u);else o=!0,g(this,ln).set(t,e);o&&M(this,Lm,Ow).call(this),e instanceof de&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return g(this,ln).has(t)}get size(){return g(this,ln).size}resetModified(){g(this,Jr)&&(C(this,Jr,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Bw(this)}get serializable(){if(g(this,ln).size===0)return dA;const t=new Map,e=new Fw,n=[],o=Object.create(null);let r=!1;for(const[u,c]of g(this,ln)){const f=c instanceof de?c.serialize(!1,o):c;f&&(t.set(u,f),e.update(`${u}:${JSON.stringify(f)}`),r||(r=!!f.bitmap))}if(r)for(const u of t.values())u.bitmap&&n.push(u.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:dA}get editorStats(){let t=null;const e=new Map;for(const n of g(this,ln).values()){if(!(n instanceof de))continue;const o=n.telemetryFinalData;if(!o)continue;const{type:r}=o;e.has(r)||e.set(r,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const u=t[r]||(t[r]=new Map);for(const[c,f]of Object.entries(o)){if(c==="type")continue;let h=u.get(c);h||(h=new Map,u.set(c,h));const y=h.get(f)??0;h.set(f,y+1)}}for(const[n,o]of e)t[n]=o.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){C(this,Kr,null)}get modifiedIds(){if(g(this,Kr))return g(this,Kr);const t=[];for(const e of g(this,ln).values())!(e instanceof de)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return C(this,Kr,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return g(this,ln).entries()}}Jr=new WeakMap,Kr=new WeakMap,ln=new WeakMap,Lm=new WeakSet,Ow=function(){g(this,Jr)||(C(this,Jr,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var th;class Bw extends ST{constructor(e){super();w(this,th);const{map:n,hash:o,transfer:r}=e.serializable,u=structuredClone(n,r?{transfer:r}:null);C(this,th,{map:u,hash:o,transfer:r})}get print(){oe("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,th)}get modifiedIds(){return Gt(this,"modifiedIds",{ids:new Set,hash:""})}}th=new WeakMap;var ac;class IB{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){w(this,ac,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),g(this,ac).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||g(this,ac).has(t.loadedName))){if(Le(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:o,src:r,style:u}=t,c=new FontFace(o,r,u);this.addNativeFontFace(c);try{await c.load(),g(this,ac).add(o),n==null||n(t)}catch{Dt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}oe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(o){throw Dt(`Failed to load font '${n.family}': '${o}'.`),t.disableFontFace=!0,o}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const o=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,o)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Gt(this,"isSyncFontLoadingSupported",Dn||hn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Le(!o.done,"completeRequest() cannot be called twice."),o.done=!0;n.length>0&&n[0].done;){const r=n.shift();setTimeout(r.callback,0)}}const{loadingRequests:n}=this,o={done:!1,complete:e,callback:t};return n.push(o),o}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(U,P){return U.charCodeAt(P)<<24|U.charCodeAt(P+1)<<16|U.charCodeAt(P+2)<<8|U.charCodeAt(P+3)&255}function o(U,P,G,F){const $=U.substring(0,P),X=U.substring(P+G);return $+F+X}let r,u;const c=this._document.createElement("canvas");c.width=1,c.height=1;const f=c.getContext("2d");let h=0;function y(U,P){if(++h>30){Dt("Load test font never loaded."),P();return}if(f.font="30px "+U,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(y.bind(null,U,P))}const A=`lt${Date.now()}${this.loadTestFontId++}`;let S=this._loadTestFont;S=o(S,976,A.length,A);const b=16,x=1482184792;let N=n(S,b);for(r=0,u=A.length-3;r<u;r+=4)N=N-x+n(A,r)|0;r<A.length&&(N=N-x+n(A+"XXX",r)|0),S=o(S,b,4,mB(N));const D=`url(data:font/opentype;base64,${btoa(S)});`,k=`@font-face {font-family:"${A}";src:${D}}`;this.insertRule(k);const L=this._document.createElement("div");L.style.visibility="hidden",L.style.width=L.style.height="10px",L.style.position="absolute",L.style.top=L.style.left="0px";for(const U of[t.loadedName,A]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=U,L.append(P)}this._document.body.append(L),y(A,()=>{L.remove(),e.complete()})}}ac=new WeakMap;class PB{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${aw(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let o=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(o+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${o}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let o;try{o=t.get(n)}catch(u){Dt(`getPathGenerator - ignoring character: "${u}".`)}const r=new Path2D(o||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=r}}function LB(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Dn)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function kB(i){if(Dn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return sp(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Dg(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const fA=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,UB=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",FB=SB.bind(null,fA,UB);var vo,km;class OB{constructor(){w(this,vo,new Map);w(this,km,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};g(this,km).then(()=>{for(const[o]of g(this,vo))o.call(this,n)})}addEventListener(t,e,n=null){let o=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:r}=n;if(r.aborted){Dt("LoopbackPort - cannot use an `aborted` signal.");return}const u=()=>this.removeEventListener(t,e);o=()=>r.removeEventListener("abort",u),r.addEventListener("abort",u)}g(this,vo).set(e,o)}removeEventListener(t,e){const n=g(this,vo).get(e);n==null||n(),g(this,vo).delete(e)}terminate(){for(const[,t]of g(this,vo))t==null||t();g(this,vo).clear()}}vo=new WeakMap,km=new WeakMap;const Ig={DATA:1,ERROR:2},De={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function t_(){}function Vn(i){if(i instanceof er||i instanceof Y0||i instanceof Wx||i instanceof Tm||i instanceof C0)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||oe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new er(i.message);case"InvalidPDFException":return new Y0(i.message);case"PasswordException":return new Wx(i.message,i.code);case"ResponseException":return new Tm(i.message,i.status,i.missing);case"UnknownErrorException":return new C0(i.message,i.details)}return new C0(i.message,i.toString())}var rc,zi,Gw,Vw,Hw,Kg;class df{constructor(t,e,n){w(this,zi);w(this,rc,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,zi,Gw).bind(this),{signal:g(this,rc).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const o=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[o]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:o,data:e},n)}catch(u){r.reject(u)}return r.promise}sendWithStream(t,e,n,o){const r=this.streamId++,u=this.sourceName,c=this.targetName,f=this.comObj;return new ReadableStream({start:h=>{const y=Promise.withResolvers();return this.streamControllers[r]={controller:h,startCall:y,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:u,targetName:c,action:t,streamId:r,data:e,desiredSize:h.desiredSize},o),y.promise},pull:h=>{const y=Promise.withResolvers();return this.streamControllers[r].pullCall=y,f.postMessage({sourceName:u,targetName:c,stream:De.PULL,streamId:r,desiredSize:h.desiredSize}),y.promise},cancel:h=>{Le(h instanceof Error,"cancel must have a valid reason");const y=Promise.withResolvers();return this.streamControllers[r].cancelCall=y,this.streamControllers[r].isClosed=!0,f.postMessage({sourceName:u,targetName:c,stream:De.CANCEL,streamId:r,reason:Vn(h)}),y.promise}},n)}destroy(){var t;(t=g(this,rc))==null||t.abort(),C(this,rc,null)}}rc=new WeakMap,zi=new WeakSet,Gw=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){M(this,zi,Hw).call(this,t);return}if(t.callback){const n=t.callbackId,o=this.callbackCapabilities[n];if(!o)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===Ig.DATA)o.resolve(t.data);else if(t.callback===Ig.ERROR)o.reject(Vn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,o=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(u){r.postMessage({sourceName:n,targetName:o,callback:Ig.DATA,callbackId:t.callbackId,data:u})},function(u){r.postMessage({sourceName:n,targetName:o,callback:Ig.ERROR,callbackId:t.callbackId,reason:Vn(u)})});return}if(t.streamId){M(this,zi,Vw).call(this,t);return}e(t.data)},Vw=function(t){const e=t.streamId,n=this.sourceName,o=t.sourceName,r=this.comObj,u=this,c=this.actionHandler[t.action],f={enqueue(h,y=1,A){if(this.isCancelled)return;const S=this.desiredSize;this.desiredSize-=y,S>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:o,stream:De.ENQUEUE,streamId:e,chunk:h},A)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:o,stream:De.CLOSE,streamId:e}),delete u.streamSinks[e])},error(h){Le(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:o,stream:De.ERROR,streamId:e,reason:Vn(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[e]=f,Promise.try(c,t.data,f).then(function(){r.postMessage({sourceName:n,targetName:o,stream:De.START_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:De.START_COMPLETE,streamId:e,reason:Vn(h)})})},Hw=function(t){const e=t.streamId,n=this.sourceName,o=t.sourceName,r=this.comObj,u=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case De.START_COMPLETE:t.success?u.startCall.resolve():u.startCall.reject(Vn(t.reason));break;case De.PULL_COMPLETE:t.success?u.pullCall.resolve():u.pullCall.reject(Vn(t.reason));break;case De.PULL:if(!c){r.postMessage({sourceName:n,targetName:o,stream:De.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||t_).then(function(){r.postMessage({sourceName:n,targetName:o,stream:De.PULL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:De.PULL_COMPLETE,streamId:e,reason:Vn(h)})});break;case De.ENQUEUE:if(Le(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(t.chunk);break;case De.CLOSE:if(Le(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),M(this,zi,Kg).call(this,u,e);break;case De.ERROR:Le(u,"error should have stream controller"),u.controller.error(Vn(t.reason)),M(this,zi,Kg).call(this,u,e);break;case De.CANCEL_COMPLETE:t.success?u.cancelCall.resolve():u.cancelCall.reject(Vn(t.reason)),M(this,zi,Kg).call(this,u,e);break;case De.CANCEL:if(!c)break;const f=Vn(t.reason);Promise.try(c.onCancel||t_,f).then(function(){r.postMessage({sourceName:n,targetName:o,stream:De.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:n,targetName:o,stream:De.CANCEL_COMPLETE,streamId:e,reason:Vn(h)})}),c.sinkCapability.reject(f),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Kg=async function(t,e){var n,o,r;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(o=t.pullCall)==null?void 0:o.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var eh;class qw{constructor({enableHWA:t=!1}){w(this,eh,!1);C(this,eh,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!g(this,eh)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){oe("Abstract method `_createCanvas` called.")}}eh=new WeakMap;class BB extends qw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class zw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){oe("Abstract method `_fetch` called.")}}class e_ extends zw{async _fetch(t){const e=await op(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):sp(e)}}class $w{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,o,r){return"none"}destroy(t=!1){}}var Wr,lc,Ao,To,Tn,Qr,Zr,ct,vn,ff,Iu,Wg,Pu,Yw,hA,Lu,hf,pf,pA,gf;class GB extends $w{constructor({docId:e,ownerDocument:n=globalThis.document}){super();w(this,ct);w(this,Wr);w(this,lc);w(this,Ao);w(this,To);w(this,Tn);w(this,Qr);w(this,Zr,0);C(this,To,e),C(this,Tn,n)}addFilter(e){if(!e)return"none";let n=g(this,ct,vn).get(e);if(n)return n;const[o,r,u]=M(this,ct,Wg).call(this,e),c=e.length===1?o:`${o}${r}${u}`;if(n=g(this,ct,vn).get(c),n)return g(this,ct,vn).set(e,n),n;const f=`g_${g(this,To)}_transfer_map_${xn(this,Zr)._++}`,h=M(this,ct,Pu).call(this,f);g(this,ct,vn).set(e,h),g(this,ct,vn).set(c,h);const y=M(this,ct,Lu).call(this,f);return M(this,ct,pf).call(this,o,r,u,y),h}addHCMFilter(e,n){var b;const o=`${e}-${n}`,r="base";let u=g(this,ct,ff).get(r);if((u==null?void 0:u.key)===o||(u?((b=u.filter)==null||b.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},g(this,ct,ff).set(r,u)),!e||!n))return u.url;const c=M(this,ct,gf).call(this,e);e=Et.makeHexColor(...c);const f=M(this,ct,gf).call(this,n);if(n=Et.makeHexColor(...f),g(this,ct,Iu).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return u.url;const h=new Array(256);for(let x=0;x<=255;x++){const N=x/255;h[x]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const y=h.join(","),A=`g_${g(this,To)}_hcm_filter`,S=u.filter=M(this,ct,Lu).call(this,A);M(this,ct,pf).call(this,y,y,y,S),M(this,ct,hA).call(this,S);const E=(x,N)=>{const D=c[x]/255,k=f[x]/255,L=new Array(N+1);for(let U=0;U<=N;U++)L[U]=D+U/N*(k-D);return L.join(",")};return M(this,ct,pf).call(this,E(0,5),E(1,5),E(2,5),S),u.url=M(this,ct,Pu).call(this,A),u.url}addAlphaFilter(e){let n=g(this,ct,vn).get(e);if(n)return n;const[o]=M(this,ct,Wg).call(this,[e]),r=`alpha_${o}`;if(n=g(this,ct,vn).get(r),n)return g(this,ct,vn).set(e,n),n;const u=`g_${g(this,To)}_alpha_map_${xn(this,Zr)._++}`,c=M(this,ct,Pu).call(this,u);g(this,ct,vn).set(e,c),g(this,ct,vn).set(r,c);const f=M(this,ct,Lu).call(this,u);return M(this,ct,pA).call(this,o,f),c}addLuminosityFilter(e){let n=g(this,ct,vn).get(e||"luminosity");if(n)return n;let o,r;if(e?([o]=M(this,ct,Wg).call(this,[e]),r=`luminosity_${o}`):r="luminosity",n=g(this,ct,vn).get(r),n)return g(this,ct,vn).set(e,n),n;const u=`g_${g(this,To)}_luminosity_map_${xn(this,Zr)._++}`,c=M(this,ct,Pu).call(this,u);g(this,ct,vn).set(e,c),g(this,ct,vn).set(r,c);const f=M(this,ct,Lu).call(this,u);return M(this,ct,Yw).call(this,f),e&&M(this,ct,pA).call(this,o,f),c}addHighlightHCMFilter(e,n,o,r,u){var k;const c=`${n}-${o}-${r}-${u}`;let f=g(this,ct,ff).get(e);if((f==null?void 0:f.key)===c||(f?((k=f.filter)==null||k.remove(),f.key=c,f.url="none",f.filter=null):(f={key:c,url:"none",filter:null},g(this,ct,ff).set(e,f)),!n||!o))return f.url;const[h,y]=[n,o].map(M(this,ct,gf).bind(this));let A=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),S=Math.round(.2126*y[0]+.7152*y[1]+.0722*y[2]),[E,b]=[r,u].map(M(this,ct,gf).bind(this));S<A&&([A,S,E,b]=[S,A,b,E]),g(this,ct,Iu).style.color="";const x=(L,U,P)=>{const G=new Array(256),F=(S-A)/P,$=L/255,X=(U-L)/(255*P);let et=0;for(let Q=0;Q<=P;Q++){const ut=Math.round(A+Q*F),Ct=$+Q*X;for(let mt=et;mt<=ut;mt++)G[mt]=Ct;et=ut+1}for(let Q=et;Q<256;Q++)G[Q]=G[et-1];return G.join(",")},N=`g_${g(this,To)}_hcm_${e}_filter`,D=f.filter=M(this,ct,Lu).call(this,N);return M(this,ct,hA).call(this,D),M(this,ct,pf).call(this,x(E[0],b[0],5),x(E[1],b[1],5),x(E[2],b[2],5),D),f.url=M(this,ct,Pu).call(this,N),f.url}destroy(e=!1){var n,o,r,u;e&&((n=g(this,Qr))!=null&&n.size)||((o=g(this,Ao))==null||o.parentNode.parentNode.remove(),C(this,Ao,null),(r=g(this,lc))==null||r.clear(),C(this,lc,null),(u=g(this,Qr))==null||u.clear(),C(this,Qr,null),C(this,Zr,0))}}Wr=new WeakMap,lc=new WeakMap,Ao=new WeakMap,To=new WeakMap,Tn=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,ct=new WeakSet,vn=function(){return g(this,lc)||C(this,lc,new Map)},ff=function(){return g(this,Qr)||C(this,Qr,new Map)},Iu=function(){if(!g(this,Ao)){const e=g(this,Tn).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const o=g(this,Tn).createElementNS(io,"svg");o.setAttribute("width",0),o.setAttribute("height",0),C(this,Ao,g(this,Tn).createElementNS(io,"defs")),e.append(o),o.append(g(this,Ao)),g(this,Tn).body.append(e)}return g(this,Ao)},Wg=function(e){if(e.length===1){const h=e[0],y=new Array(256);for(let S=0;S<256;S++)y[S]=h[S]/255;const A=y.join(",");return[A,A,A]}const[n,o,r]=e,u=new Array(256),c=new Array(256),f=new Array(256);for(let h=0;h<256;h++)u[h]=n[h]/255,c[h]=o[h]/255,f[h]=r[h]/255;return[u.join(","),c.join(","),f.join(",")]},Pu=function(e){if(g(this,Wr)===void 0){C(this,Wr,"");const n=g(this,Tn).URL;n!==g(this,Tn).baseURI&&(jm(n)?Dt('#createUrl: ignore "data:"-URL for performance reasons.'):C(this,Wr,iw(n,"")))}return`url(${g(this,Wr)}#${e})`},Yw=function(e){const n=g(this,Tn).createElementNS(io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},hA=function(e){const n=g(this,Tn).createElementNS(io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},Lu=function(e){const n=g(this,Tn).createElementNS(io,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),g(this,ct,Iu).append(n),n},hf=function(e,n,o){const r=g(this,Tn).createElementNS(io,n);r.setAttribute("type","discrete"),r.setAttribute("tableValues",o),e.append(r)},pf=function(e,n,o,r){const u=g(this,Tn).createElementNS(io,"feComponentTransfer");r.append(u),M(this,ct,hf).call(this,u,"feFuncR",e),M(this,ct,hf).call(this,u,"feFuncG",n),M(this,ct,hf).call(this,u,"feFuncB",o)},pA=function(e,n){const o=g(this,Tn).createElementNS(io,"feComponentTransfer");n.append(o),M(this,ct,hf).call(this,o,"feFuncA",e)},gf=function(e){return g(this,ct,Iu).style.color=e,TT(getComputedStyle(g(this,ct,Iu)).getPropertyValue("color"))};class Xw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){oe("Abstract method `_fetch` called.")}}class n_ extends Xw{async _fetch(t){const e=await op(t,"arraybuffer");return new Uint8Array(e)}}class Jw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){oe("Abstract method `_fetch` called.")}}class i_ extends Jw{async _fetch(t){const e=await op(t,"arraybuffer");return new Uint8Array(e)}}Dn&&Dt("Please use the `legacy` build in Node.js environments.");async function ET(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class VB extends $w{}class HB extends qw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class qB extends zw{async _fetch(t){return ET(t)}}class zB extends Xw{async _fetch(t){return ET(t)}}class $B extends Jw{async _fetch(t){return ET(t)}}const dn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function gA(i,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],o=new Path2D;o.rect(t[0],t[1],e,n),i.clip(o)}class CT{isModifyingCurrentTransform(){return!1}getPattern(){oe("Abstract method `getPattern` called.")}}class YB extends CT{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,o){let r;if(o===dn.STROKE||o===dn.FILL){const u=e.current.getClippedPathBoundingBox(o,Te(t))||[0,0,0,0],c=Math.ceil(u[2]-u[0])||1,f=Math.ceil(u[3]-u[1])||1,h=e.cachedCanvases.getCanvas("pattern",c,f),y=h.context;y.clearRect(0,0,y.canvas.width,y.canvas.height),y.beginPath(),y.rect(0,0,y.canvas.width,y.canvas.height),y.translate(-u[0],-u[1]),n=Et.transform(n,[1,0,0,1,u[0],u[1]]),y.transform(...e.baseTransform),this.matrix&&y.transform(...this.matrix),gA(y,this._bbox),y.fillStyle=this._createGradient(y),y.fill(),r=t.createPattern(h.canvas,"no-repeat");const A=new DOMMatrix(n);r.setTransform(A)}else gA(t,this._bbox),r=this._createGradient(t);return r}}function _0(i,t,e,n,o,r,u,c){const f=t.coords,h=t.colors,y=i.data,A=i.width*4;let S;f[e+1]>f[n+1]&&(S=e,e=n,n=S,S=r,r=u,u=S),f[n+1]>f[o+1]&&(S=n,n=o,o=S,S=u,u=c,c=S),f[e+1]>f[n+1]&&(S=e,e=n,n=S,S=r,r=u,u=S);const E=(f[e]+t.offsetX)*t.scaleX,b=(f[e+1]+t.offsetY)*t.scaleY,x=(f[n]+t.offsetX)*t.scaleX,N=(f[n+1]+t.offsetY)*t.scaleY,D=(f[o]+t.offsetX)*t.scaleX,k=(f[o+1]+t.offsetY)*t.scaleY;if(b>=k)return;const L=h[r],U=h[r+1],P=h[r+2],G=h[u],F=h[u+1],$=h[u+2],X=h[c],et=h[c+1],Q=h[c+2],ut=Math.round(b),Ct=Math.round(k);let mt,At,O,J,at,bt,V,Z;for(let st=ut;st<=Ct;st++){if(st<N){const wt=st<b?0:(b-st)/(b-N);mt=E-(E-x)*wt,At=L-(L-G)*wt,O=U-(U-F)*wt,J=P-(P-$)*wt}else{let wt;st>k?wt=1:N===k?wt=0:wt=(N-st)/(N-k),mt=x-(x-D)*wt,At=G-(G-X)*wt,O=F-(F-et)*wt,J=$-($-Q)*wt}let it;st<b?it=0:st>k?it=1:it=(b-st)/(b-k),at=E-(E-D)*it,bt=L-(L-X)*it,V=U-(U-et)*it,Z=P-(P-Q)*it;const yt=Math.round(Math.min(mt,at)),ht=Math.round(Math.max(mt,at));let gt=A*st+yt*4;for(let wt=yt;wt<=ht;wt++)it=(mt-wt)/(mt-at),it<0?it=0:it>1&&(it=1),y[gt++]=At-(At-bt)*it|0,y[gt++]=O-(O-V)*it|0,y[gt++]=J-(J-Z)*it|0,y[gt++]=255}}function XB(i,t,e){const n=t.coords,o=t.colors;let r,u;switch(t.type){case"lattice":const c=t.verticesPerRow,f=Math.floor(n.length/c)-1,h=c-1;for(r=0;r<f;r++){let y=r*c;for(let A=0;A<h;A++,y++)_0(i,e,n[y],n[y+1],n[y+c],o[y],o[y+1],o[y+c]),_0(i,e,n[y+c+1],n[y+1],n[y+c],o[y+c+1],o[y+1],o[y+c])}break;case"triangles":for(r=0,u=n.length;r<u;r+=3)_0(i,e,n[r],n[r+1],n[r+2],o[r],o[r+1],o[r+2]);break;default:throw new Error("illegal figure")}}class JB extends CT{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const c=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,y=Math.ceil(this._bounds[3])-f,A=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(y*t[1]*1.1)),3e3),E=h/A,b=y/S,x={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-f,scaleX:1/E,scaleY:1/b},N=A+2*2,D=S+2*2,k=n.getCanvas("mesh",N,D),L=k.context,U=L.createImageData(A,S);if(e){const G=U.data;for(let F=0,$=G.length;F<$;F+=4)G[F]=e[0],G[F+1]=e[1],G[F+2]=e[2],G[F+3]=255}for(const G of this._figures)XB(U,G,x);return L.putImageData(U,2,2),{canvas:k.canvas,offsetX:c-2*E,offsetY:f-2*b,scaleX:E,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,o){gA(t,this._bbox);const r=new Float32Array(2);if(o===dn.SHADING)Et.singularValueDecompose2dScale(Te(t),r);else if(this.matrix){Et.singularValueDecompose2dScale(this.matrix,r);const[c,f]=r;Et.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=c,r[1]*=f}else Et.singularValueDecompose2dScale(e.baseTransform,r);const u=this._createMeshCanvas(r,o===dn.SHADING?null:this._background,e.cachedCanvases);return o!==dn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(u.offsetX,u.offsetY),t.scale(u.scaleX,u.scaleY),t.createPattern(u.canvas,"no-repeat")}}class KB extends CT{getPattern(){return"hotpink"}}function WB(i){switch(i[0]){case"RadialAxial":return new YB(i);case"Mesh":return new JB(i);case"Dummy":return new KB}throw new Error(`Unknown IR type: ${i[0]}`)}const s_={COLORED:1,UNCOLORED:2},Um=class Um{constructor(t,e,n,o){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=o}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:o,tilingType:r,color:u,canvasGraphicsFactory:c}=this;let{xstep:f,ystep:h}=this;f=Math.abs(f),h=Math.abs(h),Zm("TilingType: "+r);const y=e[0],A=e[1],S=e[2],E=e[3],b=S-y,x=E-A,N=new Float32Array(2);Et.singularValueDecompose2dScale(this.matrix,N);const[D,k]=N;Et.singularValueDecompose2dScale(this.baseTransform,N);const L=D*N[0],U=k*N[1];let P=b,G=x,F=!1,$=!1;const X=Math.ceil(f*L),et=Math.ceil(h*U),Q=Math.ceil(b*L),ut=Math.ceil(x*U);X>=Q?P=f:F=!0,et>=ut?G=h:$=!0;const Ct=this.getSizeAndScale(P,this.ctx.canvas.width,L),mt=this.getSizeAndScale(G,this.ctx.canvas.height,U),At=t.cachedCanvases.getCanvas("pattern",Ct.size,mt.size),O=At.context,J=c.createCanvasGraphics(O);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,o,u),O.translate(-Ct.scale*y,-mt.scale*A),J.transform(Ct.scale,0,0,mt.scale,0,0),O.save(),this.clipBbox(J,y,A,S,E),J.baseTransform=Te(J.ctx),J.executeOperatorList(n),J.endDrawing(),O.restore(),F||$){const at=At.canvas;F&&(P=f),$&&(G=h);const bt=this.getSizeAndScale(P,this.ctx.canvas.width,L),V=this.getSizeAndScale(G,this.ctx.canvas.height,U),Z=bt.size,st=V.size,it=t.cachedCanvases.getCanvas("pattern-workaround",Z,st),yt=it.context,ht=F?Math.floor(b/f):0,gt=$?Math.floor(x/h):0;for(let wt=0;wt<=ht;wt++)for(let Vt=0;Vt<=gt;Vt++)yt.drawImage(at,Z*wt,st*Vt,Z,st,0,0,Z,st);return{canvas:it.canvas,scaleX:bt.scale,scaleY:V.scale,offsetX:y,offsetY:A}}return{canvas:At.canvas,scaleX:Ct.scale,scaleY:mt.scale,offsetX:y,offsetY:A}}getSizeAndScale(t,e,n){const o=Math.max(Um.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*n);return r>=o?r=o:n=r/t,{scale:n,size:r}}clipBbox(t,e,n,o,r){const u=o-e,c=r-n;t.ctx.rect(e,n,u,c),Et.axialAlignedBoundingBox([e,n,o,r],Te(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const o=t.ctx,r=t.current;switch(e){case s_.COLORED:const{fillStyle:u,strokeStyle:c}=this.ctx;o.fillStyle=r.fillColor=u,o.strokeStyle=r.strokeColor=c;break;case s_.UNCOLORED:o.fillStyle=o.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new gB(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,o){let r=n;o!==dn.SHADING&&(r=Et.transform(r,e.baseTransform),this.matrix&&(r=Et.transform(r,this.matrix)));const u=this.createPatternCanvas(e);let c=new DOMMatrix(r);c=c.translate(u.offsetX,u.offsetY),c=c.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(c),f}};ot(Um,"MAX_PATTERN_SIZE",3e3);let mA=Um;function QB({src:i,srcPos:t=0,dest:e,width:n,height:o,nonBlackColor:r=4294967295,inverseDecode:u=!1}){const c=hn.isLittleEndian?4278190080:255,[f,h]=u?[r,c]:[c,r],y=n>>3,A=n&7,S=i.length;e=new Uint32Array(e.buffer);let E=0;for(let b=0;b<o;b++){for(const N=t+y;t<N;t++){const D=t<S?i[t]:255;e[E++]=D&128?h:f,e[E++]=D&64?h:f,e[E++]=D&32?h:f,e[E++]=D&16?h:f,e[E++]=D&8?h:f,e[E++]=D&4?h:f,e[E++]=D&2?h:f,e[E++]=D&1?h:f}if(A===0)continue;const x=t<S?i[t++]:255;for(let N=0;N<A;N++)e[E++]=x&1<<7-N?h:f}return{srcPos:t,destPos:E}}const o_=16,a_=100,ZB=15,r_=10,Yn=16,w0=new DOMMatrix,Ai=new Float32Array(2),Bu=new Float32Array([1/0,1/0,-1/0,-1/0]);function jB(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},i.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},i.transform=function(e,n,o,r,u,c){t.transform(e,n,o,r,u,c),this.__originalTransform(e,n,o,r,u,c)},i.setTransform=function(e,n,o,r,u,c){t.setTransform(e,n,o,r,u,c),this.__originalSetTransform(e,n,o,r,u,c)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},i.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},i.bezierCurveTo=function(e,n,o,r,u,c){t.bezierCurveTo(e,n,o,r,u,c),this.__originalBezierCurveTo(e,n,o,r,u,c)},i.rect=function(e,n,o,r){t.rect(e,n,o,r),this.__originalRect(e,n,o,r)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class t3{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let o;return this.cache[t]!==void 0?(o=this.cache[t],this.canvasFactory.reset(o,e,n)):(o=this.canvasFactory.create(e,n),this.cache[t]=o),o}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Pg(i,t,e,n,o,r,u,c,f,h){const[y,A,S,E,b,x]=Te(i);if(A===0&&S===0){const k=u*y+b,L=Math.round(k),U=c*E+x,P=Math.round(U),G=(u+f)*y+b,F=Math.abs(Math.round(G)-L)||1,$=(c+h)*E+x,X=Math.abs(Math.round($)-P)||1;return i.setTransform(Math.sign(y),0,0,Math.sign(E),L,P),i.drawImage(t,e,n,o,r,0,0,F,X),i.setTransform(y,A,S,E,b,x),[F,X]}if(y===0&&E===0){const k=c*S+b,L=Math.round(k),U=u*A+x,P=Math.round(U),G=(c+h)*S+b,F=Math.abs(Math.round(G)-L)||1,$=(u+f)*A+x,X=Math.abs(Math.round($)-P)||1;return i.setTransform(0,Math.sign(A),Math.sign(S),0,L,P),i.drawImage(t,e,n,o,r,0,0,X,F),i.setTransform(y,A,S,E,b,x),[X,F]}i.drawImage(t,e,n,o,r,u,c,f,h);const N=Math.hypot(y,A),D=Math.hypot(S,E);return[N*f,D*h]}class l_{constructor(t,e){ot(this,"alphaIsShape",!1);ot(this,"fontSize",0);ot(this,"fontSizeScale",1);ot(this,"textMatrix",null);ot(this,"textMatrixScale",1);ot(this,"fontMatrix",$0);ot(this,"leading",0);ot(this,"x",0);ot(this,"y",0);ot(this,"lineX",0);ot(this,"lineY",0);ot(this,"charSpacing",0);ot(this,"wordSpacing",0);ot(this,"textHScale",1);ot(this,"textRenderingMode",yn.FILL);ot(this,"textRise",0);ot(this,"fillColor","#000000");ot(this,"strokeColor","#000000");ot(this,"patternFill",!1);ot(this,"patternStroke",!1);ot(this,"fillAlpha",1);ot(this,"strokeAlpha",1);ot(this,"lineWidth",1);ot(this,"activeSMask",null);ot(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Bu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=dn.FILL,e=null){const n=this.minMax.slice();if(t===dn.STROKE){e||oe("Stroke bounding box must include transform."),Et.singularValueDecompose2dScale(e,Ai);const o=Ai[0]*this.lineWidth/2,r=Ai[1]*this.lineWidth/2;n[0]-=o,n[1]-=r,n[2]+=o,n[3]+=r}return n}updateClipFromPath(){const t=Et.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Bu,0)}getClippedPathBoundingBox(t=dn.FILL,e=null){return Et.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function u_(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,n=t.width,o=e%Yn,r=(e-o)/Yn,u=o===0?r:r+1,c=i.createImageData(n,Yn);let f=0,h;const y=t.data,A=c.data;let S,E,b,x;if(t.kind===Gg.GRAYSCALE_1BPP){const N=y.byteLength,D=new Uint32Array(A.buffer,0,A.byteLength>>2),k=D.length,L=n+7>>3,U=4294967295,P=hn.isLittleEndian?4278190080:255;for(S=0;S<u;S++){for(b=S<r?Yn:o,h=0,E=0;E<b;E++){const G=N-f;let F=0;const $=G>L?n:G*8-7,X=$&-8;let et=0,Q=0;for(;F<X;F+=8)Q=y[f++],D[h++]=Q&128?U:P,D[h++]=Q&64?U:P,D[h++]=Q&32?U:P,D[h++]=Q&16?U:P,D[h++]=Q&8?U:P,D[h++]=Q&4?U:P,D[h++]=Q&2?U:P,D[h++]=Q&1?U:P;for(;F<$;F++)et===0&&(Q=y[f++],et=128),D[h++]=Q&et?U:P,et>>=1}for(;h<k;)D[h++]=0;i.putImageData(c,0,S*Yn)}}else if(t.kind===Gg.RGBA_32BPP){for(E=0,x=n*Yn*4,S=0;S<r;S++)A.set(y.subarray(f,f+x)),f+=x,i.putImageData(c,0,E),E+=Yn;S<u&&(x=n*o*4,A.set(y.subarray(f,f+x)),i.putImageData(c,0,E))}else if(t.kind===Gg.RGB_24BPP)for(b=Yn,x=n*b,S=0;S<u;S++){for(S>=r&&(b=o,x=n*b),h=0,E=x;E--;)A[h++]=y[f++],A[h++]=y[f++],A[h++]=y[f++],A[h++]=255;i.putImageData(c,0,S*Yn)}else throw new Error(`bad image kind: ${t.kind}`)}function c_(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,o=e%Yn,r=(e-o)/Yn,u=o===0?r:r+1,c=i.createImageData(n,Yn);let f=0;const h=t.data,y=c.data;for(let A=0;A<u;A++){const S=A<r?Yn:o;({srcPos:f}=QB({src:h,srcPos:f,dest:y,width:n,height:S,nonBlackColor:0})),i.putImageData(c,0,A*Yn)}}function ef(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)i[n]!==void 0&&(t[n]=i[n]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function Lg(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function d_(i,t){if(t)return!0;Et.singularValueDecompose2dScale(i,Ai);const e=Math.fround(Os.pixelRatio*nr.PDF_TO_CSS_UNITS);return Ai[0]<=e&&Ai[1]<=e}const e3=["butt","round","square"],n3=["miter","round","bevel"],i3={},f_={};var cs,yA,vA,AA;const RT=class RT{constructor(t,e,n,o,r,{optionalContentConfig:u,markedContentStack:c=null},f,h){w(this,cs);this.ctx=t,this.current=new l_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=o,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=u,this.cachedCanvases=new t3(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:o=null}){const r=this.ctx.canvas.width,u=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=o||"#ffffff",this.ctx.fillRect(0,0,r,u),this.ctx.fillStyle=c,n){const f=this.cachedCanvases.getCanvas("transparent",r,u);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...Te(this.compositeCtx))}this.ctx.save(),Lg(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Te(this.ctx)}executeOperatorList(t,e,n,o){const r=t.argsArray,u=t.fnArray;let c=e||0;const f=r.length;if(f===c)return c;const h=f-c>r_&&typeof n=="function",y=h?Date.now()+ZB:0;let A=0;const S=this.commonObjs,E=this.objs;let b;for(;;){if(o!==void 0&&c===o.nextBreakPoint)return o.breakIt(c,n),c;if(b=u[c],b!==Am.dependency)this[b].apply(this,r[c]);else for(const x of r[c]){const N=x.startsWith("g_")?S:E;if(!N.has(x))return N.get(x,n),c}if(c++,c===f)return c;if(h&&++A>r_){if(Date.now()>y)return n(),c;A=0}}}endDrawing(){M(this,cs,yA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),M(this,cs,vA).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,o=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),u=Math.max(Math.hypot(e[2],e[3]),1),c=n,f=o,h="prescale1",y,A;for(;r>2&&c>1||u>2&&f>1;){let S=c,E=f;r>2&&c>1&&(S=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),r/=c/S),u>2&&f>1&&(E=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,u/=f/E),y=this.cachedCanvases.getCanvas(h,S,E),A=y.context,A.clearRect(0,0,S,E),A.drawImage(t,0,0,c,f,0,0,S,E),t=y.canvas,c=S,f=E,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:f}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:o}=t,r=this.current.fillColor,u=this.current.patternFill,c=Te(e);let f,h,y,A;if((t.bitmap||t.data)&&t.count>1){const X=t.bitmap||t.data.buffer;h=JSON.stringify(u?c:[c.slice(0,4),r]),f=this._cachedBitmapsMap.get(X),f||(f=new Map,this._cachedBitmapsMap.set(X,f));const et=f.get(h);if(et&&!u){const Q=Math.round(Math.min(c[0],c[2])+c[4]),ut=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:et,offsetX:Q,offsetY:ut}}y=et}y||(A=this.cachedCanvases.getCanvas("maskCanvas",n,o),c_(A.context,t));let S=Et.transform(c,[1/n,0,0,-1/o,0,0]);S=Et.transform(S,[1,0,0,1,0,-o]);const E=Bu.slice();Et.axialAlignedBoundingBox([0,0,n,o],S,E);const[b,x,N,D]=E,k=Math.round(N-b)||1,L=Math.round(D-x)||1,U=this.cachedCanvases.getCanvas("fillCanvas",k,L),P=U.context,G=b,F=x;P.translate(-G,-F),P.transform(...S),y||(y=this._scaleImage(A.canvas,ms(P)),y=y.img,f&&u&&f.set(h,y)),P.imageSmoothingEnabled=d_(Te(P),t.interpolate),Pg(P,y,0,0,y.width,y.height,0,0,n,o),P.globalCompositeOperation="source-in";const $=Et.transform(ms(P),[1,0,0,1,-G,-F]);return P.fillStyle=u?r.getPattern(e,this,$,dn.FILL):r,P.fillRect(0,0,n,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(h,U.canvas)),{canvas:U.canvas,offsetX:Math.round(G),offsetY:Math.round(F)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=e3[t]}setLineJoin(t){this.ctx.lineJoin=n3[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;const r=this.ctx=o.context;r.setTransform(this.suspendedCtx.getTransform()),ef(this.suspendedCtx,r),jB(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ef(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,o){const r=o[0],u=o[1],c=o[2]-r,f=o[3]-u;c===0||f===0||(this.genericComposeSMask(e.context,n,c,f,e.subtype,e.backdrop,e.transferMap,r,u,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,o,r,u,c,f,h,y,A){let S=t.canvas,E=f-y,b=h-A;if(u)if(E<0||b<0||E+n>S.width||b+o>S.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,o),D=N.context;D.drawImage(S,-E,-b),D.globalCompositeOperation="destination-atop",D.fillStyle=u,D.fillRect(0,0,n,o),D.globalCompositeOperation="source-over",S=N.canvas,E=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(E,b,n,o),t.clip(N),t.globalCompositeOperation="destination-atop",t.fillStyle=u,t.fillRect(E,b,n,o),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const x=new Path2D;x.rect(f,h,n,o),e.clip(x),e.globalCompositeOperation="destination-in",e.drawImage(S,E,b,n,o,f,h,n,o),e.restore()}save(){this.inSMaskMode&&ef(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ef(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,o,r,u){this.ctx.transform(t,e,n,o,r,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){let[o]=e;if(!n){o||(o=e[0]=new Path2D),this[t](o);return}if(!(o instanceof Path2D)){const r=e[0]=new Path2D;for(let u=0,c=o.length;u<c;)switch(o[u++]){case Ng.moveTo:r.moveTo(o[u++],o[u++]);break;case Ng.lineTo:r.lineTo(o[u++],o[u++]);break;case Ng.curveTo:r.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);break;case Ng.closePath:r.closePath();break;default:Dt(`Unrecognized drawing path operator: ${o[u-1]}`);break}o=r}Et.axialAlignedBoundingBox(n,Te(this.ctx),this.current.minMax),this[t](o)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const n=this.ctx,o=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const r=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=o.getPattern(n,this,ms(n),dn.STROKE),r){const u=new Path2D;u.addPath(t,n.getTransform().invertSelf().multiplySelf(r)),t=u}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(dn.STROKE,Te(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const n=this.ctx,o=this.current.fillColor,r=this.current.patternFill;let u=!1;if(r){const f=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=o.getPattern(n,this,ms(n),dn.FILL),f){const h=new Path2D;h.addPath(t,n.getTransform().invertSelf().multiplySelf(f)),t=h}u=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),u&&n.restore(),e&&this.consumePath(t,c)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=i3}eoClip(){this.pendingClip=f_}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const n=new Path2D,o=e.getTransform().invertSelf();for(const{transform:r,x:u,y:c,fontSize:f,path:h}of t)n.addPath(h,new DOMMatrix(r).preMultiplySelf(o).translate(u,c).scale(f,-f));e.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var y;const n=this.commonObjs.get(t),o=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=n.fontMatrix||$0,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Dt("Invalid font matrix for font "+t),e<0?(e=-e,o.fontDirection=-1):o.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const r=n.loadedName||"sans-serif",u=((y=n.systemFontInfo)==null?void 0:y.css)||`"${r}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const f=n.italic?"italic":"normal";let h=e;e<o_?h=o_:e>a_&&(h=a_),this.current.fontSizeScale=e/h,this.ctx.font=`${f} ${c} ${h}px ${u}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,o,r){const u=this.ctx,c=this.current,f=c.font,h=c.textRenderingMode,y=c.fontSize/c.fontSizeScale,A=h&yn.FILL_STROKE_MASK,S=!!(h&yn.ADD_TO_PATH_FLAG),E=c.patternFill&&!f.missingFile,b=c.patternStroke&&!f.missingFile;let x;if((f.disableFontFace||S||E||b)&&(x=f.getPathGenerator(this.commonObjs,t)),f.disableFontFace||E||b){u.save(),u.translate(e,n),u.scale(y,-y);let N;if((A===yn.FILL||A===yn.FILL_STROKE)&&(o?(N=u.getTransform(),u.setTransform(...o),u.fill(M(this,cs,AA).call(this,x,N,o))):u.fill(x)),A===yn.STROKE||A===yn.FILL_STROKE)if(r){N||(N=u.getTransform()),u.setTransform(...r);const{a:D,b:k,c:L,d:U}=N,P=Et.inverseTransform(r),G=Et.transform([D,k,L,U,0,0],P);Et.singularValueDecompose2dScale(G,Ai),u.lineWidth*=Math.max(Ai[0],Ai[1])/y,u.stroke(M(this,cs,AA).call(this,x,N,r))}else u.lineWidth/=y,u.stroke(x);u.restore()}else(A===yn.FILL||A===yn.FILL_STROKE)&&u.fillText(t,e,n),(A===yn.STROKE||A===yn.FILL_STROKE)&&u.strokeText(t,e,n);S&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Te(u),x:e,y:n,fontSize:y,path:x})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let o=3;o<e.length;o+=4)if(e[o]>0&&e[o]<255){n=!0;break}return Gt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const o=e.fontSize;if(o===0)return;const r=this.ctx,u=e.fontSizeScale,c=e.charSpacing,f=e.wordSpacing,h=e.fontDirection,y=e.textHScale*h,A=t.length,S=n.vertical,E=S?1:-1,b=n.defaultVMetrics,x=o*e.fontMatrix[0],N=e.textRenderingMode===yn.FILL&&!n.disableFontFace&&!e.patternFill;r.save(),e.textMatrix&&r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),h>0?r.scale(y,-1):r.scale(y,1);let D,k;if(e.patternFill){r.save();const F=e.fillColor.getPattern(r,this,ms(r),dn.FILL);D=Te(r),r.restore(),r.fillStyle=F}if(e.patternStroke){r.save();const F=e.strokeColor.getPattern(r,this,ms(r),dn.STROKE);k=Te(r),r.restore(),r.strokeStyle=F}let L=e.lineWidth;const U=e.textMatrixScale;if(U===0||L===0){const F=e.textRenderingMode&yn.FILL_STROKE_MASK;(F===yn.STROKE||F===yn.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=U;if(u!==1&&(r.scale(u,u),L/=u),r.lineWidth=L,n.isInvalidPDFjsFont){const F=[];let $=0;for(const X of t)F.push(X.unicode),$+=X.width;r.fillText(F.join(""),0,0),e.x+=$*x*y,r.restore(),this.compose();return}let P=0,G;for(G=0;G<A;++G){const F=t[G];if(typeof F=="number"){P+=E*F*o/1e3;continue}let $=!1;const X=(F.isSpace?f:0)+c,et=F.fontChar,Q=F.accent;let ut,Ct,mt=F.width;if(S){const O=F.vmetric||b,J=-(F.vmetric?O[1]:mt*.5)*x,at=O[2]*x;mt=O?-O[0]:mt,ut=J/u,Ct=(P+at)/u}else ut=P/u,Ct=0;if(n.remeasure&&mt>0){const O=r.measureText(et).width*1e3/o*u;if(mt<O&&this.isFontSubpixelAAEnabled){const J=mt/O;$=!0,r.save(),r.scale(J,1),ut/=J}else mt!==O&&(ut+=(mt-O)/2e3*o/u)}if(this.contentVisible&&(F.isInFont||n.missingFile)){if(N&&!Q)r.fillText(et,ut,Ct);else if(this.paintChar(et,ut,Ct,D,k),Q){const O=ut+o*Q.offset.x/u,J=Ct-o*Q.offset.y/u;this.paintChar(Q.fontChar,O,J,D,k)}}const At=S?mt*x-X*h:mt*x+X*h;P+=At,$&&r.restore()}S?e.y-=P:e.x+=P*y,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,o=n.font,r=n.fontSize,u=n.fontDirection,c=o.vertical?1:-1,f=n.charSpacing,h=n.wordSpacing,y=n.textHScale*u,A=n.fontMatrix||$0,S=t.length,E=n.textRenderingMode===yn.INVISIBLE;let b,x,N,D;if(!(E||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),n.textMatrix&&e.transform(...n.textMatrix),e.translate(n.x,n.y+n.textRise),e.scale(y,u),b=0;b<S;++b){if(x=t[b],typeof x=="number"){D=c*x*r/1e3,this.ctx.translate(D,0),n.x+=D*y;continue}const k=(x.isSpace?h:0)+f,L=o.charProcOperatorList[x.operatorListId];L?this.contentVisible&&(this.save(),e.scale(r,r),e.transform(...A),this.executeOperatorList(L),this.restore()):Dt(`Type3 character "${x.operatorListId}" is not available.`);const U=[x.width,0];Et.applyTransform(U,A),N=U[0]*r+k,e.translate(N,0),n.x+=N*y}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,o,r,u){const c=new Path2D;c.rect(n,o,r-n,u-o),this.ctx.clip(c),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=this.baseTransform||Te(this.ctx),o={createCanvasGraphics:r=>new RT(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new mA(t,this.ctx,o,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=WB(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,ms(e),dn.SHADING);const o=ms(e);if(o){const{width:r,height:u}=e.canvas,c=Bu.slice();Et.axialAlignedBoundingBox([0,0,r,u],o,c);const[f,h,y,A]=c;this.ctx.fillRect(f,h,y-f,A-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){oe("Should not call beginInlineImage")}beginImageData(){oe("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Te(this.ctx),e)){Et.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[n,o,r,u]=e,c=new Path2D;c.rect(n,o,r-n,u-o),this.ctx.clip(c),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Zm("TODO: Support non-isolated groups."),t.knockout&&Dt("Knockout groups not supported.");const n=Te(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=Bu.slice();Et.axialAlignedBoundingBox(t.bbox,Te(e),o);const r=[0,0,e.canvas.width,e.canvas.height];o=Et.intersect(o,r)||[0,0,0,0];const u=Math.floor(o[0]),c=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),h=Math.max(Math.ceil(o[3])-c,1);this.current.startNewPathAndClipBox([0,0,f,h]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const A=this.cachedCanvases.getCanvas(y,f,h),S=A.context;S.translate(-u,-c),S.transform(...n);let E=new Path2D;const[b,x,N,D]=t.bbox;if(E.rect(b,x,N-b,D-x),t.matrix){const k=new Path2D;k.addPath(E,new DOMMatrix(t.matrix)),E=k}S.clip(E),t.smask?this.smaskStack.push({canvas:A.canvas,context:S,offsetX:u,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(u,c),e.save()),ef(e,S),this.ctx=S,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const o=Te(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);const r=Bu.slice();Et.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],o,r),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,n,o,r){if(M(this,cs,yA).call(this),Lg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const u=e[2]-e[0],c=e[3]-e[1];if(r&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=u,e[3]=c,Et.singularValueDecompose2dScale(Te(this.ctx),Ai);const{viewportScale:f}=this,h=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(c*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(h,y);const{canvas:A,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(Ai[0],0,0,-Ai[1],0,c*Ai[1]),Lg(this.ctx)}else{Lg(this.ctx),this.endPath();const f=new Path2D;f.rect(e[0],e[1],u,c),this.ctx.clip(f)}}this.current=new l_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...o)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),M(this,cs,vA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,o=this._createMaskCanvas(t),r=o.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,o.offsetX,o.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,o=0,r,u){if(!this.contentVisible)return;t=this.getObject(t.data,t);const c=this.ctx;c.save();const f=Te(c);c.transform(e,n,o,r,0,0);const h=this._createMaskCanvas(t);c.setTransform(1,0,0,1,h.offsetX-f[4],h.offsetY-f[5]);for(let y=0,A=u.length;y<A;y+=2){const S=Et.transform(f,[e,n,o,r,u[y],u[y+1]]);c.drawImage(h.canvas,S[4],S[5])}c.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,o=this.current.patternFill;for(const r of t){const{data:u,width:c,height:f,transform:h}=r,y=this.cachedCanvases.getCanvas("maskCanvas",c,f),A=y.context;A.save();const S=this.getObject(u,r);c_(A,S),A.globalCompositeOperation="source-in",A.fillStyle=o?n.getPattern(A,this,ms(e),dn.FILL):n,A.fillRect(0,0,c,f),A.restore(),e.save(),e.transform(...h),e.scale(1,-1),Pg(e,y.canvas,0,0,c,f,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Dt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,o){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){Dt("Dependent image isn't ready yet");return}const u=r.width,c=r.height,f=[];for(let h=0,y=o.length;h<y;h+=2)f.push({transform:[e,0,0,n,o[h],o[h+1]],x:0,y:0,w:u,h:c});this.paintInlineImageXObjectGroup(r,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:o}=t,r=this.cachedCanvases.getCanvas("inlineImage",n,o),u=r.context;return u.filter=this.current.transferMaps,u.drawImage(e,0,0),u.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,o=this.ctx;this.save();const{filter:r}=o;r!=="none"&&r!==""&&(o.filter="none"),o.scale(1/e,-1/n);let u;if(t.bitmap)u=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)u=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;u_(h,t),u=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(u,ms(o));o.imageSmoothingEnabled=d_(Te(o),t.interpolate),Pg(o,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const r=t.width,u=t.height,f=this.cachedCanvases.getCanvas("inlineImage",r,u).context;u_(f,t),o=this.applyTransferMapsToCanvas(f)}for(const r of e)n.save(),n.transform(...r.transform),n.scale(1,-1),Pg(n,o,r.x,r.y,r.w,r.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const o=this.ctx;this.pendingClip&&(n||(this.pendingClip===f_?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Te(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),o=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,o)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:o,d:r}=this.ctx.getTransform();let u,c;if(n===0&&o===0){const f=Math.abs(e),h=Math.abs(r);if(f===h)if(t===0)u=c=1/f;else{const y=f*t;u=c=y<1?1/y:1}else if(t===0)u=1/f,c=1/h;else{const y=f*t,A=h*t;u=y<1?1/y:1,c=A<1?1/A:1}}else{const f=Math.abs(e*r-n*o),h=Math.hypot(e,n),y=Math.hypot(o,r);if(t===0)u=y/f,c=h/f;else{const A=t*f;u=y>A?y/A:1,c=h>A?h/A:1}}this._cachedScaleForStroking[0]=u,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:o}}=this,[r,u]=this.getScaleForStroking();if(r===u){n.lineWidth=(o||1)*r,n.stroke(t);return}const c=n.getLineDash();e&&n.save(),n.scale(r,u),w0.a=1/r,w0.d=1/u;const f=new Path2D;if(f.addPath(t,w0),c.length>0){const h=Math.max(r,u);n.setLineDash(c.map(y=>y/h)),n.lineDashOffset/=h}n.lineWidth=o||1,n.stroke(f),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};cs=new WeakSet,yA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},vA=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},AA=function(t,e,n){const o=new Path2D;return o.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),o};let zu=RT;for(const i in Am)zu.prototype[i]!==void 0&&(zu.prototype[Am[i]]=zu.prototype[i]);var nh,ih;class Us{static get workerPort(){return g(this,nh)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");C(this,nh,t)}static get workerSrc(){return g(this,ih)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");C(this,ih,t)}}nh=new WeakMap,ih=new WeakMap,w(Us,nh,null),w(Us,ih,"");var uc,sh;class s3{constructor({parsedData:t,rawData:e}){w(this,uc);w(this,sh);C(this,uc,t),C(this,sh,e)}getRaw(){return g(this,sh)}get(t){return g(this,uc).get(t)??null}[Symbol.iterator](){return g(this,uc).entries()}}uc=new WeakMap,sh=new WeakMap;const ku=Symbol("INTERNAL");var oh,ah,rh,cc;class o3{constructor(t,{name:e,intent:n,usage:o,rbGroups:r}){w(this,oh,!1);w(this,ah,!1);w(this,rh,!1);w(this,cc,!0);C(this,oh,!!(t&vi.DISPLAY)),C(this,ah,!!(t&vi.PRINT)),this.name=e,this.intent=n,this.usage=o,this.rbGroups=r}get visible(){if(g(this,rh))return g(this,cc);if(!g(this,cc))return!1;const{print:t,view:e}=this.usage;return g(this,oh)?(e==null?void 0:e.viewState)!=="OFF":g(this,ah)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==ku&&oe("Internal method `_setVisible` called."),C(this,rh,n),C(this,cc,e)}}oh=new WeakMap,ah=new WeakMap,rh=new WeakMap,cc=new WeakMap;var Pa,ie,dc,fc,lh,TA;class a3{constructor(t,e=vi.DISPLAY){w(this,lh);w(this,Pa,null);w(this,ie,new Map);w(this,dc,null);w(this,fc,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,C(this,fc,t.order);for(const n of t.groups)g(this,ie).set(n.id,new o3(e,n));if(t.baseState==="OFF")for(const n of g(this,ie).values())n._setVisible(ku,!1);for(const n of t.on)g(this,ie).get(n)._setVisible(ku,!0);for(const n of t.off)g(this,ie).get(n)._setVisible(ku,!1);C(this,dc,this.getHash())}}isVisible(t){if(g(this,ie).size===0)return!0;if(!t)return Zm("Optional content group not defined."),!0;if(t.type==="OCG")return g(this,ie).has(t.id)?g(this,ie).get(t.id).visible:(Dt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return M(this,lh,TA).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!g(this,ie).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(g(this,ie).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!g(this,ie).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!g(this,ie).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!g(this,ie).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!g(this,ie).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!g(this,ie).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(g(this,ie).get(e).visible)return!1}return!0}return Dt(`Unknown optional content policy ${t.policy}.`),!0}return Dt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var r;const o=g(this,ie).get(t);if(!o){Dt(`Optional content group not found: ${t}`);return}if(n&&e&&o.rbGroups.length)for(const u of o.rbGroups)for(const c of u)c!==t&&((r=g(this,ie).get(c))==null||r._setVisible(ku,!1,!0));o._setVisible(ku,!!e,!0),C(this,Pa,null)}setOCGState({state:t,preserveRB:e}){let n;for(const o of t){switch(o){case"ON":case"OFF":case"Toggle":n=o;continue}const r=g(this,ie).get(o);if(r)switch(n){case"ON":this.setVisibility(o,!0,e);break;case"OFF":this.setVisibility(o,!1,e);break;case"Toggle":this.setVisibility(o,!r.visible,e);break}}C(this,Pa,null)}get hasInitialVisibility(){return g(this,dc)===null||this.getHash()===g(this,dc)}getOrder(){return g(this,ie).size?g(this,fc)?g(this,fc).slice():[...g(this,ie).keys()]:null}getGroup(t){return g(this,ie).get(t)||null}getHash(){if(g(this,Pa)!==null)return g(this,Pa);const t=new Fw;for(const[e,n]of g(this,ie))t.update(`${e}:${n.visible}`);return C(this,Pa,t.hexdigest())}[Symbol.iterator](){return g(this,ie).entries()}}Pa=new WeakMap,ie=new WeakMap,dc=new WeakMap,fc=new WeakMap,lh=new WeakSet,TA=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let o=1;o<e;o++){const r=t[o];let u;if(Array.isArray(r))u=M(this,lh,TA).call(this,r);else if(g(this,ie).has(r))u=g(this,ie).get(r).visible;else return Dt(`Optional content group not found: ${r}`),!0;switch(n){case"And":if(!u)return!1;break;case"Or":if(u)return!0;break;case"Not":return!u;default:return!0}}return n==="And"};class r3{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Le(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:o,initialData:r,progressiveDone:u,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=u,this._contentDispositionFilename=c,(r==null?void 0:r.length)>0){const f=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=o,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((f,h)=>{this._onReceiveData({begin:f,chunk:h})}),t.addProgressListener((f,h)=>{this._onProgress({loaded:f,total:h})}),t.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const o=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(n),!0)});Le(o,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,o,r;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(r=(o=this._fullRequestReader)==null?void 0:o.onProgress)==null||r.call(o,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Le(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new l3(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new u3(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class l3{constructor(t,e,n=!1,o=null){this._stream=t,this._done=n||!1,this._filename=vT(o)?o:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class u3{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function c3(i){let t=!0,e=n("filename\\*","i").exec(i);if(e){e=e[1];let y=c(e);return y=unescape(y),y=f(y),y=h(y),r(y)}if(e=u(i),e){const y=h(e);return r(y)}if(e=n("filename","i").exec(i),e){e=e[1];let y=c(e);return y=h(y),r(y)}function n(y,A){return new RegExp("(?:^|;)\\s*"+y+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',A)}function o(y,A){if(y){if(!/^[\x00-\xFF]+$/.test(A))return A;try{const S=new TextDecoder(y,{fatal:!0}),E=sp(A);A=S.decode(E),t=!1}catch{}}return A}function r(y){return t&&/[\x80-\xff]/.test(y)&&(y=o("utf-8",y),t&&(y=o("iso-8859-1",y))),y}function u(y){const A=[];let S;const E=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(S=E.exec(y))!==null;){let[,x,N,D]=S;if(x=parseInt(x,10),x in A){if(x===0)break;continue}A[x]=[N,D]}const b=[];for(let x=0;x<A.length&&x in A;++x){let[N,D]=A[x];D=c(D),N&&(D=unescape(D),x===0&&(D=f(D))),b.push(D)}return b.join("")}function c(y){if(y.startsWith('"')){const A=y.slice(1).split('\\"');for(let S=0;S<A.length;++S){const E=A[S].indexOf('"');E!==-1&&(A[S]=A[S].slice(0,E),A.length=S+1),A[S]=A[S].replaceAll(/\\(.)/g,"$1")}y=A.join('"')}return y}function f(y){const A=y.indexOf("'");if(A===-1)return y;const S=y.slice(0,A),b=y.slice(A+1).replace(/^[^']*'/,"");return o(S,b)}function h(y){return!y.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(y)?y:y.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(A,S,E,b){if(E==="q"||E==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,N){return String.fromCharCode(parseInt(N,16))}),o(S,b);try{b=atob(b)}catch{}return o(S,b)})}return""}function Kw(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const n in t){const o=t[n];o!==void 0&&e.append(n,o)}return e}function ty(i){var t;return((t=URL.parse(i))==null?void 0:t.origin)??null}function Ww({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:n}){const o={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(o.suggestedLength=r,r<=2*e)||n||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function Qw(i){const t=i.get("Content-Disposition");if(t){let e=c3(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(vT(e))return e}return null}function lp(i,t){return new Tm(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function Zw(i){return i===200||i===206}function jw(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function tM(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Dt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class d3{constructor(t){ot(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Kw(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Le(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new h3(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class f3{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),o=e.url;fetch(o,jw(n,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=ty(r.url),!Zw(r.status))throw lp(r.status,o);this._reader=r.body.getReader(),this._headersCapability.resolve();const u=r.headers,{allowRangeRequests:c,suggestedLength:f}=Ww({responseHeaders:u,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=f||this._contentLength,this._filename=Qw(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new er("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tM(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class h3{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const o=t.source;this._withCredentials=o.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${n-1}`);const u=o.url;fetch(u,jw(r,this._withCredentials,this._abortController)).then(c=>{const f=ty(c.url);if(f!==t._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${t._responseOrigin}".`);if(!Zw(c.status))throw lp(c.status,u);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:tM(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const M0=200,R0=206;function p3(i){const t=i.response;return typeof t!="string"?t:sp(t).buffer}class g3{constructor({url:t,httpHeaders:e,withCredentials:n}){ot(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Kw(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,o=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,u]of this.headers)e.setRequestHeader(r,u);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),o.expectedStatus=R0):o.expectedStatus=M0,e.responseType="arraybuffer",Le(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),o.onHeadersReceived=t.onHeadersReceived,o.onDone=t.onDone,o.onError=t.onError,o.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var o;const n=this.pendingRequests[t];n&&((o=n.onProgress)==null||o.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const o=n.xhr;if(o.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),o.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],o.status===0&&this.isHttp){n.onError(o.status);return}const r=o.status||M0;if(!(r===M0&&n.expectedStatus===R0)&&r!==n.expectedStatus){n.onError(o.status);return}const c=p3(o);if(r===R0){const f=o.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(Dt('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(o.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class m3{constructor(t){this._source=t,this._manager=new g3(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Le(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new y3(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new v3(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class y3{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=ty(e.responseURL);const n=e.getAllResponseHeaders(),o=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[f,...h]=c.split(": ");return[f,h.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:u}=Ww({responseHeaders:o,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=Qw(o),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=lp(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class v3{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=ty((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=lp(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const A3=/^[a-z][a-z0-9\-+.]+:/i;function T3(i){if(A3.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class S3{constructor(t){this.source=t,this.url=T3(t.url),Le(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Le(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new E3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new C3(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class E3{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(o=>{this._contentLength=o.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},o=>{o.code==="ENOENT"&&(o=lp(0,this._url.href)),this._storedError=o,this._headersCapability.reject(o)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new er("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class C3{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const o=t.source;this._isStreamingSupported=!o.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const nf=Symbol("INITIAL_DATA");var ri,uh,SA;class eM{constructor(){w(this,uh);w(this,ri,Object.create(null))}get(t,e=null){if(e){const o=M(this,uh,SA).call(this,t);return o.promise.then(()=>e(o.data)),null}const n=g(this,ri)[t];if(!n||n.data===nf)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=g(this,ri)[t];return!!e&&e.data!==nf}delete(t){const e=g(this,ri)[t];return!e||e.data===nf?!1:(delete g(this,ri)[t],!0)}resolve(t,e=null){const n=M(this,uh,SA).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in g(this,ri)){const{data:n}=g(this,ri)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}C(this,ri,Object.create(null))}*[Symbol.iterator](){for(const t in g(this,ri)){const{data:e}=g(this,ri)[t];e!==nf&&(yield[t,e])}}}ri=new WeakMap,uh=new WeakSet,SA=function(t){var e;return(e=g(this,ri))[t]||(e[t]={...Promise.withResolvers(),data:nf})};const b3=1e5,h_=30;var S_,La,zn,ch,dh,jr,So,fh,hh,tl,hc,pc,ka,gc,ph,mc,el,gh,mh,yc,nl,yh,Ua,vc,Ho,nM,iM,EA,Ei,Qg,CA,sM,oM;const Be=class Be{constructor({textContentSource:t,container:e,viewport:n}){w(this,Ho);w(this,La,Promise.withResolvers());w(this,zn,null);w(this,ch,!1);w(this,dh,!!((S_=globalThis.FontInspector)!=null&&S_.enabled));w(this,jr,null);w(this,So,null);w(this,fh,0);w(this,hh,0);w(this,tl,null);w(this,hc,null);w(this,pc,0);w(this,ka,0);w(this,gc,Object.create(null));w(this,ph,[]);w(this,mc,null);w(this,el,[]);w(this,gh,new WeakMap);w(this,mh,null);var f;if(t instanceof ReadableStream)C(this,mc,t);else if(typeof t=="object")C(this,mc,new ReadableStream({start(h){h.enqueue(t),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');C(this,zn,C(this,hc,e)),C(this,ka,n.scale*Os.pixelRatio),C(this,pc,n.rotation),C(this,So,{div:null,properties:null,ctx:null});const{pageWidth:o,pageHeight:r,pageX:u,pageY:c}=n.rawDims;C(this,mh,[1,0,0,-1,-u,c+r]),C(this,hh,o),C(this,fh,r),M(f=Be,Ei,sM).call(f),Bl(e,n),g(this,La).promise.finally(()=>{g(Be,vc).delete(this),C(this,So,null),C(this,gc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=hn.platform;return Gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{g(this,tl).read().then(({value:e,done:n})=>{if(n){g(this,La).resolve();return}g(this,jr)??C(this,jr,e.lang),Object.assign(g(this,gc),e.styles),M(this,Ho,nM).call(this,e.items),t()},g(this,La).reject)};return C(this,tl,g(this,mc).getReader()),g(Be,vc).add(this),t(),g(this,La).promise}update({viewport:t,onBefore:e=null}){var r;const n=t.scale*Os.pixelRatio,o=t.rotation;if(o!==g(this,pc)&&(e==null||e(),C(this,pc,o),Bl(g(this,hc),{rotation:o})),n!==g(this,ka)){e==null||e(),C(this,ka,n);const u={div:null,properties:null,ctx:M(r=Be,Ei,Qg).call(r,g(this,jr))};for(const c of g(this,el))u.properties=g(this,gh).get(c),u.div=c,M(this,Ho,EA).call(this,u)}}cancel(){var e;const t=new er("TextLayer task cancelled.");(e=g(this,tl))==null||e.cancel(t).catch(()=>{}),C(this,tl,null),g(this,La).reject(t)}get textDivs(){return g(this,el)}get textContentItemsStr(){return g(this,ph)}static cleanup(){if(!(g(this,vc).size>0)){g(this,yc).clear();for(const{canvas:t}of g(this,nl).values())t.remove();g(this,nl).clear()}}};La=new WeakMap,zn=new WeakMap,ch=new WeakMap,dh=new WeakMap,jr=new WeakMap,So=new WeakMap,fh=new WeakMap,hh=new WeakMap,tl=new WeakMap,hc=new WeakMap,pc=new WeakMap,ka=new WeakMap,gc=new WeakMap,ph=new WeakMap,mc=new WeakMap,el=new WeakMap,gh=new WeakMap,mh=new WeakMap,yc=new WeakMap,nl=new WeakMap,yh=new WeakMap,Ua=new WeakMap,vc=new WeakMap,Ho=new WeakSet,nM=function(t){var o,r;if(g(this,ch))return;(r=g(this,So)).ctx??(r.ctx=M(o=Be,Ei,Qg).call(o,g(this,jr)));const e=g(this,el),n=g(this,ph);for(const u of t){if(e.length>b3){Dt("Ignoring additional textDivs for performance reasons."),C(this,ch,!0);return}if(u.str===void 0){if(u.type==="beginMarkedContentProps"||u.type==="beginMarkedContent"){const c=g(this,zn);C(this,zn,document.createElement("span")),g(this,zn).classList.add("markedContent"),u.id!==null&&g(this,zn).setAttribute("id",`${u.id}`),c.append(g(this,zn))}else u.type==="endMarkedContent"&&C(this,zn,g(this,zn).parentNode);continue}n.push(u.str),M(this,Ho,iM).call(this,u)}},iM=function(t){var x;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};g(this,el).push(e);const o=Et.transform(g(this,mh),t.transform);let r=Math.atan2(o[1],o[0]);const u=g(this,gc)[t.fontName];u.vertical&&(r+=Math.PI/2);let c=g(this,dh)&&u.fontSubstitution||u.fontFamily;c=Be.fontFamilyMap.get(c)||c;const f=Math.hypot(o[2],o[3]),h=f*M(x=Be,Ei,oM).call(x,c,u,g(this,jr));let y,A;r===0?(y=o[4],A=o[5]-h):(y=o[4]+h*Math.sin(r),A=o[5]-h*Math.cos(r));const S="calc(var(--total-scale-factor) *",E=e.style;g(this,zn)===g(this,hc)?(E.left=`${(100*y/g(this,hh)).toFixed(2)}%`,E.top=`${(100*A/g(this,fh)).toFixed(2)}%`):(E.left=`${S}${y.toFixed(2)}px)`,E.top=`${S}${A.toFixed(2)}px)`),E.fontSize=`${S}${(g(Be,Ua)*f).toFixed(2)}px)`,E.fontFamily=c,n.fontSize=f,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,g(this,dh)&&(e.dataset.fontName=u.fontSubstitutionLoadedName||t.fontName),r!==0&&(n.angle=r*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const N=Math.abs(t.transform[0]),D=Math.abs(t.transform[3]);N!==D&&Math.max(N,D)/Math.min(N,D)>1.5&&(b=!0)}if(b&&(n.canvasWidth=u.vertical?t.height:t.width),g(this,gh).set(e,n),g(this,So).div=e,g(this,So).properties=n,M(this,Ho,EA).call(this,g(this,So)),n.hasText&&g(this,zn).append(e),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),g(this,zn).append(N)}},EA=function(t){var c;const{div:e,properties:n,ctx:o}=t,{style:r}=e;let u="";if(g(Be,Ua)>1&&(u=`scale(${1/g(Be,Ua)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:f}=r,{canvasWidth:h,fontSize:y}=n;M(c=Be,Ei,CA).call(c,o,y*g(this,ka),f);const{width:A}=o.measureText(e.textContent);A>0&&(u=`scaleX(${h*g(this,ka)/A}) ${u}`)}n.angle!==0&&(u=`rotate(${n.angle}deg) ${u}`),u.length>0&&(r.transform=u)},Ei=new WeakSet,Qg=function(t=null){let e=g(this,nl).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,nl).set(t,e),g(this,yh).set(e,{size:0,family:""})}return e},CA=function(t,e,n){const o=g(this,yh).get(t);e===o.size&&n===o.family||(t.font=`${e}px ${n}`,o.size=e,o.family=n)},sM=function(){if(g(this,Ua)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),C(this,Ua,t.getBoundingClientRect().height),t.remove()},oM=function(t,e,n){const o=g(this,yc).get(t);if(o)return o;const r=M(this,Ei,Qg).call(this,n);r.canvas.width=r.canvas.height=h_,M(this,Ei,CA).call(this,r,h_,t);const u=r.measureText(""),c=u.fontBoundingBoxAscent,f=Math.abs(u.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let h=.8;return c?h=c/(c+f):(hn.platform.isFirefox&&Dt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?h=e.ascent:e.descent&&(h=1+e.descent)),g(this,yc).set(t,h),h},w(Be,Ei),w(Be,yc,new Map),w(Be,nl,new Map),w(Be,yh,new WeakMap),w(Be,Ua,null),w(Be,vc,new Set);let _f=Be;class wf{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function o(r){var f;if(!r)return;let u=null;const c=r.name;if(c==="#text")u=r.value;else if(wf.shouldBuildText(c))(f=r==null?void 0:r.attributes)!=null&&f.textContent?u=r.attributes.textContent:r.value&&(u=r.value);else return;if(u!==null&&e.push({str:u}),!!r.children)for(const h of r.children)o(h)}return o(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const x3=100;function aM(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new bA,{docId:e}=t,n=i.url?LB(i.url):null,o=i.data?kB(i.data):null,r=i.httpHeaders||null,u=i.withCredentials===!0,c=i.password??null,f=i.range instanceof rM?i.range:null,h=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let y=i.worker instanceof Mf?i.worker:null;const A=i.verbosity,S=typeof i.docBaseUrl=="string"&&!jm(i.docBaseUrl)?i.docBaseUrl:null,E=Dg(i.cMapUrl),b=i.cMapPacked!==!1,x=i.CMapReaderFactory||(Dn?qB:e_),N=Dg(i.iccUrl),D=Dg(i.standardFontDataUrl),k=i.StandardFontDataFactory||(Dn?zB:n_),L=Dg(i.wasmUrl),U=i.WasmFactory||(Dn?$B:i_),P=i.stopAtErrors!==!0,G=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,F=i.isEvalSupported!==!1,$=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Dn,X=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Dn&&(hn.platform.isFirefox||!globalThis.chrome),et=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,Q=typeof i.disableFontFace=="boolean"?i.disableFontFace:Dn,ut=i.fontExtraProperties===!0,Ct=i.enableXfa===!0,mt=i.ownerDocument||globalThis.document,At=i.disableRange===!0,O=i.disableStream===!0,J=i.disableAutoFetch===!0,at=i.pdfBug===!0,bt=i.CanvasFactory||(Dn?HB:BB),V=i.FilterFactory||(Dn?VB:GB),Z=i.enableHWA===!0,st=i.useWasm!==!1,it=f?f.length:i.length??NaN,yt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Dn&&!Q,ht=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(x===e_&&k===n_&&U===i_&&E&&D&&L&&af(E,document.baseURI)&&af(D,document.baseURI)&&af(L,document.baseURI)),gt=null;fB(A);const wt={canvasFactory:new bt({ownerDocument:mt,enableHWA:Z}),filterFactory:new V({docId:e,ownerDocument:mt}),cMapReaderFactory:ht?null:new x({baseUrl:E,isCompressed:b}),standardFontDataFactory:ht?null:new k({baseUrl:D}),wasmFactory:ht?null:new U({baseUrl:L})};y||(y=Mf.create({verbosity:A,port:Us.workerPort}),t._worker=y);const Vt={docId:e,apiVersion:"5.3.93",data:o,password:c,disableAutoFetch:J,rangeChunkSize:h,length:it,docBaseUrl:S,enableXfa:Ct,evaluatorOptions:{maxImageSize:G,disableFontFace:Q,ignoreErrors:P,isEvalSupported:F,isOffscreenCanvasSupported:$,isImageDecoderSupported:X,canvasMaxAreaInBytes:et,fontExtraProperties:ut,useSystemFonts:yt,useWasm:st,useWorkerFetch:ht,cMapUrl:E,iccUrl:N,standardFontDataUrl:D,wasmUrl:L}},Ue={ownerDocument:mt,pdfBug:at,styleElement:gt,loadingParams:{disableAutoFetch:J,enableXfa:Ct}};return y.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(y.destroyed)throw new Error("Worker was destroyed");const ar=y.messageHandler.sendWithPromise("GetDocRequest",Vt,o?[o.buffer]:null);let $i;if(f)$i=new r3(f,{disableRange:At,disableStream:O});else if(!o){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Gs=af(n)?d3:Dn?S3:m3;$i=new Gs({url:n,length:it,httpHeaders:r,withCredentials:u,rangeChunkSize:h,disableRange:At,disableStream:O})}return ar.then(Gs=>{if(t.destroyed)throw new Error("Loading aborted");if(y.destroyed)throw new Error("Worker was destroyed");const Vs=new df(e,Gs,y.port),$o=new M3(Vs,t,$i,Ue,wt);t._transport=$o,Vs.send("Ready",null)})}).catch(t._capability.reject),t}var Fm;const Om=class Om{constructor(){ot(this,"_capability",Promise.withResolvers());ot(this,"_transport",null);ot(this,"_worker",null);ot(this,"docId",`d${xn(Om,Fm)._++}`);ot(this,"destroyed",!1);ot(this,"onPassword",null);ot(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,n,o;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(r){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,r}this._transport=null,(o=this._worker)==null||o.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Fm=new WeakMap,w(Om,Fm,0);let bA=Om;var il,vh,Ah,Th,Sh;class rM{constructor(t,e,n=!1,o=null){w(this,il,Promise.withResolvers());w(this,vh,[]);w(this,Ah,[]);w(this,Th,[]);w(this,Sh,[]);this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=o}addRangeListener(t){g(this,Sh).push(t)}addProgressListener(t){g(this,Th).push(t)}addProgressiveReadListener(t){g(this,Ah).push(t)}addProgressiveDoneListener(t){g(this,vh).push(t)}onDataRange(t,e){for(const n of g(this,Sh))n(t,e)}onDataProgress(t,e){g(this,il).promise.then(()=>{for(const n of g(this,Th))n(t,e)})}onDataProgressiveRead(t){g(this,il).promise.then(()=>{for(const e of g(this,Ah))e(t)})}onDataProgressiveDone(){g(this,il).promise.then(()=>{for(const t of g(this,vh))t()})}transportReady(){g(this,il).resolve()}requestDataRange(t,e){oe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}il=new WeakMap,vh=new WeakMap,Ah=new WeakMap,Th=new WeakMap,Sh=new WeakMap;class _3{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Eo,sl,mf;class w3{constructor(t,e,n,o=!1){w(this,sl);w(this,Eo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=o?new Zx:null,this._pdfBug=o,this.commonObjs=n.commonObjs,this.objs=new eM,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:o=0,dontFlip:r=!1}={}){return new ap({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:o,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:o=ya.ENABLE,transform:r=null,background:u=null,optionalContentConfigPromise:c=null,annotationCanvasMap:f=null,pageColors:h=null,printAnnotationStorage:y=null,isEditing:A=!1}){var U,P;(U=this._stats)==null||U.time("Overall");const S=this._transport.getRenderingIntent(n,o,y,A),{renderingIntent:E,cacheKey:b}=S;C(this,Eo,!1),c||(c=this._transport.getOptionalContentConfig(E));let x=this._intentStates.get(b);x||(x=Object.create(null),this._intentStates.set(b,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const N=!!(E&vi.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(P=this._stats)==null||P.time("Page Request"),this._pumpOperatorList(S));const D=G=>{var F;x.renderTasks.delete(k),N&&C(this,Eo,!0),M(this,sl,mf).call(this),G?(k.capability.reject(G),this._abortOperatorList({intentState:x,reason:G instanceof Error?G:new Error(G)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new xA({callback:D,params:{canvasContext:t,viewport:e,transform:r,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:h});(x.renderTasks||(x.renderTasks=new Set)).add(k);const L=k.task;return Promise.all([x.displayReadyCapability.promise,c]).then(([G,F])=>{var $;if(this.destroyed){D();return}if(($=this._stats)==null||$.time("Rendering"),!(F.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:G,optionalContentConfig:F}),k.operatorListChanged()}).catch(D),L}getOperatorList({intent:t="display",annotationMode:e=ya.ENABLE,printAnnotationStorage:n=null,isEditing:o=!1}={}){var h;function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(f))}const u=this._transport.getRenderingIntent(t,e,n,o,!0);let c=this._intentStates.get(u.cacheKey);c||(c=Object.create(null),this._intentStates.set(u.cacheKey,c));let f;return c.opListReadCapability||(f=Object.create(null),f.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(f),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(u)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(o){return o.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>wf.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,o){function r(){u.read().then(function({value:f,done:h}){if(h){n(c);return}c.lang??(c.lang=f.lang),Object.assign(c.styles,f.styles),c.items.push(...f.items),r()},o)}const u=e.getReader(),c={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),C(this,Eo,!1),Promise.all(t)}cleanup(t=!1){C(this,Eo,!0);const e=M(this,sl,mf).call(this);return t&&e&&this._stats&&(this._stats=new Zx),e}_startRenderPage(t,e){var o,r;const n=this._intentStates.get(e);n&&((o=this._stats)==null||o.timeEnd("Page Request"),(r=n.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let n=0,o=t.length;n<o;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&M(this,sl,mf).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:o}){const{map:r,transfer:u}=n,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:o},u).getReader(),h=this._intentStates.get(e);h.streamReader=f;const y=()=>{f.read().then(({value:A,done:S})=>{if(S){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(A,h),y())},A=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const S of h.renderTasks)S.operatorListChanged();M(this,sl,mf).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(A);else if(h.opListReadCapability)h.opListReadCapability.reject(A);else throw A}})};y()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof yT){let o=x3;e.extraDelay>0&&e.extraDelay<1e3&&(o+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},o);return}}if(t.streamReader.cancel(new er(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[o,r]of this._intentStates)if(r===t){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}Eo=new WeakMap,sl=new WeakSet,mf=function(){if(!g(this,Eo)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,Eo,!1),!0};var Fa,ji,Co,ol,Bm,al,rl,Ln,Zg,lM,uM,yf,Ac,jg;const pe=class pe{constructor({name:t=null,port:e=null,verbosity:n=hB()}={}){w(this,Ln);w(this,Fa,Promise.withResolvers());w(this,ji,null);w(this,Co,null);w(this,ol,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(g(pe,rl).has(e))throw new Error("Cannot use more than one PDFWorker per port.");g(pe,rl).set(e,this),M(this,Ln,lM).call(this,e)}else M(this,Ln,uM).call(this)}get promise(){return g(this,Fa).promise}get port(){return g(this,Co)}get messageHandler(){return g(this,ji)}destroy(){var t,e;this.destroyed=!0,(t=g(this,ol))==null||t.terminate(),C(this,ol,null),g(pe,rl).delete(g(this,Co)),C(this,Co,null),(e=g(this,ji))==null||e.destroy(),C(this,ji,null)}static create(t){const e=g(this,rl).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new pe(t)}static get workerSrc(){if(Us.workerSrc)return Us.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Gt(this,"_setupFakeWorkerGlobal",(async()=>g(this,Ac,jg)?g(this,Ac,jg):(await import(this.workerSrc)).WorkerMessageHandler)())}};Fa=new WeakMap,ji=new WeakMap,Co=new WeakMap,ol=new WeakMap,Bm=new WeakMap,al=new WeakMap,rl=new WeakMap,Ln=new WeakSet,Zg=function(){g(this,Fa).resolve(),g(this,ji).send("configure",{verbosity:this.verbosity})},lM=function(t){C(this,Co,t),C(this,ji,new df("main","worker",t)),g(this,ji).on("ready",()=>{}),M(this,Ln,Zg).call(this)},uM=function(){if(g(pe,al)||g(pe,Ac,jg)){M(this,Ln,yf).call(this);return}let{workerSrc:t}=pe;try{pe._isSameOrigin(window.location,t)||(t=pe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new df("main","worker",e),o=()=>{r.abort(),n.destroy(),e.terminate(),this.destroyed?g(this,Fa).reject(new Error("Worker was destroyed")):M(this,Ln,yf).call(this)},r=new AbortController;e.addEventListener("error",()=>{g(this,ol)||o()},{signal:r.signal}),n.on("test",c=>{if(r.abort(),this.destroyed||!c){o();return}C(this,ji,n),C(this,Co,e),C(this,ol,e),M(this,Ln,Zg).call(this)}),n.on("ready",c=>{if(r.abort(),this.destroyed){o();return}try{u()}catch{M(this,Ln,yf).call(this)}});const u=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};u();return}catch{Zm("The worker has been disabled.")}M(this,Ln,yf).call(this)},yf=function(){g(pe,al)||(Dt("Setting up fake worker."),C(pe,al,!0)),pe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){g(this,Fa).reject(new Error("Worker was destroyed"));return}const e=new OB;C(this,Co,e);const n=`fake${xn(pe,Bm)._++}`,o=new df(n+"_worker",n,e);t.setup(o,e),C(this,ji,new df(n,n+"_worker",e)),M(this,Ln,Zg).call(this)}).catch(t=>{g(this,Fa).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ac=new WeakSet,jg=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},w(pe,Ac),w(pe,Bm,0),w(pe,al,!1),w(pe,rl,new WeakMap),Dn&&(C(pe,al,!0),Us.workerSrc||(Us.workerSrc="./pdf.worker.mjs")),pe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const o=new URL(e,n);return n.origin===o.origin},pe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},pe.fromPort=t=>{if(xB("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return pe.create(t)};let Mf=pe;var bo,Ms,Tc,Sc,xo,ll,vf;class M3{constructor(t,e,n,o,r){w(this,ll);w(this,bo,new Map);w(this,Ms,new Map);w(this,Tc,new Map);w(this,Sc,new Map);w(this,xo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new eM,this.fontLoader=new IB({ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this.loadingParams=o.loadingParams,this._params=o,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Gt(this,"annotationStorage",new ST)}getRenderingIntent(t,e=ya.ENABLE,n=null,o=!1,r=!1){let u=vi.DISPLAY,c=dA;switch(t){case"any":u=vi.ANY;break;case"display":break;case"print":u=vi.PRINT;break;default:Dt(`getRenderingIntent - invalid intent: ${t}`)}const f=u&vi.PRINT&&n instanceof Bw?n:this.annotationStorage;switch(e){case ya.DISABLE:u+=vi.ANNOTATIONS_DISABLE;break;case ya.ENABLE:break;case ya.ENABLE_FORMS:u+=vi.ANNOTATIONS_FORMS;break;case ya.ENABLE_STORAGE:u+=vi.ANNOTATIONS_STORAGE,c=f.serializable;break;default:Dt(`getRenderingIntent - invalid annotationMode: ${e}`)}o&&(u+=vi.IS_EDITING),r&&(u+=vi.OPLIST);const{ids:h,hash:y}=f.modifiedIds,A=[u,c.hash,y];return{renderingIntent:u,cacheKey:A.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=g(this,xo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const o of g(this,Ms).values())t.push(o._destroy());g(this,Ms).clear(),g(this,Tc).clear(),g(this,Sc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var o,r;this.commonObjs.clear(),this.fontLoader.clear(),g(this,bo).clear(),this.filterFactory.destroy(),_f.cleanup(),(o=this._networkStream)==null||o.cancelAllRequests(new er("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,o)=>{Le(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},o.onPull=()=>{this._fullReader.read().then(function({value:r,done:u}){if(u){o.close();return}Le(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{o.error(r)})},o.onCancel=r=>{this._fullReader.cancel(r),o.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:o,isRangeSupported:r,contentLength:u}=this._fullReader;return(!o||!r)&&(this._lastProgress&&((c=e.onProgress)==null||c.call(e,this._lastProgress)),this._fullReader.onProgress=f=>{var h;(h=e.onProgress)==null||h.call(e,{loaded:f.loaded,total:f.total})}),{isStreamingSupported:o,isRangeSupported:r,contentLength:u}}),t.on("GetRangeReader",(n,o)=>{Le(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(n.begin,n.end);if(!r){o.close();return}o.onPull=()=>{r.read().then(function({value:u,done:c}){if(c){o.close();return}Le(u instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(u),1,[u])}).catch(u=>{o.error(u)})},o.onCancel=u=>{r.cancel(u),o.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new _3(n,this))}),t.on("DocException",n=>{e._capability.reject(Vn(n))}),t.on("PasswordRequest",n=>{C(this,xo,Promise.withResolvers());try{if(!e.onPassword)throw Vn(n);const o=r=>{r instanceof Error?g(this,xo).reject(r):g(this,xo).resolve({password:r})};e.onPassword(o,n.code)}catch(o){g(this,xo).reject(o)}return g(this,xo).promise}),t.on("DataLoaded",n=>{var o;(o=e.onProgress)==null||o.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;g(this,Ms).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,o,r])=>{var u;if(this.destroyed||this.commonObjs.has(n))return null;switch(o){case"Font":if("error"in r){const y=r.error;Dt(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=this._params.pdfBug&&((u=globalThis.FontInspector)!=null&&u.enabled)?(y,A)=>globalThis.FontInspector.fontAdded(y,A):null,f=new PB(r,c);this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&(f.data=null),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:h}=r;Le(h,"The imageRef must be defined.");for(const y of g(this,Ms).values())for(const[,A]of y.objs)if((A==null?void 0:A.ref)===h)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,r);break;default:throw new Error(`Got unknown common object type ${o}`)}return null}),t.on("obj",([n,o,r,u])=>{var f;if(this.destroyed)return;const c=g(this,Ms).get(o);if(!c.objs.has(n)){if(c._intentStates.size===0){(f=u==null?void 0:u.bitmap)==null||f.close();return}switch(r){case"Image":case"Pattern":c.objs.resolve(n,u);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",n=>{var o;this.destroyed||(o=e.onProgress)==null||o.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const o=this[n.type];if(!o)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return o.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Dt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=g(this,Tc).get(e);if(n)return n;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&g(this,Sc).set(r.refStr,t);const u=new w3(e,r,this,this._params.pdfBug);return g(this,Ms).set(e,u),u});return g(this,Tc).set(e,o),o}getPageIndex(t){return fA(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return M(this,ll,vf).call(this,"GetFieldObjects")}hasJSActions(){return M(this,ll,vf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return M(this,ll,vf).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return M(this,ll,vf).call(this,"GetOptionalContentConfig").then(e=>new a3(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=g(this,bo).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(o=>{var r,u;return{info:o[0],metadata:o[1]?new s3(o[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((u=this._fullReader)==null?void 0:u.contentLength)??null}});return g(this,bo).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of g(this,Ms).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),g(this,bo).clear(),this.filterFactory.destroy(!0),_f.cleanup()}}cachedPageNumber(t){if(!fA(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return g(this,Sc).get(e)??null}}bo=new WeakMap,Ms=new WeakMap,Tc=new WeakMap,Sc=new WeakMap,xo=new WeakMap,ll=new WeakSet,vf=function(t,e=null){const n=g(this,bo).get(t);if(n)return n;const o=this.messageHandler.sendWithPromise(t,e);return g(this,bo).set(t,o),o};var Oa;class R3{constructor(t){w(this,Oa,null);ot(this,"onContinue",null);ot(this,"onError",null);C(this,Oa,t)}get promise(){return g(this,Oa).capability.promise}cancel(t=0){g(this,Oa).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=g(this,Oa).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=g(this,Oa);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Oa=new WeakMap;var Ba,ul;const Rr=class Rr{constructor({callback:t,params:e,objs:n,commonObjs:o,annotationCanvasMap:r,operatorList:u,pageIndex:c,canvasFactory:f,filterFactory:h,useRequestAnimationFrame:y=!1,pdfBug:A=!1,pageColors:S=null}){w(this,Ba,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=o,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=u,this._pageIndex=c,this.canvasFactory=f,this.filterFactory=h,this._pdfBug=A,this.pageColors=S,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=y===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new R3(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var c,f;if(this.cancelled)return;if(this._canvas){if(g(Rr,ul).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Rr,ul).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:o,transform:r,background:u}=this.params;this.gfx=new zu(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:o,transparency:t,background:u}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(t=null,e=0){var n,o,r;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),g(this,Ba)&&(window.cancelAnimationFrame(g(this,Ba)),C(this,Ba,null)),g(Rr,ul).delete(this._canvas),t||(t=new yT(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(r=(o=this.task).onError)==null||r.call(o,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?C(this,Ba,window.requestAnimationFrame(()=>{C(this,Ba,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Rr,ul).delete(this._canvas),this.callback())))}};Ba=new WeakMap,ul=new WeakMap,w(Rr,ul,new WeakSet);let xA=Rr;const N3="5.3.93",D3="cbeef3233";function p_(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function sf(i){return Math.max(0,Math.min(255,255*i))}class g_{static CMYK_G([t,e,n,o]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+o)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=sf(t),[t,t,t]}static G_HTML([t]){const e=p_(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(sf)}static RGB_HTML(t){return`#${t.map(p_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,o]){return["RGB",1-Math.min(1,t+o),1-Math.min(1,n+o),1-Math.min(1,e+o)]}static CMYK_rgb([t,e,n,o]){return[sf(1-Math.min(1,t+o)),sf(1-Math.min(1,n+o)),sf(1-Math.min(1,e+o))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const o=1-t,r=1-e,u=1-n,c=Math.min(o,r,u);return["CMYK",o,r,u,c]}}class I3{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const o=this._createSVG("svg:svg");return o.setAttribute("version","1.1"),n||(o.setAttribute("width",`${t}px`),o.setAttribute("height",`${e}px`)),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox",`0 0 ${t} ${e}`),o}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){oe("Abstract method `_createSVG` called.")}}class Cm extends I3{_createSVG(t){return document.createElementNS(io,t)}}class cM{static setupStorage(t,e,n,o,r){const u=o.getValue(e,{value:null});switch(n.name){case"textarea":if(u.value!==null&&(t.textContent=u.value),r==="print")break;t.addEventListener("input",c=>{o.setValue(e,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(u.value===n.attributes.xfaOn?t.setAttribute("checked",!0):u.value===n.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",c=>{o.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(u.value!==null&&t.setAttribute("value",u.value),r==="print")break;t.addEventListener("input",c=>{o.setValue(e,{value:c.target.value})})}break;case"select":if(u.value!==null){t.setAttribute("value",u.value);for(const c of n.children)c.attributes.value===u.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const f=c.target.options,h=f.selectedIndex===-1?"":f[f.selectedIndex].value;o.setValue(e,{value:h})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:o,linkService:r}){const{attributes:u}=e,c=t instanceof HTMLAnchorElement;u.type==="radio"&&(u.name=`${u.name}-${o}`);for(const[f,h]of Object.entries(u))if(h!=null)switch(f){case"class":h.length&&t.setAttribute(f,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!c||f!=="href"&&f!=="newWindow")&&t.setAttribute(f,h)}c&&r.addLinkAttributes(t,u.href,u.newWindow),n&&u.dataId&&this.setupStorage(t,u.dataId,e,n)}static render(t){var A,S;const e=t.annotationStorage,n=t.linkService,o=t.xfaHtml,r=t.intent||"display",u=document.createElement(o.name);o.attributes&&this.setAttributes({html:u,element:o,intent:r,linkService:n});const c=r!=="richText",f=t.div;if(f.append(u),t.viewport){const E=`matrix(${t.viewport.transform.join(",")})`;f.style.transform=E}c&&f.setAttribute("class","xfaLayer xfaFont");const h=[];if(o.children.length===0){if(o.value){const E=document.createTextNode(o.value);u.append(E),c&&wf.shouldBuildText(o.name)&&h.push(E)}return{textDivs:h}}const y=[[o,-1,u]];for(;y.length>0;){const[E,b,x]=y.at(-1);if(b+1===E.children.length){y.pop();continue}const N=E.children[++y.at(-1)[1]];if(N===null)continue;const{name:D}=N;if(D==="#text"){const L=document.createTextNode(N.value);h.push(L),x.append(L);continue}const k=(A=N==null?void 0:N.attributes)!=null&&A.xmlns?document.createElementNS(N.attributes.xmlns,D):document.createElement(D);if(x.append(k),N.attributes&&this.setAttributes({html:k,element:N,storage:e,intent:r,linkService:n}),((S=N.children)==null?void 0:S.length)>0)y.push([N,-1,k]);else if(N.value){const L=document.createTextNode(N.value);c&&wf.shouldBuildText(D)&&h.push(L),k.append(L)}}for(const E of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))E.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const P3=9,Vl=new WeakSet;class m_{static create(t){switch(t.data.annotationType){case Ie.LINK:return new dM(t);case Ie.TEXT:return new L3(t);case Ie.WIDGET:switch(t.data.fieldType){case"Tx":return new k3(t);case"Btn":return t.data.radioButton?new pM(t):t.data.checkBox?new F3(t):new O3(t);case"Ch":return new B3(t);case"Sig":return new U3(t)}return new zl(t);case Ie.POPUP:return new wA(t);case Ie.FREETEXT:return new AM(t);case Ie.LINE:return new V3(t);case Ie.SQUARE:return new H3(t);case Ie.CIRCLE:return new q3(t);case Ie.POLYLINE:return new TM(t);case Ie.CARET:return new $3(t);case Ie.INK:return new bT(t);case Ie.POLYGON:return new z3(t);case Ie.HIGHLIGHT:return new SM(t);case Ie.UNDERLINE:return new Y3(t);case Ie.SQUIGGLY:return new X3(t);case Ie.STRIKEOUT:return new J3(t);case Ie.STAMP:return new EM(t);case Ie.FILEATTACHMENT:return new K3(t);default:return new Me(t)}}}var cl,Ec,Cc,Eh,_A;const NT=class NT{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:o=!1}={}){w(this,Eh);w(this,cl,null);w(this,Ec,!1);w(this,Cc,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),o&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return NT._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;g(this,cl)||C(this,cl,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&M(this,Eh,_A).call(this,e),(n=g(this,Cc))==null||n.popup.updateEdited(t)}resetEdited(){var t;g(this,cl)&&(M(this,Eh,_A).call(this,g(this,cl).rect),(t=g(this,Cc))==null||t.popup.resetEdited(),C(this,cl,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:o}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof zl||(r.tabIndex=0);const{style:u}=r;if(u.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof wA){const{rotation:x}=e;return!e.hasOwnCanvas&&x!==0&&this.setRotation(x,r),r}const{width:c,height:f}=this;if(!t&&e.borderStyle.width>0){u.borderWidth=`${e.borderStyle.width}px`;const x=e.borderStyle.horizontalCornerRadius,N=e.borderStyle.verticalCornerRadius;if(x>0||N>0){const k=`calc(${x}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;u.borderRadius=k}else if(this instanceof pM){const k=`calc(${c}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;u.borderRadius=k}switch(e.borderStyle.style){case Du.SOLID:u.borderStyle="solid";break;case Du.DASHED:u.borderStyle="dashed";break;case Du.BEVELED:Dt("Unimplemented border style: beveled");break;case Du.INSET:Dt("Unimplemented border style: inset");break;case Du.UNDERLINE:u.borderBottomStyle="solid";break}const D=e.borderColor||null;D?(C(this,Ec,!0),u.borderColor=Et.makeHexColor(D[0]|0,D[1]|0,D[2]|0)):u.borderWidth=0}const h=Et.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:y,pageHeight:A,pageX:S,pageY:E}=o.rawDims;u.left=`${100*(h[0]-S)/y}%`,u.top=`${100*(h[1]-E)/A}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(u.width=`${100*c/y}%`,u.height=`${100*f/A}%`):this.setRotation(b,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:o}=this.parent.viewport.rawDims;let{width:r,height:u}=this;t%180!==0&&([r,u]=[u,r]),e.style.width=`${100*r/n}%`,e.style.height=`${100*u/o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,o)=>{const r=o.detail[e],u=r[0],c=r.slice(1);o.target.style[n]=g_[`${u}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:g_[`${u}_rgb`](c)})};return Gt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,o=n%2===1;this.container.style.visibility=o?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:o,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const o of Object.keys(e.detail)){const r=t[o]||n[o];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[o,r]of Object.entries(e)){const u=n[o];if(u){const c={detail:{[o]:r},target:t};u(c),delete e[o]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,o,r]=this.data.rect.map(x=>Math.fround(x));if(t.length===8){const[x,N,D,k]=t.subarray(2,6);if(o===x&&r===N&&e===D&&n===k)return}const{style:u}=this.container;let c;if(g(this,Ec)){const{borderColor:x,borderWidth:N}=u;u.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const f=o-e,h=r-n,{svgFactory:y}=this,A=y.createElement("svg");A.classList.add("quadrilateralsContainer"),A.setAttribute("width",0),A.setAttribute("height",0),A.role="none";const S=y.createElement("defs");A.append(S);const E=y.createElement("clipPath"),b=`clippath_${this.data.id}`;E.setAttribute("id",b),E.setAttribute("clipPathUnits","objectBoundingBox"),S.append(E);for(let x=2,N=t.length;x<N;x+=8){const D=t[x],k=t[x+1],L=t[x+2],U=t[x+3],P=y.createElement("rect"),G=(L-e)/f,F=(r-k)/h,$=(D-L)/f,X=(k-U)/h;P.setAttribute("x",G),P.setAttribute("y",F),P.setAttribute("width",$),P.setAttribute("height",X),E.append(P),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${G}" y="${F}" width="${$}" height="${X}"/>`)}g(this,Ec)&&(c.push("</g></svg>')"),u.backgroundImage=c.join("")),this.container.append(A),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:t}=this,e=C(this,Cc,new wA({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){oe("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const o=this._fieldObjects[t];if(o)for(const{page:r,id:u,exportValues:c}of o){if(r===-1||u===e)continue;const f=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${u}"]`);if(h&&!Vl.has(h)){Dt(`_getElementsByName - element not allowed: ${u}`);continue}n.push({id:u,exportValue:f,domElement:h})}return n}for(const o of document.getElementsByName(t)){const{exportValue:r}=o,u=o.getAttribute("data-element-id");u!==e&&Vl.has(o)&&n.push({id:u,exportValue:r,domElement:o})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};cl=new WeakMap,Ec=new WeakMap,Cc=new WeakMap,Eh=new WeakSet,_A=function(t){const{container:{style:e},data:{rect:n,rotation:o},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:u,pageX:c,pageY:f}}}}=this;n==null||n.splice(0,4,...t),e.left=`${100*(t[0]-c)/r}%`,e.top=`${100*(u-t[3]+f)/u}%`,o===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/u}%`):this.setRotation(o)};let Me=NT;var Si,xr,fM,hM;class dM extends Me{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});w(this,Si);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,o=document.createElement("a");o.setAttribute("data-element-id",e.id);let r=!1;return e.url?(n.addLinkAttributes(o,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(o,e.action),r=!0):e.attachment?(M(this,Si,fM).call(this,o,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(M(this,Si,hM).call(this,o,e.setOCGState),r=!0):e.dest?(this._bindLink(o,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(o,e),r=!0),e.resetForm?(this._bindResetFormAction(o,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(o,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(o),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,Si,xr).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),M(this,Si,xr).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const o=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(n.actions)){const u=o.get(r);u&&(e[u]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),M(this,Si,xr).call(this)}_bindResetFormAction(e,n){const o=e.onclick;if(o||(e.href=this.linkService.getAnchorUrl("")),M(this,Si,xr).call(this),!this._fieldObjects){Dt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),o||(e.onclick=()=>!1);return}e.onclick=()=>{var A;o==null||o();const{fields:r,refs:u,include:c}=n,f=[];if(r.length!==0||u.length!==0){const S=new Set(u);for(const E of r){const b=this._fieldObjects[E]||[];for(const{id:x}of b)S.add(x)}for(const E of Object.values(this._fieldObjects))for(const b of E)S.has(b.id)===c&&f.push(b)}else for(const S of Object.values(this._fieldObjects))f.push(...S);const h=this.annotationStorage,y=[];for(const S of f){const{id:E}=S;switch(y.push(E),S.type){case"text":{const x=S.defaultValue||"";h.setValue(E,{value:x});break}case"checkbox":case"radiobutton":{const x=S.defaultValue===S.exportValues;h.setValue(E,{value:x});break}case"combobox":case"listbox":{const x=S.defaultValue||"";h.setValue(E,{value:x});break}default:continue}const b=document.querySelector(`[data-element-id="${E}"]`);if(b){if(!Vl.has(b)){Dt(`_bindResetFormAction - element not allowed: ${E}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:y,name:"ResetForm"}})),!1}}}Si=new WeakSet,xr=function(){this.container.setAttribute("data-internal-link","")},fM=function(e,n,o=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(n.content,n.filename,o),!1},M(this,Si,xr).call(this)},hM=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),M(this,Si,xr).call(this)};class L3 extends Me{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class zl extends Me{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return hn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,o,r){n.includes("mouse")?t.addEventListener(n,u=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:r(u),shift:u.shiftKey,modifier:this._getKeyModifier(u)}})}):t.addEventListener(n,u=>{var c;if(n==="blur"){if(!e.focused||!u.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}r&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:r(u)}}))})}_setEventListeners(t,e,n,o){var r,u,c;for(const[f,h]of n)(h==="Action"||(r=this.data.actions)!=null&&r[h])&&((h==="Focus"||h==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,f,h,o),h==="Focus"&&!((u=this.data.actions)!=null&&u.Blur)?this._setEventListener(t,e,"blur","Blur",null):h==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Et.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,o=this.data.defaultAppearanceData.fontSize||P3,r=t.style;let u;const c=2,f=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),y=Math.round(h/(E0*o))||1,A=h/y;u=Math.min(o,f(A/E0))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);u=Math.min(o,f(h/E0))}r.fontSize=`calc(${u}px * var(--total-scale-factor))`,r.color=Et.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class k3 extends zl{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,o){const r=this.annotationStorage;for(const u of this._getElementsByName(t.name,t.id))u.domElement&&(u.domElement[e]=n),r.setValue(u.id,{[o]:n})}render(){var o,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const u=t.getValue(e,{value:this.data.fieldValue});let c=u.value||"";const f=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;f&&c.length>f&&(c=c.slice(0,f));let h=u.formattedValue||((o=this.data.textContent)==null?void 0:o.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const y={userValue:c,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",h??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Vl.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const A=this.data.dateFormat||this.data.timeFormat;A&&(n.title=A),this._setRequired(n,this.data.required),f&&(n.maxLength=f),n.addEventListener("input",E=>{t.setValue(e,{value:E.target.value}),this.setPropertyOnSiblings(n,"value",E.target.value,"value"),y.formattedValue=null}),n.addEventListener("resetform",E=>{const b=this.data.defaultFieldValue??"";n.value=y.userValue=b,y.formattedValue=null});let S=E=>{const{formattedValue:b}=y;b!=null&&(E.target.value=b),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{var N;if(y.focused)return;const{target:x}=b;y.userValue&&(x.value=y.userValue),y.lastCommittedValue=x.value,y.commitKey=1,(N=this.data.actions)!=null&&N.Focus||(y.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const x={value(N){y.userValue=N.detail.value??"",t.setValue(e,{value:y.userValue.toString()}),N.target.value=y.userValue},formattedValue(N){const{formattedValue:D}=N.detail;y.formattedValue=D,D!=null&&N.target!==document.activeElement&&(N.target.value=D),t.setValue(e,{formattedValue:D})},selRange(N){N.target.setSelectionRange(...N.detail.selRange)},charLimit:N=>{var U;const{charLimit:D}=N.detail,{target:k}=N;if(D===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",D);let L=y.userValue;!L||L.length<=D||(L=L.slice(0,D),k.value=y.userValue=L,t.setValue(e,{value:L}),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(x,b)}),n.addEventListener("keydown",b=>{var D;y.commitKey=1;let x=-1;if(b.key==="Escape"?x=0:b.key==="Enter"&&!this.data.multiLine?x=2:b.key==="Tab"&&(y.commitKey=3),x===-1)return;const{value:N}=b.target;y.lastCommittedValue!==N&&(y.lastCommittedValue=N,y.userValue=N,(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,willCommit:!0,commitKey:x,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const E=S;S=null,n.addEventListener("blur",b=>{var N,D;if(!y.focused||!b.relatedTarget)return;(N=this.data.actions)!=null&&N.Blur||(y.focused=!1);const{value:x}=b.target;y.userValue=x,y.lastCommittedValue!==x&&((D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:y.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),E(b)}),(r=this.data.actions)!=null&&r.Keystroke&&n.addEventListener("beforeinput",b=>{var G;y.lastCommittedValue=null;const{data:x,target:N}=b,{value:D,selectionStart:k,selectionEnd:L}=N;let U=k,P=L;switch(b.inputType){case"deleteWordBackward":{const F=D.substring(0,k).match(/\w*[^\w]*$/);F&&(U-=F[0].length);break}case"deleteWordForward":{const F=D.substring(k).match(/^[^\w]*\w*/);F&&(P+=F[0].length);break}case"deleteContentBackward":k===L&&(U-=1);break;case"deleteContentForward":k===L&&(P+=1);break}b.preventDefault(),(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,change:x||"",willCommit:!1,selStart:U,selEnd:P}})}),this._setEventListeners(n,y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(S&&n.addEventListener("blur",S),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/f;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class U3 extends zl{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class F3 extends zl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let o=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof o=="string"&&(o=o!=="Off",t.setValue(n,{value:o})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Vl.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,o&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",u=>{const{name:c,checked:f}=u.target;for(const h of this._getElementsByName(c,n)){const y=f&&h.exportValue===e.exportValue;h.domElement&&(h.domElement.checked=y),t.setValue(h.id,{value:y})}t.setValue(n,{value:f})}),r.addEventListener("resetform",u=>{const c=e.defaultFieldValue||"Off";u.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",u=>{const c={value(f){f.target.checked=f.detail.value!=="Off",t.setValue(n,{value:f.target.checked})}};this._dispatchEventFromSandbox(c,u)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class pM extends zl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let o=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof o=="string"&&(o=o!==e.buttonValue,t.setValue(n,{value:o})),o)for(const u of this._getElementsByName(e.fieldName,n))t.setValue(u.id,{value:!1});const r=document.createElement("input");if(Vl.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,o&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",u=>{const{name:c,checked:f}=u.target;for(const h of this._getElementsByName(c,n))t.setValue(h.id,{value:!1});t.setValue(n,{value:f})}),r.addEventListener("resetform",u=>{const c=e.defaultFieldValue;u.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const u=e.buttonValue;r.addEventListener("updatefromsandbox",c=>{const f={value:h=>{const y=u===h.detail.value;for(const A of this._getElementsByName(h.target.name)){const S=y&&A.id===n;A.domElement&&(A.domElement.checked=S),t.setValue(A.id,{value:S})}}};this._dispatchEventFromSandbox(f,c)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class O3 extends dM{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class B3 extends zl{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),o=document.createElement("select");Vl.add(o),o.setAttribute("data-element-id",e),o.disabled=this.data.readOnly,this._setRequired(o,this.data.required),o.name=this.data.fieldName,o.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(o.size=this.data.options.length,this.data.multiSelect&&(o.multiple=!0)),o.addEventListener("resetform",y=>{const A=this.data.defaultFieldValue;for(const S of o.options)S.selected=S.value===A});for(const y of this.data.options){const A=document.createElement("option");A.textContent=y.displayValue,A.value=y.exportValue,n.value.includes(y.exportValue)&&(A.setAttribute("selected",!0),r=!1),o.append(A)}let u=null;if(r){const y=document.createElement("option");y.value=" ",y.setAttribute("hidden",!0),y.setAttribute("selected",!0),o.prepend(y),u=()=>{y.remove(),o.removeEventListener("input",u),u=null},o.addEventListener("input",u)}const c=y=>{const A=y?"value":"textContent",{options:S,multiple:E}=o;return E?Array.prototype.filter.call(S,b=>b.selected).map(b=>b[A]):S.selectedIndex===-1?null:S[S.selectedIndex][A]};let f=c(!1);const h=y=>{const A=y.target.options;return Array.prototype.map.call(A,S=>({displayValue:S.textContent,exportValue:S.value}))};return this.enableScripting&&this.hasJSActions?(o.addEventListener("updatefromsandbox",y=>{const A={value(S){u==null||u();const E=S.detail.value,b=new Set(Array.isArray(E)?E:[E]);for(const x of o.options)x.selected=b.has(x.value);t.setValue(e,{value:c(!0)}),f=c(!1)},multipleSelection(S){o.multiple=!0},remove(S){const E=o.options,b=S.detail.remove;E[b].selected=!1,o.remove(b),E.length>0&&Array.prototype.findIndex.call(E,N=>N.selected)===-1&&(E[0].selected=!0),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},clear(S){for(;o.length!==0;)o.remove(0);t.setValue(e,{value:null,items:[]}),f=c(!1)},insert(S){const{index:E,displayValue:b,exportValue:x}=S.detail.insert,N=o.children[E],D=document.createElement("option");D.textContent=b,D.value=x,N?N.before(D):o.append(D),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},items(S){const{items:E}=S.detail;for(;o.length!==0;)o.remove(0);for(const b of E){const{displayValue:x,exportValue:N}=b,D=document.createElement("option");D.textContent=x,D.value=N,o.append(D)}o.options.length>0&&(o.options[0].selected=!0),t.setValue(e,{value:c(!0),items:h(S)}),f=c(!1)},indices(S){const E=new Set(S.detail.indices);for(const b of S.target.options)b.selected=E.has(b.index);t.setValue(e,{value:c(!0)}),f=c(!1)},editable(S){S.target.disabled=!S.detail.editable}};this._dispatchEventFromSandbox(A,y)}),o.addEventListener("input",y=>{var E;const A=c(!0),S=c(!1);t.setValue(e,{value:A}),y.preventDefault(),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,change:S,changeEx:A,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(o,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],y=>y.target.value)):o.addEventListener("input",function(y){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(o),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class wA extends Me{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Me._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new G3({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const o of this.elements)o.popup=e,o.container.ariaHasPopup="dialog",n.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(o=>`${mT}${o}`).join(",")),this.container}}var bc,Gm,Vm,xc,_c,Ce,_o,dl,Ch,bh,wc,wo,ts,Mo,xh,Ro,_h,fl,hl,ae,tm,MA,gM,mM,yM,vM,em,nm,RA;class G3{constructor({container:t,color:e,elements:n,titleObj:o,modificationDate:r,contentsObj:u,richText:c,parent:f,rect:h,parentRect:y,open:A}){w(this,ae);w(this,bc,M(this,ae,yM).bind(this));w(this,Gm,M(this,ae,RA).bind(this));w(this,Vm,M(this,ae,nm).bind(this));w(this,xc,M(this,ae,em).bind(this));w(this,_c,null);w(this,Ce,null);w(this,_o,null);w(this,dl,null);w(this,Ch,null);w(this,bh,null);w(this,wc,null);w(this,wo,!1);w(this,ts,null);w(this,Mo,null);w(this,xh,null);w(this,Ro,null);w(this,_h,null);w(this,fl,null);w(this,hl,!1);var S;C(this,Ce,t),C(this,_h,o),C(this,_o,u),C(this,Ro,c),C(this,bh,f),C(this,_c,e),C(this,xh,h),C(this,wc,y),C(this,Ch,n),C(this,dl,AT.toDateObject(r)),this.trigger=n.flatMap(E=>E.getElementsToTriggerPopup());for(const E of this.trigger)E.addEventListener("click",g(this,xc)),E.addEventListener("mouseenter",g(this,Vm)),E.addEventListener("mouseleave",g(this,Gm)),E.classList.add("popupTriggerArea");for(const E of n)(S=E.container)==null||S.addEventListener("keydown",g(this,bc));g(this,Ce).hidden=!0,A&&M(this,ae,em).call(this)}render(){if(g(this,ts))return;const t=C(this,ts,document.createElement("div"));if(t.className="popup",g(this,_c)){const r=t.style.outlineColor=Et.makeHexColor(...g(this,_c));t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=g(this,_h),t.append(e),g(this,dl)){const r=document.createElement("time");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,dl).valueOf()})),r.dateTime=g(this,dl).toISOString(),e.append(r)}const o=g(this,ae,tm);if(o)cM.render({xfaHtml:o,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(g(this,_o));t.append(r)}g(this,Ce).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const o=t.split(/(?:\r\n?|\n)/);for(let r=0,u=o.length;r<u;++r){const c=o[r];n.append(document.createTextNode(c)),r<u-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;g(this,fl)||C(this,fl,{contentsObj:g(this,_o),richText:g(this,Ro)}),t&&C(this,Mo,null),e&&(C(this,Ro,M(this,ae,mM).call(this,e)),C(this,_o,null)),(n=g(this,ts))==null||n.remove(),C(this,ts,null)}resetEdited(){var t;g(this,fl)&&({contentsObj:xn(this,_o)._,richText:xn(this,Ro)._}=g(this,fl),C(this,fl,null),(t=g(this,ts))==null||t.remove(),C(this,ts,null),C(this,Mo,null))}forceHide(){C(this,hl,this.isVisible),g(this,hl)&&(g(this,Ce).hidden=!0)}maybeShow(){g(this,hl)&&(g(this,ts)||M(this,ae,nm).call(this),C(this,hl,!1),g(this,Ce).hidden=!1)}get isVisible(){return g(this,Ce).hidden===!1}}bc=new WeakMap,Gm=new WeakMap,Vm=new WeakMap,xc=new WeakMap,_c=new WeakMap,Ce=new WeakMap,_o=new WeakMap,dl=new WeakMap,Ch=new WeakMap,bh=new WeakMap,wc=new WeakMap,wo=new WeakMap,ts=new WeakMap,Mo=new WeakMap,xh=new WeakMap,Ro=new WeakMap,_h=new WeakMap,fl=new WeakMap,hl=new WeakMap,ae=new WeakSet,tm=function(){const t=g(this,Ro),e=g(this,_o);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&g(this,Ro).html||null},MA=function(){var t,e,n;return((n=(e=(t=g(this,ae,tm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},gM=function(){var t,e,n;return((n=(e=(t=g(this,ae,tm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},mM=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},o={style:{color:g(this,ae,gM),fontSize:g(this,ae,MA)?`calc(${g(this,ae,MA)}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:o});return n},yM=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&g(this,wo))&&M(this,ae,em).call(this)},vM=function(){if(g(this,Mo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:o,pageY:r}}}=g(this,bh);let u=!!g(this,wc),c=u?g(this,wc):g(this,xh);for(const b of g(this,Ch))if(!c||Et.intersect(b.data.rect,c)!==null){c=b.data.rect,u=!0;break}const f=Et.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),y=u?c[2]-c[0]+5:0,A=f[0]+y,S=f[1];C(this,Mo,[100*(A-o)/e,100*(S-r)/n]);const{style:E}=g(this,Ce);E.left=`${g(this,Mo)[0]}%`,E.top=`${g(this,Mo)[1]}%`},em=function(){C(this,wo,!g(this,wo)),g(this,wo)?(M(this,ae,nm).call(this),g(this,Ce).addEventListener("click",g(this,xc)),g(this,Ce).addEventListener("keydown",g(this,bc))):(M(this,ae,RA).call(this),g(this,Ce).removeEventListener("click",g(this,xc)),g(this,Ce).removeEventListener("keydown",g(this,bc)))},nm=function(){g(this,ts)||this.render(),this.isVisible?g(this,wo)&&g(this,Ce).classList.add("focused"):(M(this,ae,vM).call(this),g(this,Ce).hidden=!1,g(this,Ce).style.zIndex=parseInt(g(this,Ce).style.zIndex)+1e3)},RA=function(){g(this,Ce).classList.remove("focused"),!(g(this,wo)||!this.isVisible)&&(g(this,Ce).hidden=!0,g(this,Ce).style.zIndex=parseInt(g(this,Ce).style.zIndex)-1e3)};class AM extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Nt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var wh;class V3 extends Me{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,wh,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=C(this,wh,this.svgFactory.createElement("svg:line"));return u.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),u.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),u.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),u.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),u.setAttribute("stroke-width",e.borderStyle.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),r.append(u),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,wh)}addHighlightArea(){this.container.classList.add("highlightArea")}}wh=new WeakMap;var Mh;class H3 extends Me{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Mh,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=e.borderStyle.width,c=C(this,Mh,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",u/2),c.setAttribute("y",u/2),c.setAttribute("width",n-u),c.setAttribute("height",o-u),c.setAttribute("stroke-width",u||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Mh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mh=new WeakMap;var Rh;class q3 extends Me{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Rh,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:n,height:o}=this,r=this.svgFactory.create(n,o,!0),u=e.borderStyle.width,c=C(this,Rh,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",o/2),c.setAttribute("rx",n/2-u/2),c.setAttribute("ry",o/2-u/2),c.setAttribute("stroke-width",u||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Rh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rh=new WeakMap;var Nh;class TM extends Me{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Nh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:o,popupRef:r},width:u,height:c}=this;if(!n)return this.container;const f=this.svgFactory.create(u,c,!0);let h=[];for(let A=0,S=n.length;A<S;A+=2){const E=n[A]-e[0],b=e[3]-n[A+1];h.push(`${E},${b}`)}h=h.join(" ");const y=C(this,Nh,this.svgFactory.createElement(this.svgElementName));return y.setAttribute("points",h),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),f.append(y),this.container.append(f),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,Nh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nh=new WeakMap;class z3 extends TM{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $3 extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Dh,pl,Ih,NA;class bT extends Me{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});w(this,Ih);w(this,Dh,null);w(this,pl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Nt.HIGHLIGHT:Nt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:o,borderStyle:r,popupRef:u}}=this,{transform:c,width:f,height:h}=M(this,Ih,NA).call(this,n,e),y=this.svgFactory.create(f,h,!0),A=C(this,Dh,this.svgFactory.createElement("svg:g"));y.append(A),A.setAttribute("stroke-width",r.width||1),A.setAttribute("stroke-linecap","round"),A.setAttribute("stroke-linejoin","round"),A.setAttribute("stroke-miterlimit",10),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),A.setAttribute("transform",c);for(let S=0,E=o.length;S<E;S++){const b=this.svgFactory.createElement(this.svgElementName);g(this,pl).push(b),b.setAttribute("points",o[S].join(",")),A.append(b)}return!u&&this.hasPopupData&&this._createPopup(),this.container.append(y),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:o,rect:r}=e,u=g(this,Dh);if(n>=0&&u.setAttribute("stroke-width",n||1),o)for(let c=0,f=g(this,pl).length;c<f;c++)g(this,pl)[c].setAttribute("points",o[c].join(","));if(r){const{transform:c,width:f,height:h}=M(this,Ih,NA).call(this,this.data.rotation,r);u.parentElement.setAttribute("viewBox",`0 0 ${f} ${h}`),u.setAttribute("transform",c)}}getElementsToTriggerPopup(){return g(this,pl)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dh=new WeakMap,pl=new WeakMap,Ih=new WeakSet,NA=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class SM extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Nt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Y3 extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class X3 extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class J3 extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class EM extends Me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Nt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ph,Lh,DA;class K3 extends Me{constructor(e){var o;super(e,{isRenderable:!0});w(this,Lh);w(this,Ph,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(o=this.linkService.eventBus)==null||o.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let o;n.hasAppearance||n.fillAlpha===0?o=document.createElement("div"):(o=document.createElement("img"),o.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(o.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),o.addEventListener("dblclick",M(this,Lh,DA).bind(this)),C(this,Ph,o);const{isMac:r}=hn.platform;return e.addEventListener("keydown",u=>{u.key==="Enter"&&(r?u.metaKey:u.ctrlKey)&&M(this,Lh,DA).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():o.classList.add("popupTriggerArea"),e.append(o),e}getElementsToTriggerPopup(){return g(this,Ph)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ph=new WeakMap,Lh=new WeakSet,DA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var kh,gl,Ga,Uh,or,PA,LA;const DT=class DT{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:o,page:r,viewport:u,structTreeLayer:c}){w(this,or);w(this,kh,null);w(this,gl,null);w(this,Ga,new Map);w(this,Uh,null);this.div=t,C(this,kh,e),C(this,gl,n),C(this,Uh,c||null),this.page=r,this.viewport=u,this.zIndex=0,this._annotationEditorUIManager=o}hasEditableAnnotations(){return g(this,Ga).size>0}async render(t){var u;const{annotations:e}=t,n=this.div;Bl(n,this.viewport);const o=new Map,r={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Cm,annotationStorage:t.annotationStorage||new ST,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const f=c.annotationType===Ie.POPUP;if(f){const A=o.get(c.id);if(!A)continue;r.elements=A}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;r.data=c;const h=m_.create(r);if(!h.isRenderable)continue;if(!f&&c.popupRef){const A=o.get(c.popupRef);A?A.push(h):o.set(c.popupRef,[h])}const y=h.render();c.hidden&&(y.style.visibility="hidden"),await M(this,or,PA).call(this,y,c.id,r.elements),h._isEditable&&(g(this,Ga).set(h.data.id,h),(u=this._annotationEditorUIManager)==null||u.renderAnnotationElement(h))}M(this,or,LA).call(this)}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new Cm,parent:this};for(const o of t){o.borderStyle||(o.borderStyle=DT._defaultBorderStyle),n.data=o;const r=m_.create(n);if(!r.isRenderable)continue;const u=r.render();await M(this,or,PA).call(this,u,o.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,Bl(e,{rotation:t.rotation}),M(this,or,LA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(g(this,Ga).values())}getEditableAnnotation(t){return g(this,Ga).get(t)}static get _defaultBorderStyle(){return Gt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Du.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};kh=new WeakMap,gl=new WeakMap,Ga=new WeakMap,Uh=new WeakMap,or=new WeakSet,PA=async function(t,e,n){var c,f;const o=t.firstChild||t,r=o.id=`${mT}${e}`,u=await((c=g(this,Uh))==null?void 0:c.getAriaAttributes(r));if(u)for(const[h,y]of u)o.setAttribute(h,y);n?n.at(-1).container.after(t):(this.div.append(t),(f=g(this,kh))==null||f.moveElementInDOM(this.div,t,o,!1))},LA=function(){var e;if(!g(this,gl))return;const t=this.div;for(const[n,o]of g(this,gl)){const r=t.querySelector(`[data-annotation-id="${n}"]`);if(!r)continue;o.className="annotationContent";const{firstChild:u}=r;u?u.nodeName==="CANVAS"?u.replaceWith(o):u.classList.contains("annotationContent")?u.after(o):u.before(o):r.append(o);const c=g(this,Ga).get(n);c&&(c._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(n,r.id,o),c._hasNoCanvas=!1):c.canvas=o)}g(this,gl).clear()};let IA=DT;const kg=/\r\n?|\n/g;var es,li,Fh,ml,ui,ke,CM,bM,xM,im,Vo,sm,om,_M,UA,wM;const ue=class ue extends de{constructor(e){super({...e,name:"freeTextEditor"});w(this,ke);w(this,es);w(this,li,"");w(this,Fh,`${this.id}-editor`);w(this,ml,null);w(this,ui);C(this,es,e.color||ue._defaultColor||de._defaultLineColor),C(this,ui,e.fontSize||ue._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const e=ue.prototype,n=u=>u.isEmpty(),o=Gl.TRANSLATE_SMALL,r=Gl.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new rp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-o,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[o,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-o],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,o],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:n}]]))}static initialize(e,n){de.initialize(e,n);const o=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(o.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Ht.FREETEXT_SIZE:ue._defaultFontSize=n;break;case Ht.FREETEXT_COLOR:ue._defaultColor=n;break}}updateParams(e,n){switch(e){case Ht.FREETEXT_SIZE:M(this,ke,CM).call(this,n);break;case Ht.FREETEXT_COLOR:M(this,ke,bM).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ht.FREETEXT_SIZE,ue._defaultFontSize],[Ht.FREETEXT_COLOR,ue._defaultColor||de._defaultLineColor]]}get propertiesToUpdate(){return[[Ht.FREETEXT_SIZE,g(this,ui)],[Ht.FREETEXT_COLOR,g(this,es)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-ue._internalPadding*e,-(ue._internalPadding+g(this,ui))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),C(this,ml,new AbortController);const e=this._uiManager.combinedSignal(g(this,ml));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,Fh)),this._isDraggable=!0,(e=g(this,ml))==null||e.abort(),C(this,ml,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=g(this,li),n=C(this,li,M(this,ke,xM).call(this).trimEnd());if(e===n)return;const o=r=>{if(C(this,li,r),!r){this.remove();return}M(this,ke,om).call(this),this._uiManager.rebuild(this),M(this,ke,im).call(this)};this.addCommands({cmd:()=>{o(n)},undo:()=>{o(e)},mustExec:!1}),M(this,ke,im).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ue._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,n;(this._isCopy||this.annotationElementId)&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,Fh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:o}=this.editorDiv;if(o.fontSize=`calc(${g(this,ui)}px * var(--total-scale-factor))`,o.color=g(this,es),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,u]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[f,h]=this.getInitialTranslation();[f,h]=this.pageTranslationToScreen(f,h);const[y,A]=this.pageDimensions,[S,E]=this.pageTranslation;let b,x;switch(this.rotation){case 0:b=e+(c[0]-S)/y,x=n+this.height-(c[1]-E)/A;break;case 90:b=e+(c[0]-S)/y,x=n-(c[1]-E)/A,[f,h]=[h,-f];break;case 180:b=e-this.width+(c[0]-S)/y,x=n-(c[1]-E)/A,[f,h]=[-f,-h];break;case 270:b=e+(c[0]-S-this.height*A)/y,x=n+(c[1]-E-this.width*y)/A,[f,h]=[-h,f];break}this.setAt(b*r,x*u,f,h)}else this._moveAfterPaste(e,n);M(this,ke,om).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var b,x,N;const n=e.clipboardData||window.clipboardData,{types:o}=n;if(o.length===1&&o[0]==="text/plain")return;e.preventDefault();const r=M(b=ue,Vo,UA).call(b,n.getData("text")||"").replaceAll(kg,`
`);if(!r)return;const u=window.getSelection();if(!u.rangeCount)return;this.editorDiv.normalize(),u.deleteFromDocument();const c=u.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),u.collapseToStart();return}const{startContainer:f,startOffset:h}=c,y=[],A=[];if(f.nodeType===Node.TEXT_NODE){const D=f.parentElement;if(A.push(f.nodeValue.slice(h).replaceAll(kg,"")),D!==this.editorDiv){let k=y;for(const L of this.editorDiv.childNodes){if(L===D){k=A;continue}k.push(M(x=ue,Vo,sm).call(x,L))}}y.push(f.nodeValue.slice(0,h).replaceAll(kg,""))}else if(f===this.editorDiv){let D=y,k=0;for(const L of this.editorDiv.childNodes)k++===h&&(D=A),D.push(M(N=ue,Vo,sm).call(N,L))}C(this,li,`${y.join(`
`)}${r}${A.join(`
`)}`),M(this,ke,om).call(this);const S=new Range;let E=Math.sumPrecise(y.map(D=>D.length));for(const{firstChild:D}of this.editorDiv.childNodes)if(D.nodeType===Node.TEXT_NODE){const k=D.nodeValue.length;if(E<=k){S.setStart(D,E),S.setEnd(D,E);break}E-=k}u.removeAllRanges(),u.addRange(S)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,o){var c;let r=null;if(e instanceof AM){const{data:{defaultAppearanceData:{fontSize:f,fontColor:h},rect:y,rotation:A,id:S,popupRef:E},textContent:b,textPosition:x,parent:{page:{pageNumber:N}}}=e;if(!b||b.length===0)return null;r=e={annotationType:Nt.FREETEXT,color:Array.from(h),fontSize:f,value:b.join(`
`),position:x,pageIndex:N-1,rect:y.slice(0),rotation:A,annotationElementId:S,id:S,deleted:!1,popupRef:E}}const u=await super.deserialize(e,n,o);return C(u,ui,e.fontSize),C(u,es,Et.makeHexColor(...e.color)),C(u,li,M(c=ue,Vo,UA).call(c,e.value)),u._initialData=r,u}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=ue._internalPadding*this.parentScale,o=this.getRect(n,n),r=de._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:g(this,es)),u={annotationType:Nt.FREETEXT,color:r,fontSize:g(this,ui),value:M(this,ke,_M).call(this),pageIndex:this.pageIndex,rect:o,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(u.isCopy=!0,u):this.annotationElementId&&!M(this,ke,wM).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:o}=n;o.fontSize=`calc(${g(this,ui)}px * var(--total-scale-factor))`,o.color=g(this,es),n.replaceChildren();for(const u of g(this,li).split(`
`)){const c=document.createElement("div");c.append(u?document.createTextNode(u):document.createElement("br")),n.append(c)}const r=ue._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:g(this,li)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};es=new WeakMap,li=new WeakMap,Fh=new WeakMap,ml=new WeakMap,ui=new WeakMap,ke=new WeakSet,CM=function(e){const n=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-g(this,ui))*this.parentScale),C(this,ui,r),M(this,ke,im).call(this)},o=g(this,ui);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ht.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},bM=function(e){const n=r=>{C(this,es,this.editorDiv.style.color=r)},o=g(this,es);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ht.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},xM=function(){var o;const e=[];this.editorDiv.normalize();let n=null;for(const r of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(M(o=ue,Vo,sm).call(o,r)),n=r);return e.join(`
`)},im=function(){const[e,n]=this.parentDimensions;let o;if(this.isAttachedToDOM)o=this.div.getBoundingClientRect();else{const{currentLayer:r,div:u}=this,c=u.style.display,f=u.classList.contains("hidden");u.classList.remove("hidden"),u.style.display="hidden",r.div.append(this.div),o=u.getBoundingClientRect(),u.remove(),u.style.display=c,u.classList.toggle("hidden",f)}this.rotation%180===this.parentRotation%180?(this.width=o.width/e,this.height=o.height/n):(this.width=o.height/e,this.height=o.width/n),this.fixAndSetPosition()},Vo=new WeakSet,sm=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(kg,"")},om=function(){if(this.editorDiv.replaceChildren(),!!g(this,li))for(const e of g(this,li).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},_M=function(){return g(this,li).replaceAll(""," ")},UA=function(e){return e.replaceAll(" ","")},wM=function(e){const{value:n,fontSize:o,color:r,pageIndex:u}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==o||e.color.some((c,f)=>c!==r[f])||e.pageIndex!==u},w(ue,Vo),ot(ue,"_freeTextDefaultContent",""),ot(ue,"_internalPadding",0),ot(ue,"_defaultColor",null),ot(ue,"_defaultFontSize",10),ot(ue,"_type","freetext"),ot(ue,"_editorType",Nt.FREETEXT);let kA=ue;class dt{toSVGPath(){oe("Abstract method `toSVGPath` must be implemented.")}get box(){oe("Abstract getter `box` must be implemented.")}serialize(t,e){oe("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,o,r,u){u||(u=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)u[c]=e+t[c]*o,u[c+1]=n+t[c+1]*r;return u}static _rescaleAndSwap(t,e,n,o,r,u){u||(u=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)u[c]=e+t[c+1]*o,u[c+1]=n+t[c]*r;return u}static _translate(t,e,n,o){o||(o=new Float32Array(t.length));for(let r=0,u=t.length;r<u;r+=2)o[r]=e+t[r],o[r+1]=n+t[r+1];return o}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,o,r){switch(r){case 90:return[1-e/n,t/o];case 180:return[1-t/n,1-e/o];case 270:return[e/n,1-t/o];default:return[t/n,e/o]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,o,r,u){return[(t+5*n)/6,(e+5*o)/6,(5*n+r)/6,(5*o+u)/6,(n+r)/2,(o+u)/2]}}ot(dt,"PRECISION",1e-4);var ci,ns,Mc,Rc,Rs,Ft,yl,vl,Oh,Bh,Nc,Dc,Va,Gh,Hm,qm,qe,Af,MM,RM,NM,DM,IM,PM;const ro=class ro{constructor({x:t,y:e},n,o,r,u,c=0){w(this,qe);w(this,ci);w(this,ns,[]);w(this,Mc);w(this,Rc);w(this,Rs,[]);w(this,Ft,new Float32Array(18));w(this,yl);w(this,vl);w(this,Oh);w(this,Bh);w(this,Nc);w(this,Dc);w(this,Va,[]);C(this,ci,n),C(this,Dc,r*o),C(this,Rc,u),g(this,Ft).set([NaN,NaN,NaN,NaN,t,e],6),C(this,Mc,c),C(this,Bh,g(ro,Gh)*o),C(this,Oh,g(ro,qm)*o),C(this,Nc,o),g(this,Va).push(t,e)}isEmpty(){return isNaN(g(this,Ft)[8])}add({x:t,y:e}){var X;C(this,yl,t),C(this,vl,e);const[n,o,r,u]=g(this,ci);let[c,f,h,y]=g(this,Ft).subarray(8,12);const A=t-h,S=e-y,E=Math.hypot(A,S);if(E<g(this,Oh))return!1;const b=E-g(this,Bh),x=b/E,N=x*A,D=x*S;let k=c,L=f;c=h,f=y,h+=N,y+=D,(X=g(this,Va))==null||X.push(t,e);const U=-D/b,P=N/b,G=U*g(this,Dc),F=P*g(this,Dc);return g(this,Ft).set(g(this,Ft).subarray(2,8),0),g(this,Ft).set([h+G,y+F],4),g(this,Ft).set(g(this,Ft).subarray(14,18),12),g(this,Ft).set([h-G,y-F],16),isNaN(g(this,Ft)[6])?(g(this,Rs).length===0&&(g(this,Ft).set([c+G,f+F],2),g(this,Rs).push(NaN,NaN,NaN,NaN,(c+G-n)/r,(f+F-o)/u),g(this,Ft).set([c-G,f-F],14),g(this,ns).push(NaN,NaN,NaN,NaN,(c-G-n)/r,(f-F-o)/u)),g(this,Ft).set([k,L,c,f,h,y],6),!this.isEmpty()):(g(this,Ft).set([k,L,c,f,h,y],6),Math.abs(Math.atan2(L-f,k-c)-Math.atan2(D,N))<Math.PI/2?([c,f,h,y]=g(this,Ft).subarray(2,6),g(this,Rs).push(NaN,NaN,NaN,NaN,((c+h)/2-n)/r,((f+y)/2-o)/u),[c,f,k,L]=g(this,Ft).subarray(14,18),g(this,ns).push(NaN,NaN,NaN,NaN,((k+c)/2-n)/r,((L+f)/2-o)/u),!0):([k,L,c,f,h,y]=g(this,Ft).subarray(0,6),g(this,Rs).push(((k+5*c)/6-n)/r,((L+5*f)/6-o)/u,((5*c+h)/6-n)/r,((5*f+y)/6-o)/u,((c+h)/2-n)/r,((f+y)/2-o)/u),[h,y,c,f,k,L]=g(this,Ft).subarray(12,18),g(this,ns).push(((k+5*c)/6-n)/r,((L+5*f)/6-o)/u,((5*c+h)/6-n)/r,((5*f+y)/6-o)/u,((c+h)/2-n)/r,((f+y)/2-o)/u),!0))}toSVGPath(){if(this.isEmpty())return"";const t=g(this,Rs),e=g(this,ns);if(isNaN(g(this,Ft)[6])&&!this.isEmpty())return M(this,qe,MM).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let o=6;o<t.length;o+=6)isNaN(t[o])?n.push(`L${t[o+4]} ${t[o+5]}`):n.push(`C${t[o]} ${t[o+1]} ${t[o+2]} ${t[o+3]} ${t[o+4]} ${t[o+5]}`);M(this,qe,NM).call(this,n);for(let o=e.length-6;o>=6;o-=6)isNaN(e[o])?n.push(`L${e[o+4]} ${e[o+5]}`):n.push(`C${e[o]} ${e[o+1]} ${e[o+2]} ${e[o+3]} ${e[o+4]} ${e[o+5]}`);return M(this,qe,RM).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,o,r,u){return new LM(t,e,n,o,r,u)}getOutlines(){var A;const t=g(this,Rs),e=g(this,ns),n=g(this,Ft),[o,r,u,c]=g(this,ci),f=new Float32Array((((A=g(this,Va))==null?void 0:A.length)??0)+2);for(let S=0,E=f.length-2;S<E;S+=2)f[S]=(g(this,Va)[S]-o)/u,f[S+1]=(g(this,Va)[S+1]-r)/c;if(f[f.length-2]=(g(this,yl)-o)/u,f[f.length-1]=(g(this,vl)-r)/c,isNaN(n[6])&&!this.isEmpty())return M(this,qe,DM).call(this,f);const h=new Float32Array(g(this,Rs).length+24+g(this,ns).length);let y=t.length;for(let S=0;S<y;S+=2){if(isNaN(t[S])){h[S]=h[S+1]=NaN;continue}h[S]=t[S],h[S+1]=t[S+1]}y=M(this,qe,PM).call(this,h,y);for(let S=e.length-6;S>=6;S-=6)for(let E=0;E<6;E+=2){if(isNaN(e[S+E])){h[y]=h[y+1]=NaN,y+=2;continue}h[y]=e[S+E],h[y+1]=e[S+E+1],y+=2}return M(this,qe,IM).call(this,h,y),this.newFreeDrawOutline(h,f,g(this,ci),g(this,Nc),g(this,Mc),g(this,Rc))}};ci=new WeakMap,ns=new WeakMap,Mc=new WeakMap,Rc=new WeakMap,Rs=new WeakMap,Ft=new WeakMap,yl=new WeakMap,vl=new WeakMap,Oh=new WeakMap,Bh=new WeakMap,Nc=new WeakMap,Dc=new WeakMap,Va=new WeakMap,Gh=new WeakMap,Hm=new WeakMap,qm=new WeakMap,qe=new WeakSet,Af=function(){const t=g(this,Ft).subarray(4,6),e=g(this,Ft).subarray(16,18),[n,o,r,u]=g(this,ci);return[(g(this,yl)+(t[0]-e[0])/2-n)/r,(g(this,vl)+(t[1]-e[1])/2-o)/u,(g(this,yl)+(e[0]-t[0])/2-n)/r,(g(this,vl)+(e[1]-t[1])/2-o)/u]},MM=function(){const[t,e,n,o]=g(this,ci),[r,u,c,f]=M(this,qe,Af).call(this);return`M${(g(this,Ft)[2]-t)/n} ${(g(this,Ft)[3]-e)/o} L${(g(this,Ft)[4]-t)/n} ${(g(this,Ft)[5]-e)/o} L${r} ${u} L${c} ${f} L${(g(this,Ft)[16]-t)/n} ${(g(this,Ft)[17]-e)/o} L${(g(this,Ft)[14]-t)/n} ${(g(this,Ft)[15]-e)/o} Z`},RM=function(t){const e=g(this,ns);t.push(`L${e[4]} ${e[5]} Z`)},NM=function(t){const[e,n,o,r]=g(this,ci),u=g(this,Ft).subarray(4,6),c=g(this,Ft).subarray(16,18),[f,h,y,A]=M(this,qe,Af).call(this);t.push(`L${(u[0]-e)/o} ${(u[1]-n)/r} L${f} ${h} L${y} ${A} L${(c[0]-e)/o} ${(c[1]-n)/r}`)},DM=function(t){const e=g(this,Ft),[n,o,r,u]=g(this,ci),[c,f,h,y]=M(this,qe,Af).call(this),A=new Float32Array(36);return A.set([NaN,NaN,NaN,NaN,(e[2]-n)/r,(e[3]-o)/u,NaN,NaN,NaN,NaN,(e[4]-n)/r,(e[5]-o)/u,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,h,y,NaN,NaN,NaN,NaN,(e[16]-n)/r,(e[17]-o)/u,NaN,NaN,NaN,NaN,(e[14]-n)/r,(e[15]-o)/u],0),this.newFreeDrawOutline(A,t,g(this,ci),g(this,Nc),g(this,Mc),g(this,Rc))},IM=function(t,e){const n=g(this,ns);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},PM=function(t,e){const n=g(this,Ft).subarray(4,6),o=g(this,Ft).subarray(16,18),[r,u,c,f]=g(this,ci),[h,y,A,S]=M(this,qe,Af).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-r)/c,(n[1]-u)/f,NaN,NaN,NaN,NaN,h,y,NaN,NaN,NaN,NaN,A,S,NaN,NaN,NaN,NaN,(o[0]-r)/c,(o[1]-u)/f],e),e+=24},w(ro,Gh,8),w(ro,Hm,2),w(ro,qm,g(ro,Gh)+g(ro,Hm));let bm=ro;var Ic,Al,No,Vh,di,Hh,we,zm,kM;class LM extends dt{constructor(e,n,o,r,u,c){super();w(this,zm);w(this,Ic);w(this,Al,new Float32Array(4));w(this,No);w(this,Vh);w(this,di);w(this,Hh);w(this,we);C(this,we,e),C(this,di,n),C(this,Ic,o),C(this,Hh,r),C(this,No,u),C(this,Vh,c),this.lastPoint=[NaN,NaN],M(this,zm,kM).call(this,c);const[f,h,y,A]=g(this,Al);for(let S=0,E=e.length;S<E;S+=2)e[S]=(e[S]-f)/y,e[S+1]=(e[S+1]-h)/A;for(let S=0,E=n.length;S<E;S+=2)n[S]=(n[S]-f)/y,n[S+1]=(n[S+1]-h)/A}toSVGPath(){const e=[`M${g(this,we)[4]} ${g(this,we)[5]}`];for(let n=6,o=g(this,we).length;n<o;n+=6){if(isNaN(g(this,we)[n])){e.push(`L${g(this,we)[n+4]} ${g(this,we)[n+5]}`);continue}e.push(`C${g(this,we)[n]} ${g(this,we)[n+1]} ${g(this,we)[n+2]} ${g(this,we)[n+3]} ${g(this,we)[n+4]} ${g(this,we)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,o,r],u){const c=o-e,f=r-n;let h,y;switch(u){case 0:h=dt._rescale(g(this,we),e,r,c,-f),y=dt._rescale(g(this,di),e,r,c,-f);break;case 90:h=dt._rescaleAndSwap(g(this,we),e,n,c,f),y=dt._rescaleAndSwap(g(this,di),e,n,c,f);break;case 180:h=dt._rescale(g(this,we),o,n,-c,f),y=dt._rescale(g(this,di),o,n,-c,f);break;case 270:h=dt._rescaleAndSwap(g(this,we),o,r,-c,-f),y=dt._rescaleAndSwap(g(this,di),o,r,-c,-f);break}return{outline:Array.from(h),points:[Array.from(y)]}}get box(){return g(this,Al)}newOutliner(e,n,o,r,u,c=0){return new bm(e,n,o,r,u,c)}getNewOutline(e,n){const[o,r,u,c]=g(this,Al),[f,h,y,A]=g(this,Ic),S=u*y,E=c*A,b=o*y+f,x=r*A+h,N=this.newOutliner({x:g(this,di)[0]*S+b,y:g(this,di)[1]*E+x},g(this,Ic),g(this,Hh),e,g(this,Vh),n??g(this,No));for(let D=2;D<g(this,di).length;D+=2)N.add({x:g(this,di)[D]*S+b,y:g(this,di)[D+1]*E+x});return N.getOutlines()}}Ic=new WeakMap,Al=new WeakMap,No=new WeakMap,Vh=new WeakMap,di=new WeakMap,Hh=new WeakMap,we=new WeakMap,zm=new WeakSet,kM=function(e){const n=g(this,we);let o=n[4],r=n[5];const u=[o,r,o,r];let c=o,f=r;const h=e?Math.max:Math.min;for(let A=6,S=n.length;A<S;A+=6){const E=n[A+4],b=n[A+5];if(isNaN(n[A]))Et.pointBoundingBox(E,b,u),f<b?(c=E,f=b):f===b&&(c=h(c,E));else{const x=[1/0,1/0,-1/0,-1/0];Et.bezierBoundingBox(o,r,...n.slice(A,A+6),x),Et.rectBoundingBox(...x,u),f<x[3]?(c=x[2],f=x[3]):f===x[3]&&(c=h(c,x[2]))}o=E,r=b}const y=g(this,Al);y[0]=u[0]-g(this,No),y[1]=u[1]-g(this,No),y[2]=u[2]-u[0]+2*g(this,No),y[3]=u[3]-u[1]+2*g(this,No),this.lastPoint=[c,f]};var qh,zh,Ha,is,kn,UM,am,FM,OM,OA;class FA{constructor(t,e=0,n=0,o=!0){w(this,kn);w(this,qh);w(this,zh);w(this,Ha,[]);w(this,is,[]);const r=[1/0,1/0,-1/0,-1/0],u=10**-4;for(const{x:E,y:b,width:x,height:N}of t){const D=Math.floor((E-e)/u)*u,k=Math.ceil((E+x+e)/u)*u,L=Math.floor((b-e)/u)*u,U=Math.ceil((b+N+e)/u)*u,P=[D,L,U,!0],G=[k,L,U,!1];g(this,Ha).push(P,G),Et.rectBoundingBox(D,L,k,U,r)}const c=r[2]-r[0]+2*n,f=r[3]-r[1]+2*n,h=r[0]-n,y=r[1]-n,A=g(this,Ha).at(o?-1:-2),S=[A[0],A[2]];for(const E of g(this,Ha)){const[b,x,N]=E;E[0]=(b-h)/c,E[1]=(x-y)/f,E[2]=(N-y)/f}C(this,qh,new Float32Array([h,y,c,f])),C(this,zh,S)}getOutlines(){g(this,Ha).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of g(this,Ha))e[3]?(t.push(...M(this,kn,OA).call(this,e)),M(this,kn,FM).call(this,e)):(M(this,kn,OM).call(this,e),t.push(...M(this,kn,OA).call(this,e)));return M(this,kn,UM).call(this,t)}}qh=new WeakMap,zh=new WeakMap,Ha=new WeakMap,is=new WeakMap,kn=new WeakSet,UM=function(t){const e=[],n=new Set;for(const u of t){const[c,f,h]=u;e.push([c,f,u],[c,h,u])}e.sort((u,c)=>u[1]-c[1]||u[0]-c[0]);for(let u=0,c=e.length;u<c;u+=2){const f=e[u][2],h=e[u+1][2];f.push(h),h.push(f),n.add(f),n.add(h)}const o=[];let r;for(;n.size>0;){const u=n.values().next().value;let[c,f,h,y,A]=u;n.delete(u);let S=c,E=f;for(r=[c,h],o.push(r);;){let b;if(n.has(y))b=y;else if(n.has(A))b=A;else break;n.delete(b),[c,f,h,y,A]=b,S!==c&&(r.push(S,E,c,E===f?f:h),S=c),E=E===f?h:f}r.push(S,E)}return new W3(o,g(this,qh),g(this,zh))},am=function(t){const e=g(this,is);let n=0,o=e.length-1;for(;n<=o;){const r=n+o>>1,u=e[r][0];if(u===t)return r;u<t?n=r+1:o=r-1}return o+1},FM=function([,t,e]){const n=M(this,kn,am).call(this,t);g(this,is).splice(n,0,[t,e])},OM=function([,t,e]){const n=M(this,kn,am).call(this,t);for(let o=n;o<g(this,is).length;o++){const[r,u]=g(this,is)[o];if(r!==t)break;if(r===t&&u===e){g(this,is).splice(o,1);return}}for(let o=n-1;o>=0;o--){const[r,u]=g(this,is)[o];if(r!==t)break;if(r===t&&u===e){g(this,is).splice(o,1);return}}},OA=function(t){const[e,n,o]=t,r=[[e,n,o]],u=M(this,kn,am).call(this,o);for(let c=0;c<u;c++){const[f,h]=g(this,is)[c];for(let y=0,A=r.length;y<A;y++){const[,S,E]=r[y];if(!(h<=S||E<=f)){if(S>=f){if(E>h)r[y][1]=h;else{if(A===1)return[];r.splice(y,1),y--,A--}continue}r[y][2]=f,E>h&&r.push([e,h,E])}}}return r};var $h,Pc;class W3 extends dt{constructor(e,n,o){super();w(this,$h);w(this,Pc);C(this,Pc,e),C(this,$h,n),this.lastPoint=o}toSVGPath(){const e=[];for(const n of g(this,Pc)){let[o,r]=n;e.push(`M${o} ${r}`);for(let u=2;u<n.length;u+=2){const c=n[u],f=n[u+1];c===o?(e.push(`V${f}`),r=f):f===r&&(e.push(`H${c}`),o=c)}e.push("Z")}return e.join(" ")}serialize([e,n,o,r],u){const c=[],f=o-e,h=r-n;for(const y of g(this,Pc)){const A=new Array(y.length);for(let S=0;S<y.length;S+=2)A[S]=e+y[S]*f,A[S+1]=r-y[S+1]*h;c.push(A)}return c}get box(){return g(this,$h)}get classNamesForOutlining(){return["highlightOutline"]}}$h=new WeakMap,Pc=new WeakMap;class BA extends bm{newFreeDrawOutline(t,e,n,o,r,u){return new Q3(t,e,n,o,r,u)}}class Q3 extends LM{newOutliner(t,e,n,o,r,u=0){return new BA(t,e,n,o,r,u)}}var fi,Tl,Lc,He,Yh,kc,Do,Xh,qa,ss,Uc,Jh,se,GA,VA,HA,_r,BM,ma;const Hn=class Hn{constructor({editor:t=null,uiManager:e=null}){w(this,se);w(this,fi,null);w(this,Tl,null);w(this,Lc);w(this,He,null);w(this,Yh,!1);w(this,kc,!1);w(this,Do,null);w(this,Xh);w(this,qa,null);w(this,ss,null);w(this,Uc);var n,o;t?(C(this,kc,!1),C(this,Uc,Ht.HIGHLIGHT_COLOR),C(this,Do,t)):(C(this,kc,!0),C(this,Uc,Ht.HIGHLIGHT_DEFAULT_COLOR)),C(this,ss,(t==null?void 0:t._uiManager)||e),C(this,Xh,g(this,ss)._eventBus),C(this,Lc,((n=t==null?void 0:t.color)==null?void 0:n.toUpperCase())||((o=g(this,ss))==null?void 0:o.highlightColors.values().next().value)||"#FFFF98"),g(Hn,Jh)||C(Hn,Jh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Gt(this,"_keyboardManager",new rp([[["Escape","mac+Escape"],Hn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Hn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Hn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Hn.prototype._moveToPrevious],[["Home","mac+Home"],Hn.prototype._moveToBeginning],[["End","mac+End"],Hn.prototype._moveToEnd]]))}renderButton(){const t=C(this,fi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",g(this,Do)&&(t.ariaControls=`${g(this,Do).id}_colorpicker_dropdown`);const e=g(this,ss)._signal;t.addEventListener("click",M(this,se,_r).bind(this),{signal:e}),t.addEventListener("keydown",M(this,se,HA).bind(this),{signal:e});const n=C(this,Tl,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=g(this,Lc),t.append(n),t}renderMainDropdown(){const t=C(this,He,M(this,se,GA).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===g(this,fi)){M(this,se,_r).call(this,t);return}const e=t.target.getAttribute("data-color");e&&M(this,se,VA).call(this,e,t)}_moveToNext(t){var e,n;if(!g(this,se,ma)){M(this,se,_r).call(this,t);return}if(t.target===g(this,fi)){(e=g(this,He).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=g(this,He))==null?void 0:e.firstChild)||t.target===g(this,fi)){g(this,se,ma)&&this._hideDropdownFromKeyboard();return}g(this,se,ma)||M(this,se,_r).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!g(this,se,ma)){M(this,se,_r).call(this,t);return}(e=g(this,He).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!g(this,se,ma)){M(this,se,_r).call(this,t);return}(e=g(this,He).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=g(this,He))==null||t.classList.add("hidden"),g(this,fi).ariaExpanded="false",(e=g(this,qa))==null||e.abort(),C(this,qa,null)}_hideDropdownFromKeyboard(){var t;if(!g(this,kc)){if(!g(this,se,ma)){(t=g(this,Do))==null||t.unselect();return}this.hideDropdown(),g(this,fi).focus({preventScroll:!0,focusVisible:g(this,Yh)})}}updateColor(t){if(g(this,Tl)&&(g(this,Tl).style.backgroundColor=t),!g(this,He))return;const e=g(this,ss).highlightColors.values();for(const n of g(this,He).children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=g(this,fi))==null||t.remove(),C(this,fi,null),C(this,Tl,null),(e=g(this,He))==null||e.remove(),C(this,He,null)}};fi=new WeakMap,Tl=new WeakMap,Lc=new WeakMap,He=new WeakMap,Yh=new WeakMap,kc=new WeakMap,Do=new WeakMap,Xh=new WeakMap,qa=new WeakMap,ss=new WeakMap,Uc=new WeakMap,Jh=new WeakMap,se=new WeakSet,GA=function(){const t=document.createElement("div"),e=g(this,ss)._signal;t.addEventListener("contextmenu",us,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),g(this,Do)&&(t.id=`${g(this,Do).id}_colorpicker_dropdown`);for(const[n,o]of g(this,ss).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",o),r.title=n,r.setAttribute("data-l10n-id",g(Hn,Jh)[n]);const u=document.createElement("span");r.append(u),u.className="swatch",u.style.backgroundColor=o,r.ariaSelected=o===g(this,Lc),r.addEventListener("click",M(this,se,VA).bind(this,o),{signal:e}),t.append(r)}return t.addEventListener("keydown",M(this,se,HA).bind(this),{signal:e}),t},VA=function(t,e){e.stopPropagation(),g(this,Xh).dispatch("switchannotationeditorparams",{source:this,type:g(this,Uc),value:t})},HA=function(t){Hn._keyboardManager.exec(this,t)},_r=function(t){if(g(this,se,ma)){this.hideDropdown();return}if(C(this,Yh,t.detail===0),g(this,qa)||(C(this,qa,new AbortController),window.addEventListener("pointerdown",M(this,se,BM).bind(this),{signal:g(this,ss).combinedSignal(g(this,qa))})),g(this,fi).ariaExpanded="true",g(this,He)){g(this,He).classList.remove("hidden");return}const e=C(this,He,M(this,se,GA).call(this));g(this,fi).append(e)},BM=function(t){var e;(e=g(this,He))!=null&&e.contains(t.target)||this.hideDropdown()},ma=function(){return g(this,He)&&!g(this,He).classList.contains("hidden")},w(Hn,Jh,null);let xm=Hn;var Fc,Kh,Io,Sl,Wh,$n,Qh,Zh,El,Fi,hi,un,Oc,Po,Sn,Bc,Oi,jh,It,qA,rm,GM,VM,HM,zA,wr,Gi,Uu,qM,lm,Tf,zM,$M,YM,XM,JM;const Jt=class Jt extends de{constructor(e){super({...e,name:"highlightEditor"});w(this,It);w(this,Fc,null);w(this,Kh,0);w(this,Io);w(this,Sl,null);w(this,Wh,null);w(this,$n,null);w(this,Qh,null);w(this,Zh,0);w(this,El,null);w(this,Fi,null);w(this,hi,null);w(this,un,!1);w(this,Oc,null);w(this,Po);w(this,Sn,null);w(this,Bc,"");w(this,Oi);w(this,jh,"");this.color=e.color||Jt._defaultColor,C(this,Oi,e.thickness||Jt._defaultThickness),C(this,Po,e.opacity||Jt._defaultOpacity),C(this,Io,e.boxes||null),C(this,jh,e.methodOfCreation||""),C(this,Bc,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(C(this,un,!0),M(this,It,rm).call(this,e),M(this,It,wr).call(this)):g(this,Io)&&(C(this,Fc,e.anchorNode),C(this,Kh,e.anchorOffset),C(this,Qh,e.focusNode),C(this,Zh,e.focusOffset),M(this,It,qA).call(this),M(this,It,wr).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=Jt.prototype;return Gt(this,"_keyboardManager",new rp([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,un)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:g(this,Oi),methodOfCreation:g(this,jh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var o;de.initialize(e,n),Jt._defaultColor||(Jt._defaultColor=((o=n.highlightColors)==null?void 0:o.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Ht.HIGHLIGHT_DEFAULT_COLOR:Jt._defaultColor=n;break;case Ht.HIGHLIGHT_THICKNESS:Jt._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return g(this,Oc)}updateParams(e,n){switch(e){case Ht.HIGHLIGHT_COLOR:M(this,It,GM).call(this,n);break;case Ht.HIGHLIGHT_THICKNESS:M(this,It,VM).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ht.HIGHLIGHT_DEFAULT_COLOR,Jt._defaultColor],[Ht.HIGHLIGHT_THICKNESS,Jt._defaultThickness]]}get propertiesToUpdate(){return[[Ht.HIGHLIGHT_COLOR,this.color||Jt._defaultColor],[Ht.HIGHLIGHT_THICKNESS,g(this,Oi)||Jt._defaultThickness],[Ht.HIGHLIGHT_FREE,g(this,un)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",C(this,Wh,new xm({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,It,Tf).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,M(this,It,Tf).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){M(this,It,zA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,It,wr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var o;let n=!1;this.parent&&!e?M(this,It,zA).call(this):e&&(M(this,It,wr).call(this,e),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var r,u,c;const{drawLayer:n}=this.parent;let o;g(this,un)?(e=(e-this.rotation+360)%360,o=M(r=Jt,Gi,Uu).call(r,g(this,Fi).box,e)):o=M(u=Jt,Gi,Uu).call(u,[this.x,this.y,this.width,this.height],e),n.updateProperties(g(this,hi),{bbox:o,root:{"data-main-rotation":e}}),n.updateProperties(g(this,Sn),{bbox:M(c=Jt,Gi,Uu).call(c,g(this,$n).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();g(this,Bc)&&(e.setAttribute("aria-label",g(this,Bc)),e.setAttribute("role","mark")),g(this,un)?e.classList.add("free"):this.div.addEventListener("keydown",M(this,It,qM).bind(this),{signal:this._uiManager._signal});const n=C(this,El,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=g(this,Sl);const[o,r]=this.parentDimensions;return this.setDims(this.width*o,this.height*r),hw(this,g(this,El),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,Sn),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,Sn),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:M(this,It,lm).call(this,!0);break;case 1:case 3:M(this,It,lm).call(this,!1);break}}select(){var e;super.select(),g(this,Sn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,Sn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),g(this,Sn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,Sn),{rootClass:{selected:!1}}),g(this,un)||M(this,It,lm).call(this,!1))}get _mustFixPosition(){return!g(this,un)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(g(this,hi),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(g(this,Sn),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:o,x:r,y:u}){const{x:c,y:f,width:h,height:y}=o.getBoundingClientRect(),A=new AbortController,S=e.combinedSignal(A),E=b=>{A.abort(),M(this,Gi,XM).call(this,e,b)};window.addEventListener("blur",E,{signal:S}),window.addEventListener("pointerup",E,{signal:S}),window.addEventListener("pointerdown",Pe,{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",us,{signal:S}),o.addEventListener("pointermove",M(this,Gi,YM).bind(this,e),{signal:S}),this._freeHighlight=new BA({x:r,y:u},[c,f,h,y],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,o){var x,N,D,k;let r=null;if(e instanceof SM){const{data:{quadPoints:L,rect:U,rotation:P,id:G,color:F,opacity:$,popupRef:X},parent:{page:{pageNumber:et}}}=e;r=e={annotationType:Nt.HIGHLIGHT,color:Array.from(F),opacity:$,quadPoints:L,boxes:null,pageIndex:et-1,rect:U.slice(0),rotation:P,annotationElementId:G,id:G,deleted:!1,popupRef:X}}else if(e instanceof bT){const{data:{inkLists:L,rect:U,rotation:P,id:G,color:F,borderStyle:{rawWidth:$},popupRef:X},parent:{page:{pageNumber:et}}}=e;r=e={annotationType:Nt.HIGHLIGHT,color:Array.from(F),thickness:$,inkLists:L,boxes:null,pageIndex:et-1,rect:U.slice(0),rotation:P,annotationElementId:G,id:G,deleted:!1,popupRef:X}}const{color:u,quadPoints:c,inkLists:f,opacity:h}=e,y=await super.deserialize(e,n,o);y.color=Et.makeHexColor(...u),C(y,Po,h||1),f&&C(y,Oi,e.thickness),y._initialData=r;const[A,S]=y.pageDimensions,[E,b]=y.pageTranslation;if(c){const L=C(y,Io,[]);for(let U=0;U<c.length;U+=8)L.push({x:(c[U]-E)/A,y:1-(c[U+1]-b)/S,width:(c[U+2]-c[U])/A,height:(c[U+1]-c[U+5])/S});M(x=y,It,qA).call(x),M(N=y,It,wr).call(N),y.rotate(y.rotation)}else if(f){C(y,un,!0);const L=f[0],U={x:L[0]-E,y:S-(L[1]-b)},P=new BA(U,[0,0,A,S],1,g(y,Oi)/2,!0,.001);for(let $=0,X=L.length;$<X;$+=2)U.x=L[$]-E,U.y=S-(L[$+1]-b),P.add(U);const{id:G,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:y.color,"fill-opacity":y._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:P.toSVGPath()}},!0,!0);M(D=y,It,rm).call(D,{highlightOutlines:P.getOutlines(),highlightId:G,clipPathId:F}),M(k=y,It,wr).call(k),y.rotate(y.parentRotation)}return y}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),o=de._colorManager.convert(this.color),r={annotationType:Nt.HIGHLIGHT,color:o,opacity:g(this,Po),thickness:g(this,Oi),quadPoints:M(this,It,zM).call(this),outlines:M(this,It,$M).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:M(this,It,Tf).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!M(this,It,JM).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Fc=new WeakMap,Kh=new WeakMap,Io=new WeakMap,Sl=new WeakMap,Wh=new WeakMap,$n=new WeakMap,Qh=new WeakMap,Zh=new WeakMap,El=new WeakMap,Fi=new WeakMap,hi=new WeakMap,un=new WeakMap,Oc=new WeakMap,Po=new WeakMap,Sn=new WeakMap,Bc=new WeakMap,Oi=new WeakMap,jh=new WeakMap,It=new WeakSet,qA=function(){const e=new FA(g(this,Io),.001);C(this,Fi,e.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,Fi).box;const n=new FA(g(this,Io),.0025,.001,this._uiManager.direction==="ltr");C(this,$n,n.getOutlines());const{lastPoint:o}=g(this,$n);C(this,Oc,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},rm=function({highlightOutlines:e,highlightId:n,clipPathId:o}){var A,S;if(C(this,Fi,e),C(this,$n,e.getNewOutline(g(this,Oi)/2+1.5,.0025)),n>=0)C(this,hi,n),C(this,Sl,o),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),C(this,Sn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,$n).box,path:{d:g(this,$n).toSVGPath()}},!0));else if(this.parent){const E=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,hi),{bbox:M(A=Jt,Gi,Uu).call(A,g(this,Fi).box,(E-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,Sn),{bbox:M(S=Jt,Gi,Uu).call(S,g(this,$n).box,E),path:{d:g(this,$n).toSVGPath()}})}const[u,c,f,h]=e.box;switch(this.rotation){case 0:this.x=u,this.y=c,this.width=f,this.height=h;break;case 90:{const[E,b]=this.parentDimensions;this.x=c,this.y=1-u,this.width=f*b/E,this.height=h*E/b;break}case 180:this.x=1-u,this.y=1-c,this.width=f,this.height=h;break;case 270:{const[E,b]=this.parentDimensions;this.x=1-c,this.y=u,this.width=f*b/E,this.height=h*E/b;break}}const{lastPoint:y}=g(this,$n);C(this,Oc,[(y[0]-u)/f,(y[1]-c)/h])},GM=function(e){const n=(u,c)=>{var f,h;this.color=u,C(this,Po,c),(f=this.parent)==null||f.drawLayer.updateProperties(g(this,hi),{root:{fill:u,"fill-opacity":c}}),(h=g(this,Wh))==null||h.updateColor(u)},o=this.color,r=g(this,Po);this.addCommands({cmd:n.bind(this,e,Jt._defaultOpacity),undo:n.bind(this,o,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ht.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},VM=function(e){const n=g(this,Oi),o=r=>{C(this,Oi,r),M(this,It,HM).call(this,r)};this.addCommands({cmd:o.bind(this,e),undo:o.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ht.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},HM=function(e){if(!g(this,un))return;M(this,It,rm).call(this,{highlightOutlines:g(this,Fi).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)},zA=function(){g(this,hi)===null||!this.parent||(this.parent.drawLayer.remove(g(this,hi)),C(this,hi,null),this.parent.drawLayer.remove(g(this,Sn)),C(this,Sn,null))},wr=function(e=this.parent){g(this,hi)===null&&({id:xn(this,hi)._,clipPathId:xn(this,Sl)._}=e.drawLayer.draw({bbox:g(this,Fi).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":g(this,Po)},rootClass:{highlight:!0,free:g(this,un)},path:{d:g(this,Fi).toSVGPath()}},!1,!0),C(this,Sn,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,un)},bbox:g(this,$n).box,path:{d:g(this,$n).toSVGPath()}},g(this,un))),g(this,El)&&(g(this,El).style.clipPath=g(this,Sl)))},Gi=new WeakSet,Uu=function([e,n,o,r],u){switch(u){case 90:return[1-n-r,e,r,o];case 180:return[1-e-o,1-n-r,o,r];case 270:return[n,1-e-o,r,o]}return[e,n,o,r]},qM=function(e){Jt._keyboardManager.exec(this,e)},lm=function(e){if(!g(this,Fc))return;const n=window.getSelection();e?n.setPosition(g(this,Fc),g(this,Kh)):n.setPosition(g(this,Qh),g(this,Zh))},Tf=function(){return g(this,un)?this.rotation:0},zM=function(){if(g(this,un))return null;const[e,n]=this.pageDimensions,[o,r]=this.pageTranslation,u=g(this,Io),c=new Float32Array(u.length*8);let f=0;for(const{x:h,y,width:A,height:S}of u){const E=h*e+o,b=(1-y)*n+r;c[f]=c[f+4]=E,c[f+1]=c[f+3]=b,c[f+2]=c[f+6]=E+A*e,c[f+5]=c[f+7]=b-S*n,f+=8}return c},$M=function(e){return g(this,Fi).serialize(e,M(this,It,Tf).call(this))},YM=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},XM=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},JM=function(e){const{color:n}=this._initialData;return e.color.some((o,r)=>o!==n[r])},w(Jt,Gi),ot(Jt,"_defaultColor",null),ot(Jt,"_defaultOpacity",1),ot(Jt,"_defaultThickness",12),ot(Jt,"_type","highlight"),ot(Jt,"_editorType",Nt.HIGHLIGHT),ot(Jt,"_freeHighlightId",-1),ot(Jt,"_freeHighlight",null),ot(Jt,"_freeHighlightClipId","");let _m=Jt;var Cl;class KM{constructor(){w(this,Cl,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){g(this,Cl)[t]=e}toSVGProperties(){const t=g(this,Cl);return C(this,Cl,Object.create(null)),{root:t}}reset(){C(this,Cl,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){oe("Not implemented")}}Cl=new WeakMap;var pi,Gc,We,bl,xl,za,$a,Ya,_l,zt,$A,YA,XA,Sf,WM,um,Ef,Fu;const ft=class ft extends de{constructor(e){super(e);w(this,zt);w(this,pi,null);w(this,Gc);ot(this,"_drawId",null);C(this,Gc,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(M(this,zt,$A).call(this,e),M(this,zt,Sf).call(this))}static _mergeSVGProperties(e,n){const o=new Set(Object.keys(e));for(const[r,u]of Object.entries(n))o.has(r)?Object.assign(e[r],u):e[r]=u;return e}static getDefaultDrawingOptions(e){oe("Not implemented")}static get typesMap(){oe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const o=this.typesMap.get(e);o&&this._defaultDrawingOptions.updateProperty(o,n),this._currentParent&&(g(ft,We).updateProperty(o,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const o=this.constructor.typesMap.get(e);o&&this._updateProperty(e,o,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[o,r]of this.typesMap)e.push([o,n[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[o,r]of this.constructor.typesMap)e.push([o,n[r]]);return e}_updateProperty(e,n,o){const r=this._drawingOptions,u=r[n],c=f=>{var y;r.updateProperty(n,f);const h=g(this,pi).updateProperty(n,f);h&&M(this,zt,Ef).call(this,h),(y=this.parent)==null||y.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:c.bind(this,o),undo:c.bind(this,u),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(g(this,pi).getPathResizingSVGProperties(M(this,zt,um).call(this)),{bbox:M(this,zt,Fu).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(g(this,pi).getPathResizedSVGProperties(M(this,zt,um).call(this)),{bbox:M(this,zt,Fu).call(this)}))}_onTranslating(e,n){var o;(o=this.parent)==null||o.drawLayer.updateProperties(this._drawId,{bbox:M(this,zt,Fu).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(g(this,pi).getPathTranslatedSVGProperties(M(this,zt,um).call(this),this.parentDimensions),{bbox:M(this,zt,Fu).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,Gc)&&(C(this,Gc,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){M(this,zt,XA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,zt,Sf).call(this),M(this,zt,Ef).call(this,g(this,pi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var o;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),M(this,zt,XA).call(this)):e&&(this._uiManager.addShouldRescale(this),M(this,zt,Sf).call(this,e),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties({bbox:M(this,zt,Fu).call(this)},g(this,pi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,zt,Ef).call(this,g(this,pi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,n;this._isCopy&&(e=this.x,n=this.y);const o=super.render();o.classList.add("draw");const r=document.createElement("div");o.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[u,c]=this.parentDimensions;return this.setDims(this.width*u,this.height*c),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,n),o}static createDrawerInstance(e,n,o,r,u){oe("Not implemented")}static startDrawing(e,n,o,r){var N;const{target:u,offsetX:c,offsetY:f,pointerId:h,pointerType:y}=r;if(g(ft,$a)&&g(ft,$a)!==y)return;const{viewport:{rotation:A}}=e,{width:S,height:E}=u.getBoundingClientRect(),b=C(ft,bl,new AbortController),x=e.combinedSignal(b);if(g(ft,za)||C(ft,za,h),g(ft,$a)??C(ft,$a,y),window.addEventListener("pointerup",D=>{var k;g(ft,za)===D.pointerId?this._endDraw(D):(k=g(ft,Ya))==null||k.delete(D.pointerId)},{signal:x}),window.addEventListener("pointercancel",D=>{var k;g(ft,za)===D.pointerId?this._currentParent.endDrawingSession():(k=g(ft,Ya))==null||k.delete(D.pointerId)},{signal:x}),window.addEventListener("pointerdown",D=>{g(ft,$a)===D.pointerType&&((g(ft,Ya)||C(ft,Ya,new Set)).add(D.pointerId),g(ft,We).isCancellable()&&(g(ft,We).removeLastElement(),g(ft,We).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",us,{signal:x}),u.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),u.addEventListener("touchmove",D=>{D.timeStamp===g(ft,_l)&&Pe(D)},{signal:x}),e.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),g(ft,We)){e.drawLayer.updateProperties(this._currentDrawId,g(ft,We).startNew(c,f,S,E,A));return}n.updateUIForDefaultProperties(this),C(ft,We,this.createDrawerInstance(c,f,S,E,A)),C(ft,xl,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(g(ft,xl).toSVGProperties(),g(ft,We).defaultSVGProperties),!0,!1)}static _drawMove(e){var u;if(C(ft,_l,-1),!g(ft,We))return;const{offsetX:n,offsetY:o,pointerId:r}=e;if(g(ft,za)===r){if(((u=g(ft,Ya))==null?void 0:u.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(ft,We).add(n,o)),C(ft,_l,e.timeStamp),Pe(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,C(ft,We,null),C(ft,xl,null),C(ft,$a,null),C(ft,_l,NaN)),g(ft,bl)&&(g(ft,bl).abort(),C(ft,bl,null),C(ft,za,NaN),C(ft,Ya,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,g(ft,We).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const o=g(ft,We),r=this._currentDrawId,u=o.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(r,o.setLastElement(u))},undo:()=>{n.drawLayer.updateProperties(r,o.removeLastElement())},mustExec:!1,type:Ht.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Ht.DRAW_STEP),!g(ft,We).isEmpty()){const{pageDimensions:[o,r],scale:u}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(ft,We).getOutlines(o*u,r*u,u,this._INNER_MARGIN),drawingOptions:g(ft,xl),mustBeCommitted:!e});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,o,r,u,c){oe("Not implemented")}static async deserialize(e,n,o){var A,S;const{rawDims:{pageWidth:r,pageHeight:u,pageX:c,pageY:f}}=n.viewport,h=this.deserializeDraw(c,f,r,u,this._INNER_MARGIN,e),y=await super.deserialize(e,n,o);return y.createDrawingOptions(e),M(A=y,zt,$A).call(A,{drawOutlines:h}),M(S=y,zt,Sf).call(S),y.onScaleChanging(),y.rotate(),y}serializeDraw(e){const[n,o]=this.pageTranslation,[r,u]=this.pageDimensions;return g(this,pi).serialize([n,o,r,u],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};pi=new WeakMap,Gc=new WeakMap,We=new WeakMap,bl=new WeakMap,xl=new WeakMap,za=new WeakMap,$a=new WeakMap,Ya=new WeakMap,_l=new WeakMap,zt=new WeakSet,$A=function({drawOutlines:e,drawId:n,drawingOptions:o}){C(this,pi,e),this._drawingOptions||(this._drawingOptions=o),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=M(this,zt,YA).call(this,e,this.parent),M(this,zt,Ef).call(this,e.box)},YA=function(e,n){const{id:o}=n.drawLayer.draw(ft._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return o},XA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Sf=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,zt,YA).call(this,g(this,pi),e)}},WM=function([e,n,o,r]){const{parentDimensions:[u,c],rotation:f}=this;switch(f){case 90:return[n,1-e,o*(c/u),r*(u/c)];case 180:return[1-e,1-n,o,r];case 270:return[1-n,e,o*(c/u),r*(u/c)];default:return[e,n,o,r]}},um=function(){const{x:e,y:n,width:o,height:r,parentDimensions:[u,c],rotation:f}=this;switch(f){case 90:return[1-n,e,o*(u/c),r*(c/u)];case 180:return[1-e,1-n,o,r];case 270:return[n,1-e,o*(u/c),r*(c/u)];default:return[e,n,o,r]}},Ef=function(e){if([this.x,this.y,this.width,this.height]=M(this,zt,WM).call(this,e),this.div){this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)}this._onResized()},Fu=function(){const{x:e,y:n,width:o,height:r,rotation:u,parentRotation:c,parentDimensions:[f,h]}=this;switch((u*4+c)/90){case 1:return[1-n-r,e,r,o];case 2:return[1-e-o,1-n-r,o,r];case 3:return[n,1-e-o,r,o];case 4:return[e,n-o*(f/h),r*(h/f),o*(f/h)];case 5:return[1-n,e,o*(f/h),r*(h/f)];case 6:return[1-e-r*(h/f),1-n,r*(h/f),o*(f/h)];case 7:return[n-o*(f/h),1-e-r*(h/f),o*(f/h),r*(h/f)];case 8:return[e-o,n-r,o,r];case 9:return[1-n,e-o,r,o];case 10:return[1-e,1-n,o,r];case 11:return[n-r,1-e,r,o];case 12:return[e-r*(h/f),n,r*(h/f),o*(f/h)];case 13:return[1-n-o*(f/h),e-r*(h/f),o*(f/h),r*(h/f)];case 14:return[1-e,1-n-o*(f/h),r*(h/f),o*(f/h)];case 15:return[n,1-e,o*(f/h),r*(h/f)];default:return[e,n,o,r]}},ot(ft,"_currentDrawId",-1),ot(ft,"_currentParent",null),w(ft,We,null),w(ft,bl,null),w(ft,xl,null),w(ft,za,NaN),w(ft,$a,null),w(ft,Ya,null),w(ft,_l,NaN),ot(ft,"_INNER_MARGIN",3);let wm=ft;var Ns,Qe,Ze,wl,Vc,Mn,cn,Bi,Ml,Rl,Nl,Hc,cm;class Z3{constructor(t,e,n,o,r,u){w(this,Hc);w(this,Ns,new Float64Array(6));w(this,Qe);w(this,Ze);w(this,wl);w(this,Vc);w(this,Mn);w(this,cn,"");w(this,Bi,0);w(this,Ml,new up);w(this,Rl);w(this,Nl);C(this,Rl,n),C(this,Nl,o),C(this,wl,r),C(this,Vc,u),[t,e]=M(this,Hc,cm).call(this,t,e);const c=C(this,Qe,[NaN,NaN,NaN,NaN,t,e]);C(this,Mn,[t,e]),C(this,Ze,[{line:c,points:g(this,Mn)}]),g(this,Ns).set(c,0)}updateProperty(t,e){t==="stroke-width"&&C(this,Vc,e)}isEmpty(){return!g(this,Ze)||g(this,Ze).length===0}isCancellable(){return g(this,Mn).length<=10}add(t,e){[t,e]=M(this,Hc,cm).call(this,t,e);const[n,o,r,u]=g(this,Ns).subarray(2,6),c=t-r,f=e-u;return Math.hypot(g(this,Rl)*c,g(this,Nl)*f)<=2?null:(g(this,Mn).push(t,e),isNaN(n)?(g(this,Ns).set([r,u,t,e],2),g(this,Qe).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(g(this,Ns)[0])&&g(this,Qe).splice(6,6),g(this,Ns).set([n,o,r,u,t,e],0),g(this,Qe).push(...dt.createBezierPoints(n,o,r,u,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(g(this,Mn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,o,r){C(this,Rl,n),C(this,Nl,o),C(this,wl,r),[t,e]=M(this,Hc,cm).call(this,t,e);const u=C(this,Qe,[NaN,NaN,NaN,NaN,t,e]);C(this,Mn,[t,e]);const c=g(this,Ze).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),g(this,Ze).push({line:u,points:g(this,Mn)}),g(this,Ns).set(u,0),C(this,Bi,0),this.toSVGPath(),null}getLastElement(){return g(this,Ze).at(-1)}setLastElement(t){return g(this,Ze)?(g(this,Ze).push(t),C(this,Qe,t.line),C(this,Mn,t.points),C(this,Bi,0),{path:{d:this.toSVGPath()}}):g(this,Ml).setLastElement(t)}removeLastElement(){if(!g(this,Ze))return g(this,Ml).removeLastElement();g(this,Ze).pop(),C(this,cn,"");for(let t=0,e=g(this,Ze).length;t<e;t++){const{line:n,points:o}=g(this,Ze)[t];C(this,Qe,n),C(this,Mn,o),C(this,Bi,0),this.toSVGPath()}return{path:{d:g(this,cn)}}}toSVGPath(){const t=dt.svgRound(g(this,Qe)[4]),e=dt.svgRound(g(this,Qe)[5]);if(g(this,Mn).length===2)return C(this,cn,`${g(this,cn)} M ${t} ${e} Z`),g(this,cn);if(g(this,Mn).length<=6){const o=g(this,cn).lastIndexOf("M");C(this,cn,`${g(this,cn).slice(0,o)} M ${t} ${e}`),C(this,Bi,6)}if(g(this,Mn).length===4){const o=dt.svgRound(g(this,Qe)[10]),r=dt.svgRound(g(this,Qe)[11]);return C(this,cn,`${g(this,cn)} L ${o} ${r}`),C(this,Bi,12),g(this,cn)}const n=[];g(this,Bi)===0&&(n.push(`M ${t} ${e}`),C(this,Bi,6));for(let o=g(this,Bi),r=g(this,Qe).length;o<r;o+=6){const[u,c,f,h,y,A]=g(this,Qe).slice(o,o+6).map(dt.svgRound);n.push(`C${u} ${c} ${f} ${h} ${y} ${A}`)}return C(this,cn,g(this,cn)+n.join(" ")),C(this,Bi,g(this,Qe).length),g(this,cn)}getOutlines(t,e,n,o){const r=g(this,Ze).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),g(this,Ml).build(g(this,Ze),t,e,n,g(this,wl),g(this,Vc),o),C(this,Ns,null),C(this,Qe,null),C(this,Ze,null),C(this,cn,null),g(this,Ml)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ns=new WeakMap,Qe=new WeakMap,Ze=new WeakMap,wl=new WeakMap,Vc=new WeakMap,Mn=new WeakMap,cn=new WeakMap,Bi=new WeakMap,Ml=new WeakMap,Rl=new WeakMap,Nl=new WeakMap,Hc=new WeakSet,cm=function(t,e){return dt._normalizePoint(t,e,g(this,Rl),g(this,Nl),g(this,wl))};var Rn,tp,ep,gi,Ds,Is,qc,zc,Dl,fn,oo,QM,ZM,jM;class up extends dt{constructor(){super(...arguments);w(this,fn);w(this,Rn);w(this,tp,0);w(this,ep);w(this,gi);w(this,Ds);w(this,Is);w(this,qc);w(this,zc);w(this,Dl)}build(e,n,o,r,u,c,f){C(this,Ds,n),C(this,Is,o),C(this,qc,r),C(this,zc,u),C(this,Dl,c),C(this,ep,f??0),C(this,gi,e),M(this,fn,ZM).call(this)}get thickness(){return g(this,Dl)}setLastElement(e){return g(this,gi).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,gi).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of g(this,gi)){if(e.push(`M${dt.svgRound(n[4])} ${dt.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12&&isNaN(n[6])){e.push(`L${dt.svgRound(n[10])} ${dt.svgRound(n[11])}`);continue}for(let o=6,r=n.length;o<r;o+=6){const[u,c,f,h,y,A]=n.subarray(o,o+6).map(dt.svgRound);e.push(`C${u} ${c} ${f} ${h} ${y} ${A}`)}}return e.join("")}serialize([e,n,o,r],u){const c=[],f=[],[h,y,A,S]=M(this,fn,QM).call(this);let E,b,x,N,D,k,L,U,P;switch(g(this,zc)){case 0:P=dt._rescale,E=e,b=n+r,x=o,N=-r,D=e+h*o,k=n+(1-y-S)*r,L=e+(h+A)*o,U=n+(1-y)*r;break;case 90:P=dt._rescaleAndSwap,E=e,b=n,x=o,N=r,D=e+y*o,k=n+h*r,L=e+(y+S)*o,U=n+(h+A)*r;break;case 180:P=dt._rescale,E=e+o,b=n,x=-o,N=r,D=e+(1-h-A)*o,k=n+y*r,L=e+(1-h)*o,U=n+(y+S)*r;break;case 270:P=dt._rescaleAndSwap,E=e+o,b=n+r,x=-o,N=-r,D=e+(1-y-S)*o,k=n+(1-h-A)*r,L=e+(1-y)*o,U=n+(1-h)*r;break}for(const{line:G,points:F}of g(this,gi))c.push(P(G,E,b,x,N,u?new Array(G.length):null)),f.push(P(F,E,b,x,N,u?new Array(F.length):null));return{lines:c,points:f,rect:[D,k,L,U]}}static deserialize(e,n,o,r,u,{paths:{lines:c,points:f},rotation:h,thickness:y}){const A=[];let S,E,b,x,N;switch(h){case 0:N=dt._rescale,S=-e/o,E=n/r+1,b=1/o,x=-1/r;break;case 90:N=dt._rescaleAndSwap,S=-n/r,E=-e/o,b=1/r,x=1/o;break;case 180:N=dt._rescale,S=e/o+1,E=-n/r,b=-1/o,x=1/r;break;case 270:N=dt._rescaleAndSwap,S=n/r+1,E=e/o+1,b=-1/r,x=-1/o;break}if(!c){c=[];for(const k of f){const L=k.length;if(L===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(L===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const U=new Float32Array(3*(L-2));c.push(U);let[P,G,F,$]=k.subarray(0,4);U.set([NaN,NaN,NaN,NaN,P,G],0);for(let X=4;X<L;X+=2){const et=k[X],Q=k[X+1];U.set(dt.createBezierPoints(P,G,F,$,et,Q),(X-2)*3),[P,G,F,$]=[F,$,et,Q]}}}for(let k=0,L=c.length;k<L;k++)A.push({line:N(c[k].map(U=>U??NaN),S,E,b,x),points:N(f[k].map(U=>U??NaN),S,E,b,x)});const D=new this.prototype.constructor;return D.build(A,o,r,1,h,y,u),D}get box(){return g(this,Rn)}updateProperty(e,n){return e==="stroke-width"?M(this,fn,jM).call(this,n):null}updateParentDimensions([e,n],o){const[r,u]=M(this,fn,oo).call(this);C(this,Ds,e),C(this,Is,n),C(this,qc,o);const[c,f]=M(this,fn,oo).call(this),h=c-r,y=f-u,A=g(this,Rn);return A[0]-=h,A[1]-=y,A[2]+=2*h,A[3]+=2*y,A}updateRotation(e){return C(this,tp,e),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,Rn).map(dt.svgRound).join(" ")}get defaultProperties(){const[e,n]=g(this,Rn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=g(this,Rn);let o=0,r=0,u=0,c=0,f=0,h=0;switch(g(this,tp)){case 90:r=n/e,u=-e/n,f=e;break;case 180:o=-1,c=-1,f=e,h=n;break;case 270:r=-n/e,u=e/n,h=n;break;default:return""}return`matrix(${o} ${r} ${u} ${c} ${dt.svgRound(f)} ${dt.svgRound(h)})`}getPathResizingSVGProperties([e,n,o,r]){const[u,c]=M(this,fn,oo).call(this),[f,h,y,A]=g(this,Rn);if(Math.abs(y-u)<=dt.PRECISION||Math.abs(A-c)<=dt.PRECISION){const N=e+o/2-(f+y/2),D=n+r/2-(h+A/2);return{path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${D})`}}}const S=(o-2*u)/(y-2*u),E=(r-2*c)/(A-2*c),b=y/o,x=A/r;return{path:{"transform-origin":`${dt.svgRound(f)} ${dt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${x}) translate(${dt.svgRound(u)} ${dt.svgRound(c)}) scale(${S} ${E}) translate(${dt.svgRound(-u)} ${dt.svgRound(-c)})`}}}getPathResizedSVGProperties([e,n,o,r]){const[u,c]=M(this,fn,oo).call(this),f=g(this,Rn),[h,y,A,S]=f;if(f[0]=e,f[1]=n,f[2]=o,f[3]=r,Math.abs(A-u)<=dt.PRECISION||Math.abs(S-c)<=dt.PRECISION){const D=e+o/2-(h+A/2),k=n+r/2-(y+S/2);for(const{line:L,points:U}of g(this,gi))dt._translate(L,D,k,L),dt._translate(U,D,k,U);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const E=(o-2*u)/(A-2*u),b=(r-2*c)/(S-2*c),x=-E*(h+u)+e+u,N=-b*(y+c)+n+c;if(E!==1||b!==1||x!==0||N!==0)for(const{line:D,points:k}of g(this,gi))dt._rescale(D,x,N,E,b,D),dt._rescale(k,x,N,E,b,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],o){const[r,u]=o,c=g(this,Rn),f=e-c[0],h=n-c[1];if(g(this,Ds)===r&&g(this,Is)===u)for(const{line:y,points:A}of g(this,gi))dt._translate(y,f,h,y),dt._translate(A,f,h,A);else{const y=g(this,Ds)/r,A=g(this,Is)/u;C(this,Ds,r),C(this,Is,u);for(const{line:S,points:E}of g(this,gi))dt._rescale(S,f,h,y,A,S),dt._rescale(E,f,h,y,A,E);c[2]*=y,c[3]*=A}return c[0]=e,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(n)}`}}}get defaultSVGProperties(){const e=g(this,Rn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${dt.svgRound(e[0])} ${dt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}Rn=new WeakMap,tp=new WeakMap,ep=new WeakMap,gi=new WeakMap,Ds=new WeakMap,Is=new WeakMap,qc=new WeakMap,zc=new WeakMap,Dl=new WeakMap,fn=new WeakSet,oo=function(e=g(this,Dl)){const n=g(this,ep)+e/2*g(this,qc);return g(this,zc)%180===0?[n/g(this,Ds),n/g(this,Is)]:[n/g(this,Is),n/g(this,Ds)]},QM=function(){const[e,n,o,r]=g(this,Rn),[u,c]=M(this,fn,oo).call(this,0);return[e+u,n+c,o-2*u,r-2*c]},ZM=function(){const e=C(this,Rn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of g(this,gi)){if(r.length<=12){for(let f=4,h=r.length;f<h;f+=6)Et.pointBoundingBox(r[f],r[f+1],e);continue}let u=r[4],c=r[5];for(let f=6,h=r.length;f<h;f+=6){const[y,A,S,E,b,x]=r.subarray(f,f+6);Et.bezierBoundingBox(u,c,y,A,S,E,b,x,e),u=b,c=x}}const[n,o]=M(this,fn,oo).call(this);e[0]=In(e[0]-n,0,1),e[1]=In(e[1]-o,0,1),e[2]=In(e[2]+n,0,1),e[3]=In(e[3]+o,0,1),e[2]-=e[0],e[3]-=e[1]},jM=function(e){const[n,o]=M(this,fn,oo).call(this);C(this,Dl,e);const[r,u]=M(this,fn,oo).call(this),[c,f]=[r-n,u-o],h=g(this,Rn);return h[0]-=c,h[1]-=f,h[2]+=2*c,h[3]+=2*f,h};class ey extends KM{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:de._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new ey(this._viewParameters);return t.updateAll(this),t}}var $m,t1;const Vu=class Vu extends wm{constructor(e){super({...e,name:"inkEditor"});w(this,$m);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,n){de.initialize(e,n),this._defaultDrawingOptions=new ey(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Gt(this,"typesMap",new Map([[Ht.INK_THICKNESS,"stroke-width"],[Ht.INK_COLOR,"stroke"],[Ht.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,o,r,u){return new Z3(e,n,o,r,u,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,o,r,u,c){return up.deserialize(e,n,o,r,u,c)}static async deserialize(e,n,o){let r=null;if(e instanceof bT){const{data:{inkLists:c,rect:f,rotation:h,id:y,color:A,opacity:S,borderStyle:{rawWidth:E},popupRef:b},parent:{page:{pageNumber:x}}}=e;r=e={annotationType:Nt.INK,color:Array.from(A),thickness:E,opacity:S,paths:{points:c},boxes:null,pageIndex:x-1,rect:f.slice(0),rotation:h,annotationElementId:y,id:y,deleted:!1,popupRef:b}}const u=await super.deserialize(e,n,o);return u._initialData=r,u}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:o}=this;n.updateSVGProperty("stroke-width"),o.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:o}){this._drawingOptions=Vu.getDefaultDrawingOptions({stroke:Et.makeHexColor(...e),"stroke-width":n,"stroke-opacity":o})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:o,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:u,"stroke-opacity":c,"stroke-width":f}}=this,h={annotationType:Nt.INK,color:de._colorManager.convert(u),opacity:c,thickness:f,paths:{lines:n,points:o},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!M(this,$m,t1).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){const{points:n,rect:o}=this.serializeDraw(!1);return e.updateEdited({rect:o,thickness:this._drawingOptions["stroke-width"],points:n}),null}};$m=new WeakSet,t1=function(e){const{color:n,thickness:o,opacity:r,pageIndex:u}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,f)=>c!==n[f])||e.thickness!==o||e.opacity!==r||e.pageIndex!==u},ot(Vu,"_type","ink"),ot(Vu,"_editorType",Nt.INK),ot(Vu,"_defaultDrawingOptions",null);let JA=Vu;class KA extends up{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Ug=8,of=3;var Il,Kt,WA,os,e1,n1,QA,dm,i1,s1,o1,ZA,jA,a1;class Bo{static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:o},r,u,c,f){let h=new OffscreenCanvas(1,1),y=h.getContext("2d",{alpha:!1});const A=200,S=y.font=`${n} ${o} ${A}px ${e}`,{actualBoundingBoxLeft:E,actualBoundingBoxRight:b,actualBoundingBoxAscent:x,actualBoundingBoxDescent:N,fontBoundingBoxAscent:D,fontBoundingBoxDescent:k,width:L}=y.measureText(t),U=1.5,P=Math.ceil(Math.max(Math.abs(E)+Math.abs(b)||0,L)*U),G=Math.ceil(Math.max(Math.abs(x)+Math.abs(N)||A,Math.abs(D)+Math.abs(k)||A)*U);h=new OffscreenCanvas(P,G),y=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),y.font=S,y.filter="grayscale(1)",y.fillStyle="white",y.fillRect(0,0,P,G),y.fillStyle="black",y.fillText(t,P*(U-1)/2,G*(3-U)/2);const F=M(this,Kt,ZA).call(this,y.getImageData(0,0,P,G).data),$=M(this,Kt,o1).call(this,F),X=M(this,Kt,jA).call(this,$),et=M(this,Kt,QA).call(this,F,P,G,X);return this.processDrawnLines({lines:{curves:et,width:P,height:G},pageWidth:r,pageHeight:u,rotation:c,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(t,e,n,o,r){const[u,c,f]=M(this,Kt,a1).call(this,t),[h,y]=M(this,Kt,s1).call(this,u,c,f,Math.hypot(c,f)*g(this,Il).sigmaSFactor,g(this,Il).sigmaR,g(this,Il).kernelSize),A=M(this,Kt,jA).call(this,y),S=M(this,Kt,QA).call(this,h,c,f,A);return this.processDrawnLines({lines:{curves:S,width:c,height:f},pageWidth:e,pageHeight:n,rotation:o,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:o,innerMargin:r,mustSmooth:u,areContours:c}){o%180!==0&&([e,n]=[n,e]);const{curves:f,width:h,height:y}=t,A=t.thickness??0,S=[],E=Math.min(e/h,n/y),b=E/e,x=E/n,N=[];for(const{points:k}of f){const L=u?M(this,Kt,i1).call(this,k):k;if(!L)continue;N.push(L);const U=L.length,P=new Float32Array(U),G=new Float32Array(3*(U===2?2:U-2));if(S.push({line:G,points:P}),U===2){P[0]=L[0]*b,P[1]=L[1]*x,G.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[F,$,X,et]=L;F*=b,$*=x,X*=b,et*=x,P.set([F,$,X,et],0),G.set([NaN,NaN,NaN,NaN,F,$],0);for(let Q=4;Q<U;Q+=2){const ut=P[Q]=L[Q]*b,Ct=P[Q+1]=L[Q+1]*x;G.set(dt.createBezierPoints(F,$,X,et,ut,Ct),(Q-2)*3),[F,$,X,et]=[X,et,ut,Ct]}}if(S.length===0)return null;const D=c?new KA:new up;return D.build(S,e,n,1,o,c?0:A,r),{outline:D,newCurves:N,areContours:c,thickness:A,width:h,height:y}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:o,height:r}){let u=1/0,c=-1/0,f=0;for(const L of t){f+=L.length;for(let U=2,P=L.length;U<P;U++){const G=L[U]-L[U-2];u=Math.min(u,G),c=Math.max(c,G)}}let h;u>=-128&&c<=127?h=Int8Array:u>=-32768&&c<=32767?h=Int16Array:h=Int32Array;const y=t.length,A=Ug+of*y,S=new Uint32Array(A);let E=0;S[E++]=A*Uint32Array.BYTES_PER_ELEMENT+(f-2*y)*h.BYTES_PER_ELEMENT,S[E++]=0,S[E++]=o,S[E++]=r,S[E++]=e?0:1,S[E++]=Math.max(0,Math.floor(n??0)),S[E++]=y,S[E++]=h.BYTES_PER_ELEMENT;for(const L of t)S[E++]=L.length-2,S[E++]=L[0],S[E++]=L[1];const b=new CompressionStream("deflate-raw"),x=b.writable.getWriter();await x.ready,x.write(S);const N=h.prototype.constructor;for(const L of t){const U=new N(L.length-2);for(let P=2,G=L.length;P<G;P++)U[P-2]=L[P]-L[P-2];x.write(U)}x.close();const D=await new Response(b.readable).arrayBuffer(),k=new Uint8Array(D);return aw(k)}static async decompressSignature(t){try{const e=EB(t),{readable:n,writable:o}=new DecompressionStream("deflate-raw"),r=o.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let u=null,c=0;for await(const L of n)u||(u=new Uint8Array(new Uint32Array(L.buffer,0,4)[0])),u.set(L,c),c+=L.length;const f=new Uint32Array(u.buffer,0,u.length>>2),h=f[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const y=f[2],A=f[3],S=f[4]===0,E=f[5],b=f[6],x=f[7],N=[],D=(Ug+of*b)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(x){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(u.buffer,D);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(u.buffer,D);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(u.buffer,D);break}c=0;for(let L=0;L<b;L++){const U=f[of*L+Ug],P=new Float32Array(U+2);N.push(P);for(let G=0;G<of-1;G++)P[G]=f[of*L+Ug+G+1];for(let G=0;G<U;G++)P[G+2]=P[G]+k[c++]}return{areContours:S,thickness:E,outlines:N,width:y,height:A}}catch(e){return Dt(`decompressSignature: ${e}`),null}}}Il=new WeakMap,Kt=new WeakSet,WA=function(t,e,n,o){return n-=t,o-=e,n===0?o>0?0:4:n===1?o+6:2-o},os=new WeakMap,e1=function(t,e,n,o,r,u,c){const f=M(this,Kt,WA).call(this,n,o,r,u);for(let h=0;h<8;h++){const y=(-h+f-c+16)%8,A=g(this,os)[2*y],S=g(this,os)[2*y+1];if(t[(n+A)*e+(o+S)]!==0)return y}return-1},n1=function(t,e,n,o,r,u,c){const f=M(this,Kt,WA).call(this,n,o,r,u);for(let h=0;h<8;h++){const y=(h+f+c+16)%8,A=g(this,os)[2*y],S=g(this,os)[2*y+1];if(t[(n+A)*e+(o+S)]!==0)return y}return-1},QA=function(t,e,n,o){const r=t.length,u=new Int32Array(r);for(let y=0;y<r;y++)u[y]=t[y]<=o?1:0;for(let y=1;y<n-1;y++)u[y*e]=u[y*e+e-1]=0;for(let y=0;y<e;y++)u[y]=u[e*n-1-y]=0;let c=1,f;const h=[];for(let y=1;y<n-1;y++){f=1;for(let A=1;A<e-1;A++){const S=y*e+A,E=u[S];if(E===0)continue;let b=y,x=A;if(E===1&&u[S-1]===0)c+=1,x-=1;else if(E>=1&&u[S+1]===0)c+=1,x+=1,E>1&&(f=E);else{E!==1&&(f=Math.abs(E));continue}const N=[A,y],D=x===A+1,k={isHole:D,points:N,id:c,parent:0};h.push(k);let L;for(const Q of h)if(Q.id===f){L=Q;break}L?L.isHole?k.parent=D?L.parent:f:k.parent=D?f:L.parent:k.parent=D?f:0;const U=M(this,Kt,e1).call(this,u,e,y,A,b,x,0);if(U===-1){u[S]=-c,u[S]!==1&&(f=Math.abs(u[S]));continue}let P=g(this,os)[2*U],G=g(this,os)[2*U+1];const F=y+P,$=A+G;b=F,x=$;let X=y,et=A;for(;;){const Q=M(this,Kt,n1).call(this,u,e,X,et,b,x,1);P=g(this,os)[2*Q],G=g(this,os)[2*Q+1];const ut=X+P,Ct=et+G;N.push(Ct,ut);const mt=X*e+et;if(u[mt+1]===0?u[mt]=-c:u[mt]===1&&(u[mt]=c),ut===y&&Ct===A&&X===F&&et===$){u[S]!==1&&(f=Math.abs(u[S]));break}else b=X,x=et,X=ut,et=Ct}}}return h},dm=function(t,e,n,o){if(n-e<=4){for(let F=e;F<n-2;F+=2)o.push(t[F],t[F+1]);return}const r=t[e],u=t[e+1],c=t[n-4]-r,f=t[n-3]-u,h=Math.hypot(c,f),y=c/h,A=f/h,S=y*u-A*r,E=f/c,b=1/h,x=Math.atan(E),N=Math.cos(x),D=Math.sin(x),k=b*(Math.abs(N)+Math.abs(D)),L=b*(1-k+k**2),U=Math.max(Math.atan(Math.abs(D+N)*L),Math.atan(Math.abs(D-N)*L));let P=0,G=e;for(let F=e+2;F<n-2;F+=2){const $=Math.abs(S-y*t[F+1]+A*t[F]);$>P&&(G=F,P=$)}P>(h*U)**2?(M(this,Kt,dm).call(this,t,e,G+2,o),M(this,Kt,dm).call(this,t,G,n,o)):o.push(r,u)},i1=function(t){const e=[],n=t.length;return M(this,Kt,dm).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e},s1=function(t,e,n,o,r,u){const c=new Float32Array(u**2),f=-2*o**2,h=u>>1;for(let x=0;x<u;x++){const N=(x-h)**2;for(let D=0;D<u;D++)c[x*u+D]=Math.exp((N+(D-h)**2)/f)}const y=new Float32Array(256),A=-2*r**2;for(let x=0;x<256;x++)y[x]=Math.exp(x**2/A);const S=t.length,E=new Uint8Array(S),b=new Uint32Array(256);for(let x=0;x<n;x++)for(let N=0;N<e;N++){const D=x*e+N,k=t[D];let L=0,U=0;for(let G=0;G<u;G++){const F=x+G-h;if(!(F<0||F>=n))for(let $=0;$<u;$++){const X=N+$-h;if(X<0||X>=e)continue;const et=t[F*e+X],Q=c[G*u+$]*y[Math.abs(et-k)];L+=et*Q,U+=Q}}const P=E[D]=Math.round(L/U);b[P]++}return[E,b]},o1=function(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e},ZA=function(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let o=-1/0,r=1/0;for(let c=0,f=n.length;c<f;c++){if(t[(c<<2)+3]===0){o=n[c]=255;continue}const y=n[c]=t[c<<2];y>o&&(o=y),y<r&&(r=y)}const u=255/(o-r);for(let c=0;c<e;c++)n[c]=(n[c]-r)*u;return n},jA=function(t){let e,n=-1/0,o=-1/0;const r=t.findIndex(f=>f!==0);let u=r,c=r;for(e=r;e<256;e++){const f=t[e];f>n&&(e-u>o&&(o=e-u,c=e-1),n=f,u=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e},a1=function(t){const e=t,{width:n,height:o}=t,{maxDim:r}=g(this,Il);let u=n,c=o;if(n>r||o>r){let S=n,E=o,b=Math.log2(Math.max(n,o)/r);const x=Math.floor(b);b=b===x?x-1:x;for(let D=0;D<b;D++){u=Math.ceil(S/2),c=Math.ceil(E/2);const k=new OffscreenCanvas(u,c);k.getContext("2d").drawImage(t,0,0,S,E,0,0,u,c),S=u,E=c,t!==e&&t.close(),t=k.transferToImageBitmap()}const N=Math.min(r/u,r/c);u=Math.round(u*N),c=Math.round(c*N)}const h=new OffscreenCanvas(u,c).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(t,0,0,t.width,t.height,0,0,u,c);const y=h.getImageData(0,0,u,c).data;return[M(this,Kt,ZA).call(this,y),u,c]},w(Bo,Kt),w(Bo,Il,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),w(Bo,os,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class xT extends KM{constructor(){super(),super.updateProperties({fill:de._defaultLineColor,"stroke-width":0})}clone(){const t=new xT;return t.updateAll(this),t}}class _T extends ey{constructor(t){super(t),super.updateProperties({stroke:de._defaultLineColor,"stroke-width":1})}clone(){const t=new _T(this._viewParameters);return t.updateAll(this),t}}var Xa,Ps,Ja,Pl;const ii=class ii extends wm{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});w(this,Xa,!1);w(this,Ps,null);w(this,Ja,null);w(this,Pl,null);this._willKeepAspectRatio=!0,C(this,Ja,e.signatureData||null),C(this,Ps,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,n){de.initialize(e,n),this._defaultDrawingOptions=new xT,this._defaultDrawnSignatureOptions=new _T(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Gt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!g(this,Ps)}}static computeTelemetryFinalData(e){const n=e.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,n;const{_isCopy:o}=this;if(o&&(this._isCopy=!1,e=this.x,n=this.y),super.render(),this._drawId===null)if(g(this,Ja)){const{lines:r,mustSmooth:u,areContours:c,description:f,uuid:h,heightInPage:y}=g(this,Ja),{rawDims:{pageWidth:A,pageHeight:S},rotation:E}=this.parent.viewport,b=Bo.processDrawnLines({lines:r,pageWidth:A,pageHeight:S,rotation:E,innerMargin:ii._INNER_MARGIN,mustSmooth:u,areContours:c});this.addSignature(b,y,f,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return o&&(this._isCopy=!0,this._moveAfterPaste(e,n)),this.div}setUuid(e){C(this,Pl,e),this.addEditToolbar()}getUuid(){return g(this,Pl)}get description(){return g(this,Ps)}set description(e){C(this,Ps,e),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:n,thickness:o,width:r,height:u}=g(this,Ja),c=Math.max(r,u),f=Bo.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:o,width:r,height:u},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:f.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,n,o,r){const{x:u,y:c}=this,{outline:f}=C(this,Ja,e);C(this,Xa,f instanceof KA),this.description=o,this.div.setAttribute("data-l10n-args",JSON.stringify({description:o}));let h;g(this,Xa)?h=ii.getDefaultDrawingOptions():(h=ii._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":f.thickness})),this._addOutlines({drawOutlines:f,drawingOptions:h});const[y,A]=this.parentDimensions,[,S]=this.pageDimensions;let E=n/S;E=E>=1?.5:E,this.width*=E/this.height,this.width>=1&&(E*=.9/this.width,this.width=.9),this.height=E,this.setDims(y*this.width,A*this.height),this.x=u,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!o}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:n,pageHeight:o},rotation:r}=this.parent.viewport;return Bo.process(e,n,o,r,ii._INNER_MARGIN)}getFromText(e,n){const{rawDims:{pageWidth:o,pageHeight:r},rotation:u}=this.parent.viewport;return Bo.extractContoursFromText(e,n,o,r,u,ii._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:n,pageHeight:o},rotation:r}=this.parent.viewport;return Bo.processDrawnLines({lines:e,pageWidth:n,pageHeight:o,rotation:r,innerMargin:ii._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:n}){e?this._drawingOptions=ii.getDefaultDrawingOptions():(this._drawingOptions=ii._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:n,points:o,rect:r}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":u}}=this,c={annotationType:Nt.SIGNATURE,isSignature:!0,areContours:g(this,Xa),color:[0,0,0],thickness:g(this,Xa)?0:u,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(c.paths={lines:n,points:o},c.uuid=g(this,Pl),c.isCopy=!0):c.lines=n,g(this,Ps)&&(c.accessibilityData={type:"Figure",alt:g(this,Ps)}),c}static deserializeDraw(e,n,o,r,u,c){return c.areContours?KA.deserialize(e,n,o,r,u,c):up.deserialize(e,n,o,r,u,c)}static async deserialize(e,n,o){var u;const r=await super.deserialize(e,n,o);return C(r,Xa,e.areContours),C(r,Ps,((u=e.accessibilityData)==null?void 0:u.alt)||""),C(r,Pl,e.uuid),r}};Xa=new WeakMap,Ps=new WeakMap,Ja=new WeakMap,Pl=new WeakMap,ot(ii,"_type","signature"),ot(ii,"_editorType",Nt.SIGNATURE),ot(ii,"_defaultDrawingOptions",null);let tT=ii;var me,je,Ka,Lo,Wa,$c,ko,Ll,Ls,mi,Yc,$t,Cf,bf,fm,hm,pm,nT,gm,r1;class eT extends de{constructor(e){super({...e,name:"stampEditor"});w(this,$t);w(this,me,null);w(this,je,null);w(this,Ka,null);w(this,Lo,null);w(this,Wa,null);w(this,$c,"");w(this,ko,null);w(this,Ll,!1);w(this,Ls,null);w(this,mi,!1);w(this,Yc,!1);C(this,Lo,e.bitmapUrl),C(this,Wa,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,n){de.initialize(e,n)}static isHandlingMimeForPasting(e){return J0.includes(e)}static paste(e,n){n.pasteEditor({mode:Nt.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:o}=this._uiManager;if(!o)throw new Error("No ML.");if(!await o.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:u,height:c}=e||this.copyCanvas(null,null,!0).imageData,f=await o.guess({name:"altText",request:{data:r,width:u,height:c,channels:r.length/(u*c)}});if(!f)throw new Error("No response from the AI service.");if(f.error)throw new Error("Error from the AI service.");if(f.cancel)return null;if(!f.output)throw new Error("No valid response from the AI service.");const h=f.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var e;g(this,je)&&(C(this,me,null),this._uiManager.imageManager.deleteId(g(this,je)),(e=g(this,ko))==null||e.remove(),C(this,ko,null),g(this,Ls)&&(clearTimeout(g(this,Ls)),C(this,Ls,null))),super.remove()}rebuild(){if(!this.parent){g(this,je)&&M(this,$t,fm).call(this);return}super.rebuild(),this.div!==null&&(g(this,je)&&g(this,ko)===null&&M(this,$t,fm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(g(this,Ka)||g(this,me)||g(this,Lo)||g(this,Wa)||g(this,je)||g(this,Ll))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;return this._isCopy&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),g(this,Ll)||(g(this,me)?M(this,$t,hm).call(this):M(this,$t,fm).call(this)),this._isCopy&&this._moveAfterPaste(e,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,n){const{id:o,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,n);n.remove(),o&&this._uiManager.imageManager.isValidId(o)&&(C(this,je,o),r&&C(this,me,r),C(this,Ll,!1),M(this,$t,hm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,Ls)!==null&&clearTimeout(g(this,Ls)),C(this,Ls,setTimeout(()=>{C(this,Ls,null),M(this,$t,nT).call(this)},200))}copyCanvas(e,n,o=!1){var E;e||(e=224);const{width:r,height:u}=g(this,me),c=new Os;let f=g(this,me),h=r,y=u,A=null;if(n){if(r>n||u>n){const $=Math.min(n/r,n/u);h=Math.floor(r*$),y=Math.floor(u*$)}A=document.createElement("canvas");const b=A.width=Math.ceil(h*c.sx),x=A.height=Math.ceil(y*c.sy);g(this,mi)||(f=M(this,$t,pm).call(this,b,x));const N=A.getContext("2d");N.filter=this._uiManager.hcmFilter;let D="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(E=window.matchMedia)!=null&&E.call(window,"(prefers-color-scheme: dark)").matches&&(D="#8f8f9d",k="#42414d");const L=15,U=L*c.sx,P=L*c.sy,G=new OffscreenCanvas(U*2,P*2),F=G.getContext("2d");F.fillStyle=D,F.fillRect(0,0,U*2,P*2),F.fillStyle=k,F.fillRect(0,0,U,P),F.fillRect(U,P,U,P),N.fillStyle=N.createPattern(G,"repeat"),N.fillRect(0,0,b,x),N.drawImage(f,0,0,f.width,f.height,0,0,b,x)}let S=null;if(o){let b,x;if(c.symmetric&&f.width<e&&f.height<e)b=f.width,x=f.height;else if(f=g(this,me),r>e||u>e){const k=Math.min(e/r,e/u);b=Math.floor(r*k),x=Math.floor(u*k),g(this,mi)||(f=M(this,$t,pm).call(this,b,x))}const D=new OffscreenCanvas(b,x).getContext("2d",{willReadFrequently:!0});D.drawImage(f,0,0,f.width,f.height,0,0,b,x),S={width:b,height:x,data:D.getImageData(0,0,b,x).data}}return{canvas:A,width:h,height:y,imageData:S}}static async deserialize(e,n,o){var N;let r=null,u=!1;if(e instanceof EM){const{data:{rect:D,rotation:k,id:L,structParent:U,popupRef:P},container:G,parent:{page:{pageNumber:F}},canvas:$}=e;let X,et;$?(delete e.canvas,{id:X,bitmap:et}=o.imageManager.getFromCanvas(G.id,$),$.remove()):(u=!0,e._hasNoCanvas=!0);const Q=((N=await n._structTree.getAriaAttributes(`${mT}${L}`))==null?void 0:N.get("aria-label"))||"";r=e={annotationType:Nt.STAMP,bitmapId:X,bitmap:et,pageIndex:F-1,rect:D.slice(0),rotation:k,annotationElementId:L,id:L,deleted:!1,accessibilityData:{decorative:!1,altText:Q},isSvg:!1,structParent:U,popupRef:P}}const c=await super.deserialize(e,n,o),{rect:f,bitmap:h,bitmapUrl:y,bitmapId:A,isSvg:S,accessibilityData:E}=e;u?(o.addMissingCanvas(e.id,c),C(c,Ll,!0)):A&&o.imageManager.isValidId(A)?(C(c,je,A),h&&C(c,me,h)):C(c,Lo,y),C(c,mi,S);const[b,x]=c.pageDimensions;return c.width=(f[2]-f[0])/b,c.height=(f[3]-f[1])/x,E&&(c.altTextData=E),c._initialData=r,C(c,Yc,!!r),c}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const o={annotationType:Nt.STAMP,bitmapId:g(this,je),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:g(this,mi),structTreeParentId:this._structTreeParentId};if(e)return o.bitmapUrl=M(this,$t,gm).call(this,!0),o.accessibilityData=this.serializeAltText(!0),o.isCopy=!0,o;const{decorative:r,altText:u}=this.serializeAltText(!1);if(!r&&u&&(o.accessibilityData={type:"Figure",alt:u}),this.annotationElementId){const f=M(this,$t,r1).call(this,o);if(f.isSame)return null;f.isSameAltText?delete o.accessibilityData:o.accessibilityData.structParent=this._initialData.structParent??-1}if(o.id=this.annotationElementId,n===null)return o;n.stamps||(n.stamps=new Map);const c=g(this,mi)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!n.stamps.has(g(this,je)))n.stamps.set(g(this,je),{area:c,serialized:o}),o.bitmap=M(this,$t,gm).call(this,!1);else if(g(this,mi)){const f=n.stamps.get(g(this,je));c>f.area&&(f.area=c,f.serialized.bitmap.close(),f.serialized.bitmap=M(this,$t,gm).call(this,!1))}return o}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}me=new WeakMap,je=new WeakMap,Ka=new WeakMap,Lo=new WeakMap,Wa=new WeakMap,$c=new WeakMap,ko=new WeakMap,Ll=new WeakMap,Ls=new WeakMap,mi=new WeakMap,Yc=new WeakMap,$t=new WeakSet,Cf=function(e,n=!1){if(!e){this.remove();return}C(this,me,e.bitmap),n||(C(this,je,e.id),C(this,mi,e.isSvg)),e.file&&C(this,$c,e.file.name),M(this,$t,hm).call(this)},bf=function(){if(C(this,Ka,null),this._uiManager.enableWaiting(!1),!!g(this,ko)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,me)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,me)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},fm=function(){if(g(this,je)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,je)).then(o=>M(this,$t,Cf).call(this,o,!0)).finally(()=>M(this,$t,bf).call(this));return}if(g(this,Lo)){const o=g(this,Lo);C(this,Lo,null),this._uiManager.enableWaiting(!0),C(this,Ka,this._uiManager.imageManager.getFromUrl(o).then(r=>M(this,$t,Cf).call(this,r)).finally(()=>M(this,$t,bf).call(this)));return}if(g(this,Wa)){const o=g(this,Wa);C(this,Wa,null),this._uiManager.enableWaiting(!0),C(this,Ka,this._uiManager.imageManager.getFromFile(o).then(r=>M(this,$t,Cf).call(this,r)).finally(()=>M(this,$t,bf).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=J0.join(",");const n=this._uiManager._signal;C(this,Ka,new Promise(o=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,$t,Cf).call(this,r)}o()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),o()},{signal:n})}).finally(()=>M(this,$t,bf).call(this))),e.click()},hm=function(){var A;const{div:e}=this;let{width:n,height:o}=g(this,me);const[r,u]=this.pageDimensions,c=.75;if(this.width)n=this.width*r,o=this.height*u;else if(n>c*r||o>c*u){const S=Math.min(c*r/n,c*u/o);n*=S,o*=S}const[f,h]=this.parentDimensions;this.setDims(n*f/r,o*h/u),this._uiManager.enableWaiting(!1);const y=C(this,ko,document.createElement("canvas"));y.setAttribute("role","img"),this.addContainer(y),this.width=n/r,this.height=o/u,(A=this._initialOptions)!=null&&A.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),M(this,$t,nT).call(this),g(this,Yc)||(this.parent.addUndoableEditor(this),C(this,Yc,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,$c)&&this.div.setAttribute("aria-description",g(this,$c)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},pm=function(e,n){const{width:o,height:r}=g(this,me);let u=o,c=r,f=g(this,me);for(;u>2*e||c>2*n;){const h=u,y=c;u>2*e&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const A=new OffscreenCanvas(u,c);A.getContext("2d").drawImage(f,0,0,h,y,0,0,u,c),f=A.transferToImageBitmap()}return f},nT=function(){const[e,n]=this.parentDimensions,{width:o,height:r}=this,u=new Os,c=Math.ceil(o*e*u.sx),f=Math.ceil(r*n*u.sy),h=g(this,ko);if(!h||h.width===c&&h.height===f)return;h.width=c,h.height=f;const y=g(this,mi)?g(this,me):M(this,$t,pm).call(this,c,f),A=h.getContext("2d");A.filter=this._uiManager.hcmFilter,A.drawImage(y,0,0,y.width,y.height,0,0,c,f)},gm=function(e){if(e){if(g(this,mi)){const r=this._uiManager.imageManager.getSvgUrl(g(this,je));if(r)return r}const n=document.createElement("canvas");return{width:n.width,height:n.height}=g(this,me),n.getContext("2d").drawImage(g(this,me),0,0),n.toDataURL()}if(g(this,mi)){const[n,o]=this.pageDimensions,r=Math.round(this.width*n*nr.PDF_TO_CSS_UNITS),u=Math.round(this.height*o*nr.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,u);return c.getContext("2d").drawImage(g(this,me),0,0,g(this,me).width,g(this,me).height,0,0,r,u),c.transferToImageBitmap()}return structuredClone(g(this,me))},r1=function(e){var c;const{pageIndex:n,accessibilityData:{altText:o}}=this._initialData,r=e.pageIndex===n,u=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===o;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&u,isSameAltText:u}},ot(eT,"_type","stamp"),ot(eT,"_editorType",Nt.STAMP);var kl,Xc,ks,Qa,Uo,yi,Za,Jc,Ul,as,Fo,tn,Oo,ja,Kc,vt,tr,ye,l1,vs,sT,oT,mm;const Ki=class Ki{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:o,accessibilityManager:r,annotationLayer:u,drawLayer:c,textLayer:f,viewport:h,l10n:y}){w(this,ye);w(this,kl);w(this,Xc,!1);w(this,ks,null);w(this,Qa,null);w(this,Uo,null);w(this,yi,new Map);w(this,Za,!1);w(this,Jc,!1);w(this,Ul,!1);w(this,as,null);w(this,Fo,null);w(this,tn,null);w(this,Oo,null);w(this,ja,null);w(this,Kc,-1);w(this,vt);const A=[...g(Ki,tr).values()];if(!Ki._initialized){Ki._initialized=!0;for(const S of A)S.initialize(y,t)}t.registerEditorTypes(A),C(this,vt,t),this.pageIndex=e,this.div=n,C(this,kl,r),C(this,ks,u),this.viewport=h,C(this,tn,f),this.drawLayer=c,this._structTree=o,g(this,vt).addLayer(this)}get isEmpty(){return g(this,yi).size===0}get isInvisible(){return this.isEmpty&&g(this,vt).getMode()===Nt.NONE}updateToolbar(t){g(this,vt).updateToolbar(t)}updateMode(t=g(this,vt).getMode()){switch(M(this,ye,mm).call(this),t){case Nt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Nt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Nt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of g(Ki,tr).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=g(this,tn))==null?void 0:e.div)}setEditingState(t){g(this,vt).setEditingState(t)}addCommands(t){g(this,vt).addCommands(t)}cleanUndoStack(t){g(this,vt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=g(this,ks))==null||e.div.classList.toggle("disabled",!t)}async enable(){var n;C(this,Ul,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(n=g(this,ja))==null||n.abort(),C(this,ja,null);const t=new Set;for(const o of g(this,yi).values())o.enableEditing(),o.show(!0),o.annotationElementId&&(g(this,vt).removeChangedExistingAnnotation(o),t.add(o.annotationElementId));if(!g(this,ks)){C(this,Ul,!1);return}const e=g(this,ks).getEditableAnnotations();for(const o of e){if(o.hide(),g(this,vt).isDeletedAnnotationElement(o.data.id)||t.has(o.data.id))continue;const r=await this.deserialize(o);r&&(this.addOrRebuild(r),r.enableEditing())}C(this,Ul,!1)}disable(){var o;if(C(this,Jc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),g(this,tn)&&!g(this,ja)){C(this,ja,new AbortController);const r=g(this,vt).combinedSignal(g(this,ja));g(this,tn).div.addEventListener("pointerdown",u=>{const{clientX:f,clientY:h,timeStamp:y}=u,A=g(this,Kc);if(y-A>500){C(this,Kc,y);return}C(this,Kc,-1);const{classList:S}=this.div;S.toggle("getElements",!0);const E=document.elementsFromPoint(f,h);if(S.toggle("getElements",!1),!this.div.contains(E[0]))return;let b;const x=new RegExp(`^${ew}[0-9]+$`);for(const D of E)if(x.test(D.id)){b=D.id;break}if(!b)return;const N=g(this,yi).get(b);(N==null?void 0:N.annotationElementId)===null&&(u.stopPropagation(),u.preventDefault(),N.dblclick())},{signal:r,capture:!0})}const t=new Map,e=new Map;for(const r of g(this,yi).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);(o=this.getEditableAnnotation(r.annotationElementId))==null||o.show(),r.remove()}if(g(this,ks)){const r=g(this,ks).getEditableAnnotations();for(const u of r){const{id:c}=u.data;if(g(this,vt).isDeletedAnnotationElement(c))continue;let f=e.get(c);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=t.get(c),f&&(g(this,vt).addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}M(this,ye,mm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of g(Ki,tr).values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Jc,!1)}getEditableAnnotation(t){var e;return((e=g(this,ks))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){g(this,vt).getActive()!==t&&g(this,vt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=g(this,tn))!=null&&t.div&&!g(this,Oo)){C(this,Oo,new AbortController);const e=g(this,vt).combinedSignal(g(this,Oo));g(this,tn).div.addEventListener("pointerdown",M(this,ye,l1).bind(this),{signal:e}),g(this,tn).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=g(this,tn))!=null&&t.div&&g(this,Oo)&&(g(this,Oo).abort(),C(this,Oo,null),g(this,tn).div.classList.remove("highlighting"))}enableClick(){if(g(this,Qa))return;C(this,Qa,new AbortController);const t=g(this,vt).combinedSignal(g(this,Qa));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=g(this,Qa))==null||t.abort(),C(this,Qa,null)}attach(t){g(this,yi).set(t.id,t);const{annotationElementId:e}=t;e&&g(this,vt).isDeletedAnnotationElement(e)&&g(this,vt).removeDeletedAnnotationElement(t)}detach(t){var e;g(this,yi).delete(t.id),(e=g(this,kl))==null||e.removePointerInTextLayer(t.contentDiv),!g(this,Jc)&&t.annotationElementId&&g(this,vt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),g(this,vt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(g(this,vt).addDeletedAnnotationElement(t.annotationElementId),de.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),g(this,vt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!g(this,Ul)),g(this,vt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!g(this,Uo)&&(t._focusEventsAllowed=!1,C(this,Uo,setTimeout(()=>{C(this,Uo,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:g(this,vt)._signal}),e.focus())},0))),t._structTreeParentId=(n=g(this,kl))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return g(this,vt).getId()}combinedSignal(t){return g(this,vt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=g(this,ye,vs))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await g(this,vt).updateMode(t.mode);const{offsetX:n,offsetY:o}=M(this,ye,oT).call(this),r=this.getNextId(),u=M(this,ye,sT).call(this,{parent:this,id:r,x:n,y:o,uiManager:g(this,vt),isCentered:!0,...e});u&&this.add(u)}async deserialize(t){var e;return await((e=g(Ki,tr).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,g(this,vt)))||null}createAndAddNewEditor(t,e,n={}){const o=this.getNextId(),r=M(this,ye,sT).call(this,{parent:this,id:o,x:t.offsetX,y:t.offsetY,uiManager:g(this,vt),isCentered:e,...n});return r&&this.add(r),r}addNewEditor(t={}){this.createAndAddNewEditor(M(this,ye,oT).call(this),!0,t)}setSelected(t){g(this,vt).setSelected(t)}toggleSelected(t){g(this,vt).toggleSelected(t)}unselect(t){g(this,vt).unselect(t)}pointerup(t){var o;const{isMac:e}=hn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!g(this,Za)||(C(this,Za,!1),(o=g(this,ye,vs))!=null&&o.isDrawer&&g(this,ye,vs).supportMultipleDrawings))return;if(!g(this,Xc)){C(this,Xc,!0);return}const n=g(this,vt).getMode();if(n===Nt.STAMP||n===Nt.SIGNATURE){g(this,vt).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var o;if(g(this,vt).getMode()===Nt.HIGHLIGHT&&this.enableTextSelection(),g(this,Za)){C(this,Za,!1);return}const{isMac:e}=hn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(C(this,Za,!0),(o=g(this,ye,vs))!=null&&o.isDrawer){this.startDrawingSession(t);return}const n=g(this,vt).getActive();C(this,Xc,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),g(this,as)){g(this,ye,vs).startDrawing(this,g(this,vt),!1,t);return}g(this,vt).setCurrentDrawingSession(this),C(this,as,new AbortController);const e=g(this,vt).combinedSignal(g(this,as));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(C(this,Fo,null),this.commitOrRemove())},{signal:e}),g(this,ye,vs).startDrawing(this,g(this,vt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&C(this,Fo,e);return}g(this,Fo)&&setTimeout(()=>{var e;(e=g(this,Fo))==null||e.focus(),C(this,Fo,null)},0)}endDrawingSession(t=!1){return g(this,as)?(g(this,vt).setCurrentDrawingSession(null),g(this,as).abort(),C(this,as,null),C(this,Fo,null),g(this,ye,vs).endDrawing(t)):null}findNewParent(t,e,n){const o=g(this,vt).findParent(e,n);return o===null||o===this?!1:(o.changeParent(t),!0)}commitOrRemove(){return g(this,as)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,as)&&g(this,ye,vs).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=g(this,vt).getActive())==null?void 0:t.parent)===this&&(g(this,vt).commitOrRemove(),g(this,vt).setActiveEditor(null)),g(this,Uo)&&(clearTimeout(g(this,Uo)),C(this,Uo,null));for(const n of g(this,yi).values())(e=g(this,kl))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,g(this,yi).clear(),g(this,vt).removeLayer(this)}render({viewport:t}){this.viewport=t,Bl(this.div,t);for(const e of g(this,vt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){g(this,vt).commitOrRemove(),M(this,ye,mm).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Bl(this.div,{rotation:n}),e!==n)for(const o of g(this,yi).values())o.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return g(this,vt).viewParameters.realScale}};kl=new WeakMap,Xc=new WeakMap,ks=new WeakMap,Qa=new WeakMap,Uo=new WeakMap,yi=new WeakMap,Za=new WeakMap,Jc=new WeakMap,Ul=new WeakMap,as=new WeakMap,Fo=new WeakMap,tn=new WeakMap,Oo=new WeakMap,ja=new WeakMap,Kc=new WeakMap,vt=new WeakMap,tr=new WeakMap,ye=new WeakSet,l1=function(t){g(this,vt).unselectAll();const{target:e}=t;if(e===g(this,tn).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&g(this,tn).div.contains(e)){const{isMac:n}=hn.platform;if(t.button!==0||t.ctrlKey&&n)return;g(this,vt).showAllEditors("highlight",!0,!0),g(this,tn).div.classList.add("free"),this.toggleDrawing(),_m.startHighlighting(this,g(this,vt).direction==="ltr",{target:g(this,tn).div,x:t.x,y:t.y}),g(this,tn).div.addEventListener("pointerup",()=>{g(this,tn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,vt)._signal}),t.preventDefault()}},vs=function(){return g(Ki,tr).get(g(this,vt).getMode())},sT=function(t){const e=g(this,ye,vs);return e?new e.prototype.constructor(t):null},oT=function(){const{x:t,y:e,width:n,height:o}=this.div.getBoundingClientRect(),r=Math.max(0,t),u=Math.max(0,e),c=Math.min(window.innerWidth,t+n),f=Math.min(window.innerHeight,e+o),h=(r+c)/2-t,y=(u+f)/2-e,[A,S]=this.viewport.rotation%180===0?[h,y]:[y,h];return{offsetX:A,offsetY:S}},mm=function(){for(const t of g(this,yi).values())t.isEmpty()&&t.remove()},ot(Ki,"_initialized",!1),w(Ki,tr,new Map([kA,JA,eT,_m,tT].map(t=>[t._editorType,t])));let iT=Ki;var rs,Nn,Fl,np,Ym,u1,Bs,rT,c1,lT;const Ge=class Ge{constructor({pageIndex:t}){w(this,Bs);w(this,rs,null);w(this,Nn,new Map);w(this,Fl,new Map);this.pageIndex=t}setParent(t){if(!g(this,rs)){C(this,rs,t);return}if(g(this,rs)!==t){if(g(this,Nn).size>0)for(const e of g(this,Nn).values())e.remove(),t.append(e);C(this,rs,t)}}static get _svgFactory(){return Gt(this,"_svgFactory",new Cm)}draw(t,e=!1,n=!1){const o=xn(Ge,np)._++,r=M(this,Bs,rT).call(this),u=Ge._svgFactory.createElement("defs");r.append(u);const c=Ge._svgFactory.createElement("path");u.append(c);const f=`path_p${this.pageIndex}_${o}`;c.setAttribute("id",f),c.setAttribute("vector-effect","non-scaling-stroke"),e&&g(this,Fl).set(o,c);const h=n?M(this,Bs,c1).call(this,u,f):null,y=Ge._svgFactory.createElement("use");return r.append(y),y.setAttribute("href",`#${f}`),this.updateProperties(r,t),g(this,Nn).set(o,r),{id:o,clipPathId:`url(#${h})`}}drawOutline(t,e){const n=xn(Ge,np)._++,o=M(this,Bs,rT).call(this),r=Ge._svgFactory.createElement("defs");o.append(r);const u=Ge._svgFactory.createElement("path");r.append(u);const c=`path_p${this.pageIndex}_${n}`;u.setAttribute("id",c),u.setAttribute("vector-effect","non-scaling-stroke");let f;if(e){const A=Ge._svgFactory.createElement("mask");r.append(A),f=`mask_p${this.pageIndex}_${n}`,A.setAttribute("id",f),A.setAttribute("maskUnits","objectBoundingBox");const S=Ge._svgFactory.createElement("rect");A.append(S),S.setAttribute("width","1"),S.setAttribute("height","1"),S.setAttribute("fill","white");const E=Ge._svgFactory.createElement("use");A.append(E),E.setAttribute("href",`#${c}`),E.setAttribute("stroke","none"),E.setAttribute("fill","black"),E.setAttribute("fill-rule","nonzero"),E.classList.add("mask")}const h=Ge._svgFactory.createElement("use");o.append(h),h.setAttribute("href",`#${c}`),f&&h.setAttribute("mask",`url(#${f})`);const y=h.cloneNode();return o.append(y),h.classList.add("mainOutline"),y.classList.add("secondaryOutline"),this.updateProperties(o,t),g(this,Nn).set(n,o),n}finalizeDraw(t,e){g(this,Fl).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var f;if(!e)return;const{root:n,bbox:o,rootClass:r,path:u}=e,c=typeof t=="number"?g(this,Nn).get(t):t;if(c){if(n&&M(this,Bs,lT).call(this,c,n),o&&M(f=Ge,Ym,u1).call(f,c,o),r){const{classList:h}=c;for(const[y,A]of Object.entries(r))h.toggle(y,A)}if(u){const y=c.firstChild.firstChild;M(this,Bs,lT).call(this,y,u)}}}updateParent(t,e){if(e===this)return;const n=g(this,Nn).get(t);n&&(g(e,rs).append(n),g(this,Nn).delete(t),g(e,Nn).set(t,n))}remove(t){g(this,Fl).delete(t),g(this,rs)!==null&&(g(this,Nn).get(t).remove(),g(this,Nn).delete(t))}destroy(){C(this,rs,null);for(const t of g(this,Nn).values())t.remove();g(this,Nn).clear(),g(this,Fl).clear()}};rs=new WeakMap,Nn=new WeakMap,Fl=new WeakMap,np=new WeakMap,Ym=new WeakSet,u1=function(t,[e,n,o,r]){const{style:u}=t;u.top=`${100*n}%`,u.left=`${100*e}%`,u.width=`${100*o}%`,u.height=`${100*r}%`},Bs=new WeakSet,rT=function(){const t=Ge._svgFactory.create(1,1,!0);return g(this,rs).append(t),t.setAttribute("aria-hidden",!0),t},c1=function(t,e){const n=Ge._svgFactory.createElement("clipPath");t.append(n);const o=`clip_${e}`;n.setAttribute("id",o),n.setAttribute("clipPathUnits","objectBoundingBox");const r=Ge._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),o},lT=function(t,e){for(const[n,o]of Object.entries(e))o===null?t.removeAttribute(n):t.setAttribute(n,o)},w(Ge,Ym),w(Ge,np,0);let aT=Ge;globalThis._pdfjsTestingUtils={HighlightOutliner:FA};globalThis.pdfjsLib={AbortException:er,AnnotationEditorLayer:iT,AnnotationEditorParamsType:Ht,AnnotationEditorType:Nt,AnnotationEditorUIManager:Gl,AnnotationLayer:IA,AnnotationMode:ya,AnnotationType:Ie,build:D3,ColorPicker:xm,createValidAbsoluteUrl:nw,DOMSVGFactory:Cm,DrawLayer:aT,FeatureTest:hn,fetchData:op,getDocument:aM,getFilenameFromUrl:CB,getPdfFilenameFromUrl:bB,getUuid:ow,getXfaPageViewport:_B,GlobalWorkerOptions:Us,ImageKind:Gg,InvalidPDFException:Y0,isDataScheme:jm,isPdfFile:vT,isValidExplicitDest:FB,MathClamp:In,noContextMenu:us,normalizeUnicode:TB,OPS:Am,OutputScale:Os,PasswordResponses:dB,PDFDataRangeTransport:rM,PDFDateString:AT,PDFWorker:Mf,PermissionFlag:cB,PixelsPerInch:nr,RenderingCancelledException:yT,ResponseException:Tm,setLayerDimensions:Bl,shadow:Gt,SignatureExtractor:Bo,stopEvent:Pe,SupportedImageMimeTypes:J0,TextLayer:_f,TouchManager:Em,updateUrlHash:iw,Util:Et,VerbosityLevel:Wm,version:N3,XfaLayer:cM};const j3="gemini-2.5-flash";function cp(){try{const i=localStorage.getItem("selectedModel");if(i)return i}catch{}return j3}const ny=async(i,t=3,e=1e3)=>{var r;let n=0,o=e;for(;;)try{console.log(` [DEBUG] withRetry tentativa ${n+1}/${t+1}...`);const u=new Promise((f,h)=>{setTimeout(()=>h(new Error("API call timeout after 60 seconds")),6e4)}),c=await Promise.race([i(),u]);return console.log(" [DEBUG] withRetry sucesso na tentativa",n+1),c}catch(u){console.log(` [DEBUG] withRetry erro na tentativa ${n+1}:`,u.message||u);const c=u.toString().includes("429")||u.toString().includes("RESOURCE_EXHAUSTED"),f=(r=u.message)==null?void 0:r.includes("timeout");if((c||f)&&n<t)console.warn(`${f?"Timeout":"Rate limit"} hit on attempt ${n+1}. Retrying in ${o}ms...`),await new Promise(h=>setTimeout(h,o)),n++,o*=2;else throw console.error(`API call failed after ${n} retries or for a non-retriable error.`,u),u}};async function y_(i){console.log(" [DEBUG] findProblematicPages iniciado, texto length:",i.length),console.log(" [DEBUG] Iniciando anlise local...");const t=tG(i);console.log(" [DEBUG] Anlise local encontrou:",t.issues),console.log(" [DEBUG] Pginas problemticas localmente:",t.problematicPages);try{return console.log(" [DEBUG] Iniciando withRetry para chamada  AI..."),await ny(async()=>{console.log(" [DEBUG] Preparando prompt para AI...");const e=`You are a document analysis expert specializing in PDF text extraction quality. Analyze the provided text for extraction problems that require OCR correction.

      CRITICAL: Be MORE SENSITIVE to quality issues. Look for:
      
      **ALWAYS FLAG FOR OCR if you find:**
      - Pages with poor formatting (weird line breaks, spacing issues)
      - Text that looks like it came from a scanned document
      - Missing spaces between words or odd character spacing
      - Any signs that this came from image-to-text conversion rather than native PDF text
      - Broken paragraph structure or awkward text flow
      - Mixed fonts or inconsistent character rendering
      
      **ALSO FLAG:**
      - Garbled or nonsensical text
      - Incomplete tables/lists  
      - Pages with very little text (under 200 chars)
      - Missing punctuation or formatting
      - Footnote markers without corresponding text
      
      **BE AGGRESSIVE**: When in doubt, flag the page for OCR. It's better to re-process a good page than miss a poor extraction.
      
      Document has page breaks marked '--- END OF PAGE X ---'.
      
      Return JSON array of page numbers needing OCR. If text quality seems poor overall, consider flagging ALL pages.
      
      Example: [1, 2, 3] for a 3-page document with quality issues`;console.log(" [DEBUG] Fazendo chamada para llmService.generateContent...");const n=await td.generateContent({model:cp(),contents:i,config:{systemInstruction:e,temperature:.1,responseMimeType:"application/json",responseSchema:{type:Fs.ARRAY,items:{type:Fs.INTEGER}}}});console.log(" [DEBUG] llmService.generateContent concludo com sucesso!"),console.log(" [DEBUG] findProblematicPages response recebido:",n.text);const o=n.text;if(!o)return console.warn("Enhanced analysis returned empty. Using local analysis fallback."),t.problematicPages;const r=o.replace(/^```json\n?/,"").replace(/```$/,""),u=JSON.parse(r),c=[...new Set([...u,...t.problematicPages])];if(console.log(" [DEBUG] Pginas problemticas detectadas:",c),console.log(" [DEBUG] Detalhes da anlise:",{aiDetected:u,localDetected:t.problematicPages,combined:c,reasons:t.issues}),!Array.isArray(c)||!c.every(f=>typeof f=="number"))throw new Error("Invalid format for problematic pages.");return c})}catch(e){return console.error("Error in findProblematicPages after retries:",e),console.warn("Using local analysis as fallback"),t.problematicPages.length>0?t.problematicPages:[]}}function tG(i){const t=[],e=[];return i.split(/--- END OF PAGE \d+ ---/).forEach((o,r)=>{const u=r+1,c=[],f=o.trim();if(f.length===0)return;f.length<200&&(c.push("Texto muito curto"),e.push(u));const h=f.match(/\w\n\w/g);h&&h.length>3&&(c.push("Quebras de linha suspeitas"),e.push(u));const y=f.match(/[a-z][A-Z]/g);y&&y.length>5&&(c.push("Possvel falta de espaos"),e.push(u));const A=f.match(/[^\w\s\-.,;:'"!?()[\]{}]/g);A&&A.length>f.length*.05&&(c.push("Muitos caracteres especiais"),e.push(u));const S=f.match(/\b\w{1,2}\b/g);S&&S.length>f.split(/\s+/).length*.3&&(c.push("Palavras muito fragmentadas"),e.push(u)),c.length>0&&t.push(`Pgina ${u}: ${c.join(", ")}`)}),{issues:t,problematicPages:[...new Set(e)]}}async function eG(i){try{return await ny(async()=>{const t={inlineData:{mimeType:"image/jpeg",data:i}},e={text:`You are a precise OCR engine. Extract and correct all text from this image with maximum accuracy.

CRITICAL OCR RULES:
1. **Character Precision**: Be extremely careful with similar characters:
   - Do NOT confuse "la" with "1a" 
   - Do NOT confuse "Il" with "11"
   - Do NOT confuse "O" with "0" 
   - Do NOT confuse "S" with "5"
   - Verify each character in context
2. **Full Transcription**: Extract ALL text including headers, body, footers, margins
3. **Footnote Detection**: Find ANY footnote markers (numbers, symbols, letters: , , *, [1], (a), 14-1, etc.) and wrap as <fn>X</fn>
4. **Structure Preservation**: Maintain original paragraphs and formatting
5. **Context Validation**: Use surrounding words to verify character accuracy

OUTPUT FORMAT:
Provide the extracted text, then document findings:

---OCR ANALYSIS---
 Character corrections: "1a"  "la", "Il"  "Il" (verified)
 Found footnote marker "" after "document" 
 Extracted margin text: "Definition notes"
 Total characters: X
---END ANALYSIS---

For clean extractions: "---CLEAN EXTRACTION---"`},o=(await td.generateContent({model:cp(),contents:{parts:[t,e]},config:{temperature:.1}})).text;if(!o)throw new Error("AI API response for text extraction was empty.");const r=o.match(/---OCR ANALYSIS---([\s\S]*?)---END ANALYSIS---/),u=o.match(/---CLEAN EXTRACTION---/);let c="";return r?c=r[1].trim():u?c="Clean extraction - no issues found":c="OCR analysis not provided",{text:o.replace(/---OCR ANALYSIS---[\s\S]*?---END ANALYSIS---/,"").replace(/---CLEAN EXTRACTION---/,"").trim(),changes:c}})}catch(t){throw console.error("Error in extractTextFromImage after retries:",t),new Error("AI API failed to extract text from image.")}}async function nG(i,t){if(!i||i.trim()==="")return{text:i,changes:"No text to process"};try{return await ny(async()=>{const e={inlineData:{mimeType:"image/jpeg",data:t}},n={text:`This is the text extracted from the page's text layer: 

${i}`},u=(await td.generateContent({model:cp(),contents:{parts:[e,n]},config:{systemInstruction:`You are a precision document analyst. Compare the page image with extracted text to make accurate corrections while avoiding character substitution errors.

CRITICAL ACCURACY RULES:
1. **Character Precision**: Be extremely careful with similar characters:
   - Verify "la" vs "1a" by context (usually "la" in words)
   - Check "Il" vs "11" by examining surrounding letters
   - Distinguish "O" vs "0" based on context (letters vs numbers)
   - Validate "S" vs "5" using word patterns
2. **Context Validation**: Use surrounding words to verify character accuracy
3. **Conservative Approach**: Only change text if you're absolutely certain

YOUR PROCESS:
1. **CHARACTER VERIFICATION**: Double-check each suspicious character using context
2. **FOOTNOTE DETECTION**: Find ANY footnote markers (numbers, symbols, letters: , [2], (3), *, a, 14-1, etc.) and add <fn> tags
3. **STRUCTURAL FIXES**: Correct obvious OCR errors verified by image
4. **CHANGE DOCUMENTATION**: Record all modifications made

OUTPUT FORMAT:
Provide corrected text with <fn> tags, then add:

---CHANGES MADE---
 Verified "la" characters (no changes needed)
 Added footnote marker <fn>X</fn> after "word"
 Fixed verified OCR error: "articel"  "article"
 Fixed spacing in "Section1.1" to "Section 1.1"
---END CHANGES---

If no changes were needed, write "---NO CHANGES NEEDED---"`,temperature:.1}})).text;if(!u)throw new Error("AI API response for text processing was empty.");const c=u.match(/---CHANGES MADE---([\s\S]*?)---END CHANGES---/),f=u.match(/---NO CHANGES NEEDED---/);let h="";return c?h=c[1].trim():f?h="No changes needed":h="Changes summary not provided",{text:u.replace(/---CHANGES MADE---[\s\S]*?---END CHANGES---/,"").replace(/---NO CHANGES NEEDED---/,"").trim(),changes:h}})}catch(e){throw console.error("Error in processPageWithText after retries:",e),new Error("AI API failed to process page text after multiple attempts.")}}async function v_(i){console.log(`[INFO] Starting final document reformatting. Text length: ${i.length} chars.`);const t=Date.now();if(i.length>5e4)return iG(i);const n=new Promise((o,r)=>{setTimeout(()=>{r(new Error("reformatDocumentText timed out after 180 seconds."))},18e4)});try{return await Promise.race([n,ny(async()=>{var f;console.log("[INFO] Sending single request to Gemini API for final formatting...");const r=await td.generateContent({model:cp(),contents:i,config:{systemInstruction:`You are an expert document formatter. Your task is to clean and format a raw text document while preserving its original structure and readability.

CRITICAL FORMATTING RULES:

1. **PRESERVE ORIGINAL STRUCTURE**:
   - Keep all headings exactly as they appear (SECTION A, CHAPTER 1, Section 1.1, etc.)
   - Maintain proper spacing between sections (blank lines between major sections)
   - Preserve numbered lists, bullet points, and paragraph breaks
   - Keep sub-sections and definitions properly indented
   - **NEVER merge paragraphs into one continuous block of text**

2. **CLEAN THE TEXT**:
   - Remove page break markers ('--- END OF PAGE X ---')
   - Remove duplicate headers/footers that appear on multiple pages
   - Fix obvious OCR errors while preserving content

3. **HANDLE FOOTNOTES**:
   - **Detect all potential footnote markers**: This includes superscript numbers (), numbers in brackets ([1]), numbers in parentheses ((1)), asterisks (*), and simple numbers following a word (word1, word2).
   - **Convert ALL footnote references** to the format: {{footnotenumberX}}Y{{-footnotenumberX}}, where X is a sequential counter (1, 2, 3...) and Y is the original marker (e.g., 1, 2, *, a).
   - **Convert ALL footnote definitions** (usually at the bottom of a page) to the format: {{footnoteX}}Y Footnote text here{{-footnoteX}}.
   - **Renumber all footnotes sequentially** starting from 1. The X in the tags must be sequential.
   - Ensure every reference tag {{footnotenumberX}} has a corresponding definition tag {{footnoteX}}.

4. **OUTPUT FORMAT**:
   - Return clean, readable text that matches the original document structure
   - Use proper line breaks and spacing
   - Maintain professional document formatting
   - Each article, section, and paragraph should be clearly separated`,temperature:.2,maxOutputTokens:8192}}),u=Date.now()-t;console.log(`[SUCCESS] Final formatting completed in ${u}ms. Output length: ${((f=r.text)==null?void 0:f.length)||0}`);const c=r.text;if(!c)throw new Error("API response for reformatting was empty.");return c})])}catch(o){return console.error("[ERROR] Final formatting failed after retries:",o),console.log("[INFO] Fallback: Returning original, unformatted text."),i.replace(/--- END OF PAGE \d+ ---/g,`
`)}}async function iG(i){console.log(`[INFO] Document is large (${i.length} chars). Processing in chunks.`);const t=i.split(/(?=--- END OF PAGE \d+ ---)/g),e=[];console.log(`[INFO] Split document into ${t.length} chunks.`);for(let n=0;n<t.length;n++){const o=t[n];if(o.trim().length!==0){console.log(`[INFO] Formatting chunk ${n+1}/${t.length} (${o.length} chars)...`);try{const u=await td.generateContent({model:cp(),contents:o,config:{systemInstruction:`You are an expert document formatter. Your task is to clean and format this text chunk.
      - Remove page break markers ('--- END OF PAGE X ---').
      - Fix obvious OCR errors and spacing issues.
      - Preserve all {{footnote...}} tags and other structural elements exactly as they are.
      - Return only the cleaned text for this chunk. Do not add extra commentary.`,temperature:.1}});e.push(u.text||o)}catch(r){console.error(`[ERROR] Failed to format chunk ${n+1}. Using original text for this chunk.`,r),e.push(o)}}}return console.log(`[SUCCESS] All ${t.length} chunks have been processed. Reassembling document.`),e.join(`
`).replace(/--- END OF PAGE \d+ ---/g,`
`)}const sG=(i={},t=0)=>{const[e,n]=rt.useState(i),[o,r]=rt.useState(null),[u,c]=rt.useState(t),[f,h]=rt.useState(null),y=rt.useRef(null);rt.useEffect(()=>{const U=Object.keys(e).find(P=>e[P].isActive);U&&h(U)},[e]),rt.useEffect(()=>{if(Object.values(e).some(P=>P.isActive)||o)return y.current=setInterval(()=>{const P=Date.now();n(G=>{const F={...G};return Object.keys(F).forEach($=>{F[$].isActive&&F[$].startTime&&(F[$].elapsedTime=P-F[$].startTime)}),F}),o&&c(P-o)},100),()=>{y.current&&clearInterval(y.current)}},[e,o]);const A=rt.useCallback(()=>{const U=Date.now();r(U),c(0)},[]),S=rt.useCallback(()=>{o&&c(Date.now()-o),r(null),h(null)},[o]),E=rt.useCallback((U,P)=>{const G=Date.now();n(F=>{const $={...F};return Object.keys($).forEach(X=>{$[X].isActive&&($[X].isActive=!1,$[X].endTime=G,$[X].duration=G-($[X].startTime||G))}),$}),n(F=>({...F,[U]:{id:U,name:P,startTime:G,endTime:null,duration:0,isActive:!0,elapsedTime:0}})),h(U)},[]),b=rt.useCallback(U=>{const P=Date.now();n(G=>{const F=G[U];return F?{...G,[U]:{...F,isActive:!1,endTime:P,duration:F.startTime?P-F.startTime:0,elapsedTime:F.startTime?P-F.startTime:0}}:G}),f===U&&h(null)},[f]),x=rt.useCallback((U,P)=>{n(G=>{const F=G[U];return F?{...G,[U]:{...F,name:`${F.name.split(" - ")[0]} - ${P}`}}:G})},[]),N=rt.useCallback(()=>{n({}),r(null),c(0),h(null),y.current&&clearInterval(y.current)},[]),D=rt.useCallback(()=>({totalTime:u,activeStep:f,steps:e,averages:{}}),[u,f,e]),k=rt.useCallback(U=>{if(U<1e3)return`${Math.round(U)}ms`;const P=Math.floor(U/1e3),G=Math.floor(P/60),F=Math.floor(G/60);return F>0?`${F}:${(G%60).toString().padStart(2,"0")}:${(P%60).toString().padStart(2,"0")}`:G>0?`${G}:${(P%60).toString().padStart(2,"0")}`:`${P}s`},[]),L=rt.useCallback((U,P,G)=>{const F=e[U];if(!F||!F.startTime||G===0)return"Calculando...";const $=Date.now()-F.startTime,X=$/(G/100),et=X-$,Q=Object.values(e).filter(At=>At.endTime&&At.duration>0),ut=Q.length>0?Q.reduce((At,O)=>At+O.duration,0)/Q.length:X,Ct=P-Object.keys(e).length,mt=et+Ct*ut;return k(Math.max(0,mt))},[e,k]);return{timers:e,totalElapsed:u,activeStep:f,startTotal:A,stopTotal:S,startStep:E,stopStep:b,updateStepProgress:x,reset:N,getStats:D,formatTime:k,getEstimatedTimeRemaining:L}},oG=i=>{const[t,e]=rt.useState(null),n=rt.useCallback(u=>{try{const c=window.localStorage.getItem(i);if(c){const f=JSON.parse(c);if(f.fileInfo&&f.fileInfo.name===u.name&&f.fileInfo.size===u.size&&f.fileInfo.lastModified===u.lastModified)return console.log(`Found and loaded existing process state for: ${u.name}`),e(f),f.processData}}catch(c){console.error(`Error reading state from localStorage for key "${i}":`,c)}return console.log(`No existing process state found for: ${u.name}`),e(null),null},[i]),o=rt.useCallback((u,c)=>{try{const f={processData:u,fileInfo:{name:c.name,size:c.size,lastModified:c.lastModified},timestamp:Date.now()};window.localStorage.setItem(i,JSON.stringify(f)),e(f)}catch(f){console.error(`Error saving state to localStorage for key "${i}":`,f)}},[i]),r=rt.useCallback(()=>{try{window.localStorage.removeItem(i),e(null)}catch(u){console.error(`Error clearing state from localStorage for key "${i}":`,u)}},[i]);return{persistedProcessState:(t==null?void 0:t.processData)??null,loadState:n,saveState:o,clearState:r}};class Hi{constructor(){this.baseUrl="http://localhost:3001/api/debug",this.enabled=!0}static getInstance(){return Hi.instance||(Hi.instance=new Hi),Hi.instance}async sendRequest(t,e,n="POST"){if(this.enabled)try{const o=new AbortController,r=setTimeout(()=>o.abort(),5e3),u={method:n,headers:{"Content-Type":"application/json"},signal:o.signal};e&&n!=="GET"&&(u.body=JSON.stringify(e));const c=await fetch(`${this.baseUrl}${t}`,u);return clearTimeout(r),await c.json()}catch(o){console.error("Failed to send debug data:",o)}}async log(t,e,n,o="frontend"){await this.sendRequest("/log",{level:t,message:e,data:n,source:o}),(t==="error"?console.error:t==="warn"?console.warn:t==="debug"?console.debug:console.log)(`[${t.toUpperCase()}] ${o}: ${e}`,n||"")}error(t,e,n="frontend"){const o=t instanceof Error?t.message:t,r=t instanceof Error?t.stack:void 0;this.sendRequest("/error",{error:o,stack:r,context:e,source:n}),console.error(`[ERROR] ${n}: ${o}`,{stack:r,context:e})}async getLogs(t){const e=new URLSearchParams;t!=null&&t.level&&e.set("level",t.level),t!=null&&t.source&&e.set("source",t.source),t!=null&&t.limit&&e.set("limit",t.limit.toString());const n=e.toString()?`?${e}`:"";return this.sendRequest(`/logs${n}`,void 0,"GET")}async getErrors(t){const e=t?`?limit=${t}`:"";return this.sendRequest(`/errors${e}`,void 0,"GET")}async getStatus(){return this.sendRequest("/status",void 0,"GET")}async clearLogs(){return this.sendRequest("/logs",void 0,"DELETE")}async clearErrors(){return this.sendRequest("/errors",void 0,"DELETE")}async clearAll(){return this.sendRequest("/all",void 0,"DELETE")}setupGlobalErrorHandling(){window.addEventListener("error",t=>{this.error(t.error||t.message,{filename:t.filename,lineno:t.lineno,colno:t.colno},"global-error")}),window.addEventListener("unhandledrejection",t=>{this.error(t.reason,{type:"unhandled-promise-rejection"},"global-promise")})}setEnabled(t){this.enabled=t}}const on=Hi.getInstance();function aG(){return rt.useEffect(()=>{on.setupGlobalErrorHandling()},[]),{log:on.log.bind(on),error:on.error.bind(on),getLogs:on.getLogs.bind(on),getErrors:on.getErrors.bind(on),getStatus:on.getStatus.bind(on),clearLogs:on.clearLogs.bind(on),clearErrors:on.clearErrors.bind(on),clearAll:on.clearAll.bind(on)}}Us.workerSrc="https://unpkg.com/pdfjs-dist@5.3.93/build/pdf.worker.min.mjs";const A_=i=>new Promise(t=>setTimeout(t,i)),N0={results:[],isProcessing:!1,isReformatting:!1,formattedText:null,progress:{processed:0,total:0,phase:"Ready",phaseProgress:""},error:null,footnoteAnalysis:null,processingTime:null,stepTimers:{},totalElapsed:0,isCompleted:!1},T_="pdfProcessState",rG=()=>{const[i,t]=rt.useState(N0),[e,n]=rt.useState(null),{saveState:o,loadState:r,clearState:u}=oG(T_),c=sG(i.stepTimers,i.totalElapsed),f=Hi.getInstance(),h=rt.useCallback(N=>{t(D=>{const k={...D,...N};return e&&o(k,e),k})},[e,o]),y=rt.useCallback(async(N,D="info",k)=>{const U=`[${new Date().toLocaleTimeString()}] ${N}`;console.log(`[${D.toUpperCase()}] ${U}`,k||""),Promise.resolve().then(async()=>{try{await f.log(D,U,k,"PDF-Processor")}catch(P){console.error("Failed to send log to debug server:",P)}})},[f]),A=rt.useCallback(()=>{e&&u(),t(N0),c.reset(),n(null);try{f.clearLogs(),f.clearErrors()}catch(D){console.error("Failed to clear debug logs:",D)}},[u,c,f,e]),S=rt.useCallback(async N=>{var L,U,P,G,F;let D=i.results;const k=i.results.filter($=>$.status!==ce.PENDING).length;await y(` startProcessing called: startFrom=${k}, currentResults=${i.results.length}`,"info"),await y(` Timer state: totalElapsed=${c.totalElapsed}, activeStep=${c.activeStep}`,"info"),k===0?(await y(`--- Starting new process for ${N.name} ---`,"info"),c.startTotal()):(await y(`--- Resuming process for ${N.name} from page ${k+1} ---`,"info"),c.startTotal()),h({isProcessing:!0});try{const $=new Uint8Array(await N.arrayBuffer()),X=await aM($).promise,et=X.numPages;k===0?(D=Array.from({length:et},(O,J)=>({pageNumber:J+1,status:ce.PENDING,text:null,imageUrl:null,method:null})),h({results:D,progress:{processed:0,total:et,phase:"Phase 1: Extracting text",phaseProgress:""}})):(i.progress.total===0||i.progress.total!==et)&&h({progress:{...i.progress,total:et,processed:k}});const Q=(L=i.stepTimers.phase1)==null?void 0:L.endTime,ut=D.every(O=>O.status!==ce.PENDING);if(await y(` Phase 1 check: phase1Complete=${!!Q}, allPagesExtracted=${ut}, startFrom=${k}, total=${et}`,"info"),!Q&&!ut){c.startStep("phase1","Phase 1: Extracting text"),await y(` Phase 1: Starting initial extraction from ${et} pages...`,"info");for(let O=k+1;O<=et;O++){const J=await X.getPage(O),at=J.getViewport({scale:1.5}),bt=document.createElement("canvas"),V=bt.getContext("2d");if(!V)throw new Error("Could not get canvas context");bt.height=at.height,bt.width=at.width;const Z=textContent.items.map(st=>st.str).join(" ").trim();if(Z.length>200)D[O-1]={...D[O-1],text:Z,status:ce.COMPLETED,method:"Native Extraction"};else{await J.render({canvasContext:V,viewport:at}).promise;const st=bt.toDataURL("image/jpeg");D[O-1]={...D[O-1],imageUrl:st,text:Z,status:ce.PROCESSING}}h({results:[...D],progress:{processed:O,total:et,phase:i.progress.phase||"Phase 1: Extracting text",phaseProgress:`${O}/${et} pages extracted`}}),await A_(1)}await y(" Phase 1 completed","info"),c.stopStep("phase1")}const Ct=(U=i.stepTimers.phase2)==null?void 0:U.endTime;await y(` Phase 2 check: phase2Complete=${!!Ct}`,"info");const mt=D.filter(O=>O.status!==ce.COMPLETED);if(!Ct&&mt.length>0){c.startStep("phase2","Phase 2: AI analyzing document"),await y(" Phase 2: AI analyzing document for extraction errors...","info");const O=mt.map(at=>`--- PAGE ${at.pageNumber} ---
${at.text||""}`).join(`

`),J=await y_(O);D.forEach(at=>{J.includes(at.pageNumber)&&(at.status=ce.CORRECTING)}),h({results:[...D]}),await y(` Found ${J.length} pages needing correction.`,"info",{pages:J}),c.stopStep("phase2")}const At=D.filter(O=>O.status===ce.CORRECTING);if(At.length>0&&!((P=i.stepTimers.phase3)!=null&&P.endTime)){c.startStep("phase3",`Phase 3: AI correction (${At.length} pages)`),await y(` Phase 3: Starting AI correction for ${At.length} pages...`,"info");for(const O of At){const J=O.pageNumber-1;await y(` Correcting page ${O.pageNumber}...`,"debug");const{text:at,imageUrl:bt}=O;let V=null,Z=null;if(bt){const st=bt.split(",")[1],it=at&&at.length>50?await nG(at,st):await eG(st);V=it.text,Z=it.changes}else V=at,Z="No image for AI OCR, relying on text analysis.";D[J]={...D[J],text:V,status:ce.COMPLETED,changes:Z,method:bt&&at&&at.length>50?"AI Correction":bt?"AI OCR":"Native Extraction (re-analyzed)"},h({results:[...D]})}await y(" Phase 3 completed","info"),c.stopStep("phase3")}if(!((G=i.stepTimers.phase4)!=null&&G.endTime)){c.startStep("phase4","Phase 4: AI formatting final document"),await y(" Phase 4: AI formatting final document...","info"),h({isReformatting:!0,error:null});const O=D.map(V=>V.text?`${V.text}

--- PAGE ${V.pageNumber} ---

`:"").join("");if(O.trim().length===0)throw new Error("No text to reformat.");const J=await v_(O),at=/<fn>.*?<\/fn>|{{footnote\d+/g,bt={count:((F=J.match(at))==null?void 0:F.length)||0,pages:[]};h({formattedText:J,footnoteAnalysis:bt}),await y(" PROCESSING COMPLETE!","info"),c.stopStep("phase4")}}catch($){await y(` ERROR: ${$.message||$}`,"error",{stack:$.stack}),h({error:$.message||"An unknown error occurred."})}finally{h({isProcessing:!1,isReformatting:!1,processingTime:c.totalElapsed/1e3,isCompleted:!0}),c.stopTotal()}},[i,h,y,c]),E=rt.useCallback(async N=>{var D,k,L,U;await y(" Iniciando continuao do processamento...","info"),c.activeStep||(c.startTotal(),await y(" Timer reativado para continuar contagem","info")),h({isProcessing:!0});try{let P=[...N.results];if(!((D=N.stepTimers.phase2)!=null&&D.endTime)){console.log(" ANTES de stepTimers.startStep"),c.startStep("phase2","Phase 2: AI analyzing document"),console.log(" DEPOIS de stepTimers.startStep"),await y(" Phase 2: AI analyzing document for extraction errors...","info"),await y(" [DEBUG] Linha 275 executada com sucesso!","info"),await y(" [DEBUG] Preparando anlise AI - criando textForAnalysis...","info");const F=P.map(X=>`--- PAGE ${X.pageNumber} ---
${X.text||""}`).join(`

`);await y(` [DEBUG] textForAnalysis criado - Length: ${F.length}`,"info"),await y(" [DEBUG] Chamando findProblematicPages...","info");const $=await y_(F);await y(` [DEBUG] findProblematicPages retornou: ${JSON.stringify($)}`,"info"),P.forEach(X=>{$.includes(X.pageNumber)&&(X.status=ce.CORRECTING)}),h({results:[...P]}),await y(` Found ${$.length} pages needing correction.`,"info",{pages:$}),c.stopStep("phase2")}const G=P.filter(F=>F.status===ce.CORRECTING);if(G.length>0&&!((k=N.stepTimers.phase3)!=null&&k.endTime)){c.startStep("phase3",`Phase 3: AI correction (${G.length} pages)`),await y(` Phase 3: AI correcting ${G.length} problematic pages...`,"info");for(const F of G)await y(` Correcting page ${F.pageNumber}...`,"info"),F.status=ce.COMPLETED,F.method="AI Correction",h({results:[...P]}),await A_(100);c.stopStep("phase3")}if(!((L=N.stepTimers.phase4)!=null&&L.endTime)&&!N.formattedText){c.startStep("phase4","Phase 4: Final formatting"),h({isReformatting:!0,error:null}),await y(" Phase 4: Formatting final document...","info");const F=P.map(Q=>Q.text||"").join(`

`),$=await v_(F),X=/<fn>.*?<\/fn>|{{footnote\d+/g,et={count:((U=$.match(X))==null?void 0:U.length)||0,pages:[]};h({formattedText:$,footnoteAnalysis:et}),await y(" PROCESSING COMPLETE!","info"),c.stopStep("phase4")}}catch(P){await y(` ERROR: ${P.message||P}`,"error",{stack:P.stack}),h({error:P.message||"An unknown error occurred."})}finally{h({isProcessing:!1,isReformatting:!1,processingTime:c.totalElapsed/1e3,isCompleted:!0}),c.stopTotal()}},[h,y,c]),b=rt.useCallback(async N=>{var k,L,U,P,G;n(N),await y(` processPdf chamado para: ${N.name} (${N.size} bytes)`,"info",{fileSize:N.size,apiKeyConfigured:!0});const D=r(N);if(D)if(await y(" Estado salvo encontrado - verificando compatibilidade...","info"),t(D),D.formattedText)await y(` Processo j estava completo. Restaurado: ${N.name}`,"info");else{const F=((k=D.progress)==null?void 0:k.total)||0,$=((L=D.progress)==null?void 0:L.processed)||0;if(F===0&&D.results&&D.results.length>0){const X={...D,progress:{...D.progress,total:D.results.length,processed:$}};t(X),await y(` Corrigido total de pginas: ${D.results.length} pginas`,"info")}await y(` Retomando processo para: ${N.name} (Progresso: ${((U=D.progress)==null?void 0:U.processed)||0}/${((P=D.progress)==null?void 0:P.total)||((G=D.results)==null?void 0:G.length)||0})`,"info"),await S(N)}else await y(` Iniciando novo processamento para: ${N.name}`,"info"),t(N0),await S(N)},[r,S,y]);rt.useEffect(()=>{(i.stepTimers!==c.timers||i.totalElapsed!==c.totalElapsed)&&h({stepTimers:c.timers,totalElapsed:c.totalElapsed})},[c.timers,c.totalElapsed,h,i.stepTimers,i.totalElapsed]);const x=rt.useCallback(async()=>{var N,D,k,L,U,P;try{await y(" Verificando estado salvo no localStorage...","info");const G=localStorage.getItem(T_);if(!G)return await y(" Nenhum estado salvo encontrado no localStorage","warn"),!1;await y(" Estado encontrado, analisando estrutura...","info");const F=JSON.parse(G);if(!F.processData||!F.fileInfo)return await y(" Estrutura de dados invlida no localStorage","warn",{hasProcessData:!!F.processData,hasFileInfo:!!F.fileInfo,keys:Object.keys(F)}),!1;await y(" Estrutura vlida encontrada, restaurando estado...","info",{fileName:F.fileInfo.name,progress:`${((N=F.processData.progress)==null?void 0:N.processed)||0}/${((D=F.processData.progress)==null?void 0:D.total)||0}`,phase:((k=F.processData.progress)==null?void 0:k.phase)||"unknown",isCompleted:F.processData.isCompleted,resultsCount:((L=F.processData.results)==null?void 0:L.length)||0});const $={...F.processData,progress:{...F.processData.progress,total:((U=F.processData.progress)==null?void 0:U.total)||((P=F.processData.results)==null?void 0:P.length)||0}};await y(` Estado corrigido - Progresso final: ${$.progress.processed}/${$.progress.total}`,"info"),t($);const X=new File([],F.fileInfo.name,{type:"application/pdf",lastModified:F.fileInfo.lastModified});return n(X),await y(` Processo retomado com sucesso: ${F.fileInfo.name}`,"info"),!$.isCompleted&&!$.formattedText&&(await y(` Continuando processamento automaticamente da pgina ${$.progress.processed+1}...`,"info"),await E($)),!0}catch(G){await y(` Erro ao retomar processo: ${G}`,"error",{error:G instanceof Error?G.message:String(G)}),console.error("Erro ao retomar do localStorage:",G)}return!1},[y]);return{...i,processPdf:b,clear:A,stepTimers:c,resumeFromLocalStorage:x,continueProcessingFromState:E}},Ti=({className:i,variant:t="default",size:e="default",...n})=>{const o="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",r={default:"bg-primary-600 text-primary-foreground hover:bg-primary-600/90 focus-visible:ring-primary-500 dark:bg-primary-500 dark:hover:bg-primary-500/90",outline:"border border-slate-300 dark:border-slate-700 bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 focus-visible:ring-slate-400 dark:focus-visible:ring-slate-500"},u={default:"px-4 py-2",sm:"px-3 py-1.5"};return R.jsx("button",{className:`${o} ${r[t]} ${u[e]} ${i||""}`,...n})},lG=({text:i})=>{const t=()=>{navigator.clipboard.writeText(i)};return R.jsxs("div",{className:"w-full h-full flex flex-col",children:[R.jsxs("div",{className:"flex justify-between items-center mb-3",children:[R.jsx("h3",{className:"text-lg font-semibold dark:text-slate-100",children:"Resultado Final"}),R.jsx(Ti,{variant:"outline",size:"sm",onClick:t,children:"Copiar Texto"})]}),R.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"Abaixo est o texto final processado pela IA. Voc pode revisar, copiar ou fazer o download como um arquivo .txt."}),R.jsx("div",{className:"flex-grow bg-slate-50 dark:bg-slate-900/50 rounded-md ring-1 ring-slate-200 dark:ring-slate-700 h-[50vh] min-h-[300px]",children:R.jsx("textarea",{readOnly:!0,className:"w-full h-full p-4 bg-transparent border-0 resize-none focus:ring-0 text-sm font-sans dark:text-slate-300",value:i})})]})};function uG({stepId:i,timers:t,formatTime:e,isActive:n,isCompleted:o}){const r=t[i];return!r&&!n?null:R.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${n?"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200":o?"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:[R.jsx(z0,{className:"w-3 h-3"}),R.jsx("span",{className:"font-mono",children:r?e(r.isActive?r.elapsedTime:r.duration):"0s"}),n&&R.jsx("div",{className:"w-1 h-1 bg-current rounded-full animate-pulse"})]})}function cG({currentStep:i,isProcessing:t,isReformatting:e,progress:n,pagesWithAICorrection:o,debugLogs:r,timers:u={},formatTime:c=f=>`${Math.round(f/1e3)}s`}){const h=(()=>{const E=r.slice(-10).join(" ");return e||E.includes("Phase 4")||E.includes("")?4:E.includes("Phase 3")||E.includes("")?3:E.includes("Phase 2")||E.includes("")?2:t||E.includes("Phase 1")||E.includes("")?1:0})(),y=[{id:1,name:"Text Extraction",icon:tw,description:"Extracting text from PDF pages using built-in text layer",status:h>1?"completed":h===1?"active":"pending",details:n.phaseProgress||`${n.processed}/${n.total} pages processed`},{id:2,name:"AI Analysis",icon:oB,description:"AI analyzing document to identify pages with extraction errors",status:h>2?"completed":h===2?"active":"pending",details:o.length>0?`${o.length} pages need AI correction`:"All pages extracted cleanly"},{id:3,name:"AI Correction",icon:sB,description:"Reprocessing problematic pages with AI for maximum accuracy",status:h>3?"completed":h===3?"active":"pending",details:o.length>0?`Pages ${o.join(", ")} corrected`:"No corrections needed"},{id:4,name:"Final Formatting",icon:q0,description:"AI consolidating and formatting the complete document",status:h>4?"completed":h===4||e?"active":"pending",details:"Cleaning text, removing artifacts, applying final structure"}],A=E=>{switch(E){case"completed":return R.jsx(q0,{className:"w-5 h-5 text-green-500"});case"active":return R.jsx(z0,{className:"w-5 h-5 text-blue-500 animate-spin"});case"pending":return R.jsx(z0,{className:"w-5 h-5 text-gray-400"});default:return R.jsx(iB,{className:"w-5 h-5 text-red-500"})}},S=E=>{switch(E){case"completed":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"active":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";case"pending":return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-700";default:return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}};return R.jsxs(Vi,{className:"p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"Processing Status - Behind the Scenes"}),R.jsx("div",{className:"space-y-4",children:y.map(E=>{const b=E.icon;return R.jsx("div",{className:`p-4 border rounded-lg transition-all duration-300 ${S(E.status)}`,children:R.jsxs("div",{className:"flex items-start space-x-3",children:[R.jsx("div",{className:"flex-shrink-0 mt-0.5",children:A(E.status)}),R.jsxs("div",{className:"flex-grow",children:[R.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[R.jsx(b,{className:"w-4 h-4 text-slate-600 dark:text-slate-400"}),R.jsxs("h4",{className:"font-medium text-slate-800 dark:text-slate-100",children:["Phase ",E.id,": ",E.name]}),R.jsx(uG,{stepId:`phase${E.id}`,timers:u,formatTime:c,isActive:E.status==="active",isCompleted:E.status==="completed"})]}),R.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:E.description}),R.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500 font-mono",children:E.details})]})]})},E.id)})}),R.jsxs("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[R.jsx("h4",{className:"font-medium text-slate-800 dark:text-slate-100 mb-2",children:"Current Activity"}),R.jsxs("div",{className:"flex items-center space-x-2",children:[R.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),R.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:[e&&"AI is formatting the final document...",t&&"Processing pages and analyzing content...",!t&&!e&&i<4&&"Ready to process",i===4&&"Processing complete!"]})]})]})]})}function dG({isOpen:i,onClose:t}){var k,L,U,P,G,F,$,X,et,Q,ut,Ct,mt,At;const e=aG(),[n,o]=rt.useState([]),[r,u]=rt.useState([]),[c,f]=rt.useState(null),[h,y]=rt.useState("logs"),[A,S]=rt.useState(!1),E=rt.useRef(null);rt.useEffect(()=>{i&&b()},[i]),rt.useEffect(()=>{if(A){const O=setInterval(b,2e3);return()=>clearInterval(O)}},[A]),rt.useEffect(()=>{i&&E.current&&(E.current.scrollTop=E.current.scrollHeight)},[n,i]);const b=async()=>{try{const[O,J,at]=await Promise.all([e.getLogs({limit:50}),e.getErrors(20),e.getStatus()]);o((O==null?void 0:O.logs)||[]),u((J==null?void 0:J.errors)||[]),f(at)}catch(O){console.error("Failed to refresh debug data:",O)}},x=async()=>{await e.clearLogs(),b()},N=async()=>{await e.clearErrors(),b()},D=async()=>{await e.clearAll(),b()};return i?R.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:R.jsxs(Vi,{className:"w-11/12 h-5/6 bg-white flex flex-col",children:[R.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[R.jsx("h2",{className:"text-xl font-bold",children:"Debug Panel"}),R.jsxs("div",{className:"flex gap-2",children:[R.jsx(Ti,{variant:A?"default":"outline",onClick:()=>S(!A),className:"text-sm",children:A?"Auto-refresh ON":"Auto-refresh OFF"}),R.jsx(Ti,{onClick:b,className:"text-sm",children:"Refresh"}),R.jsx(Ti,{onClick:D,variant:"outline",className:"text-sm bg-red-50 hover:bg-red-100 text-red-700 border-red-300",children:" Limpar Tudo"}),R.jsx(Ti,{onClick:t,variant:"outline",className:"text-sm",children:""})]})]}),R.jsxs("div",{className:"flex border-b",children:[R.jsxs("button",{className:`px-4 py-2 ${h==="logs"?"bg-blue-100 border-b-2 border-blue-500":""}`,onClick:()=>y("logs"),children:["Logs (",n.length,")"]}),R.jsxs("button",{className:`px-4 py-2 ${h==="errors"?"bg-red-100 border-b-2 border-red-500":""}`,onClick:()=>y("errors"),children:["Errors (",r.length,")"]}),R.jsx("button",{className:`px-4 py-2 ${h==="status"?"bg-green-100 border-b-2 border-green-500":""}`,onClick:()=>y("status"),children:"Status"})]}),R.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[h==="logs"&&R.jsxs("div",{children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsx("h3",{className:"font-semibold",children:"Application Logs"}),R.jsx(Ti,{onClick:x,variant:"outline",className:"text-sm",children:"Clear Logs"})]}),R.jsx("div",{className:"space-y-2 font-mono text-sm",children:n.map((O,J)=>R.jsxs("div",{className:`p-2 rounded border-l-4 ${O.level==="error"?"border-red-500 bg-red-50":O.level==="warn"?"border-yellow-500 bg-yellow-50":O.level==="debug"?"border-gray-500 bg-gray-50":"border-blue-500 bg-blue-50"}`,children:[R.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[R.jsxs("span",{children:["[",O.level.toUpperCase(),"] ",O.source]}),R.jsx("span",{children:new Date(O.timestamp).toLocaleTimeString()})]}),R.jsx("div",{className:"font-medium",children:O.message}),O.data&&R.jsx("pre",{className:"mt-1 text-xs bg-white p-2 rounded overflow-auto max-h-20",children:JSON.stringify(O.data,null,2)})]},J))})]}),h==="errors"&&R.jsxs("div",{children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsx("h3",{className:"font-semibold",children:"Application Errors"}),R.jsx(Ti,{onClick:N,variant:"outline",className:"text-sm",children:"Clear Errors"})]}),R.jsx("div",{className:"space-y-2 font-mono text-sm",children:r.map((O,J)=>R.jsxs("div",{className:"p-2 rounded border-l-4 border-red-500 bg-red-50",children:[R.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[R.jsx("span",{children:"ERROR"}),R.jsx("span",{children:new Date(O.timestamp).toLocaleTimeString()})]}),R.jsx("div",{className:"font-medium text-red-800",children:O.error}),O.stack&&R.jsx("pre",{className:"mt-1 text-xs bg-white p-2 rounded overflow-auto max-h-32",children:O.stack}),O.context&&R.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-20",children:JSON.stringify(O.context,null,2)})]},J))})]}),h==="status"&&R.jsxs("div",{children:[R.jsx("h3",{className:"font-semibold mb-4",children:"Server Status"}),c&&R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[R.jsxs(Vi,{className:"p-4",children:[R.jsx("h4",{className:"font-medium mb-2",children:"Server Info"}),R.jsxs("div",{className:"text-sm space-y-1",children:[R.jsxs("div",{children:["Uptime: ",((k=c.server)==null?void 0:k.uptime)||"N/A"]}),R.jsxs("div",{children:["Version: ",((L=c.server)==null?void 0:L.version)||"N/A"]}),R.jsxs("div",{children:["Platform: ",((U=c.server)==null?void 0:U.platform)||"N/A"]})]})]}),R.jsxs(Vi,{className:"p-4",children:[R.jsx("h4",{className:"font-medium mb-2",children:"Logs Summary"}),R.jsxs("div",{className:"text-sm space-y-1",children:[R.jsxs("div",{children:["Total: ",((P=c.logs)==null?void 0:P.total)||0]}),R.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[R.jsxs("div",{children:["Info: ",((F=(G=c.logs)==null?void 0:G.byLevel)==null?void 0:F.info)||0]}),R.jsxs("div",{children:["Warn: ",((X=($=c.logs)==null?void 0:$.byLevel)==null?void 0:X.warn)||0]}),R.jsxs("div",{children:["Error: ",((Q=(et=c.logs)==null?void 0:et.byLevel)==null?void 0:Q.error)||0]}),R.jsxs("div",{children:["Debug: ",((Ct=(ut=c.logs)==null?void 0:ut.byLevel)==null?void 0:Ct.debug)||0]})]})]})]})]}),R.jsxs(Vi,{className:"p-4",children:[R.jsx("h4",{className:"font-medium mb-2",children:"Recent Errors"}),R.jsx("div",{className:"text-sm space-y-1 max-h-40 overflow-auto",children:((At=(mt=c.errors)==null?void 0:mt.recent)==null?void 0:At.map((O,J)=>R.jsxs("div",{className:"p-2 bg-red-50 rounded text-xs",children:[R.jsx("div",{className:"font-medium",children:O.error}),R.jsx("div",{className:"text-gray-600",children:new Date(O.timestamp).toLocaleString()})]},J)))||R.jsx("div",{className:"text-gray-500",children:"No recent errors"})})]})]})]})]})]})}):null}const fG=({isOpen:i,processInfo:t,onResume:e,onDismiss:n})=>{if(rt.useEffect(()=>{if(i){const r=setTimeout(()=>{n()},3e4);return()=>clearTimeout(r)}},[i,n]),!i||!t)return null;const o=r=>{const c=Date.now()-r,f=Math.floor(c/6e4),h=Math.floor(f/60);return h>0?`h ${h}h${f%60}min`:f>0?`h ${f} minutos`:"h pouco tempo"};return R.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:R.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 border border-slate-200 dark:border-slate-700",children:[R.jsx("div",{className:"flex items-center justify-center mb-4",children:R.jsx("div",{className:"w-16 h-16 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center",children:R.jsx("svg",{className:"w-8 h-8 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),R.jsx("h3",{className:"text-xl font-bold text-center text-slate-900 dark:text-slate-100 mb-2",children:"Processo Interrompido Detectado"}),R.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/50 rounded-lg p-4 mb-6 space-y-2",children:[R.jsxs("div",{className:"flex justify-between",children:[R.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Arquivo:"}),R.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate max-w-48",children:t.fileName})]}),R.jsxs("div",{className:"flex justify-between",children:[R.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Progresso:"}),R.jsxs("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:[t.progress," pginas processadas"]})]}),R.jsxs("div",{className:"flex justify-between",children:[R.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"ltima fase:"}),R.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.lastStep})]}),R.jsxs("div",{className:"flex justify-between",children:[R.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Interrompido:"}),R.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:o(t.timestamp)})]})]}),R.jsxs("div",{className:"flex gap-3",children:[R.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors duration-200",children:"Ignorar"}),R.jsxs("button",{onClick:e,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[R.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8M7 7h10a2 2 0 012 2v8a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2z"})}),"Retomar Processo"]})]}),R.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center mt-3",children:"Este dilogo ser fechado automaticamente em 30 segundos"})]})})},hG=()=>{const[i,t]=rt.useState({hasIncompleteProcess:!1,processInfo:null}),[e,n]=rt.useState(!1),o=rt.useCallback(()=>{var c,f,h;try{const y=window.localStorage.getItem("pdfProcessState");if(y){const A=JSON.parse(y);if(A.processData&&!A.processData.isCompleted&&A.processData.isProcessing){const S={fileName:((c=A.fileInfo)==null?void 0:c.name)||"Arquivo desconhecido",progress:((f=A.processData.progress)==null?void 0:f.processed)||0,lastStep:((h=A.processData.progress)==null?void 0:h.phase)||"Desconhecido",timestamp:A.timestamp||Date.now()};return t({hasIncompleteProcess:!0,processInfo:S}),setTimeout(()=>{n(!0),setTimeout(async()=>{try{console.log(" [AUTO-RESUME] Iniciando continuao automtica...");const E=new CustomEvent("autoResumeProcess",{detail:{processInfo:S}});window.dispatchEvent(E)}catch(E){console.error("Erro no auto-resume:",E)}},3e3)},1e3),!0}}}catch(y){console.error("Erro ao verificar processo incompleto:",y)}return t({hasIncompleteProcess:!1,processInfo:null}),!1},[]),r=rt.useCallback(()=>{try{const c=window.localStorage.getItem("pdfProcessState");if(c){const f=JSON.parse(c);f.processData&&(f.processData.isCompleted=!0,f.processData.isProcessing=!1,window.localStorage.setItem("pdfProcessState",JSON.stringify(f)))}}catch(c){console.error("Erro ao marcar processo como finalizado:",c)}},[]),u=rt.useCallback(()=>{t({hasIncompleteProcess:!1,processInfo:null}),n(!1)},[]);return rt.useEffect(()=>{const c=setTimeout(()=>{o()},500);return()=>clearTimeout(c)},[o]),{autoResumeState:i,showResumeDialog:e,setShowResumeDialog:n,checkForIncompleteProcess:o,markProcessAsCompleted:r,dismissIncompleteProcess:u}},pG=()=>{const[i,t]=rt.useState([]),e=Hi.getInstance(),n=rt.useCallback(async()=>{try{console.log("Tentando buscar logs do servidor debug...");const o=await e.getLogs({limit:10});if(console.log("Resposta do servidor:",o),o!=null&&o.logs){const r=o.logs.map(u=>`[${new Date(u.timestamp).toLocaleTimeString()}] ${u.level.toUpperCase()}: ${u.message}`);t(r)}else t([" Nenhum log encontrado no servidor"])}catch(o){console.error("Erro ao buscar logs:",o),t([" Erro ao conectar com servidor de debug"," Verifique se o servidor backend est rodando na porta 3001",` Erro detalhado: ${o instanceof Error?o.message:String(o)}`])}},[e]);return rt.useEffect(()=>{n();const o=setInterval(n,2e3);return()=>clearInterval(o)},[n]),{logs:i,refreshLogs:n}};function gG(){const[i,t]=rt.useState("ocr"),[e,n]=rt.useState("AIzaSyAQ2G3iTq-ncvefA-a6T8dfo_VYR1IudzU"),[o,r]=rt.useState(!1),[u,c]=rt.useState(!1),f=rt.useMemo(()=>new Hi,[]);rt.useEffect(()=>{e&&Kx(e)},[e]);const[h,y]=rt.useState(null),{results:A=[],processPdf:S,isProcessing:E,isReformatting:b,footnoteAnalysis:x,formattedText:N,progress:D,error:k,clear:L,resumeFromLocalStorage:U,continueProcessingFromState:P}=rG(),{autoResumeState:G,showResumeDialog:F,markProcessAsCompleted:$,dismissIncompleteProcess:X}=hG(),{logs:et}=pG();rt.useEffect(()=>{Hi.getInstance().log("info"," PDF OCR Pro iniciado",null,"App").catch(console.error)},[]);const[Q,ut]=rt.useState(0),[Ct,mt]=rt.useState("summary"),At=()=>{const[ht,gt]=rt.useState(""),[wt,Vt]=rt.useState(()=>localStorage.getItem("selectedModel")||"gemini-2.5-flash"),[Ue,ar]=rt.useState("Hello world"),[$i,Gs]=rt.useState("{}"),[Vs,$o]=rt.useState(""),[dp,fp]=rt.useState(null),[Xn,hp]=rt.useState(!1),pp=async()=>{fp(null),$o(""),hp(!0),Kx(ht);try{const Cn=JSON.parse($i||"{}"),$l=await td.generateContent({model:wt,contents:Ue,config:Cn});$o($l.text)}catch(Cn){fp(Cn.message||String(Cn))}finally{hp(!1)}};return R.jsxs(Vi,{className:"max-w-xl mx-auto p-6 space-y-4 overflow-y-auto max-h-[70vh]",children:[R.jsx("h2",{className:"text-2xl font-bold",children:"LLM API Tester"}),R.jsxs("div",{className:"flex flex-col",children:[R.jsx("label",{className:"mb-1 font-medium",children:"API Key"}),R.jsx("input",{className:"border rounded px-3 py-2",type:"password",placeholder:"Enter API Key",value:ht,onChange:Cn=>gt(Cn.target.value)})]}),R.jsxs("div",{className:"flex flex-col",children:[R.jsx("label",{className:"mb-1 font-medium",children:"Model"}),R.jsxs("select",{className:"border rounded px-3 py-2",value:wt,onChange:Cn=>Vt(Cn.target.value),children:[R.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash"}),R.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro"})]})]}),R.jsxs("div",{className:"flex flex-col",children:[R.jsx("label",{className:"mb-1 font-medium",children:"Contents"}),R.jsx("textarea",{className:"border rounded px-3 py-2 h-24",value:Ue,onChange:Cn=>ar(Cn.target.value)})]}),R.jsxs("div",{className:"flex flex-col",children:[R.jsx("label",{className:"mb-1 font-medium",children:"Config (JSON)"}),R.jsx("textarea",{className:"border rounded px-3 py-2 h-20 font-mono text-sm",value:$i,onChange:Cn=>Gs(Cn.target.value)})]}),R.jsxs("div",{className:"flex space-x-2",children:[R.jsx(Ti,{onClick:pp,disabled:Xn,className:"flex-1",children:Xn?"Generating...":"Generate"}),R.jsx(Ti,{variant:"outline",onClick:()=>{localStorage.setItem("selectedModel",wt),alert("Model saved successfully!"),t("ocr")},className:"flex-1",children:"Save Model"})]}),dp&&R.jsxs(Vi,{className:"bg-red-100 border-red-400 text-red-800 p-4",children:[R.jsx("strong",{children:"Error:"})," ",dp]}),Vs&&R.jsxs(Vi,{className:"bg-green-50 p-4",children:[R.jsx("h3",{className:"font-semibold mb-2",children:"Response"}),R.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:Vs})]})]})},O=async()=>{var ht,gt;if(G.processInfo)try{if(await f.log("info",` Tentando retomar processo para: ${G.processInfo.fileName}`,{progress:G.processInfo.progress,lastStep:G.processInfo.lastStep}),await U()){await f.log("info"," Estado restaurado do localStorage");const Vt=localStorage.getItem("pdfProcessState");if(Vt){const Ue=JSON.parse(Vt);Ue.fileInfo&&!Ue.processData.isCompleted&&(await f.log("info"," Iniciando continuao automtica do processamento..."),await P(Ue),await f.log("info"," Processamento continuado automaticamente!"),await f.log("info",` Progresso salvo: ${((ht=Ue.processData.progress)==null?void 0:ht.processed)||0}/${((gt=Ue.processData.progress)==null?void 0:gt.total)||0} pginas`))}}else await f.log("error"," No foi possvel restaurar estado do localStorage");X()}catch(wt){console.error("Erro ao retomar processo:",wt),await f.log("error",` Erro ao retomar processo: ${wt}`),X()}},J=()=>{X()};rt.useEffect(()=>{N&&!k&&$()},[N,k,$]),rt.useEffect(()=>{N?ut(4):b?ut(3):E?(D.processed===D.total&&D.total>0,ut(2)):ut(h?1:0)},[E,b,N,h,D]);const at=rt.useCallback(ht=>{y(ht),ut(1),Hi.getInstance().log("info",` Arquivo selecionado: ${ht.name}`,{size:ht.size,type:ht.type,lastModified:ht.lastModified},"FileSelection").catch(console.error)},[]),bt=rt.useCallback(()=>{h&&(Hi.getInstance().log("info",` Iniciando processamento de: ${h.name}`,{fileSize:h.size,apiKeyConfigured:!!e},"ProcessingStart").catch(console.error),S(h))},[h,S,e]),V=rt.useCallback(()=>{y(null),L(),mt("summary")},[L]),Z=rt.useCallback(()=>{if(!N)return;const ht=new Blob([N],{type:"text/plain;charset=utf-8"}),gt=URL.createObjectURL(ht),wt=document.createElement("a");wt.href=gt,wt.download=`${h==null?void 0:h.name.replace(/\.pdf$/i,"")}_final.txt`||"final_document.txt",document.body.appendChild(wt),wt.click(),document.body.removeChild(wt),URL.revokeObjectURL(gt)},[N,h]),st=["Upload","Confirm","Process","Analyze Notes","Finalize","Download"],it=rt.useMemo(()=>A.filter(ht=>ht.method==="AI Correction"||ht.method==="AI OCR").map(ht=>ht.pageNumber),[A]),yt=()=>{if(i==="api")return R.jsx(At,{});switch(Q){case 0:return R.jsx(aB,{onFileSelect:at});case 1:return R.jsxs("div",{className:"text-center w-full",children:[R.jsx(tw,{className:"mx-auto h-16 w-16 text-primary-500"}),R.jsx("h3",{className:"mt-2 text-lg font-medium text-slate-900 dark:text-slate-100",children:"PDF Selected"}),R.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:h==null?void 0:h.name}),R.jsxs("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:["(",((h==null?void 0:h.size)||0)/1024/1024>1?`${(((h==null?void 0:h.size)||0)/1024/1024).toFixed(2)} MB`:`${(((h==null?void 0:h.size)||0)/1024).toFixed(2)} KB`,")"]}),R.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[R.jsx(Ti,{onClick:V,variant:"outline",children:"Change File"}),R.jsxs(Ti,{onClick:bt,disabled:!e,children:[R.jsx(jO,{className:"mr-2 h-4 w-4"}),"Start Processing"]})]}),!e&&R.jsx("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:R.jsx("p",{className:"text-amber-800 dark:text-amber-200 text-sm",children:" Please enter your API Key above to start processing the PDF."})})]});case 2:return R.jsxs("div",{className:"w-full space-y-6",children:[R.jsx(cG,{currentStep:Q,isProcessing:E,isReformatting:b,progress:D,footnoteAnalysis:x,pagesWithAICorrection:it,debugLogs:et}),R.jsx(lB,{results:A,isProcessing:E,isReformatting:b,progress:D,error:k})]});case 3:return R.jsxs("div",{className:"w-full text-center flex flex-col items-center justify-center",children:[R.jsx(nB,{className:"w-16 h-16 text-primary-500"}),R.jsx("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:"Analyzing Footnotes..."}),R.jsxs("div",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400 min-h-[42px]",children:[x&&x.count>0&&R.jsxs("div",{className:"animate-fade-in",children:[R.jsxs("p",{children:[R.jsx("strong",{children:x.count})," notes found on pages: ",x.pages.join(", "),"."]}),R.jsx("p",{className:"mt-1",children:"Continuing to final formatting..."})]}),x&&x.count===0&&R.jsxs("div",{className:"animate-fade-in",children:[R.jsx("p",{children:"No footnotes found."}),R.jsx("p",{className:"mt-1",children:"Proceeding to finalization..."})]})]})]});case 4:return R.jsxs("div",{className:"w-full text-center flex flex-col items-center justify-center",children:[R.jsx(eB,{className:"w-16 h-16 text-primary-500 animate-bounce"}),R.jsx("p",{className:"mt-4 text-lg font-medium dark:text-slate-200",children:"Finalizing with AI..."}),R.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Gathering text, removing artifacts and formatting the final document."})]});case 5:return R.jsxs("div",{className:"w-full h-full flex flex-col",children:[R.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700 mb-4",children:R.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[R.jsx("button",{onClick:()=>mt("summary"),className:`${Ct==="summary"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-200 dark:hover:border-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none`,children:"Processing Summary"}),R.jsx("button",{onClick:()=>mt("final"),className:`${Ct==="final"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-200 dark:hover:border-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none`,children:"Final Text"}),R.jsx("button",{onClick:()=>mt("debug"),className:`${Ct==="debug"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm`,children:"Debug Logs"})]})}),R.jsxs("div",{className:"flex-grow min-h-[55vh]",children:[Ct==="summary"&&R.jsx("div",{className:"w-full h-full flex flex-col gap-6 text-sm animate-fade-in",children:R.jsxs(Vi,{className:"p-4",children:[R.jsx("h4",{className:"font-semibold text-base mb-2 text-slate-800 dark:text-slate-100",children:"AI Correction Procedure"}),R.jsxs("p",{className:"text-slate-600 dark:text-slate-400",children:["The document was processed with an optimized strategy for speed and precision, using the ",R.jsx("strong",{className:"text-slate-900 dark:text-slate-200",children:"Gemini 2.5 Flash"})," model."]}),R.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1.5 text-slate-600 dark:text-slate-400",children:[R.jsxs("li",{children:[R.jsx("strong",{children:"Quick Extraction:"})," All text was initially extracted from the PDF's text layer for maximum speed."]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Intelligent Analysis:"})," AI analyzed the complete document to identify pages with likely extraction errors (e.g., broken tables, missing text)."]}),it.length>0&&R.jsxs("li",{children:[R.jsx("strong",{children:"Targeted Correction:"})," Pages ",R.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:it.join(", ")})," were reprocessed with AI to ensure maximum fidelity."]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Footnote Analysis:"}),x&&x.count>0?R.jsxs("span",{children:[" The system identified and marked ",R.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:x.count})," footnotes for formatting."]}):R.jsx("span",{children:" No footnotes were detected in the document."})]}),R.jsxs("li",{children:[R.jsx("strong",{children:"Final Formatting:"})," Text from all pages was consolidated, cleaned and reformatted by AI to generate the final document structure."]})]})]})}),Ct==="final"&&N&&R.jsx(lG,{text:N}),Ct==="debug"&&R.jsx("pre",{className:"whitespace-pre-wrap bg-gray-100 p-4 overflow-auto h-full",children:et.join(`
`)})]})]});default:return null}};return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex space-x-4 mb-4",children:[R.jsx("button",{onClick:()=>t("ocr"),className:"btn",children:"OCR App"}),R.jsx("button",{onClick:()=>t("api"),className:"btn",children:"LLM API"})]}),i==="ocr"?R.jsx("div",{className:"min-h-screen flex flex-col items-center p-4 sm:p-6 lg:p-8 font-sans",children:R.jsxs("div",{className:"w-full max-w-7xl mx-auto",children:[R.jsxs("header",{className:"text-center mb-6",children:[R.jsx("h1",{className:"text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-50",children:"PDF OCR Pro"}),R.jsx("p",{className:"mt-2 text-lg text-slate-600 dark:text-slate-400",children:"Extract and format documents from PDFs with precision."})]}),R.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[R.jsx("input",{className:"border rounded px-3 py-2 w-80",type:"password",placeholder:"Enter Google Gemini API Key",value:e,onChange:ht=>n(ht.target.value)}),!e&&R.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Please enter your Gemini API Key to process the PDF."})]}),R.jsxs("main",{className:"w-full",children:[R.jsx(uB,{steps:st,currentStep:Q}),R.jsx("div",{className:"mt-8 bg-white dark:bg-slate-800/50 rounded-xl shadow-lg p-6 min-h-[400px] flex flex-col justify-center items-center ring-1 ring-slate-200 dark:ring-slate-700",children:yt()}),Q===5&&R.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[R.jsxs(Ti,{onClick:V,variant:"outline",children:[R.jsx(tB,{className:"mr-2 h-4 w-4"}),"Process New PDF"]}),R.jsxs(Ti,{onClick:Z,children:[R.jsx(ZO,{className:"mr-2 h-4 w-4"}),"Download Final .txt"]})]})]}),R.jsx("footer",{className:"text-center mt-12 text-sm text-slate-500 dark:text-slate-400",children:R.jsxs("p",{children:[" ",new Date().getFullYear()," PDF OCR Pro. Built with React & Gemini."]})})]})}):R.jsx(At,{}),R.jsx(dG,{isOpen:u,onClose:()=>c(!1)}),R.jsxs("div",{className:`fixed bottom-0 left-0 right-0 bg-gray-100 dark:bg-gray-800 border-t z-50 transition-all duration-300 ${o?"h-12":"h-64"}`,children:[R.jsxs("div",{className:"flex justify-between items-center p-3",children:[R.jsx("h3",{className:"font-semibold text-sm",children:"Debug Logs"}),R.jsx("div",{className:"flex gap-2",children:R.jsx("button",{onClick:()=>r(!o),className:"text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded",children:o?" Expand":" Minimize"})})]}),!o&&R.jsx("div",{className:"px-4 pb-6 overflow-auto",style:{height:"220px"},children:R.jsx("pre",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:et.join(`
`)})})]}),R.jsx(fG,{isOpen:F,processInfo:G.processInfo,onResume:O,onDismiss:J})]})}const d1=document.getElementById("root");if(!d1)throw new Error("Could not find root element to mount to");const mG=zN.createRoot(d1);mG.render(R.jsx(UN.StrictMode,{children:R.jsx(gG,{})}));
